5~@~   2.  19.60905:D:   40:*:*:M: MSSQL - Change AppInfo table~@~34~@~40~@~D~@~~@~~@~M~@~~@~MSSQL - Change AppInfo table~@~Y~@~-- Add AppItemLink to table AppInfo on all design db:
if not exists (select 'true' from dbo.syscolumns where id = object_id('dbo.AppInfo') and name = 'AppItemLink')
BEGIN
	EXEC ('CREATE TABLE dbo.Tmp_AppInfo(
	AppInfoId int NOT NULL,
	VersionMa smallint NOT NULL,
	VersionMi smallint NOT NULL,
	VersionDt datetime NULL)')
	EXEC ('INSERT INTO dbo.Tmp_AppInfo (AppInfoId, VersionMa, VersionMi, VersionDt)
	SELECT AppInfoId, VersionMa, VersionMi, VersionDt FROM dbo.AppInfo')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.Tmp_AppInfo) > 0 OR (SELECT COUNT(1) FROM dbo.AppInfo) = 0 DROP TABLE dbo.AppInfo')
	EXEC ('CREATE TABLE dbo.AppInfo(
	AppInfoId int IDENTITY NOT NULL,
	AppInfoDesc varchar(50) NULL,
	VersionMa smallint NOT NULL,
	VersionMi smallint NOT NULL,
	VersionDt datetime NULL,
	Prerequisite nvarchar(200) NULL,
	Readme ntext NULL,
	AppItemLink varchar(200) NULL,
	CONSTRAINT PK_AppInfo PRIMARY KEY CLUSTERED (AppInfoId))')
	EXEC ('SET IDENTITY_INSERT dbo.AppInfo ON
		INSERT INTO dbo.AppInfo (AppInfoId, AppInfoDesc, VersionMa, VersionMi, VersionDt)
		SELECT AppInfoId, right(space(3)+convert(varchar,VersionMa),4) + ''.'' + right(space(3)+convert(varchar,VersionMi),4)
		+ case when VersionDt is null then space(0)
		else ''.'' + right(convert(varchar,datepart(yy,VersionDt)),1) + right(''0''+convert(varchar,datepart(mm,VersionDt)),2)
		+ right(''0''+convert(varchar,datepart(dd,VersionDt)),2) end
		, VersionMa, VersionMi, VersionDt FROM dbo.Tmp_AppInfo
		SET IDENTITY_INSERT dbo.AppInfo OFF')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.AppInfo) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AppInfo) = 0 DROP TABLE dbo.Tmp_AppInfo')
END
GO
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5&typ=N&sys=3","","",""); return false;
7~@~   2.  19.60905:D:   10:*:*:*: Add four Ct tables~@~34~@~10~@~D~@~~@~~@~~@~~@~Add four Ct tables~@~N~@~-- ??Design:
if not exists (select 'true' from dbo.sysobjects where id = object_id('dbo.CtDbProvider'))
BEGIN
	EXEC ('CREATE TABLE dbo.CtDbProvider (
	DbProviderCd char (1) NOT NULL ,
	DbProviderName nvarchar (50) NOT NULL ,
	DbProviderOle varchar (30) NOT NULL,
	CONSTRAINT PK_CtDbProvider PRIMARY KEY CLUSTERED (DbProviderCd))')
	INSERT INTO CtDbProvider VALUES ('M','MsSQL','Sqloledb')
	INSERT INTO CtDbProvider VALUES ('S','Sybase','Sybase.ASEOLEDBProvider')
END
GO

if not exists (select 'true' from dbo.sysobjects where id = object_id('dbo.CtFramework'))
BEGIN
	EXEC ('CREATE TABLE dbo.CtFramework (
	FrameworkCd char (1) NOT NULL ,
	FrameworkName nvarchar (50) NOT NULL,
	CONSTRAINT PK_CtFramework PRIMARY KEY CLUSTERED (FrameworkCd))')
	INSERT INTO CtFramework VALUES ('1','DotNet 1.1')
	INSERT INTO CtFramework VALUES ('2','DotNet 2.0')
END
GO

if not exists (select 'true' from dbo.sysobjects where id = object_id('dbo.CtLanguage'))
BEGIN
	EXEC ('CREATE TABLE dbo.CtLanguage (
	LanguageCd char (1) NOT NULL ,
	LanguageName nvarchar (50) NOT NULL,
	CONSTRAINT PK_CtLanguage PRIMARY KEY CLUSTERED (LanguageCd))')
	INSERT INTO CtLanguage VALUES ('C','C#')
	INSERT INTO CtLanguage VALUES ('J','Java')
END
GO

if not exists (select 'true' from dbo.sysobjects where id = object_id('dbo.CtObjectType'))
BEGIN
	EXEC ('CREATE TABLE dbo.CtObjectType (
	ObjectTypeCd char (1) NOT NULL ,
	ObjectTypeName nvarchar (50) NOT NULL,
	CONSTRAINT PK_CtObject PRIMARY KEY CLUSTERED (ObjectTypeCd))')
	INSERT INTO CtObjectType VALUES ('C','Client')
	INSERT INTO CtObjectType VALUES ('D','Data')
	INSERT INTO CtObjectType VALUES ('R','Rule')
END
GO
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7&typ=N&sys=3","","",""); return false;
10~@~   2.  19.60905:D:   50:*:*:M: MSSQL - Add three AppItem tables~@~34~@~50~@~D~@~~@~~@~M~@~~@~MSSQL - Add three AppItem tables~@~N~@~-- ??Design:
if not exists (select 'true' from dbo.sysobjects where id = object_id('dbo.AppItemDll'))
BEGIN
	EXEC ('CREATE TABLE dbo.AppItemDll (
	AppItemDllId int IDENTITY NOT NULL ,
	DllName varchar (50) NOT NULL ,
	EffectiveFr datetime NOT NULL ,
	EffectiveTo datetime NOT NULL,
	CONSTRAINT PK_AppItemDll PRIMARY KEY CLUSTERED (AppItemDllId))')
	EXEC ('INSERT AppItemDll (DllName,EffectiveFr,EffectiveTo) VALUES (''BusinessFacade.dll'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemDll (DllName,EffectiveFr,EffectiveTo) VALUES (''BusinessRules.dll'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemDll (DllName,EffectiveFr,EffectiveTo) VALUES (''Common.dll'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemDll (DllName,EffectiveFr,EffectiveTo) VALUES (''DataAccess.dll'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemDll (DllName,EffectiveFr,EffectiveTo) VALUES (''SystemFramework.dll'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemDll (DllName,EffectiveFr,EffectiveTo) VALUES (''WebControls.dll'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemDll (DllName,EffectiveFr,EffectiveTo) VALUES (''WebRules.dll'',''1900.01.01'',''9999.12.31'')')
END
GO

if not exists (select 'true' from dbo.sysobjects where id = object_id('dbo.AppItemCln'))
BEGIN
	EXEC ('CREATE TABLE dbo.AppItemCln (
	AppItemClnId int IDENTITY NOT NULL ,
	ClnName varchar (50) NOT NULL ,
	EffectiveFr datetime NOT NULL ,
	EffectiveTo datetime NOT NULL,
	CONSTRAINT PK_AppItemCln PRIMARY KEY CLUSTERED (AppItemClnId))')
	EXEC ('INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''Default.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''EncryptPwd.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''ForgotPwd.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''GetCss.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''Global.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''ImportSchema.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''ImportTemplate.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''ModuleBase.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''PageBase.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''InfoPage.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''Msg.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''UpLoad.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\AdvModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\BannerModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\EncryptModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\FooterModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\ForgotPwdModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\ImportTemplateModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\LoginModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\MenuModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\MenuTopModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\MsgModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\PageModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\UpLoadModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\UsrPrefModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''reports\AdmRpt*.rpt'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''scripts\ClientRule.js'',''1900.01.01'',''9999.12.31'')')
END
GO

if not exists (select 'true' from dbo.sysobjects where id = object_id('dbo.AppItemRul'))
BEGIN
	EXEC ('CREATE TABLE dbo.AppItemRul (
	AppItemRulId int IDENTITY NOT NULL ,
	RulName varchar (50) NOT NULL ,
	EffectiveFr datetime NOT NULL ,
	EffectiveTo datetime NOT NULL,
	CONSTRAINT PK_AppItemRul PRIMARY KEY CLUSTERED (AppItemRulId))')
	EXEC ('INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''BusinessFacade\AdminSystem.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''BusinessFacade\ForgotPwdSystem.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''BusinessFacade\ImportTemplateSystem.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''BusinessFacade\LoginSystem.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''BusinessFacade\MenuSystem.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''BusinessFacade\UpLoadSystem.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''BusinessRules\AdminRules.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''BusinessRules\ImportTemplateRules.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''Common\*.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''Common\Data\Credential.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''Common\Data\LoginUsr.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''Common\Data\UsrCurr.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''Common\Data\UsrImpr.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''Common\Data\UsrPref.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''DataAccess\AdminAccess.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''DataAccess\ForgotPwdAccess.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''DataAccess\ImportTemplateAccess.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''DataAccess\LoginAccess.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''DataAccess\MenuAccess.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''DataAccess\UpLoadAccess.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''DataAccess\WebAccess.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''SystemFramework\*.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''WebControls\*.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''WebRules\WebRule.cs'',''1900.01.01'',''9999.12.31'')')
END
GO
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=10&typ=N&sys=3","","",""); return false;
12~@~   2.  19.60905:D:   30:*:*:M: MSSQL - Add AppItem table~@~34~@~30~@~D~@~~@~~@~M~@~~@~MSSQL - Add AppItem table~@~Y~@~-- All design db:
if not exists (select 'true' from dbo.sysobjects where id = object_id(N'dbo.AppItem'))
BEGIN
	EXEC ('CREATE TABLE dbo.AppItem (
	AppItemId int IDENTITY NOT NULL ,
	AppItemDesc varchar (200) NULL ,
	AppInfoId int NOT NULL ,
	ExecOrder smallint NULL ,
	ObjectTypeCd char (1) NOT NULL ,
	LanguageCd char (1) NULL ,
	FrameworkCd char (1) NULL ,
	DbProviderCd char (1) NULL ,
	RelativePath varchar (100) NULL ,
	AppItemName varchar (50) NOT NULL ,
	MultiDesignDb char (1) NOT NULL ,
	AppItemCode ntext NULL ,
	Attachmt varchar (100) NULL ,
	RemoveItem char (1) NOT NULL ,
	ScreenId int NULL ,
	ReportId int NULL ,
	WizardId int NULL ,
	CustomId int NULL ,
	AppItemLink varchar (200) NULL,
	CONSTRAINT PK_AppItem PRIMARY KEY CLUSTERED (AppItemId))')
	EXEC ('CREATE INDEX IX_AppItem ON dbo.AppItem(AppInfoId, AppItemDesc)')
	EXEC ('CREATE INDEX IX_AppItem_Atmt ON dbo.AppItem(Attachmt)')
END
GO~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=12&typ=N&sys=3","","",""); return false;
14~@~   2.  19.60905:D:   60:*:*:M: MSSQL - Add FootNote column to ScreenHlp~@~34~@~60~@~D~@~~@~~@~M~@~~@~MSSQL - Add FootNote column to ScreenHlp~@~Y~@~-- Add FootNote to table ScreenHlp on all design db:
if not exists (select 'true' from dbo.syscolumns where id = object_id('dbo.ScreenHlp') and name = 'FootNote')
BEGIN
	EXEC ('if exists (select ''true'' from dbo.sysobjects where id = object_id(''FK_ScreenHlp_Screen''))
		ALTER TABLE dbo.ScreenHlp DROP CONSTRAINT FK_ScreenHlp_Screen')
	EXEC ('CREATE TABLE dbo.Tmp_ScreenHlp(
		ScreenHlpId int NOT NULL,
		ScreenId int NOT NULL,
		CultureId tinyint NOT NULL,
		DefaultHlpMsg nvarchar(400) NOT NULL,
		ScreenTitle nvarchar(50) NOT NULL,
		AddMsg nvarchar(100) NULL,
		UpdMsg nvarchar(100) NULL,
		DelMsg nvarchar(100) NULL)')
	EXEC ('INSERT INTO dbo.Tmp_ScreenHlp (ScreenHlpId, ScreenId, CultureId, DefaultHlpMsg, ScreenTitle, AddMsg, UpdMsg, DelMsg)
		SELECT ScreenHlpId, ScreenId, CultureId, DefaultHlpMsg, ScreenTitle, AddMsg, UpdMsg, DelMsg FROM dbo.ScreenHlp')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenHlp) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenHlp) = 0 DROP TABLE dbo.ScreenHlp')
	EXEC ('CREATE TABLE dbo.ScreenHlp(
		ScreenHlpId int IDENTITY NOT NULL,
		ScreenId int NOT NULL,
		CultureId tinyint NOT NULL,
		DefaultHlpMsg nvarchar(400) NOT NULL,
		FootNote nvarchar(400) NULL,
		ScreenTitle nvarchar(50) NOT NULL,
		AddMsg nvarchar(100) NULL,
		UpdMsg nvarchar(100) NULL,
		DelMsg nvarchar(100) NULL,
	CONSTRAINT PK_ScreenHlp PRIMARY KEY CLUSTERED (ScreenHlpId))')
	EXEC ('SET IDENTITY_INSERT dbo.ScreenHlp ON
		INSERT INTO dbo.ScreenHlp (ScreenHlpId, ScreenId, CultureId, DefaultHlpMsg, ScreenTitle, AddMsg, UpdMsg, DelMsg)
		SELECT ScreenHlpId, ScreenId, CultureId, DefaultHlpMsg, ScreenTitle, AddMsg, UpdMsg, DelMsg FROM dbo.Tmp_ScreenHlp
		SET IDENTITY_INSERT dbo.ScreenHlp OFF')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.ScreenHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenHlp) = 0 DROP TABLE dbo.Tmp_ScreenHlp')
	EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_ScreenHlp_ScreenId ON dbo.ScreenHlp (CultureId,ScreenId)')
	EXEC ('ALTER TABLE dbo.ScreenHlp ADD CONSTRAINT FK_ScreenHlp_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')
END
GO
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=14&typ=N&sys=3","","",""); return false;
15~@~   2.  19.60905:D:  110:*:*:S: Sybase - Add FootNote column to ScreenHlp~@~34~@~110~@~D~@~~@~~@~S~@~~@~Sybase - Add FootNote column to ScreenHlp~@~Y~@~-- Add FootNote to table ScreenHlp on all design db:
if not exists (select 'true' from dbo.syscolumns where id = object_id('dbo.ScreenHlp') and name = 'FootNote')
BEGIN
	EXEC ('if exists (select ''true'' from dbo.sysobjects where id = object_id(''FK_ScreenHlp_Screen''))
		ALTER TABLE dbo.ScreenHlp DROP CONSTRAINT FK_ScreenHlp_Screen')
	EXEC ('CREATE TABLE dbo.Tmp_ScreenHlp(
		ScreenHlpId numeric(10,0) NOT NULL,
		ScreenId numeric(10,0) NOT NULL,
		CultureId numeric(3,0) NOT NULL,
		DefaultHlpMsg nvarchar(400) NOT NULL,
		ScreenTitle nvarchar(50) NOT NULL,
		AddMsg nvarchar(100) NULL,
		UpdMsg nvarchar(100) NULL,
		DelMsg nvarchar(100) NULL)')
	EXEC ('INSERT INTO dbo.Tmp_ScreenHlp (ScreenHlpId, ScreenId, CultureId, DefaultHlpMsg, ScreenTitle, AddMsg, UpdMsg, DelMsg)
		SELECT ScreenHlpId, ScreenId, CultureId, DefaultHlpMsg, ScreenTitle, AddMsg, UpdMsg, DelMsg FROM dbo.ScreenHlp')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenHlp) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenHlp) = 0 DROP TABLE dbo.ScreenHlp')
	EXEC ('CREATE TABLE dbo.ScreenHlp(
		ScreenHlpId numeric(10,0) IDENTITY NOT NULL,
		ScreenId numeric(10,0) NOT NULL,
		CultureId numeric(3,0) NOT NULL,
		DefaultHlpMsg nvarchar(400) NOT NULL,
		FootNote nvarchar(400) NULL,
		ScreenTitle nvarchar(50) NOT NULL,
		AddMsg nvarchar(100) NULL,
		UpdMsg nvarchar(100) NULL,
		DelMsg nvarchar(100) NULL,
	CONSTRAINT PK_ScreenHlp PRIMARY KEY CLUSTERED (ScreenHlpId))')
	EXEC ('SET IDENTITY_INSERT dbo.ScreenHlp ON
		INSERT INTO dbo.ScreenHlp (ScreenHlpId, ScreenId, CultureId, DefaultHlpMsg, ScreenTitle, AddMsg, UpdMsg, DelMsg)
		SELECT ScreenHlpId, ScreenId, CultureId, DefaultHlpMsg, ScreenTitle, AddMsg, UpdMsg, DelMsg FROM dbo.Tmp_ScreenHlp
		SET IDENTITY_INSERT dbo.ScreenHlp OFF')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.ScreenHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenHlp) = 0 DROP TABLE dbo.Tmp_ScreenHlp')
	EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_ScreenHlp_ScreenId ON dbo.ScreenHlp (CultureId,ScreenId)')
	EXEC ('ALTER TABLE dbo.ScreenHlp ADD CONSTRAINT FK_ScreenHlp_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')
END
GO
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=15&typ=N&sys=3","","",""); return false;
16~@~   2.  19.60905:D:   80:*:*:S: Sybase - Add AppItem table~@~34~@~80~@~D~@~~@~~@~S~@~~@~Sybase - Add AppItem table~@~Y~@~-- All design db:
if not exists (select 'true' from dbo.sysobjects where id = object_id(N'dbo.AppItem'))
BEGIN
	EXEC ('CREATE TABLE dbo.AppItem (
	AppItemId numeric(10,0) IDENTITY NOT NULL ,
	AppItemDesc varchar (200) NULL ,
	AppInfoId numeric(10,0) NOT NULL ,
	ExecOrder numeric(5,0) NULL ,
	ObjectTypeCd char (1) NOT NULL ,
	LanguageCd char (1) NULL ,
	FrameworkCd char (1) NULL ,
	DbProviderCd char (1) NULL ,
	RelativePath varchar (100) NULL ,
	AppItemName varchar (50) NOT NULL ,
	MultiDesignDb char (1) NOT NULL ,
	AppItemCode text NULL ,
	Attachmt varchar (100) NULL ,
	RemoveItem char (1) NOT NULL ,
	ScreenId numeric(10,0) NULL ,
	ReportId numeric(10,0) NULL ,
	WizardId numeric(10,0) NULL ,
	CustomId numeric(10,0) NULL ,
	AppItemLink varchar (200) NULL,
	CONSTRAINT PK_AppItem PRIMARY KEY CLUSTERED (AppItemId))')
	EXEC ('CREATE INDEX IX_AppItem ON dbo.AppItem(AppInfoId, AppItemDesc)')
	EXEC ('CREATE INDEX IX_AppItem_Atmt ON dbo.AppItem(Attachmt)')
END
GO~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=16&typ=N&sys=3","","",""); return false;
17~@~   2.  19.60905:D:   90:*:*:S: Sybase - Change AppInfo table~@~34~@~90~@~D~@~~@~~@~S~@~~@~Sybase - Change AppInfo table~@~Y~@~-- Add AppItemLink to table AppInfo on all design db:
if not exists (select 'true' from dbo.syscolumns where id = object_id('dbo.AppInfo') and name = 'AppItemLink')
BEGIN
	EXEC ('CREATE TABLE dbo.Tmp_AppInfo(
	AppInfoId numeric(10,0) NOT NULL,
	VersionMa numeric(5,0) NOT NULL,
	VersionMi numeric(5,0) NOT NULL,
	VersionDt datetime NULL)')
	EXEC ('INSERT INTO dbo.Tmp_AppInfo (AppInfoId, VersionMa, VersionMi, VersionDt)
	SELECT AppInfoId, VersionMa, VersionMi, VersionDt FROM dbo.AppInfo')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.Tmp_AppInfo) > 0 OR (SELECT COUNT(1) FROM dbo.AppInfo) = 0 DROP TABLE dbo.AppInfo')
	EXEC ('CREATE TABLE dbo.AppInfo(
	AppInfoId numeric(10,0) IDENTITY NOT NULL,
	AppInfoDesc varchar(50) NULL,
	VersionMa numeric(5,0) NOT NULL,
	VersionMi numeric(5,0) NOT NULL,
	VersionDt datetime NULL,
	Prerequisite nvarchar(200) NULL,
	Readme text NULL,
	AppItemLink varchar(200) NULL,
	CONSTRAINT PK_AppInfo PRIMARY KEY CLUSTERED (AppInfoId))')
	EXEC ('SET IDENTITY_INSERT dbo.AppInfo ON
		INSERT INTO dbo.AppInfo (AppInfoId, AppInfoDesc, VersionMa, VersionMi, VersionDt)
		SELECT AppInfoId, right(space(3)+convert(varchar,VersionMa),4) + ''.'' + right(space(3)+convert(varchar,VersionMi),4)
		+ case when VersionDt is null then space(0)
		else ''.'' + right(convert(varchar,datepart(yy,VersionDt)),1) + right(''0''+convert(varchar,datepart(mm,VersionDt)),2)
		+ right(''0''+convert(varchar,datepart(dd,VersionDt)),2) end
		, VersionMa, VersionMi, VersionDt FROM dbo.Tmp_AppInfo
		SET IDENTITY_INSERT dbo.AppInfo OFF')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.AppInfo) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AppInfo) = 0 DROP TABLE dbo.Tmp_AppInfo')
END
GO
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=17&typ=N&sys=3","","",""); return false;
18~@~   2.  19.60905:D:  100:*:*:S: Sybase - Add three AppItem tables~@~34~@~100~@~D~@~~@~~@~S~@~~@~Sybase - Add three AppItem tables~@~N~@~-- ??Design:
if not exists (select 'true' from dbo.sysobjects where id = object_id('dbo.AppItemDll'))
BEGIN
	EXEC ('CREATE TABLE dbo.AppItemDll (
	AppItemDllId numeric(10,0) IDENTITY NOT NULL ,
	DllName varchar (50) NOT NULL ,
	EffectiveFr datetime NOT NULL ,
	EffectiveTo datetime NOT NULL,
	CONSTRAINT PK_AppItemDll PRIMARY KEY CLUSTERED (AppItemDllId))')
	EXEC ('INSERT AppItemDll (DllName,EffectiveFr,EffectiveTo) VALUES (''BusinessFacade.dll'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemDll (DllName,EffectiveFr,EffectiveTo) VALUES (''BusinessRules.dll'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemDll (DllName,EffectiveFr,EffectiveTo) VALUES (''Common.dll'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemDll (DllName,EffectiveFr,EffectiveTo) VALUES (''DataAccess.dll'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemDll (DllName,EffectiveFr,EffectiveTo) VALUES (''SystemFramework.dll'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemDll (DllName,EffectiveFr,EffectiveTo) VALUES (''WebControls.dll'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemDll (DllName,EffectiveFr,EffectiveTo) VALUES (''WebRules.dll'',''1900.01.01'',''9999.12.31'')')
END
GO

if not exists (select 'true' from dbo.sysobjects where id = object_id('dbo.AppItemCln'))
BEGIN
	EXEC ('CREATE TABLE dbo.AppItemCln (
	AppItemClnId numeric(10,0) IDENTITY NOT NULL ,
	ClnName varchar (50) NOT NULL ,
	EffectiveFr datetime NOT NULL ,
	EffectiveTo datetime NOT NULL,
	CONSTRAINT PK_AppItemCln PRIMARY KEY CLUSTERED (AppItemClnId))')
	EXEC ('INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''Default.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''EncryptPwd.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''ForgotPwd.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''GetCss.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''Global.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''ImportSchema.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''ImportTemplate.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''ModuleBase.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''PageBase.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''InfoPage.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''Msg.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''UpLoad.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\AdvModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\BannerModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\EncryptModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\FooterModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\ForgotPwdModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\ImportTemplateModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\LoginModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\MenuModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\MenuTopModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\MsgModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\PageModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\UpLoadModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''modules\UsrPrefModule.*'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''reports\AdmRpt*.rpt'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemCln (ClnName,EffectiveFr,EffectiveTo) VALUES (''scripts\ClientRule.js'',''1900.01.01'',''9999.12.31'')')
END
GO

if not exists (select 'true' from dbo.sysobjects where id = object_id('dbo.AppItemRul'))
BEGIN
	EXEC ('CREATE TABLE dbo.AppItemRul (
	AppItemRulId numeric(10,0) IDENTITY NOT NULL ,
	RulName varchar (50) NOT NULL ,
	EffectiveFr datetime NOT NULL ,
	EffectiveTo datetime NOT NULL,
	CONSTRAINT PK_AppItemRul PRIMARY KEY CLUSTERED (AppItemRulId))')
	EXEC ('INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''BusinessFacade\AdminSystem.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''BusinessFacade\ForgotPwdSystem.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''BusinessFacade\ImportTemplateSystem.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''BusinessFacade\LoginSystem.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''BusinessFacade\MenuSystem.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''BusinessFacade\UpLoadSystem.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''BusinessRules\AdminRules.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''BusinessRules\ImportTemplateRules.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''Common\*.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''Common\Data\Credential.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''Common\Data\LoginUsr.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''Common\Data\UsrCurr.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''Common\Data\UsrImpr.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''Common\Data\UsrPref.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''DataAccess\AdminAccess.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''DataAccess\ForgotPwdAccess.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''DataAccess\ImportTemplateAccess.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''DataAccess\LoginAccess.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''DataAccess\MenuAccess.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''DataAccess\UpLoadAccess.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''DataAccess\WebAccess.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''SystemFramework\*.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''WebControls\*.cs'',''1900.01.01'',''9999.12.31'')
	INSERT AppItemRul (RulName,EffectiveFr,EffectiveTo) VALUES (''WebRules\WebRule.cs'',''1900.01.01'',''9999.12.31'')')
END
GO
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=18&typ=N&sys=3","","",""); return false;
19~@~   2.  19.60905:D:   20:*:*:M: MSSQL -Remove obsolete stored procedures~@~34~@~20~@~D~@~~@~~@~M~@~~@~MSSQL -Remove obsolete stored procedures~@~Y~@~-- Need sp to run cursor in Sybase.
-- Remove sp from ??Design:
IF EXISTS (SELECT 'true' FROM dbo.sysobjects WHERE id = object_id('dbo.Tmp_1') AND type='P') DROP PROCEDURE dbo.Tmp_1
GO
CREATE PROCEDURE Tmp_1
AS
DECLARE	 @ProgName	varchar(20)
DECLARE cur1 CURSOR FOR SELECT ProgramName + convert(varchar,ScreenId) FROM [[?]]Design.dbo.Screen FOR READ ONLY
OPEN cur1
FETCH NEXT FROM cur1 INTO @ProgName
WHILE @@FETCH_STATUS = 0
BEGIN
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Del' + @ProgName + ''') AND type = ''P'') DROP PROCEDURE Del' + @ProgName)
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Add' + @ProgName + ''') AND type = ''P'') DROP PROCEDURE Add' + @ProgName)
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Upd' + @ProgName + ''') AND type = ''P'') DROP PROCEDURE Upd' + @ProgName)
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Del' + @ProgName + 'Dt'') AND type = ''P'') DROP PROCEDURE Del' + @ProgName + 'Dt')
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Add' + @ProgName + 'Dt'') AND type = ''P'') DROP PROCEDURE Add' + @ProgName + 'Dt')
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Upd' + @ProgName + 'Dt'') AND type = ''P'') DROP PROCEDURE Upd' + @ProgName + 'Dt')
	FETCH NEXT FROM cur1 INTO @ProgName
END
CLOSE cur1
DEALLOCATE cur1
-- Remove sp from all design db:
DECLARE cur1 CURSOR FOR SELECT ProgramName + convert(varchar,ScreenId) FROM dbo.Screen FOR READ ONLY
OPEN cur1
FETCH NEXT FROM cur1 INTO @ProgName
WHILE @@FETCH_STATUS = 0
BEGIN
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Del' + @ProgName + ''') AND type = ''P'') DROP PROCEDURE Del' + @ProgName)
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Add' + @ProgName + ''') AND type = ''P'') DROP PROCEDURE Add' + @ProgName)
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Upd' + @ProgName + ''') AND type = ''P'') DROP PROCEDURE Upd' + @ProgName)
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Del' + @ProgName + 'Dt'') AND type = ''P'') DROP PROCEDURE Del' + @ProgName + 'Dt')
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Add' + @ProgName + 'Dt'') AND type = ''P'') DROP PROCEDURE Add' + @ProgName + 'Dt')
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Upd' + @ProgName + 'Dt'') AND type = ''P'') DROP PROCEDURE Upd' + @ProgName + 'Dt')
	FETCH NEXT FROM cur1 INTO @ProgName
END
CLOSE cur1
DEALLOCATE cur1
GO
EXEC Tmp_1
GO
DROP PROCEDURE dbo.Tmp_1
GO
if exists (select 'true' from dbo.sysobjects where id = object_id(N'dbo.MkScreenUpd')) drop procedure dbo.MkScreenUpd
GO~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=19&typ=N&sys=3","","",""); return false;
20~@~   2.  19.60905:D:   70:*:*:S: Sybase -Remove obsolete stored procedures~@~34~@~70~@~D~@~~@~~@~S~@~~@~Sybase -Remove obsolete stored procedures~@~Y~@~-- Need sp to run cursor in Sybase.
-- Remove sp from ??Design:
IF EXISTS (SELECT 'true' FROM dbo.sysobjects WHERE id = object_id('dbo.Tmp_1') AND type='P') DROP PROCEDURE dbo.Tmp_1
GO
CREATE PROCEDURE Tmp_1
AS
DECLARE	 @ProgName	varchar(20)
DECLARE cur1 CURSOR FOR SELECT ProgramName + convert(varchar,ScreenId) FROM [[?]]Design.dbo.Screen FOR READ ONLY
OPEN cur1
FETCH cur1 INTO @ProgName
WHILE @@sqlStatus = 0
BEGIN
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Del' + @ProgName + ''') AND type = ''P'') DROP PROCEDURE Del' + @ProgName)
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Add' + @ProgName + ''') AND type = ''P'') DROP PROCEDURE Add' + @ProgName)
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Upd' + @ProgName + ''') AND type = ''P'') DROP PROCEDURE Upd' + @ProgName)
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Del' + @ProgName + 'Dt'') AND type = ''P'') DROP PROCEDURE Del' + @ProgName + 'Dt')
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Add' + @ProgName + 'Dt'') AND type = ''P'') DROP PROCEDURE Add' + @ProgName + 'Dt')
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Upd' + @ProgName + 'Dt'') AND type = ''P'') DROP PROCEDURE Upd' + @ProgName + 'Dt')
	FETCH cur1 INTO @ProgName
END
CLOSE cur1
DEALLOCATE CURSOR cur1
-- Remove sp from all design db:
DECLARE cur1 CURSOR FOR SELECT ProgramName + convert(varchar,ScreenId) FROM dbo.Screen FOR READ ONLY
OPEN cur1
FETCH cur1 INTO @ProgName
WHILE @@sqlStatus = 0
BEGIN
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Del' + @ProgName + ''') AND type = ''P'') DROP PROCEDURE Del' + @ProgName)
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Add' + @ProgName + ''') AND type = ''P'') DROP PROCEDURE Add' + @ProgName)
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Upd' + @ProgName + ''') AND type = ''P'') DROP PROCEDURE Upd' + @ProgName)
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Del' + @ProgName + 'Dt'') AND type = ''P'') DROP PROCEDURE Del' + @ProgName + 'Dt')
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Add' + @ProgName + 'Dt'') AND type = ''P'') DROP PROCEDURE Add' + @ProgName + 'Dt')
	EXEC ('IF exists (SELECT ''true'' FROM dbo.sysobjects WHERE id = object_id(''Upd' + @ProgName + 'Dt'') AND type = ''P'') DROP PROCEDURE Upd' + @ProgName + 'Dt')
	FETCH cur1 INTO @ProgName
END
CLOSE cur1
DEALLOCATE CURSOR cur1
GO
EXEC Tmp_1
GO
DROP PROCEDURE dbo.Tmp_1
GO
if exists (select 'true' from dbo.sysobjects where id = object_id(N'dbo.MkScreenUpd')) drop procedure dbo.MkScreenUpd
GO
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=20&typ=N&sys=3","","",""); return false;
22~@~   2.  19.60911:D:   20:*:*:M: MSSQL - Add row to table CtClientScript~@~35~@~20~@~D~@~~@~~@~M~@~~@~MSSQL - Add row to table CtClientScript~@~N~@~-- Add row and remove identity on table CtClientScript on ??design db:
if not exists (select 'true' from dbo.CtClientScript where ClientScriptId = 13)
BEGIN
	EXEC ('CREATE TABLE dbo.Tmp_CtClientScript (
	ClientScriptId smallint NOT NULL,
	ClientScriptEvent varchar(50) NOT NULL,
	ClientScriptName varchar(50) NOT NULL,
	ClientScriptDesc nvarchar(100) NOT NULL)')
	EXEC ('INSERT INTO dbo.Tmp_CtClientScript (ClientScriptId, ClientScriptEvent, ClientScriptName, ClientScriptDesc)
		SELECT ClientScriptId, ClientScriptEvent, ClientScriptName, ClientScriptDesc FROM dbo.CtClientScript')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.Tmp_CtClientScript) > 0 OR (SELECT COUNT(1) FROM dbo.CtClientScript) = 0 DROP TABLE dbo.CtClientScript')
	EXEC ('CREATE TABLE dbo.CtClientScript (
	ClientScriptId smallint NOT NULL,
	ClientScriptEvent varchar(50) NOT NULL,
	ClientScriptName varchar(50) NOT NULL,
	ClientScriptDesc nvarchar(100) NOT NULL,
	CONSTRAINT PK_CtClientScript PRIMARY KEY CLUSTERED (ClientScriptId))')
	EXEC ('INSERT INTO dbo.CtClientScript (ClientScriptId, ClientScriptEvent, ClientScriptName, ClientScriptDesc)
		SELECT ClientScriptId, ClientScriptEvent, ClientScriptName, ClientScriptDesc FROM dbo.Tmp_CtClientScript')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.CtClientScript) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtClientScript) = 0 DROP TABLE dbo.Tmp_CtClientScript')
	EXEC ('INSERT dbo.CtClientScript SELECT 13,''onKeyDown'',''AeFocusCtrl();'',''Focus on (ctrl) upon Enter key press''')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=22&typ=N&sys=3","","",""); return false;
23~@~   2.  19.60911:D:   20:*:*:S: Sybase - Add row to table CtClientScript~@~35~@~20~@~D~@~~@~~@~S~@~~@~Sybase - Add row to table CtClientScript~@~N~@~-- Add row and remove identity on table CtClientScript on ??design db:
if not exists (select 'true' from dbo.CtClientScript where ClientScriptId = 13)
BEGIN
	EXEC ('CREATE TABLE dbo.Tmp_CtClientScript (
	ClientScriptId numeric(5,0) NOT NULL,
	ClientScriptEvent varchar(50) NOT NULL,
	ClientScriptName varchar(50) NOT NULL,
	ClientScriptDesc nvarchar(100) NOT NULL)')
	EXEC ('INSERT INTO dbo.Tmp_CtClientScript (ClientScriptId, ClientScriptEvent, ClientScriptName, ClientScriptDesc)
		SELECT ClientScriptId, ClientScriptEvent, ClientScriptName, ClientScriptDesc FROM dbo.CtClientScript')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.Tmp_CtClientScript) > 0 OR (SELECT COUNT(1) FROM dbo.CtClientScript) = 0 DROP TABLE dbo.CtClientScript')
	EXEC ('CREATE TABLE dbo.CtClientScript (
	ClientScriptId numeric(5,0) NOT NULL,
	ClientScriptEvent varchar(50) NOT NULL,
	ClientScriptName varchar(50) NOT NULL,
	ClientScriptDesc nvarchar(100) NOT NULL,
	CONSTRAINT PK_CtClientScript PRIMARY KEY CLUSTERED (ClientScriptId))')
	EXEC ('INSERT INTO dbo.CtClientScript (ClientScriptId, ClientScriptEvent, ClientScriptName, ClientScriptDesc)
		SELECT ClientScriptId, ClientScriptEvent, ClientScriptName, ClientScriptDesc FROM dbo.Tmp_CtClientScript')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.CtClientScript) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtClientScript) = 0 DROP TABLE dbo.Tmp_CtClientScript')
	EXEC ('INSERT dbo.CtClientScript SELECT 13,''onKeyDown'',''AeFocusCtrl();'',''Focus on (ctrl) upon Enter key press''')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=23&typ=N&sys=3","","",""); return false;
24~@~   2.  20.60918:D:   10:*:*:M: MSSQL - Add table AppLog~@~36~@~10~@~D~@~~@~~@~M~@~~@~MSSQL - Add table AppLog~@~N~@~if not exists (select 'true' from dbo.sysobjects where id = object_id('dbo.AppLog'))
BEGIN
	EXEC ('CREATE TABLE dbo.AppLog (
	AppLogId int IDENTITY NOT NULL ,
	AppLogDesc varchar (200) NOT NULL ,
	AppLogNote ntext NOT NULL ,
	InputBy int NOT NULL ,
	InputOn datetime NOT NULL,
	CONSTRAINT PK_AppLog PRIMARY KEY CLUSTERED (AppLogId))')
END
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=24&typ=N&sys=3","","",""); return false;
25~@~   2.  20.60918:D:   10:*:*:S: Sybase - Add table AppLog~@~36~@~10~@~D~@~~@~~@~S~@~~@~Sybase - Add table AppLog~@~N~@~if not exists (select 'true' from dbo.sysobjects where id = object_id('dbo.AppLog'))
BEGIN
	EXEC ('CREATE TABLE dbo.AppLog (
	AppLogId numeric(10,0) IDENTITY NOT NULL ,
	AppLogDesc varchar (200) NOT NULL ,
	AppLogNote text NOT NULL ,
	InputBy numeric(10,0) NOT NULL ,
	InputOn datetime NOT NULL,
	CONSTRAINT PK_AppLog PRIMARY KEY CLUSTERED (AppLogId))')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=25&typ=N&sys=3","","",""); return false;
27~@~   2.  20.60920:D:   10:*:*:M: MSSQL - Add column ValidateReq to table Screen~@~37~@~10~@~D~@~~@~~@~M~@~~@~MSSQL - Add column ValidateReq to table Screen~@~Y~@~-- Add column ValidateRequest to table Screen on all design db:
if not exists (select 'true' from dbo.syscolumns where id = object_id('dbo.Screen') and name = 'ValidateReq')
BEGIN
	EXEC ('if exists (select ''true'' from dbo.sysobjects where id = object_id(''FK_ScreenHlp_Screen''))
		ALTER TABLE dbo.ScreenHlp DROP CONSTRAINT FK_ScreenHlp_Screen')
	EXEC ('if exists (select ''true'' from dbo.sysobjects where id = object_id(''FK_ScreenObj_Screen''))
		ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_Screen')
	EXEC ('if exists (select ''true'' from dbo.sysobjects where id = object_id(''FK_ScreenCri_Screen''))
		ALTER TABLE dbo.ScreenCri DROP CONSTRAINT FK_ScreenCri_Screen')
	EXEC ('if exists (select ''true'' from dbo.sysobjects where id = object_id(''FK_AuthRow_Screen''))
		ALTER TABLE dbo.AuthRow DROP CONSTRAINT FK_AuthRow_Screen')
	EXEC ('CREATE TABLE dbo.Tmp_Screen(
		ScreenId int NOT NULL,
		ProgramName varchar(20) NOT NULL,
		ScreenDesc nvarchar(50) NULL,
		ScreenTypeId tinyint NOT NULL,
		MasterTableId int NULL,
		DetailTableId int NULL,
		SearchId int NULL,
		SearchAscending char(1) NOT NULL,
		GridRows tinyint NULL,
		ScreenObj varchar(100) NULL,
		ScreenFilter varchar(100) NULL,
		GenerateSc char(1) NOT NULL,
		HasDeleteAll char(1) NOT NULL)')
	EXEC ('INSERT INTO dbo.Tmp_Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll)
		SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll FROM dbo.Screen')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen')
	EXEC ('CREATE TABLE dbo.Screen(
		ScreenId int IDENTITY NOT NULL,
		ProgramName varchar(20) NOT NULL,
		ScreenDesc nvarchar(50) NULL,
		ScreenTypeId tinyint NOT NULL,
		MasterTableId int NULL,
		DetailTableId int NULL,
		SearchId int NULL,
		SearchAscending char(1) NOT NULL,
		GridRows tinyint NULL,
		ScreenObj varchar(100) NULL,
		ScreenFilter varchar(100) NULL,
		GenerateSc char(1) NOT NULL,
		HasDeleteAll char(1) NOT NULL,
		ValidateReq char(1) NOT NULL,
		CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))')
	EXEC ('SET IDENTITY_INSERT dbo.Screen ON
		INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq)
		SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ''Y'' FROM dbo.Tmp_Screen
		SET IDENTITY_INSERT dbo.Screen OFF')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen')
	EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_Screen_ProgramName ON dbo.Screen (ProgramName)')
	EXEC ('ALTER TABLE dbo.AuthRow ADD CONSTRAINT FK_AuthRow_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')
	EXEC ('ALTER TABLE dbo.ScreenCri ADD CONSTRAINT FK_ScreenCri_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')
	EXEC ('ALTER TABLE dbo.ScreenObj ADD CONSTRAINT FK_ScreenObj_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')
	EXEC ('ALTER TABLE dbo.ScreenHlp ADD CONSTRAINT FK_ScreenHlp_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=27&typ=N&sys=3","","",""); return false;
28~@~   2.  20.60920:D:   10:*:*:S: Sybase - Add column ValidateReq to table Screen~@~37~@~10~@~D~@~~@~~@~S~@~~@~Sybase - Add column ValidateReq to table Screen~@~Y~@~-- Add column ValidateRequest to table Screen on all design db:
if not exists (select 'true' from dbo.syscolumns where id = object_id('dbo.Screen') and name = 'ValidateReq')
BEGIN
	EXEC ('if exists (select ''true'' from dbo.sysobjects where id = object_id(''FK_ScreenHlp_Screen''))
		ALTER TABLE dbo.ScreenHlp DROP CONSTRAINT FK_ScreenHlp_Screen')
	EXEC ('if exists (select ''true'' from dbo.sysobjects where id = object_id(''FK_ScreenObj_Screen''))
		ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_Screen')
	EXEC ('if exists (select ''true'' from dbo.sysobjects where id = object_id(''FK_ScreenCri_Screen''))
		ALTER TABLE dbo.ScreenCri DROP CONSTRAINT FK_ScreenCri_Screen')
	EXEC ('if exists (select ''true'' from dbo.sysobjects where id = object_id(''FK_AuthRow_Screen''))
		ALTER TABLE dbo.AuthRow DROP CONSTRAINT FK_AuthRow_Screen')
	EXEC ('CREATE TABLE dbo.Tmp_Screen(
		ScreenId numeric(10,0) NOT NULL,
		ProgramName varchar(20) NOT NULL,
		ScreenDesc nvarchar(50) NULL,
		ScreenTypeId numeric(3,0) NOT NULL,
		MasterTableId numeric(10,0) NULL,
		DetailTableId numeric(10,0) NULL,
		SearchId numeric(10,0) NULL,
		SearchAscending char(1) NOT NULL,
		GridRows numeric(3,0) NULL,
		ScreenObj varchar(100) NULL,
		ScreenFilter varchar(100) NULL,
		GenerateSc char(1) NOT NULL,
		HasDeleteAll char(1) NOT NULL)')
	EXEC ('INSERT INTO dbo.Tmp_Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll)
		SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll FROM dbo.Screen')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen')
	EXEC ('CREATE TABLE dbo.Screen(
		ScreenId numeric(10,0) IDENTITY NOT NULL,
		ProgramName varchar(20) NOT NULL,
		ScreenDesc nvarchar(50) NULL,
		ScreenTypeId numeric(3,0) NOT NULL,
		MasterTableId numeric(10,0) NULL,
		DetailTableId numeric(10,0) NULL,
		SearchId numeric(10,0) NULL,
		SearchAscending char(1) NOT NULL,
		GridRows numeric(3,0) NULL,
		ScreenObj varchar(100) NULL,
		ScreenFilter varchar(100) NULL,
		GenerateSc char(1) NOT NULL,
		HasDeleteAll char(1) NOT NULL,
		ValidateReq char(1) NOT NULL,
		CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))')
	EXEC ('SET IDENTITY_INSERT dbo.Screen ON
		INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq)
		SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ''Y'' FROM dbo.Tmp_Screen
		SET IDENTITY_INSERT dbo.Screen OFF')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen')
	EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_Screen_ProgramName ON dbo.Screen (ProgramName)')
	EXEC ('ALTER TABLE dbo.AuthRow ADD CONSTRAINT FK_AuthRow_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')
	EXEC ('ALTER TABLE dbo.ScreenCri ADD CONSTRAINT FK_ScreenCri_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')
	EXEC ('ALTER TABLE dbo.ScreenObj ADD CONSTRAINT FK_ScreenObj_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')
	EXEC ('ALTER TABLE dbo.ScreenHlp ADD CONSTRAINT FK_ScreenHlp_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=28&typ=N&sys=3","","",""); return false;
34~@~   2.  20.61014:D:   10:*:*:M: MSSQL - Add tables Custom...~@~39~@~10~@~D~@~~@~~@~M~@~~@~MSSQL - Add tables Custom...~@~Y~@~-- All design db:
if not exists (select 'true' from dbo.sysobjects where id = object_id(N'dbo.Custom'))
BEGIN
	EXEC ('CREATE TABLE dbo.Custom (
	CustomId int IDENTITY NOT NULL ,
	CustomName nvarchar (50) NOT NULL ,
	CustomDesc nvarchar (200) NULL ,
	SysProgram char (1) NOT NULL ,
	GenerateCm char (1) NOT NULL ,
	CustomDtlLink varchar (200) NULL ,
	CONSTRAINT PK_Custom PRIMARY KEY CLUSTERED (CustomId))')
	EXEC ('CREATE UNIQUE INDEX IX_Custom ON dbo.Custom(CustomName)')
END
if not exists (select 'true' from dbo.sysobjects where id = object_id(N'dbo.CustomDtl'))
BEGIN
	EXEC ('CREATE TABLE dbo.CustomDtl (
	CustomDtlId int IDENTITY NOT NULL ,
	CustomId int NOT NULL ,
	CustomDtlDesc nvarchar (200) NULL ,
	ObjectTypeCd char (1) NOT NULL ,
	LanguageCd char (1) NULL ,
	FrameworkCd char (1) NULL ,
	DbProviderCd char (1) NULL ,
	MultiDesignDb char (1) NOT NULL ,
	RelativePath varchar (100) NULL ,
	ProgramName varchar (50) NOT NULL ,
	CustomCode ntext NULL ,
	Attachmt varchar (100) NULL ,
	CustomDtlLink varchar (200) NULL,
	CONSTRAINT PK_CustomDtl PRIMARY KEY CLUSTERED (CustomDtlId))')
	EXEC ('CREATE INDEX IX_CustomDtl ON dbo.CustomDtl(CustomId, CustomDtlDesc)')
	EXEC ('CREATE INDEX IX_CustomDtl_Atmt ON dbo.CustomDtl(Attachmt)')
	EXEC ('ALTER TABLE dbo.CustomDtl ADD CONSTRAINT FK_CustomDtl_Custom FOREIGN KEY (CustomId) REFERENCES dbo.Custom (CustomId)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=34&typ=N&sys=3","","",""); return false;
35~@~   2.  20.61014:D:   10:*:*:S: Sybase - Add tables Custom...~@~39~@~10~@~D~@~~@~~@~S~@~~@~Sybase - Add tables Custom...~@~Y~@~-- All design db:
if not exists (select 'true' from dbo.sysobjects where id = object_id(N'dbo.Custom'))
BEGIN
	EXEC ('CREATE TABLE dbo.Custom (
	CustomId numeric(10,0) IDENTITY NOT NULL ,
	CustomName nvarchar (50) NOT NULL ,
	CustomDesc nvarchar (200) NULL ,
	SysProgram char (1) NOT NULL ,
	GenerateCm char (1) NOT NULL ,
	CustomDtlLink varchar (200) NULL ,
	CONSTRAINT PK_Custom PRIMARY KEY CLUSTERED (CustomId))')
	EXEC ('CREATE UNIQUE INDEX IX_Custom ON dbo.Custom(CustomName)')
END
if not exists (select 'true' from dbo.sysobjects where id = object_id(N'dbo.CustomDtl'))
BEGIN
	EXEC ('CREATE TABLE dbo.CustomDtl (
	CustomDtlId numeric(10,0) IDENTITY NOT NULL ,
	CustomId numeric(10,0) NOT NULL ,
	CustomDtlDesc nvarchar (200) NULL ,
	ObjectTypeCd char (1) NOT NULL ,
	LanguageCd char (1) NULL ,
	FrameworkCd char (1) NULL ,
	DbProviderCd char (1) NULL ,
	MultiDesignDb char (1) NOT NULL ,
	RelativePath varchar (100) NULL ,
	ProgramName varchar (50) NOT NULL ,
	CustomCode text NULL ,
	Attachmt varchar (100) NULL ,
	CustomDtlLink varchar (200) NULL,
	CONSTRAINT PK_CustomDtl PRIMARY KEY CLUSTERED (CustomDtlId))')
	EXEC ('CREATE INDEX IX_CustomDtl ON dbo.CustomDtl(CustomId, CustomDtlDesc)')
	EXEC ('CREATE INDEX IX_CustomDtl_Atmt ON dbo.CustomDtl(Attachmt)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=35&typ=N&sys=3","","",""); return false;
43~@~   2.  20.61018:D:   10:*:*:S: Remove column Custom.SysProgram~@~40~@~10~@~D~@~~@~~@~S~@~~@~Remove column Custom.SysProgram~@~Y~@~if exists (select * from dbo.syscolumns where id = object_id('dbo.Custom') and name = 'SysProgram') 
EXEC ('ALTER TABLE dbo.Custom DROP SysProgram')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=43&typ=N&sys=3","","",""); return false;
45~@~   2.  20.61018:D:   30:*:*:*: Remove obsolete s.proc~@~40~@~30~@~D~@~~@~~@~~@~~@~Remove obsolete s.proc~@~N~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AddRegisterUsr'') AND type=''P'') DROP PROCEDURE AddRegisterUsr')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=45&typ=N&sys=3","","",""); return false;
47~@~   2.  22.61110:D:   10:*:*:*: Add row to CtMenuOption~@~42~@~10~@~D~@~~@~~@~~@~~@~Add row to CtMenuOption~@~N~@~IF not exists (SELECT 'true' FROM CtMenuOption WHERE MenuOptionCode = 'T')
INSERT CtMenuOption SELECT 'T','Top Menu Only'~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=47&typ=N&sys=3","","",""); return false;
48~@~   2.  22.61113:D:   10:*:*:*: Add three columns to CustomDtl~@~43~@~10~@~D~@~~@~~@~~@~~@~Add three columns to CustomDtl~@~Y~@~if not exists (select * from dbo.syscolumns where id = object_id('dbo.CustomDtl') and name = 'ModifiedBy')
BEGIN
	EXEC ('ALTER TABLE dbo.CustomDtl ADD ModifiedBy int NULL, ModifiedOn datetime NULL, LastGenDt datetime NULL')
	EXEC ('UPDATE dbo.CustomDtl SET ModifiedBy = 1, ModifiedOn = getdate()')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=48&typ=N&sys=3","","",""); return false;
50~@~   2.  20.61018:D:   10:*:*:M: Remove column Custom.SysProgram~@~40~@~10~@~D~@~~@~~@~M~@~~@~Remove column Custom.SysProgram~@~Y~@~if exists (select * from dbo.syscolumns where id = object_id('dbo.Custom') and name = 'SysProgram') 
EXEC ('ALTER TABLE dbo.Custom DROP column SysProgram')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=50&typ=N&sys=3","","",""); return false;
51~@~   2.  23.61221:D:   10:*:*:M: Add columns to table ServerRule~@~48~@~10~@~D~@~~@~~@~M~@~~@~Add columns to table ServerRule~@~Y~@~IF not exists (select 'true' from dbo.syscolumns where id = object_id('dbo.ServerRule') and name = 'RuleCode')
BEGIN
	EXEC ('ALTER TABLE dbo.ServerRule ADD RuleCode ntext NULL, ModifiedBy int NULL, ModifiedOn datetime NULL')
	EXEC ('UPDATE dbo.ServerRule SET ModifiedBy = 1, ModifiedOn = getdate()')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=51&typ=N&sys=3","","",""); return false;
54~@~   2.  23.61221:D:   40:*:*:M: Add columns to DbTable and DbColumn~@~48~@~40~@~D~@~~@~~@~M~@~~@~Add columns to DbTable and DbColumn~@~Y~@~IF not exists (select 'true' from dbo.syscolumns where id = object_id('dbo.DbTable') and name = 'PrevTblName')
BEGIN
	EXEC ('ALTER TABLE dbo.DbTable ADD PrevTblName varchar(20) NULL')
	EXEC ('ALTER TABLE dbo.DbColumn ADD PrevColName varchar(20) NULL, ColumnIndex smallint NULL, DefaultValue nvarchar(50) NULL')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=54&typ=N&sys=3","","",""); return false;
55~@~   2.  23.61221:D:   60:*:*:M: Add column DoubleByte to CtDataType~@~48~@~60~@~D~@~~@~~@~M~@~~@~Add column DoubleByte to CtDataType~@~N~@~if not exists (select 'true' from dbo.syscolumns where id = object_id('dbo.CtDataType') and name = 'DoubleByte')
BEGIN
	EXEC ('CREATE TABLE dbo.Tmp_CtDataType(
		DataTypeId tinyint NOT NULL,
		DataTypeName varchar(20) NOT NULL,
		DataTypeSqlName varchar(20) NOT NULL,
		DataTypeSysName varchar(20) NOT NULL,
		DataTypeSByteOle varchar(20) NOT NULL,
		DataTypeDByteOle varchar(20) NOT NULL,
		DataTypeDesc varchar(80) NOT NULL,
		NumericData char(1) NOT NULL,
		DoubleByte char(1) NOT NULL)')
	EXEC ('INSERT INTO dbo.Tmp_CtDataType SELECT DataTypeId, DataTypeName, DataTypeSqlName, DataTypeSysName, DataTypeSByteOle, DataTypeDByteOle, DataTypeDesc, NumericData
		, CASE WHEN DataTypeId IN (10,11,19) THEN ''Y'' ELSE ''N'' END FROM dbo.CtDataType')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.Tmp_CtDataType) > 0 OR (SELECT COUNT(1) FROM dbo.CtDataType) = 0 DROP TABLE dbo.CtDataType')
	EXEC ('CREATE TABLE dbo.CtDataType(
		DataTypeId tinyint IDENTITY NOT NULL,
		DataTypeName varchar(20) NOT NULL,
		DataTypeSqlName varchar(20) NOT NULL,
		DataTypeSysName varchar(20) NOT NULL,
		DataTypeSByteOle varchar(20) NOT NULL,
		DataTypeDByteOle varchar(20) NOT NULL,
		DataTypeDesc varchar(80) NOT NULL,
		NumericData char(1) NOT NULL,
		DoubleByte char(1) NOT NULL,
		CONSTRAINT PK_CtDataType PRIMARY KEY CLUSTERED (DataTypeId))')
	EXEC ('SET IDENTITY_INSERT dbo.CtDataType ON
		INSERT INTO dbo.CtDataType (DataTypeId, DataTypeName, DataTypeSqlName, DataTypeSysName, DataTypeSByteOle, DataTypeDByteOle, DataTypeDesc, NumericData, DoubleByte)
		SELECT * FROM dbo.Tmp_CtDataType
		SET IDENTITY_INSERT dbo.CtDataType OFF')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.CtDataType) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtDataType) = 0 DROP TABLE dbo.Tmp_CtDataType')
	EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_CtDataType ON dbo.CtDataType (DataTypeName)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=55&typ=N&sys=3","","",""); return false;
56~@~   2.  23.61221:D:   30:*:*:*: Correct indices on table DbColumn~@~48~@~30~@~D~@~~@~~@~~@~~@~Correct indices on table DbColumn~@~N~@~IF EXISTS (SELECT 1 FROM dbo.sysindexes WHERE id = object_id('dbo.DbColumn') and name = 'IX_DbColumn_TableId')
BEGIN
	EXEC ('DROP INDEX dbo.DbColumn.IX_DbColumn_TableId')
	EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_DbColumn ON dbo.DbColumn (TableId,ColumnName)')
END
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('PK_ColavailCol') AND type = 'K')
BEGIN
	EXEC ('ALTER TABLE dbo.DbColumn DROP CONSTRAINT PK_ColavailCol')
	EXEC ('ALTER TABLE dbo.DbColumn ADD CONSTRAINT PK_DbColumn PRIMARY KEY CLUSTERED (ColumnId)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=56&typ=N&sys=3","","",""); return false;
66~@~   2.  23.61221:D:   70:*:*:S: Add column DoubleByte to CtDataType~@~48~@~70~@~D~@~~@~~@~S~@~~@~Add column DoubleByte to CtDataType~@~N~@~if not exists (select 'true' from dbo.syscolumns where id = object_id('dbo.CtDataType') and name = 'DoubleByte')
BEGIN
	EXEC ('CREATE TABLE dbo.Tmp_CtDataType(
		DataTypeId numeric(3,0) NOT NULL,
		DataTypeName varchar(20) NOT NULL,
		DataTypeSqlName varchar(20) NOT NULL,
		DataTypeSysName varchar(20) NOT NULL,
		DataTypeSByteOle varchar(20) NOT NULL,
		DataTypeDByteOle varchar(20) NOT NULL,
		DataTypeDesc varchar(80) NOT NULL,
		NumericData char(1) NOT NULL,
		DoubleByte char(1) NOT NULL)')
	EXEC ('INSERT INTO dbo.Tmp_CtDataType SELECT DataTypeId, DataTypeName, DataTypeSqlName, DataTypeSysName, DataTypeSByteOle, DataTypeDByteOle, DataTypeDesc, NumericData
		, CASE WHEN DataTypeId IN (10,11,19) THEN ''Y'' ELSE ''N'' END FROM dbo.CtDataType')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.Tmp_CtDataType) > 0 OR (SELECT COUNT(1) FROM dbo.CtDataType) = 0 DROP TABLE dbo.CtDataType')
	EXEC ('CREATE TABLE dbo.CtDataType(
		DataTypeId numeric(3,0) IDENTITY NOT NULL,
		DataTypeName varchar(20) NOT NULL,
		DataTypeSqlName varchar(20) NOT NULL,
		DataTypeSysName varchar(20) NOT NULL,
		DataTypeSByteOle varchar(20) NOT NULL,
		DataTypeDByteOle varchar(20) NOT NULL,
		DataTypeDesc varchar(80) NOT NULL,
		NumericData char(1) NOT NULL,
		DoubleByte char(1) NOT NULL,
		CONSTRAINT PK_CtDataType PRIMARY KEY CLUSTERED (DataTypeId))')
	EXEC ('SET IDENTITY_INSERT dbo.CtDataType ON
		INSERT INTO dbo.CtDataType (DataTypeId, DataTypeName, DataTypeSqlName, DataTypeSysName, DataTypeSByteOle, DataTypeDByteOle, DataTypeDesc, NumericData, DoubleByte)
		SELECT * FROM dbo.Tmp_CtDataType
		SET IDENTITY_INSERT dbo.CtDataType OFF')
	EXEC ('IF (SELECT COUNT(1) FROM dbo.CtDataType) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtDataType) = 0 DROP TABLE dbo.Tmp_CtDataType')
	EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_CtDataType ON dbo.CtDataType (DataTypeName)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=66&typ=N&sys=3","","",""); return false;
67~@~   2.  23.61221:D:   20:*:*:S: Add columns to table ServerRule~@~48~@~20~@~D~@~~@~~@~S~@~~@~Add columns to table ServerRule~@~Y~@~IF not exists (select 'true' from dbo.syscolumns where id = object_id('dbo.ServerRule') and name = 'RuleCode')
BEGIN
	EXEC ('ALTER TABLE dbo.ServerRule ADD RuleCode text NULL, ModifiedBy numeric(10,0) NULL, ModifiedOn datetime NULL')
	EXEC ('UPDATE dbo.ServerRule SET ModifiedBy = 1, ModifiedOn = getdate()')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=67&typ=N&sys=3","","",""); return false;
68~@~   2.  23.61221:D:   50:*:*:S: Add columns to DbTable and DbColumn~@~48~@~50~@~D~@~~@~~@~S~@~~@~Add columns to DbTable and DbColumn~@~Y~@~IF not exists (select 'true' from dbo.syscolumns where id = object_id('dbo.DbTable') and name = 'PrevTblName')
BEGIN
	EXEC ('ALTER TABLE dbo.DbTable ADD PrevTblName varchar(20) NULL')
	EXEC ('ALTER TABLE dbo.DbColumn ADD PrevColName varchar(20) NULL, ColumnIndex numeric(5,0) NULL, DefaultValue nvarchar(50) NULL')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=68&typ=N&sys=3","","",""); return false;
80~@~   2.  24.70108:D:   10:*:*:M: Change table AppInfo~@~49~@~10~@~D~@~~@~~@~M~@~~@~Change table AppInfo~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_AppInfo (AppInfoDesc varchar(50) NULL, AppInfoId int NOT NULL, AppItemLink varchar(200) NULL, Prerequisite nvarchar(200) NULL, Readme ntext NULL, VersionDt datetime NULL, VersionMa smallint NOT NULL, VersionMi smallint NOT NULL) INSERT INTO dbo.Tmp_AppInfo (AppInfoDesc, AppInfoId, AppItemLink, Prerequisite, Readme, VersionDt, VersionMa, VersionMi) SELECT AppInfoDesc, AppInfoId, AppItemLink, Prerequisite, Readme, VersionDt, VersionMa, VersionMi FROM dbo.AppInfo IF (SELECT COUNT(1) FROM dbo.Tmp_AppInfo) > 0 OR (SELECT COUNT(1) FROM dbo.AppInfo) = 0 DROP TABLE dbo.AppInfo CREATE TABLE dbo.AppInfo (AppInfoId Int IDENTITY NOT NULL, AppInfoDesc VarChar(50) NULL, VersionMa SmallInt NOT NULL, VersionMi SmallInt NOT NULL, VersionDt DateTime NULL, DeployZip VarChar(100) NULL, Prerequisite NVarChar(200) NULL, Readme NText NULL, AppItemLink VarChar(200) NULL, CONSTRAINT PK_AppInfo PRIMARY KEY CLUSTERED (AppInfoId)) SET IDENTITY_INSERT dbo.AppInfo ON INSERT INTO dbo.AppInfo (AppInfoId, AppInfoDesc, VersionMa, VersionMi, VersionDt, Prerequisite, Readme, AppItemLink) SELECT AppInfoId, AppInfoDesc, VersionMa, VersionMi, VersionDt, Prerequisite, Readme, AppItemLink FROM dbo.Tmp_AppInfo SET IDENTITY_INSERT dbo.AppInfo OFF IF (SELECT COUNT(1) FROM dbo.AppInfo) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AppInfo) = 0 DROP TABLE dbo.Tmp_AppInfo')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=80&typ=N&sys=3","","",""); return false;
81~@~   2.  24.70108:D:   10:*:*:S: Change table AppInfo~@~49~@~10~@~D~@~~@~~@~S~@~~@~Change table AppInfo~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_AppInfo (AppInfoDesc varchar(50) NULL, AppInfoId numeric(10,0) NOT NULL, AppItemLink varchar(200) NULL, Prerequisite nvarchar(200) NULL, Readme text NULL, VersionDt datetime NULL, VersionMa numeric(5,0) NOT NULL, VersionMi numeric(5,0) NOT NULL)')

EXEC ('INSERT INTO dbo.Tmp_AppInfo (AppInfoDesc, AppInfoId, AppItemLink, Prerequisite, Readme, VersionDt, VersionMa, VersionMi) SELECT AppInfoDesc, AppInfoId, AppItemLink, Prerequisite, Readme, VersionDt, VersionMa, VersionMi FROM dbo.AppInfo IF (SELECT COUNT(1) FROM dbo.Tmp_AppInfo) > 0 OR (SELECT COUNT(1) FROM dbo.AppInfo) = 0 DROP TABLE dbo.AppInfo')

EXEC ('CREATE TABLE dbo.AppInfo (AppInfoId numeric(10,0) IDENTITY NOT NULL, AppInfoDesc VarChar(50) NULL, VersionMa numeric(5,0) NOT NULL, VersionMi numeric(5,0) NOT NULL, VersionDt DateTime NULL, DeployZip VarChar(100) NULL, Prerequisite NVarChar(200) NULL, Readme Text NULL, AppItemLink VarChar(200) NULL, CONSTRAINT PK_AppInfo PRIMARY KEY CLUSTERED (AppInfoId))')

EXEC ('SET IDENTITY_INSERT dbo.AppInfo ON INSERT INTO dbo.AppInfo (AppInfoId, AppInfoDesc, VersionMa, VersionMi, VersionDt, Prerequisite, Readme, AppItemLink) SELECT AppInfoId, AppInfoDesc, VersionMa, VersionMi, VersionDt, Prerequisite, Readme, AppItemLink FROM dbo.Tmp_AppInfo SET IDENTITY_INSERT dbo.AppInfo OFF IF (SELECT COUNT(1) FROM dbo.AppInfo) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AppInfo) = 0 DROP TABLE dbo.Tmp_AppInfo')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=81&typ=N&sys=3","","",""); return false;
82~@~   2.  24.70122:D:   10:*:*:M: Change table ServerRule~@~50~@~10~@~D~@~~@~~@~M~@~~@~Change table ServerRule~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_ServerRule (BeforeCRUD char(1) NOT NULL, CallingParams varchar(200) NULL, ExecOrder smallint NOT NULL, MasterTable char(1) NOT NULL, ModifiedBy int NULL, ModifiedOn datetime NULL, OnAdd char(1) NOT NULL, OnDel char(1) NOT NULL, OnUpd char(1) NOT NULL, ParameterNames varchar(200) NULL, ParameterTypes varchar(200) NULL, ProcedureName varchar(28) NOT NULL, RuleCode ntext NULL, RuleDesc nvarchar(150) NULL, RuleDescription nvarchar(500) NULL, RuleName nvarchar(100) NOT NULL, RuleTypeId tinyint NOT NULL, ScreenId int NOT NULL, ServerRuleId int NOT NULL) INSERT INTO dbo.Tmp_ServerRule (BeforeCRUD, CallingParams, ExecOrder, MasterTable, ModifiedBy, ModifiedOn, OnAdd, OnDel, OnUpd, ParameterNames, ParameterTypes, ProcedureName, RuleCode, RuleDesc, RuleDescription, RuleName, RuleTypeId, ScreenId, ServerRuleId) SELECT BeforeCRUD, CallingParams, ExecOrder, MasterTable, ModifiedBy, ModifiedOn, OnAdd, OnDel, OnUpd, ParameterNames, ParameterTypes, ProcedureName, RuleCode, RuleDesc, RuleDescription, RuleName, RuleTypeId, ScreenId, ServerRuleId FROM dbo.ServerRule IF (SELECT COUNT(1) FROM dbo.Tmp_ServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.ServerRule) = 0 DROP TABLE dbo.ServerRule')EXEC (' CREATE TABLE dbo.ServerRule (ServerRuleId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, RuleTypeId TinyInt NOT NULL, MasterTable Char(1) NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, ExecOrder SmallInt NOT NULL, ProcedureName VarChar(28) NOT NULL, ParameterNames VarChar(200) NULL, ParameterTypes VarChar(200) NULL, CallingParams VarChar(200) NULL, OnAdd Char(1) NOT NULL, OnUpd Char(1) NOT NULL, OnDel Char(1) NOT NULL, BeforeCRUD Char(1) NOT NULL, RuleCode NText NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, CONSTRAINT PK_ServerRule PRIMARY KEY CLUSTERED (ServerRuleId))')EXEC (' SET IDENTITY_INSERT dbo.ServerRule ON INSERT INTO dbo.ServerRule (ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, ExecOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn) SELECT ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, ExecOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn FROM dbo.Tmp_ServerRule SET IDENTITY_INSERT dbo.ServerRule OFF IF (SELECT COUNT(1) FROM dbo.ServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ServerRule) = 0 DROP TABLE dbo.Tmp_ServerRule')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=82&typ=N&sys=3","","",""); return false;
83~@~   2.  24.70122:D:   10:*:*:S: Change table ServerRule~@~50~@~10~@~D~@~~@~~@~S~@~~@~Change table ServerRule~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_ServerRule (BeforeCRUD char(1) NOT NULL, CallingParams varchar(200) NULL, ExecOrder numeric (5,0) NOT NULL, MasterTable char(1) NOT NULL, ModifiedBy numeric (10,0) NULL, ModifiedOn datetime NULL, OnAdd char(1) NOT NULL, OnDel char(1) NOT NULL, OnUpd char(1) NOT NULL, ParameterNames varchar(200) NULL, ParameterTypes varchar(200) NULL, ProcedureName varchar(28) NOT NULL, RuleCode text NULL, RuleDesc nvarchar(150) NULL, RuleDescription nvarchar(500) NULL, RuleName nvarchar(100) NOT NULL, RuleTypeId numeric (3,0) NOT NULL, ScreenId numeric (10,0) NOT NULL, ServerRuleId numeric (10,0) NOT NULL) INSERT INTO dbo.Tmp_ServerRule (BeforeCRUD, CallingParams, ExecOrder, MasterTable, ModifiedBy, ModifiedOn, OnAdd, OnDel, OnUpd, ParameterNames, ParameterTypes, ProcedureName, RuleCode, RuleDesc, RuleDescription, RuleName, RuleTypeId, ScreenId, ServerRuleId) SELECT BeforeCRUD, CallingParams, ExecOrder, MasterTable, ModifiedBy, ModifiedOn, OnAdd, OnDel, OnUpd, ParameterNames, ParameterTypes, ProcedureName, RuleCode, RuleDesc, RuleDescription, RuleName, RuleTypeId, ScreenId, ServerRuleId FROM dbo.ServerRule IF (SELECT COUNT(1) FROM dbo.Tmp_ServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.ServerRule) = 0 DROP TABLE dbo.ServerRule')EXEC (' CREATE TABLE dbo.ServerRule (ServerRuleId numeric (10,0) IDENTITY NOT NULL, ScreenId numeric (10,0) NOT NULL, RuleTypeId numeric (3,0) NOT NULL, MasterTable Char(1) NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, ExecOrder numeric (5,0) NOT NULL, ProcedureName VarChar(28) NOT NULL, ParameterNames VarChar(200) NULL, ParameterTypes VarChar(200) NULL, CallingParams VarChar(200) NULL, OnAdd Char(1) NOT NULL, OnUpd Char(1) NOT NULL, OnDel Char(1) NOT NULL, BeforeCRUD Char(1) NOT NULL, RuleCode text NULL, ModifiedBy numeric (10,0) NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, CONSTRAINT PK_ServerRule PRIMARY KEY CLUSTERED (ServerRuleId))')EXEC (' SET IDENTITY_INSERT dbo.ServerRule ON INSERT INTO dbo.ServerRule (ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, ExecOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn) SELECT ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, ExecOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn FROM dbo.Tmp_ServerRule SET IDENTITY_INSERT dbo.ServerRule OFF IF (SELECT COUNT(1) FROM dbo.ServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ServerRule) = 0 DROP TABLE dbo.Tmp_ServerRule')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=83&typ=N&sys=3","","",""); return false;
85~@~   2.  24.70129:D:   10:*:*:*: Add table CtCrawler~@~52~@~10~@~D~@~~@~~@~~@~~@~Add table CtCrawler~@~Y~@~if not exists (select 'true' from dbo.sysobjects where id = object_id('dbo.CtCrawler'))
BEGIN
EXEC (' CREATE TABLE dbo.CtCrawler (CrawlerCd Char(2) NOT NULL, CrawlerName NVarChar(50) NOT NULL, CrawlerURL VarChar(100) NOT NULL, CrawlerREF VarChar(100) NOT NULL, PreText VarChar(200) NOT NULL, PostText VarChar(200) NOT NULL, ResultRegex VarChar(100) NOT NULL, CONSTRAINT PK_CtCrawler PRIMARY KEY CLUSTERED (CrawlerCd))')
EXEC ('INSERT INTO dbo.CtCrawler VALUES(''GG'',''Google'',''http://translate.google.com/translate_t'',''http://translate.google.com/'',''langpair='',''&text='',''<div id=result_box dir=ltr>((?:.|\n)*?)</div>'')')
EXEC ('INSERT INTO dbo.CtCrawler VALUES(''BB'',''BabelFish'',''http://babelfish.altavista.com/babelfish/tr'',''http://babelfish.altavista.com/'',''lp='',''&tt=urltext&intl=1&doit=done&urltext='',''<div style=padding:10px;>((?:.|\n)*?)</div>'')')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=85&typ=N&sys=3","","",""); return false;
92~@~   2.  24.70219:D:   10:*:*:M: Change table ReportCri~@~53~@~10~@~D~@~~@~~@~M~@~~@~Change table ReportCri~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.syscolumns WHERE id = object_id('dbo.ReportCri') and name = 'RegClause')
BEGIN
EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''FK_ReportCri_Report'')) ALTER TABLE dbo.ReportCri DROP CONSTRAINT FK_ReportCri_Report')
EXEC (' CREATE TABLE dbo.Tmp_ReportCri (ColumnName varchar(20) NOT NULL, ColumnSize smallint NULL, DataTypeId tinyint NOT NULL, DataTypeSize smallint NULL, DdlKeyColumnName varchar(50) NULL, DdlRefColumnName varchar(50) NULL, DdlSrtColumnName varchar(50) NULL, DisplayModeId tinyint NOT NULL, RegExeClause varchar(400) NULL, ReportCriDesc varchar(100) NULL, ReportCriId int NOT NULL, ReportGrpId int NOT NULL, ReportId int NOT NULL, RequiredValid char(1) NOT NULL, RowSize smallint NULL, TabIndex smallint NOT NULL, TableAbbr varchar(10) NULL, TableId int NULL, WhereClause varchar(1000) NULL) INSERT INTO dbo.Tmp_ReportCri (ColumnName, ColumnSize, DataTypeId, DataTypeSize, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, DisplayModeId, RegExeClause, ReportCriDesc, ReportCriId, ReportGrpId, ReportId, RequiredValid, RowSize, TabIndex, TableAbbr, TableId, WhereClause) SELECT ColumnName, ColumnSize, DataTypeId, DataTypeSize, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, DisplayModeId, RegExeClause, ReportCriDesc, ReportCriId, ReportGrpId, ReportId, RequiredValid, RowSize, TabIndex, TableAbbr, TableId, WhereClause FROM dbo.ReportCri IF (SELECT COUNT(1) FROM dbo.Tmp_ReportCri) > 0 OR (SELECT COUNT(1) FROM dbo.ReportCri) = 0 DROP TABLE dbo.ReportCri')
EXEC (' CREATE TABLE dbo.ReportCri (ReportCriId Int IDENTITY NOT NULL, ReportId Int NOT NULL, ReportCriDesc VarChar(100) NULL, ReportGrpId Int NOT NULL, TableId Int NULL, TableAbbr VarChar(10) NULL, ColumnName VarChar(20) NOT NULL, TabIndex SmallInt NOT NULL, DataTypeId TinyInt NOT NULL, DataTypeSize SmallInt NULL, DisplayModeId TinyInt NOT NULL, ColumnSize SmallInt NULL, RowSize SmallInt NULL, DdlKeyColumnName VarChar(50) NULL, DdlRefColumnName VarChar(50) NULL, DdlSrtColumnName VarChar(50) NULL, RequiredValid Char(1) NOT NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, CONSTRAINT PK_ReportCri PRIMARY KEY CLUSTERED (ReportCriId))')
EXEC (' SET IDENTITY_INSERT dbo.ReportCri ON INSERT INTO dbo.ReportCri (ReportCriId, ReportId, ReportCriDesc, ReportGrpId, TableId, TableAbbr, ColumnName, TabIndex, DataTypeId, DataTypeSize, DisplayModeId, ColumnSize, RowSize, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, RequiredValid, WhereClause, RegClause) SELECT ReportCriId, ReportId, ReportCriDesc, ReportGrpId, TableId, TableAbbr, ColumnName, TabIndex, DataTypeId, DataTypeSize, DisplayModeId, ColumnSize, RowSize, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, RequiredValid, WhereClause, RegExeClause FROM dbo.Tmp_ReportCri SET IDENTITY_INSERT dbo.ReportCri OFF IF (SELECT COUNT(1) FROM dbo.ReportCri) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ReportCri) = 0 DROP TABLE dbo.Tmp_ReportCri')
EXEC (' CREATE UNIQUE NONCLUSTERED INDEX IX_ReportCri_ReportId ON dbo.ReportCri (ReportId,TabIndex,ColumnName)')
EXEC (' ALTER TABLE dbo.ReportCri WITH NOCHECK ADD CONSTRAINT FK_ReportCri_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=92&typ=N&sys=3","","",""); return false;
94~@~   2.  24.70219:D:   20:*:*:M: Change table Report~@~53~@~20~@~D~@~~@~~@~M~@~~@~Change table Report~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.syscolumns WHERE id = object_id('dbo.Report') and name = 'RegClause')
BEGIN
EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''FK_ReportCri_Report'')) ALTER TABLE dbo.ReportCri DROP CONSTRAINT FK_ReportCri_Report')
EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''FK_ReportObj_Report'')) ALTER TABLE dbo.ReportObj DROP CONSTRAINT FK_ReportObj_Report')
EXEC (' CREATE TABLE dbo.Tmp_Report (CopyReportId int NULL, GenerateRp char(1) NOT NULL, GlobalCriteria char(1) NOT NULL, PrintPortrait char(1) NOT NULL, ProgramName varchar(20) NOT NULL, RegExeClause varchar(400) NULL, ReportDesc nvarchar(50) NULL, ReportId int NOT NULL, TemplateName varchar(50) NULL, ToXlsOnly char(1) NOT NULL, UpdExeClause varchar(200) NULL, WhereClause varchar(1000) NULL, XlsExeClause varchar(200) NULL) INSERT INTO dbo.Tmp_Report (CopyReportId, GenerateRp, GlobalCriteria, PrintPortrait, ProgramName, RegExeClause, ReportDesc, ReportId, TemplateName, ToXlsOnly, UpdExeClause, WhereClause, XlsExeClause) SELECT CopyReportId, GenerateRp, GlobalCriteria, PrintPortrait, ProgramName, RegExeClause, ReportDesc, ReportId, TemplateName, ToXlsOnly, UpdExeClause, WhereClause, XlsExeClause FROM dbo.Report IF (SELECT COUNT(1) FROM dbo.Tmp_Report) > 0 OR (SELECT COUNT(1) FROM dbo.Report) = 0 DROP TABLE dbo.Report')
EXEC (' CREATE TABLE dbo.Report (ReportId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ReportDesc NVarChar(50) NULL, GlobalCriteria Char(1) NOT NULL, PrintPortrait Char(1) NOT NULL, ToXlsOnly Char(1) NOT NULL, TemplateName VarChar(50) NULL, CopyReportId Int NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, UpdClause VarChar(200) NULL, XlsClause VarChar(200) NULL, GenerateRp Char(1) NOT NULL, CONSTRAINT PK_Report PRIMARY KEY CLUSTERED (ReportId))')
EXEC (' SET IDENTITY_INSERT dbo.Report ON INSERT INTO dbo.Report (ReportId, ProgramName, ReportDesc, GlobalCriteria, PrintPortrait, ToXlsOnly, TemplateName, CopyReportId, WhereClause, RegClause, UpdClause, XlsClause, GenerateRp) SELECT ReportId, ProgramName, ReportDesc, GlobalCriteria, PrintPortrait, ToXlsOnly, TemplateName, CopyReportId, WhereClause, RegExeClause, UpdExeClause, XlsExeClause, GenerateRp FROM dbo.Tmp_Report SET IDENTITY_INSERT dbo.Report OFF IF (SELECT COUNT(1) FROM dbo.Report) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Report) = 0 DROP TABLE dbo.Tmp_Report')
EXEC (' CREATE UNIQUE NONCLUSTERED INDEX IX_Report_ProgramName ON dbo.Report (ProgramName)')
EXEC (' ALTER TABLE dbo.ReportObj WITH NOCHECK ADD CONSTRAINT FK_ReportObj_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId)')
EXEC (' ALTER TABLE dbo.ReportCri WITH NOCHECK ADD CONSTRAINT FK_ReportCri_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=94&typ=N&sys=3","","",""); return false;
95~@~   2.  24.70219:D:   30:*:*:M: Change table ServerRule~@~53~@~30~@~D~@~~@~~@~M~@~~@~Change table ServerRule~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.syscolumns WHERE id = object_id('dbo.ServerRule') and name = 'RuleOrder')
BEGIN
EXEC (' CREATE TABLE dbo.Tmp_ServerRule (BeforeCRUD char(1) NOT NULL, CallingParams varchar(200) NULL, ExecOrder smallint NOT NULL, LastGenDt datetime NULL, MasterTable char(1) NOT NULL, ModifiedBy int NULL, ModifiedOn datetime NULL, OnAdd char(1) NOT NULL, OnDel char(1) NOT NULL, OnUpd char(1) NOT NULL, ParameterNames varchar(200) NULL, ParameterTypes varchar(200) NULL, ProcedureName varchar(28) NOT NULL, RuleCode ntext NULL, RuleDesc nvarchar(150) NULL, RuleDescription nvarchar(500) NULL, RuleName nvarchar(100) NOT NULL, RuleTypeId tinyint NOT NULL, ScreenId int NOT NULL, ServerRuleId int NOT NULL) INSERT INTO dbo.Tmp_ServerRule (BeforeCRUD, CallingParams, ExecOrder, LastGenDt, MasterTable, ModifiedBy, ModifiedOn, OnAdd, OnDel, OnUpd, ParameterNames, ParameterTypes, ProcedureName, RuleCode, RuleDesc, RuleDescription, RuleName, RuleTypeId, ScreenId, ServerRuleId) SELECT BeforeCRUD, CallingParams, ExecOrder, LastGenDt, MasterTable, ModifiedBy, ModifiedOn, OnAdd, OnDel, OnUpd, ParameterNames, ParameterTypes, ProcedureName, RuleCode, RuleDesc, RuleDescription, RuleName, RuleTypeId, ScreenId, ServerRuleId FROM dbo.ServerRule IF (SELECT COUNT(1) FROM dbo.Tmp_ServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.ServerRule) = 0 DROP TABLE dbo.ServerRule')EXEC (' CREATE TABLE dbo.ServerRule (ServerRuleId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, RuleTypeId TinyInt NOT NULL, MasterTable Char(1) NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, RuleOrder SmallInt NOT NULL, ProcedureName VarChar(28) NOT NULL, ParameterNames VarChar(200) NULL, ParameterTypes VarChar(200) NULL, CallingParams VarChar(200) NULL, OnAdd Char(1) NOT NULL, OnUpd Char(1) NOT NULL, OnDel Char(1) NOT NULL, BeforeCRUD Char(1) NOT NULL, RuleCode NText NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, CONSTRAINT PK_ServerRule PRIMARY KEY CLUSTERED (ServerRuleId))')EXEC (' SET IDENTITY_INSERT dbo.ServerRule ON INSERT INTO dbo.ServerRule (ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, RuleOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn, LastGenDt) SELECT ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, ExecOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn, LastGenDt FROM dbo.Tmp_ServerRule SET IDENTITY_INSERT dbo.ServerRule OFF IF (SELECT COUNT(1) FROM dbo.ServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ServerRule) = 0 DROP TABLE dbo.Tmp_ServerRule')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=95&typ=N&sys=3","","",""); return false;
96~@~   2.  24.70219:D:   40:*:*:M: Change table WizardRule~@~53~@~40~@~D~@~~@~~@~M~@~~@~Change table WizardRule~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.syscolumns WHERE id = object_id('dbo.WizardRule') and name = 'RuleOrder')
BEGIN
EXEC (' CREATE TABLE dbo.Tmp_WizardRule (BeforeCRUD char(1) NOT NULL, ExecOrder smallint NOT NULL, ProcedureName varchar(50) NOT NULL, RuleDesc nvarchar(150) NULL, RuleDescription nvarchar(500) NULL, RuleName nvarchar(100) NOT NULL, RuleTypeId tinyint NOT NULL, WizardId int NOT NULL, WizardRuleId int NOT NULL) INSERT INTO dbo.Tmp_WizardRule (BeforeCRUD, ExecOrder, ProcedureName, RuleDesc, RuleDescription, RuleName, RuleTypeId, WizardId, WizardRuleId) SELECT BeforeCRUD, ExecOrder, ProcedureName, RuleDesc, RuleDescription, RuleName, RuleTypeId, WizardId, WizardRuleId FROM dbo.WizardRule IF (SELECT COUNT(1) FROM dbo.Tmp_WizardRule) > 0 OR (SELECT COUNT(1) FROM dbo.WizardRule) = 0 DROP TABLE dbo.WizardRule')
EXEC (' CREATE TABLE dbo.WizardRule (WizardRuleId Int IDENTITY NOT NULL, WizardId Int NOT NULL, RuleTypeId TinyInt NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, RuleOrder SmallInt NOT NULL, ProcedureName VarChar(50) NOT NULL, BeforeCRUD Char(1) NOT NULL, CONSTRAINT PK_WizardRule PRIMARY KEY CLUSTERED (WizardRuleId))')
EXEC (' SET IDENTITY_INSERT dbo.WizardRule ON INSERT INTO dbo.WizardRule (WizardRuleId, WizardId, RuleTypeId, RuleName, RuleDesc, RuleDescription, RuleOrder, ProcedureName, BeforeCRUD) SELECT WizardRuleId, WizardId, RuleTypeId, RuleName, RuleDesc, RuleDescription, ExecOrder, ProcedureName, BeforeCRUD FROM dbo.Tmp_WizardRule SET IDENTITY_INSERT dbo.WizardRule OFF IF (SELECT COUNT(1) FROM dbo.WizardRule) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_WizardRule) = 0 DROP TABLE dbo.Tmp_WizardRule')
EXEC (' CREATE UNIQUE NONCLUSTERED INDEX IX_WizardRule_WizardId ON dbo.WizardRule (WizardId,RuleOrder)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=96&typ=N&sys=3","","",""); return false;
97~@~   2.  24.70219:D:   50:*:*:M: Change table AppItem~@~53~@~50~@~D~@~~@~~@~M~@~~@~Change table AppItem~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.syscolumns WHERE id = object_id('dbo.AppItem') and name = 'ItemOrder')
BEGIN
EXEC (' CREATE TABLE dbo.Tmp_AppItem (AppInfoId int NOT NULL, AppItemCode ntext NULL, AppItemDesc varchar(200) NULL, AppItemId int NOT NULL, AppItemLink varchar(200) NULL, AppItemName varchar(50) NOT NULL, Attachmt varchar(100) NULL, CustomId int NULL, DbProviderCd char(1) NULL, FrameworkCd char(1) NULL, ItemOrder smallint NULL, LanguageCd char(1) NULL, MultiDesignDb char(1) NOT NULL, ObjectTypeCd char(1) NOT NULL, RelativePath varchar(100) NULL, RemoveItem char(1) NOT NULL, ReportId int NULL, ScreenId int NULL, WizardId int NULL) INSERT INTO dbo.Tmp_AppItem (AppInfoId, AppItemCode, AppItemDesc, AppItemId, AppItemLink, AppItemName, Attachmt, CustomId, DbProviderCd, FrameworkCd, ItemOrder, LanguageCd, MultiDesignDb, ObjectTypeCd, RelativePath, RemoveItem, ReportId, ScreenId, WizardId) SELECT AppInfoId, AppItemCode, AppItemDesc, AppItemId, AppItemLink, AppItemName, Attachmt, CustomId, DbProviderCd, FrameworkCd, ExecOrder, LanguageCd, MultiDesignDb, ObjectTypeCd, RelativePath, RemoveItem, ReportId, ScreenId, WizardId FROM dbo.AppItem IF (SELECT COUNT(1) FROM dbo.Tmp_AppItem) > 0 OR (SELECT COUNT(1) FROM dbo.AppItem) = 0 DROP TABLE dbo.AppItem')
EXEC (' CREATE TABLE dbo.AppItem (AppItemId Int IDENTITY NOT NULL, AppItemDesc VarChar(200) NULL, AppInfoId Int NOT NULL, ItemOrder SmallInt NULL, ObjectTypeCd Char(1) NOT NULL, LanguageCd Char(1) NULL, FrameworkCd Char(1) NULL, DbProviderCd Char(1) NULL, RelativePath VarChar(100) NULL, AppItemName VarChar(50) NOT NULL, MultiDesignDb Char(1) NOT NULL, AppItemCode NText NULL, Attachmt VarChar(100) NULL, RemoveItem Char(1) NOT NULL, ScreenId Int NULL, ReportId Int NULL, WizardId Int NULL, CustomId Int NULL, AppItemLink VarChar(200) NULL, CONSTRAINT PK_AppItem PRIMARY KEY CLUSTERED (AppItemId))')
EXEC (' SET IDENTITY_INSERT dbo.AppItem ON INSERT INTO dbo.AppItem (AppItemId, AppItemDesc, AppInfoId, ItemOrder, ObjectTypeCd, LanguageCd, FrameworkCd, DbProviderCd, RelativePath, AppItemName, MultiDesignDb, AppItemCode, Attachmt, RemoveItem, ScreenId, ReportId, WizardId, CustomId, AppItemLink) SELECT AppItemId, AppItemDesc, AppInfoId, ItemOrder, ObjectTypeCd, LanguageCd, FrameworkCd, DbProviderCd, RelativePath, AppItemName, MultiDesignDb, AppItemCode, Attachmt, RemoveItem, ScreenId, ReportId, WizardId, CustomId, AppItemLink FROM dbo.Tmp_AppItem SET IDENTITY_INSERT dbo.AppItem OFF IF (SELECT COUNT(1) FROM dbo.AppItem) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AppItem) = 0 DROP TABLE dbo.Tmp_AppItem')
EXEC (' CREATE NONCLUSTERED INDEX IX_AppItem ON dbo.AppItem (AppInfoId,AppItemDesc)')
EXEC (' CREATE NONCLUSTERED INDEX IX_AppItem_Atmt ON dbo.AppItem (Attachmt)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=97&typ=N&sys=3","","",""); return false;
98~@~   2.  24.70219:D:   60:*:*:M: Change table DbColumn~@~53~@~60~@~D~@~~@~~@~M~@~~@~Change table DbColumn~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.syscolumns WHERE id = object_id('dbo.DbColumn') and name = 'ColObjective' and length = 400)
BEGIN
EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''FK_ScreenObj_DbColumn'')) ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_DbColumn')
EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''FK_DbColumn_DbTable'')) ALTER TABLE dbo.DbColumn DROP CONSTRAINT FK_DbColumn_DbTable')
EXEC (' CREATE TABLE dbo.Tmp_DbColumn (AllowNulls char(1) NOT NULL, ColObjective ntext NULL, ColumnDesc varchar(100) NULL, ColumnId int NOT NULL, ColumnIdentity char(1) NOT NULL, ColumnIndex smallint NULL, ColumnLength smallint NOT NULL, ColumnName varchar(20) NOT NULL, ColumnScale tinyint NULL, DataType tinyint NOT NULL, DefaultValue nvarchar(50) NULL, ExternalTable varchar(50) NULL, PrevColName varchar(20) NULL, PrimaryKey char(1) NOT NULL, TableId int NOT NULL) INSERT INTO dbo.Tmp_DbColumn (AllowNulls, ColObjective, ColumnDesc, ColumnId, ColumnIdentity, ColumnIndex, ColumnLength, ColumnName, ColumnScale, DataType, DefaultValue, ExternalTable, PrevColName, PrimaryKey, TableId) SELECT AllowNulls, ColObjective, ColumnDesc, ColumnId, ColumnIdentity, ColumnIndex, ColumnLength, ColumnName, ColumnScale, DataType, DefaultValue, ExternalTable, PrevColName, PrimaryKey, TableId FROM dbo.DbColumn IF (SELECT COUNT(1) FROM dbo.Tmp_DbColumn) > 0 OR (SELECT COUNT(1) FROM dbo.DbColumn) = 0 DROP TABLE dbo.DbColumn')
EXEC (' CREATE TABLE dbo.DbColumn (ColumnId Int IDENTITY NOT NULL, TableId Int NOT NULL, ExternalTable VarChar(50) NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(100) NULL, DataType TinyInt NOT NULL, ColumnLength SmallInt NOT NULL, ColumnScale TinyInt NULL, AllowNulls Char(1) NOT NULL, ColumnIdentity Char(1) NOT NULL, PrimaryKey Char(1) NOT NULL, ColObjective NVarChar(200) NULL, PrevColName VarChar(20) NULL, ColumnIndex SmallInt NULL, DefaultValue NVarChar(50) NULL, CONSTRAINT PK_DbColumn PRIMARY KEY CLUSTERED (ColumnId))')
EXEC (' SET IDENTITY_INSERT dbo.DbColumn ON INSERT INTO dbo.DbColumn (ColumnId, TableId, ExternalTable, ColumnName, ColumnDesc, DataType, ColumnLength, ColumnScale, AllowNulls, ColumnIdentity, PrimaryKey, ColObjective, PrevColName, ColumnIndex, DefaultValue) SELECT ColumnId, TableId, ExternalTable, ColumnName, ColumnDesc, DataType, ColumnLength, ColumnScale, AllowNulls, ColumnIdentity, PrimaryKey, convert(nvarchar(200),ColObjective), PrevColName, ColumnIndex, DefaultValue FROM dbo.Tmp_DbColumn SET IDENTITY_INSERT dbo.DbColumn OFF IF (SELECT COUNT(1) FROM dbo.DbColumn) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_DbColumn) = 0 DROP TABLE dbo.Tmp_DbColumn')
EXEC (' CREATE UNIQUE NONCLUSTERED INDEX IX_DbColumn ON dbo.DbColumn (TableId,ColumnName)')
EXEC (' ALTER TABLE dbo.DbColumn WITH NOCHECK ADD CONSTRAINT FK_DbColumn_DbTable FOREIGN KEY (TableId) REFERENCES dbo.DbTable (TableId)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=98&typ=N&sys=3","","",""); return false;
99~@~   2.  24.70219:D:   70:*:*:M: Change table ScreenGrp~@~53~@~70~@~D~@~~@~~@~M~@~~@~Change table ScreenGrp~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.syscolumns WHERE id = object_id('dbo.ScreenGrp') and name = 'TabIndex')
BEGIN
EXEC (' CREATE TABLE dbo.Tmp_ScreenGrp (BorderWidth tinyint NOT NULL, ContentVertical char(1) NOT NULL, LabelVertical char(1) NOT NULL, ParentGrpId int NULL, ScreenGrpId int NOT NULL, ScreenGrpIndex varchar(20) NULL, ScreenGrpName nvarchar(50) NOT NULL, ScreenGrpTypeCd char(1) NULL, ScreenId int NULL) INSERT INTO dbo.Tmp_ScreenGrp (BorderWidth, ContentVertical, LabelVertical, ParentGrpId, ScreenGrpId, ScreenGrpIndex, ScreenGrpName, ScreenGrpTypeCd, ScreenId) SELECT BorderWidth, ContentVertical, LabelVertical, ParentGrpId, ScreenGrpId, ScreenGrpIndex, ScreenGrpName, ScreenGrpTypeCd, ScreenId FROM dbo.ScreenGrp IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenGrp) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenGrp) = 0 DROP TABLE dbo.ScreenGrp')EXEC (' CREATE TABLE dbo.ScreenGrp (ScreenGrpId Int IDENTITY NOT NULL, ScreenId Int NULL, ScreenGrpTypeCd Char(1) NULL, ParentGrpId Int NULL, ScreenGrpName NVarChar(50) NOT NULL, TabIndex SmallInt NULL, ScreenGrpIndex VarChar(20) NULL, ContentVertical Char(1) NOT NULL, LabelVertical Char(1) NOT NULL, BorderWidth TinyInt NOT NULL, CONSTRAINT PK_ScreenGrp PRIMARY KEY CLUSTERED (ScreenGrpId))')EXEC (' SET IDENTITY_INSERT dbo.ScreenGrp ON INSERT INTO dbo.ScreenGrp (ScreenGrpId, ScreenId, ScreenGrpTypeCd, ParentGrpId, ScreenGrpName, ScreenGrpIndex, ContentVertical, LabelVertical, BorderWidth) SELECT ScreenGrpId, ScreenId, ScreenGrpTypeCd, ParentGrpId, ScreenGrpName, ScreenGrpIndex, ContentVertical, LabelVertical, BorderWidth FROM dbo.Tmp_ScreenGrp SET IDENTITY_INSERT dbo.ScreenGrp OFF IF (SELECT COUNT(1) FROM dbo.ScreenGrp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenGrp) = 0 DROP TABLE dbo.Tmp_ScreenGrp')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=99&typ=N&sys=3","","",""); return false;
100~@~   2.  24.70219:D:   80:*:*:M: Change table ReportGrp~@~53~@~80~@~D~@~~@~~@~M~@~~@~Change table ReportGrp~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.syscolumns WHERE id = object_id('dbo.ReportGrp') and name = 'TabIndex')
BEGIN
EXEC (' CREATE TABLE dbo.Tmp_ReportGrp (BorderWidth tinyint NOT NULL, ContentVertical char(1) NOT NULL, LabelVertical char(1) NOT NULL, ParentGrpId int NULL, ReportGrpId int NOT NULL, ReportGrpIndex varchar(20) NULL, ReportGrpName nvarchar(50) NOT NULL, ReportId int NULL) INSERT INTO dbo.Tmp_ReportGrp (BorderWidth, ContentVertical, LabelVertical, ParentGrpId, ReportGrpId, ReportGrpIndex, ReportGrpName, ReportId) SELECT BorderWidth, ContentVertical, LabelVertical, ParentGrpId, ReportGrpId, ReportGrpIndex, ReportGrpName, ReportId FROM dbo.ReportGrp IF (SELECT COUNT(1) FROM dbo.Tmp_ReportGrp) > 0 OR (SELECT COUNT(1) FROM dbo.ReportGrp) = 0 DROP TABLE dbo.ReportGrp')EXEC (' CREATE TABLE dbo.ReportGrp (ReportGrpId Int IDENTITY NOT NULL, ReportId Int NULL, ParentGrpId Int NULL, ReportGrpName NVarChar(50) NOT NULL, ReportGrpIndex VarChar(20) NULL, TabIndex SmallInt NULL, ContentVertical Char(1) NOT NULL, LabelVertical Char(1) NOT NULL, BorderWidth TinyInt NOT NULL, CONSTRAINT PK_ReportGrp PRIMARY KEY CLUSTERED (ReportGrpId))')EXEC (' SET IDENTITY_INSERT dbo.ReportGrp ON INSERT INTO dbo.ReportGrp (ReportGrpId, ReportId, ParentGrpId, ReportGrpName, ReportGrpIndex, ContentVertical, LabelVertical, BorderWidth) SELECT ReportGrpId, ReportId, ParentGrpId, ReportGrpName, ReportGrpIndex, ContentVertical, LabelVertical, BorderWidth FROM dbo.Tmp_ReportGrp SET IDENTITY_INSERT dbo.ReportGrp OFF IF (SELECT COUNT(1) FROM dbo.ReportGrp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ReportGrp) = 0 DROP TABLE dbo.Tmp_ReportGrp')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=100&typ=N&sys=3","","",""); return false;
101~@~   2.  24.70219:D:   90:*:*:*: Add View VwAppItem~@~53~@~90~@~D~@~~@~~@~~@~~@~Add View VwAppItem~@~Y~@~if not exists (select 1 from dbo.sysobjects where id = object_id('dbo.VwAppItem'))
BEGIN
EXEC ('CREATE VIEW VwAppItem AS
	SELECT a.AppInfoDesc, b.ItemOrder, b.DbProviderCd, b.AppItemName, b.MultiDesignDb, b.AppItemCode
	FROM dbo.AppInfo a INNER JOIN dbo.AppItem b ON a.AppInfoId = b.AppInfoId
	WHERE a.VersionDt is not null AND b.ObjectTypeCd = ''D''
	AND a.VersionDt > dateadd(mm,-13,convert(datetime,convert(varchar,getdate(),102)))')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=101&typ=N&sys=3","","",""); return false;
102~@~   2.  24.70219:D:   80:*:*:S: Change table ReportGrp~@~53~@~80~@~D~@~~@~~@~S~@~~@~Change table ReportGrp~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.syscolumns WHERE id = object_id('dbo.ReportGrp') and name = 'TabIndex')
BEGIN
EXEC (' CREATE TABLE dbo.Tmp_ReportGrp (BorderWidth numeric (3,0) NOT NULL, ContentVertical char(1) NOT NULL, LabelVertical char(1) NOT NULL, ParentGrpId numeric (10,0) NULL, ReportGrpId numeric (10,0) NOT NULL, ReportGrpIndex varchar(20) NULL, ReportGrpName nvarchar(50) NOT NULL, ReportId numeric (10,0) NULL) INSERT INTO dbo.Tmp_ReportGrp (BorderWidth, ContentVertical, LabelVertical, ParentGrpId, ReportGrpId, ReportGrpIndex, ReportGrpName, ReportId) SELECT BorderWidth, ContentVertical, LabelVertical, ParentGrpId, ReportGrpId, ReportGrpIndex, ReportGrpName, ReportId FROM dbo.ReportGrp IF (SELECT COUNT(1) FROM dbo.Tmp_ReportGrp) > 0 OR (SELECT COUNT(1) FROM dbo.ReportGrp) = 0 DROP TABLE dbo.ReportGrp')EXEC (' CREATE TABLE dbo.ReportGrp (ReportGrpId numeric (10,0) IDENTITY NOT NULL, ReportId numeric (10,0) NULL, ParentGrpId numeric (10,0) NULL, ReportGrpName NVarChar(50) NOT NULL, ReportGrpIndex VarChar(20) NULL, TabIndex numeric (5,0) NULL, ContentVertical Char(1) NOT NULL, LabelVertical Char(1) NOT NULL, BorderWidth numeric (3,0) NOT NULL, CONSTRAINT PK_ReportGrp PRIMARY KEY CLUSTERED (ReportGrpId))')EXEC (' SET IDENTITY_INSERT dbo.ReportGrp ON INSERT INTO dbo.ReportGrp (ReportGrpId, ReportId, ParentGrpId, ReportGrpName, ReportGrpIndex, ContentVertical, LabelVertical, BorderWidth) SELECT ReportGrpId, ReportId, ParentGrpId, ReportGrpName, ReportGrpIndex, ContentVertical, LabelVertical, BorderWidth FROM dbo.Tmp_ReportGrp SET IDENTITY_INSERT dbo.ReportGrp OFF IF (SELECT COUNT(1) FROM dbo.ReportGrp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ReportGrp) = 0 DROP TABLE dbo.Tmp_ReportGrp')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=102&typ=N&sys=3","","",""); return false;
103~@~   2.  24.70219:D:   70:*:*:S: Change table ScreenGrp~@~53~@~70~@~D~@~~@~~@~S~@~~@~Change table ScreenGrp~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.syscolumns WHERE id = object_id('dbo.ScreenGrp') and name = 'TabIndex')
BEGIN
EXEC (' CREATE TABLE dbo.Tmp_ScreenGrp (BorderWidth numeric (3,0) NOT NULL, ContentVertical char(1) NOT NULL, LabelVertical char(1) NOT NULL, ParentGrpId numeric (10,0) NULL, ScreenGrpId numeric (10,0) NOT NULL, ScreenGrpIndex varchar(20) NULL, ScreenGrpName nvarchar(50) NOT NULL, ScreenGrpTypeCd char(1) NULL, ScreenId numeric (10,0) NULL) INSERT INTO dbo.Tmp_ScreenGrp (BorderWidth, ContentVertical, LabelVertical, ParentGrpId, ScreenGrpId, ScreenGrpIndex, ScreenGrpName, ScreenGrpTypeCd, ScreenId) SELECT BorderWidth, ContentVertical, LabelVertical, ParentGrpId, ScreenGrpId, ScreenGrpIndex, ScreenGrpName, ScreenGrpTypeCd, ScreenId FROM dbo.ScreenGrp IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenGrp) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenGrp) = 0 DROP TABLE dbo.ScreenGrp')EXEC (' CREATE TABLE dbo.ScreenGrp (ScreenGrpId numeric (10,0) IDENTITY NOT NULL, ScreenId numeric (10,0) NULL, ScreenGrpTypeCd Char(1) NULL, ParentGrpId numeric (10,0) NULL, ScreenGrpName NVarChar(50) NOT NULL, TabIndex numeric (5,0) NULL, ScreenGrpIndex VarChar(20) NULL, ContentVertical Char(1) NOT NULL, LabelVertical Char(1) NOT NULL, BorderWidth numeric (3,0) NOT NULL, CONSTRAINT PK_ScreenGrp PRIMARY KEY CLUSTERED (ScreenGrpId))')EXEC (' SET IDENTITY_INSERT dbo.ScreenGrp ON INSERT INTO dbo.ScreenGrp (ScreenGrpId, ScreenId, ScreenGrpTypeCd, ParentGrpId, ScreenGrpName, ScreenGrpIndex, ContentVertical, LabelVertical, BorderWidth) SELECT ScreenGrpId, ScreenId, ScreenGrpTypeCd, ParentGrpId, ScreenGrpName, ScreenGrpIndex, ContentVertical, LabelVertical, BorderWidth FROM dbo.Tmp_ScreenGrp SET IDENTITY_INSERT dbo.ScreenGrp OFF IF (SELECT COUNT(1) FROM dbo.ScreenGrp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenGrp) = 0 DROP TABLE dbo.Tmp_ScreenGrp')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=103&typ=N&sys=3","","",""); return false;
104~@~   2.  24.70219:D:   60:*:*:S: Change table DbColumn~@~53~@~60~@~D~@~~@~~@~S~@~~@~Change table DbColumn~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.syscolumns WHERE id = object_id('dbo.DbColumn') and name = 'ColObjective' and length = 400)
BEGIN
EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''FK_ScreenObj_DbColumn'')) ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_DbColumn')
EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''FK_DbColumn_DbTable'')) ALTER TABLE dbo.DbColumn DROP CONSTRAINT FK_DbColumn_DbTable')
EXEC (' CREATE TABLE dbo.Tmp_DbColumn (AllowNulls char(1) NOT NULL, ColObjective text NULL, ColumnDesc varchar(100) NULL, ColumnId numeric (10,0) NOT NULL, ColumnIdentity char(1) NOT NULL, ColumnIndex numeric (5,0) NULL, ColumnLength numeric (5,0) NOT NULL, ColumnName varchar(20) NOT NULL, ColumnScale numeric (3,0) NULL, DataType numeric (3,0) NOT NULL, DefaultValue nvarchar(50) NULL, ExternalTable varchar(50) NULL, PrevColName varchar(20) NULL, PrimaryKey char(1) NOT NULL, TableId numeric (10,0) NOT NULL) INSERT INTO dbo.Tmp_DbColumn (AllowNulls, ColObjective, ColumnDesc, ColumnId, ColumnIdentity, ColumnIndex, ColumnLength, ColumnName, ColumnScale, DataType, DefaultValue, ExternalTable, PrevColName, PrimaryKey, TableId) SELECT AllowNulls, ColObjective, ColumnDesc, ColumnId, ColumnIdentity, ColumnIndex, ColumnLength, ColumnName, ColumnScale, DataType, DefaultValue, ExternalTable, PrevColName, PrimaryKey, TableId FROM dbo.DbColumn IF (SELECT COUNT(1) FROM dbo.Tmp_DbColumn) > 0 OR (SELECT COUNT(1) FROM dbo.DbColumn) = 0 DROP TABLE dbo.DbColumn')
EXEC (' CREATE TABLE dbo.DbColumn (ColumnId numeric (10,0) IDENTITY NOT NULL, TableId numeric (10,0) NOT NULL, ExternalTable VarChar(50) NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(100) NULL, DataType numeric (3,0) NOT NULL, ColumnLength numeric (5,0) NOT NULL, ColumnScale numeric (3,0) NULL, AllowNulls Char(1) NOT NULL, ColumnIdentity Char(1) NOT NULL, PrimaryKey Char(1) NOT NULL, ColObjective NVarChar(200) NULL, PrevColName VarChar(20) NULL, ColumnIndex numeric (5,0) NULL, DefaultValue NVarChar(50) NULL, CONSTRAINT PK_DbColumn PRIMARY KEY CLUSTERED (ColumnId))')
EXEC (' SET IDENTITY_INSERT dbo.DbColumn ON INSERT INTO dbo.DbColumn (ColumnId, TableId, ExternalTable, ColumnName, ColumnDesc, DataType, ColumnLength, ColumnScale, AllowNulls, ColumnIdentity, PrimaryKey, ColObjective, PrevColName, ColumnIndex, DefaultValue) SELECT ColumnId, TableId, ExternalTable, ColumnName, ColumnDesc, DataType, ColumnLength, ColumnScale, AllowNulls, ColumnIdentity, PrimaryKey, convert(nvarchar(200),ColObjective), PrevColName, ColumnIndex, DefaultValue FROM dbo.Tmp_DbColumn SET IDENTITY_INSERT dbo.DbColumn OFF IF (SELECT COUNT(1) FROM dbo.DbColumn) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_DbColumn) = 0 DROP TABLE dbo.Tmp_DbColumn')
EXEC (' CREATE UNIQUE NONCLUSTERED INDEX IX_DbColumn ON dbo.DbColumn (TableId,ColumnName)')
EXEC (' ALTER TABLE dbo.DbColumn  ADD CONSTRAINT FK_DbColumn_DbTable FOREIGN KEY (TableId) REFERENCES dbo.DbTable (TableId)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=104&typ=N&sys=3","","",""); return false;
105~@~   2.  24.70219:D:   50:*:*:S: Change table AppItem~@~53~@~50~@~D~@~~@~~@~S~@~~@~Change table AppItem~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.syscolumns WHERE id = object_id('dbo.AppItem') and name = 'ItemOrder')
BEGIN
EXEC (' CREATE TABLE dbo.Tmp_AppItem (AppInfoId numeric (10,0) NOT NULL, AppItemCode text NULL, AppItemDesc varchar(200) NULL, AppItemId numeric (10,0) NOT NULL, AppItemLink varchar(200) NULL, AppItemName varchar(50) NOT NULL, Attachmt varchar(100) NULL, CustomId numeric (10,0) NULL, DbProviderCd char(1) NULL, FrameworkCd char(1) NULL, ItemOrder numeric (5,0) NULL, LanguageCd char(1) NULL, MultiDesignDb char(1) NOT NULL, ObjectTypeCd char(1) NOT NULL, RelativePath varchar(100) NULL, RemoveItem char(1) NOT NULL, ReportId numeric (10,0) NULL, ScreenId numeric (10,0) NULL, WizardId numeric (10,0) NULL) INSERT INTO dbo.Tmp_AppItem (AppInfoId, AppItemCode, AppItemDesc, AppItemId, AppItemLink, AppItemName, Attachmt, CustomId, DbProviderCd, FrameworkCd, ItemOrder, LanguageCd, MultiDesignDb, ObjectTypeCd, RelativePath, RemoveItem, ReportId, ScreenId, WizardId) SELECT AppInfoId, AppItemCode, AppItemDesc, AppItemId, AppItemLink, AppItemName, Attachmt, CustomId, DbProviderCd, FrameworkCd, ExecOrder, LanguageCd, MultiDesignDb, ObjectTypeCd, RelativePath, RemoveItem, ReportId, ScreenId, WizardId FROM dbo.AppItem IF (SELECT COUNT(1) FROM dbo.Tmp_AppItem) > 0 OR (SELECT COUNT(1) FROM dbo.AppItem) = 0 DROP TABLE dbo.AppItem')
EXEC (' CREATE TABLE dbo.AppItem (AppItemId numeric (10,0) IDENTITY NOT NULL, AppItemDesc VarChar(200) NULL, AppInfoId numeric (10,0) NOT NULL, ItemOrder numeric (5,0) NULL, ObjectTypeCd Char(1) NOT NULL, LanguageCd Char(1) NULL, FrameworkCd Char(1) NULL, DbProviderCd Char(1) NULL, RelativePath VarChar(100) NULL, AppItemName VarChar(50) NOT NULL, MultiDesignDb Char(1) NOT NULL, AppItemCode text NULL, Attachmt VarChar(100) NULL, RemoveItem Char(1) NOT NULL, ScreenId numeric (10,0) NULL, ReportId numeric (10,0) NULL, WizardId numeric (10,0) NULL, CustomId numeric (10,0) NULL, AppItemLink VarChar(200) NULL, CONSTRAINT PK_AppItem PRIMARY KEY CLUSTERED (AppItemId))')
EXEC (' SET IDENTITY_INSERT dbo.AppItem ON INSERT INTO dbo.AppItem (AppItemId, AppItemDesc, AppInfoId, ItemOrder, ObjectTypeCd, LanguageCd, FrameworkCd, DbProviderCd, RelativePath, AppItemName, MultiDesignDb, AppItemCode, Attachmt, RemoveItem, ScreenId, ReportId, WizardId, CustomId, AppItemLink) SELECT AppItemId, AppItemDesc, AppInfoId, ItemOrder, ObjectTypeCd, LanguageCd, FrameworkCd, DbProviderCd, RelativePath, AppItemName, MultiDesignDb, AppItemCode, Attachmt, RemoveItem, ScreenId, ReportId, WizardId, CustomId, AppItemLink FROM dbo.Tmp_AppItem SET IDENTITY_INSERT dbo.AppItem OFF IF (SELECT COUNT(1) FROM dbo.AppItem) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AppItem) = 0 DROP TABLE dbo.Tmp_AppItem')
EXEC (' CREATE NONCLUSTERED INDEX IX_AppItem ON dbo.AppItem (AppInfoId,AppItemDesc)')
EXEC (' CREATE NONCLUSTERED INDEX IX_AppItem_Atmt ON dbo.AppItem (Attachmt)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=105&typ=N&sys=3","","",""); return false;
106~@~   2.  24.70219:D:   40:*:*:S: Change table WizardRule~@~53~@~40~@~D~@~~@~~@~S~@~~@~Change table WizardRule~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.syscolumns WHERE id = object_id('dbo.WizardRule') and name = 'RuleOrder')
BEGIN
EXEC (' CREATE TABLE dbo.Tmp_WizardRule (BeforeCRUD char(1) NOT NULL, ExecOrder numeric (5,0) NOT NULL, ProcedureName varchar(50) NOT NULL, RuleDesc nvarchar(150) NULL, RuleDescription nvarchar(500) NULL, RuleName nvarchar(100) NOT NULL, RuleTypeId numeric (3,0) NOT NULL, WizardId numeric (10,0) NOT NULL, WizardRuleId numeric (10,0) NOT NULL) INSERT INTO dbo.Tmp_WizardRule (BeforeCRUD, ExecOrder, ProcedureName, RuleDesc, RuleDescription, RuleName, RuleTypeId, WizardId, WizardRuleId) SELECT BeforeCRUD, ExecOrder, ProcedureName, RuleDesc, RuleDescription, RuleName, RuleTypeId, WizardId, WizardRuleId FROM dbo.WizardRule IF (SELECT COUNT(1) FROM dbo.Tmp_WizardRule) > 0 OR (SELECT COUNT(1) FROM dbo.WizardRule) = 0 DROP TABLE dbo.WizardRule')
EXEC (' CREATE TABLE dbo.WizardRule (WizardRuleId numeric (10,0) IDENTITY NOT NULL, WizardId numeric (10,0) NOT NULL, RuleTypeId numeric (3,0) NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, RuleOrder numeric (5,0) NOT NULL, ProcedureName VarChar(50) NOT NULL, BeforeCRUD Char(1) NOT NULL, CONSTRAINT PK_WizardRule PRIMARY KEY CLUSTERED (WizardRuleId))')
EXEC (' SET IDENTITY_INSERT dbo.WizardRule ON INSERT INTO dbo.WizardRule (WizardRuleId, WizardId, RuleTypeId, RuleName, RuleDesc, RuleDescription, RuleOrder, ProcedureName, BeforeCRUD) SELECT WizardRuleId, WizardId, RuleTypeId, RuleName, RuleDesc, RuleDescription, ExecOrder, ProcedureName, BeforeCRUD FROM dbo.Tmp_WizardRule SET IDENTITY_INSERT dbo.WizardRule OFF IF (SELECT COUNT(1) FROM dbo.WizardRule) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_WizardRule) = 0 DROP TABLE dbo.Tmp_WizardRule')
EXEC (' CREATE UNIQUE NONCLUSTERED INDEX IX_WizardRule_WizardId ON dbo.WizardRule (WizardId,RuleOrder)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=106&typ=N&sys=3","","",""); return false;
107~@~   2.  24.70219:D:   30:*:*:S: Change table ServerRule~@~53~@~30~@~D~@~~@~~@~S~@~~@~Change table ServerRule~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.syscolumns WHERE id = object_id('dbo.ServerRule') and name = 'RuleOrder')
BEGIN
EXEC (' CREATE TABLE dbo.Tmp_ServerRule (BeforeCRUD char(1) NOT NULL, CallingParams varchar(200) NULL, ExecOrder numeric (5,0) NOT NULL, LastGenDt datetime NULL, MasterTable char(1) NOT NULL, ModifiedBy numeric (10,0) NULL, ModifiedOn datetime NULL, OnAdd char(1) NOT NULL, OnDel char(1) NOT NULL, OnUpd char(1) NOT NULL, ParameterNames varchar(200) NULL, ParameterTypes varchar(200) NULL, ProcedureName varchar(28) NOT NULL, RuleCode text NULL, RuleDesc nvarchar(150) NULL, RuleDescription nvarchar(500) NULL, RuleName nvarchar(100) NOT NULL, RuleTypeId numeric (3,0) NOT NULL, ScreenId numeric (10,0) NOT NULL, ServerRuleId numeric (10,0) NOT NULL) INSERT INTO dbo.Tmp_ServerRule (BeforeCRUD, CallingParams, ExecOrder, LastGenDt, MasterTable, ModifiedBy, ModifiedOn, OnAdd, OnDel, OnUpd, ParameterNames, ParameterTypes, ProcedureName, RuleCode, RuleDesc, RuleDescription, RuleName, RuleTypeId, ScreenId, ServerRuleId) SELECT BeforeCRUD, CallingParams, ExecOrder, LastGenDt, MasterTable, ModifiedBy, ModifiedOn, OnAdd, OnDel, OnUpd, ParameterNames, ParameterTypes, ProcedureName, RuleCode, RuleDesc, RuleDescription, RuleName, RuleTypeId, ScreenId, ServerRuleId FROM dbo.ServerRule IF (SELECT COUNT(1) FROM dbo.Tmp_ServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.ServerRule) = 0 DROP TABLE dbo.ServerRule')EXEC (' CREATE TABLE dbo.ServerRule (ServerRuleId numeric (10,0) IDENTITY NOT NULL, ScreenId numeric (10,0) NOT NULL, RuleTypeId numeric (3,0) NOT NULL, MasterTable Char(1) NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, RuleOrder numeric (5,0) NOT NULL, ProcedureName VarChar(28) NOT NULL, ParameterNames VarChar(200) NULL, ParameterTypes VarChar(200) NULL, CallingParams VarChar(200) NULL, OnAdd Char(1) NOT NULL, OnUpd Char(1) NOT NULL, OnDel Char(1) NOT NULL, BeforeCRUD Char(1) NOT NULL, RuleCode text NULL, ModifiedBy numeric (10,0) NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, CONSTRAINT PK_ServerRule PRIMARY KEY CLUSTERED (ServerRuleId))')EXEC (' SET IDENTITY_INSERT dbo.ServerRule ON INSERT INTO dbo.ServerRule (ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, RuleOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn, LastGenDt) SELECT ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, ExecOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn, LastGenDt FROM dbo.Tmp_ServerRule SET IDENTITY_INSERT dbo.ServerRule OFF IF (SELECT COUNT(1) FROM dbo.ServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ServerRule) = 0 DROP TABLE dbo.Tmp_ServerRule')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=107&typ=N&sys=3","","",""); return false;
108~@~   2.  24.70219:D:   20:*:*:S: Change table Report~@~53~@~20~@~D~@~~@~~@~S~@~~@~Change table Report~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.syscolumns WHERE id = object_id('dbo.Report') and name = 'RegClause')
BEGIN
EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''FK_ReportCri_Report'')) ALTER TABLE dbo.ReportCri DROP CONSTRAINT FK_ReportCri_Report')
EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''FK_ReportObj_Report'')) ALTER TABLE dbo.ReportObj DROP CONSTRAINT FK_ReportObj_Report')
EXEC (' CREATE TABLE dbo.Tmp_Report (CopyReportId numeric (10,0) NULL, GenerateRp char(1) NOT NULL, GlobalCriteria char(1) NOT NULL, PrintPortrait char(1) NOT NULL, ProgramName varchar(20) NOT NULL, RegExeClause varchar(400) NULL, ReportDesc nvarchar(50) NULL, ReportId numeric (10,0) NOT NULL, TemplateName varchar(50) NULL, ToXlsOnly char(1) NOT NULL, UpdExeClause varchar(200) NULL, WhereClause varchar(1000) NULL, XlsExeClause varchar(200) NULL) INSERT INTO dbo.Tmp_Report (CopyReportId, GenerateRp, GlobalCriteria, PrintPortrait, ProgramName, RegExeClause, ReportDesc, ReportId, TemplateName, ToXlsOnly, UpdExeClause, WhereClause, XlsExeClause) SELECT CopyReportId, GenerateRp, GlobalCriteria, PrintPortrait, ProgramName, RegExeClause, ReportDesc, ReportId, TemplateName, ToXlsOnly, UpdExeClause, WhereClause, XlsExeClause FROM dbo.Report IF (SELECT COUNT(1) FROM dbo.Tmp_Report) > 0 OR (SELECT COUNT(1) FROM dbo.Report) = 0 DROP TABLE dbo.Report')
EXEC (' CREATE TABLE dbo.Report (ReportId numeric (10,0) IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ReportDesc NVarChar(50) NULL, GlobalCriteria Char(1) NOT NULL, PrintPortrait Char(1) NOT NULL, ToXlsOnly Char(1) NOT NULL, TemplateName VarChar(50) NULL, CopyReportId numeric (10,0) NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, UpdClause VarChar(200) NULL, XlsClause VarChar(200) NULL, GenerateRp Char(1) NOT NULL, CONSTRAINT PK_Report PRIMARY KEY CLUSTERED (ReportId))')
EXEC (' SET IDENTITY_INSERT dbo.Report ON INSERT INTO dbo.Report (ReportId, ProgramName, ReportDesc, GlobalCriteria, PrintPortrait, ToXlsOnly, TemplateName, CopyReportId, WhereClause, RegClause, UpdClause, XlsClause, GenerateRp) SELECT ReportId, ProgramName, ReportDesc, GlobalCriteria, PrintPortrait, ToXlsOnly, TemplateName, CopyReportId, WhereClause, RegExeClause, UpdExeClause, XlsExeClause, GenerateRp FROM dbo.Tmp_Report SET IDENTITY_INSERT dbo.Report OFF IF (SELECT COUNT(1) FROM dbo.Report) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Report) = 0 DROP TABLE dbo.Tmp_Report')
EXEC (' CREATE UNIQUE NONCLUSTERED INDEX IX_Report_ProgramName ON dbo.Report (ProgramName)')
EXEC (' ALTER TABLE dbo.ReportObj  ADD CONSTRAINT FK_ReportObj_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId)')
EXEC (' ALTER TABLE dbo.ReportCri  ADD CONSTRAINT FK_ReportCri_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=108&typ=N&sys=3","","",""); return false;
109~@~   2.  24.70219:D:   10:*:*:S: Change table ReportCri~@~53~@~10~@~D~@~~@~~@~S~@~~@~Change table ReportCri~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.syscolumns WHERE id = object_id('dbo.ReportCri') and name = 'RegClause')
BEGIN
EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''FK_ReportCri_Report'')) ALTER TABLE dbo.ReportCri DROP CONSTRAINT FK_ReportCri_Report')
EXEC (' CREATE TABLE dbo.Tmp_ReportCri (ColumnName varchar(20) NOT NULL, ColumnSize numeric (5,0) NULL, DataTypeId numeric (3,0) NOT NULL, DataTypeSize numeric (5,0) NULL, DdlKeyColumnName varchar(50) NULL, DdlRefColumnName varchar(50) NULL, DdlSrtColumnName varchar(50) NULL, DisplayModeId numeric (3,0) NOT NULL, RegExeClause varchar(400) NULL, ReportCriDesc varchar(100) NULL, ReportCriId numeric (10,0) NOT NULL, ReportGrpId numeric (10,0) NOT NULL, ReportId numeric (10,0) NOT NULL, RequiredValid char(1) NOT NULL, RowSize numeric (5,0) NULL, TabIndex numeric (5,0) NOT NULL, TableAbbr varchar(10) NULL, TableId numeric (10,0) NULL, WhereClause varchar(1000) NULL) INSERT INTO dbo.Tmp_ReportCri (ColumnName, ColumnSize, DataTypeId, DataTypeSize, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, DisplayModeId, RegExeClause, ReportCriDesc, ReportCriId, ReportGrpId, ReportId, RequiredValid, RowSize, TabIndex, TableAbbr, TableId, WhereClause) SELECT ColumnName, ColumnSize, DataTypeId, DataTypeSize, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, DisplayModeId, RegExeClause, ReportCriDesc, ReportCriId, ReportGrpId, ReportId, RequiredValid, RowSize, TabIndex, TableAbbr, TableId, WhereClause FROM dbo.ReportCri IF (SELECT COUNT(1) FROM dbo.Tmp_ReportCri) > 0 OR (SELECT COUNT(1) FROM dbo.ReportCri) = 0 DROP TABLE dbo.ReportCri')
EXEC (' CREATE TABLE dbo.ReportCri (ReportCriId numeric (10,0) IDENTITY NOT NULL, ReportId numeric (10,0) NOT NULL, ReportCriDesc VarChar(100) NULL, ReportGrpId numeric (10,0) NOT NULL, TableId numeric (10,0) NULL, TableAbbr VarChar(10) NULL, ColumnName VarChar(20) NOT NULL, TabIndex numeric (5,0) NOT NULL, DataTypeId numeric (3,0) NOT NULL, DataTypeSize numeric (5,0) NULL, DisplayModeId numeric (3,0) NOT NULL, ColumnSize numeric (5,0) NULL, RowSize numeric (5,0) NULL, DdlKeyColumnName VarChar(50) NULL, DdlRefColumnName VarChar(50) NULL, DdlSrtColumnName VarChar(50) NULL, RequiredValid Char(1) NOT NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, CONSTRAINT PK_ReportCri PRIMARY KEY CLUSTERED (ReportCriId))')
EXEC (' SET IDENTITY_INSERT dbo.ReportCri ON INSERT INTO dbo.ReportCri (ReportCriId, ReportId, ReportCriDesc, ReportGrpId, TableId, TableAbbr, ColumnName, TabIndex, DataTypeId, DataTypeSize, DisplayModeId, ColumnSize, RowSize, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, RequiredValid, WhereClause, RegClause) SELECT ReportCriId, ReportId, ReportCriDesc, ReportGrpId, TableId, TableAbbr, ColumnName, TabIndex, DataTypeId, DataTypeSize, DisplayModeId, ColumnSize, RowSize, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, RequiredValid, WhereClause, RegExeClause FROM dbo.Tmp_ReportCri SET IDENTITY_INSERT dbo.ReportCri OFF IF (SELECT COUNT(1) FROM dbo.ReportCri) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ReportCri) = 0 DROP TABLE dbo.Tmp_ReportCri')
EXEC (' CREATE UNIQUE NONCLUSTERED INDEX IX_ReportCri_ReportId ON dbo.ReportCri (ReportId,TabIndex,ColumnName)')
EXEC (' ALTER TABLE dbo.ReportCri  ADD CONSTRAINT FK_ReportCri_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=109&typ=N&sys=3","","",""); return false;
112~@~   2.  25.70313:D:   10:*:*:*: Add table CtJustify~@~54~@~10~@~D~@~~@~~@~~@~~@~Add table CtJustify~@~N~@~if not exists (select 'true' from dbo.sysobjects where id = object_id('dbo.CtJustify'))
BEGIN
EXEC (' CREATE TABLE dbo.CtJustify (JustifyCd Char(1) NOT NULL, JustifyName NVarChar(10) NOT NULL, CONSTRAINT PK_CtJustify PRIMARY KEY CLUSTERED (JustifyCd))')
EXEC ('INSERT dbo.CtJustify(JustifyCd,JustifyName) SELECT ''L'',''Left''')
EXEC ('INSERT dbo.CtJustify(JustifyCd,JustifyName) SELECT ''R'',''Right''')
EXEC ('INSERT dbo.CtJustify(JustifyCd,JustifyName) SELECT ''C'',''Center''')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=112&typ=N&sys=3","","",""); return false;
113~@~   2.  25.70313:D:   30:*:*:*: Update table ScreenObj~@~54~@~30~@~D~@~~@~~@~~@~~@~Update table ScreenObj~@~Y~@~UPDATE dbo.ScreenObj SET ColumnJustify = case
	when d.TypeName = 'CheckBox' then 'C'
	when d.TypeName in ('DropDownList','ListBox','ComboBox') then 'L'
	when c.NumericData = 'Y' then 'R' else 'L' end
FROM dbo.ScreenObj a
INNER JOIN [[?]]Design.dbo.CtDisplayType d ON a.DisplayModeId = d.TypeId
LEFT JOIN dbo.DbColumn b ON a.ColumnId = b.ColumnId
LEFT JOIN [[?]]Design.dbo.CtDataType c ON b.DataType = c.DataTypeId~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=113&typ=N&sys=3","","",""); return false;
121~@~   2.  25.70313:D:   20:*:*:M: Change table ScreenObj~@~54~@~20~@~D~@~~@~~@~M~@~~@~Change table ScreenObj~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_Screen'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_ScreenTab'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_ScreenTab CREATE TABLE dbo.Tmp_ScreenObj (AggregateCd char(1) NULL, ColumnDesc varchar(100) NULL, ColumnHeight smallint NULL, ColumnId int NULL, ColumnLink varchar(100) NULL, ColumnName varchar(20) NOT NULL, ColumnSize smallint NULL, ColumnWrap char(1) NOT NULL, DdlAdnColumnId int NULL, DdlFtrColumnId int NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DefaultValue nvarchar(100) NULL, DisplayModeId tinyint NOT NULL, GenerateSp char(1) NOT NULL, MaskValid varchar(50) NULL, MasterTable char(1) NOT NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, RangeValidType varchar(50) NULL, RefreshOnCUD char(1) NOT NULL, RequiredValid char(1) NOT NULL, ScreenGrpId int NOT NULL, ScreenId int NOT NULL, ScreenObjId int NOT NULL, SortOrder smallint NULL, SystemValue nvarchar(100) NULL, TabFolderId int NULL, TabIndex smallint NOT NULL)')
EXEC('INSERT INTO dbo.Tmp_ScreenObj (AggregateCd, ColumnDesc, ColumnHeight, ColumnId, ColumnLink, ColumnName, ColumnSize, ColumnWrap, DdlAdnColumnId, DdlFtrColumnId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DefaultValue, DisplayModeId, GenerateSp, MaskValid, MasterTable, RangeValidMax, RangeValidMin, RangeValidType, RefreshOnCUD, RequiredValid, ScreenGrpId, ScreenId, ScreenObjId, SortOrder, SystemValue, TabFolderId, TabIndex) SELECT AggregateCd, ColumnDesc, ColumnHeight, ColumnId, ColumnLink, ColumnName, ColumnSize, ColumnWrap, DdlAdnColumnId, DdlFtrColumnId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DefaultValue, DisplayModeId, GenerateSp, MaskValid, MasterTable, RangeValidMax, RangeValidMin, RangeValidType, RefreshOnCUD, RequiredValid, ScreenGrpId, ScreenId, ScreenObjId, SortOrder, SystemValue, TabFolderId, TabIndex FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj')EXEC (' CREATE TABLE dbo.ScreenObj (ScreenObjId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, ScreenGrpId Int NOT NULL, ColumnId Int NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(100) NULL, DefaultValue NVarChar(100) NULL, SystemValue NVarChar(100) NULL, ColumnWrap Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, ColumnHeight SmallInt NULL, DisplayModeId TinyInt NOT NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlAdnColumnId Int NULL, DdlFtrColumnId Int NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId Int NULL, TabIndex SmallInt NOT NULL, SortOrder SmallInt NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(50) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(100) NULL, RefreshOnCUD Char(1) NOT NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))')EXEC (' SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD) SELECT ScreenObjId, ScreenId, MasterTable, ScreenGrpId, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj CREATE NONCLUSTERED INDEX IX_ScreenObj_ScreenId ON dbo.ScreenObj (ScreenId,TabIndex) ALTER TABLE dbo.ScreenObj WITH NOCHECK ADD CONSTRAINT FK_ScreenObj_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenObj WITH NOCHECK ADD CONSTRAINT FK_ScreenObj_ScreenTab FOREIGN KEY (TabFolderId) REFERENCES dbo.ScreenTab (ScreenTabId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=121&typ=N&sys=3","","",""); return false;
124~@~   2.  25.70313:D:   40:*:*:M: Change table Screen~@~54~@~40~@~D~@~~@~~@~M~@~~@~Change table Screen~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_AuthoRow_Screen'') ALTER TABLE dbo.AuthRow DROP CONSTRAINT FK_AuthRow_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenCri_Screen'') ALTER TABLE dbo.ScreenCri DROP CONSTRAINT FK_ScreenCri_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenHlp_Screen'') ALTER TABLE dbo.ScreenHlp DROP CONSTRAINT FK_ScreenHlp_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_Screen'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_Screen CREATE TABLE dbo.Tmp_Screen (DetailTableId int NULL, GenerateSc char(1) NOT NULL, GridRows tinyint NULL, HasDeleteAll char(1) NOT NULL, MasterTableId int NULL, ProgramName varchar(20) NOT NULL, ScreenDesc nvarchar(50) NULL, ScreenFilter varchar(100) NULL, ScreenId int NOT NULL, ScreenObj varchar(100) NULL, ScreenTypeId tinyint NOT NULL, SearchAscending char(1) NOT NULL, SearchId int NULL, ValidateReq char(1) NOT NULL)')
EXEC('INSERT INTO dbo.Tmp_Screen (DetailTableId, GenerateSc, GridRows, HasDeleteAll, MasterTableId, ProgramName, ScreenDesc, ScreenFilter, ScreenId, ScreenObj, ScreenTypeId, SearchAscending, SearchId, ValidateReq) SELECT DetailTableId, GenerateSc, GridRows, HasDeleteAll, MasterTableId, ProgramName, ScreenDesc, ScreenFilter, ScreenId, ScreenObj, ScreenTypeId, SearchAscending, SearchId, ValidateReq FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen')
EXEC (' CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchId Int NULL, SearchAscending Char(1) NOT NULL, GridRows TinyInt NULL, GridClass VarChar(30) NULL, GridTitle NVarChar(50) NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))')EXEC (' SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen CREATE UNIQUE NONCLUSTERED INDEX IX_Screen_ProgramName ON dbo.Screen (ProgramName) ALTER TABLE dbo.AuthRow WITH NOCHECK ADD CONSTRAINT FK_AuthRow_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenCri WITH NOCHECK ADD CONSTRAINT FK_ScreenCri_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenHlp WITH NOCHECK ADD CONSTRAINT FK_ScreenHlp_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenObj WITH NOCHECK ADD CONSTRAINT FK_ScreenObj_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=124&typ=N&sys=3","","",""); return false;
126~@~   2.  25.70313:D:   50:*:*:M: Change table ScreenCri~@~54~@~50~@~D~@~~@~~@~M~@~~@~Change table ScreenCri~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenCri_Screen'') ALTER TABLE dbo.ScreenCri DROP CONSTRAINT FK_ScreenCri_Screen CREATE TABLE dbo.Tmp_ScreenCri (ColumnId int NOT NULL, ColumnSize smallint NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DisplayModeId tinyint NOT NULL, RequiredValid char(1) NOT NULL, RowSize smallint NULL, ScreenCriDesc varchar(100) NULL, ScreenCriId int NOT NULL, ScreenGrpId int NOT NULL, ScreenId int NOT NULL, TabIndex smallint NOT NULL)')
EXEC('INSERT INTO dbo.Tmp_ScreenCri (ColumnId, ColumnSize, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DisplayModeId, RequiredValid, RowSize, ScreenCriDesc, ScreenCriId, ScreenGrpId, ScreenId, TabIndex) SELECT ColumnId, ColumnSize, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DisplayModeId, RequiredValid, RowSize, ScreenCriDesc, ScreenCriId, ScreenGrpId, ScreenId, TabIndex FROM dbo.ScreenCri IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenCri) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenCri) = 0 DROP TABLE dbo.ScreenCri')EXEC (' CREATE TABLE dbo.ScreenCri (ScreenCriId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, ScreenCriDesc VarChar(100) NULL, ScreenGrpId Int NOT NULL, ColumnId Int NOT NULL, TabIndex SmallInt NOT NULL, DisplayModeId TinyInt NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, RowSize SmallInt NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, RequiredValid Char(1) NOT NULL, CONSTRAINT PK_ScreenCri PRIMARY KEY CLUSTERED (ScreenCriId))')EXEC (' SET IDENTITY_INSERT dbo.ScreenCri ON INSERT INTO dbo.ScreenCri (ScreenCriId, ScreenId, ScreenCriDesc, ScreenGrpId, ColumnId, TabIndex, DisplayModeId, ColumnSize, RowSize, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, RequiredValid) SELECT ScreenCriId, ScreenId, ScreenCriDesc, ScreenGrpId, ColumnId, TabIndex, DisplayModeId, ColumnSize, RowSize, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, RequiredValid FROM dbo.Tmp_ScreenCri SET IDENTITY_INSERT dbo.ScreenCri OFF IF (SELECT COUNT(1) FROM dbo.ScreenCri) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenCri) = 0 DROP TABLE dbo.Tmp_ScreenCri CREATE UNIQUE NONCLUSTERED INDEX IX_ScreenCri_ScreenId ON dbo.ScreenCri (ScreenId,TabIndex,ColumnId) ALTER TABLE dbo.ScreenCri WITH NOCHECK ADD CONSTRAINT FK_ScreenCri_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=126&typ=N&sys=3","","",""); return false;
127~@~   2.  25.70313:D:   60:*:*:*: Update table ScreenCri~@~54~@~60~@~D~@~~@~~@~~@~~@~Update table ScreenCri~@~Y~@~UPDATE dbo.ScreenCri SET ColumnJustify = case
	when d.TypeName = 'CheckBox' then 'C'
	when d.TypeName in ('DropDownList','ListBox','ComboBox') then 'L'
	when c.NumericData = 'Y' then 'R' else 'L' end
FROM dbo.ScreenCri a
INNER JOIN [[?]]Design.dbo.CtDisplayType d ON a.DisplayModeId = d.TypeId
LEFT JOIN dbo.DbColumn b ON a.ColumnId = b.ColumnId
LEFT JOIN [[?]]Design.dbo.CtDataType c ON b.DataType = c.DataTypeId~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=127&typ=N&sys=3","","",""); return false;
129~@~   2.  25.70313:D:   20:*:*:S: Change table ScreenObj~@~54~@~20~@~D~@~~@~~@~S~@~~@~Change table ScreenObj~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_Screen'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_ScreenTab'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_ScreenTab CREATE TABLE dbo.Tmp_ScreenObj (AggregateCd char(1) NULL, ColumnDesc varchar(100) NULL, ColumnHeight numeric (5,0) NULL, ColumnId numeric (10,0) NULL, ColumnLink varchar(100) NULL, ColumnName varchar(20) NOT NULL, ColumnSize numeric (5,0) NULL, ColumnWrap char(1) NOT NULL, DdlAdnColumnId numeric (10,0) NULL, DdlFtrColumnId numeric (10,0) NULL, DdlKeyColumnId numeric (10,0) NULL, DdlRefColumnId numeric (10,0) NULL, DdlSrtColumnId numeric (10,0) NULL, DefaultValue nvarchar(100) NULL, DisplayModeId numeric (3,0) NOT NULL, GenerateSp char(1) NOT NULL, MaskValid varchar(50) NULL, MasterTable char(1) NOT NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, RangeValidType varchar(50) NULL, RefreshOnCUD char(1) NOT NULL, RequiredValid char(1) NOT NULL, ScreenGrpId numeric (10,0) NOT NULL, ScreenId numeric (10,0) NOT NULL, ScreenObjId numeric (10,0) NOT NULL, SortOrder numeric (5,0) NULL, SystemValue nvarchar(100) NULL, TabFolderId numeric (10,0) NULL, TabIndex numeric (5,0) NOT NULL)')
EXEC('INSERT INTO dbo.Tmp_ScreenObj (AggregateCd, ColumnDesc, ColumnHeight, ColumnId, ColumnLink, ColumnName, ColumnSize, ColumnWrap, DdlAdnColumnId, DdlFtrColumnId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DefaultValue, DisplayModeId, GenerateSp, MaskValid, MasterTable, RangeValidMax, RangeValidMin, RangeValidType, RefreshOnCUD, RequiredValid, ScreenGrpId, ScreenId, ScreenObjId, SortOrder, SystemValue, TabFolderId, TabIndex) SELECT AggregateCd, ColumnDesc, ColumnHeight, ColumnId, ColumnLink, ColumnName, ColumnSize, ColumnWrap, DdlAdnColumnId, DdlFtrColumnId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DefaultValue, DisplayModeId, GenerateSp, MaskValid, MasterTable, RangeValidMax, RangeValidMin, RangeValidType, RefreshOnCUD, RequiredValid, ScreenGrpId, ScreenId, ScreenObjId, SortOrder, SystemValue, TabFolderId, TabIndex FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj')EXEC (' CREATE TABLE dbo.ScreenObj (ScreenObjId numeric (10,0) IDENTITY NOT NULL, ScreenId numeric (10,0) NOT NULL, MasterTable Char(1) NOT NULL, ScreenGrpId numeric (10,0) NOT NULL, ColumnId numeric (10,0) NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(100) NULL, DefaultValue NVarChar(100) NULL, SystemValue NVarChar(100) NULL, ColumnWrap Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize numeric (5,0) NULL, ColumnHeight numeric (5,0) NULL, DisplayModeId numeric (3,0) NOT NULL, DdlKeyColumnId numeric (10,0) NULL, DdlRefColumnId numeric (10,0) NULL, DdlSrtColumnId numeric (10,0) NULL, DdlAdnColumnId numeric (10,0) NULL, DdlFtrColumnId numeric (10,0) NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId numeric (10,0) NULL, TabIndex numeric (5,0) NOT NULL, SortOrder numeric (5,0) NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(50) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(100) NULL, RefreshOnCUD Char(1) NOT NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))')EXEC (' SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD) SELECT ScreenObjId, ScreenId, MasterTable, ScreenGrpId, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj CREATE NONCLUSTERED INDEX IX_ScreenObj_ScreenId ON dbo.ScreenObj (ScreenId,TabIndex) ALTER TABLE dbo.ScreenObj  ADD CONSTRAINT FK_ScreenObj_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenObj  ADD CONSTRAINT FK_ScreenObj_ScreenTab FOREIGN KEY (TabFolderId) REFERENCES dbo.ScreenTab (ScreenTabId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=129&typ=N&sys=3","","",""); return false;
130~@~   2.  25.70313:D:   40:*:*:S: Change table Screen~@~54~@~40~@~D~@~~@~~@~S~@~~@~Change table Screen~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_AuthRow_Screen'') ALTER TABLE dbo.AuthRow DROP CONSTRAINT FK_AuthRow_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenCri_Screen'') ALTER TABLE dbo.ScreenCri DROP CONSTRAINT FK_ScreenCri_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenHlp_Screen'') ALTER TABLE dbo.ScreenHlp DROP CONSTRAINT FK_ScreenHlp_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_Screen'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_Screen CREATE TABLE dbo.Tmp_Screen (DetailTableId numeric (10,0) NULL, GenerateSc char(1) NOT NULL, GridRows numeric (3,0) NULL, HasDeleteAll char(1) NOT NULL, MasterTableId numeric (10,0) NULL, ProgramName varchar(20) NOT NULL, ScreenDesc nvarchar(50) NULL, ScreenFilter varchar(100) NULL, ScreenId numeric (10,0) NOT NULL, ScreenObj varchar(100) NULL, ScreenTypeId numeric (3,0) NOT NULL, SearchAscending char(1) NOT NULL, SearchId numeric (10,0) NULL, ValidateReq char(1) NOT NULL)')
EXEC('INSERT INTO dbo.Tmp_Screen (DetailTableId, GenerateSc, GridRows, HasDeleteAll, MasterTableId, ProgramName, ScreenDesc, ScreenFilter, ScreenId, ScreenObj, ScreenTypeId, SearchAscending, SearchId, ValidateReq) SELECT DetailTableId, GenerateSc, GridRows, HasDeleteAll, MasterTableId, ProgramName, ScreenDesc, ScreenFilter, ScreenId, ScreenObj, ScreenTypeId, SearchAscending, SearchId, ValidateReq FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen')EXEC (' CREATE TABLE dbo.Screen (ScreenId numeric (10,0) IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId numeric (3,0) NOT NULL, MasterTableId numeric (10,0) NULL, DetailTableId numeric (10,0) NULL, SearchId numeric (10,0) NULL, SearchAscending Char(1) NOT NULL, GridRows numeric (3,0) NULL, GridClass VarChar(30) NULL, GridTitle NVarChar(50) NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))')EXEC (' SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen CREATE UNIQUE NONCLUSTERED INDEX IX_Screen_ProgramName ON dbo.Screen (ProgramName) ALTER TABLE dbo.AuthRow  ADD CONSTRAINT FK_AuthRow_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenCri  ADD CONSTRAINT FK_ScreenCri_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenHlp  ADD CONSTRAINT FK_ScreenHlp_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenObj  ADD CONSTRAINT FK_ScreenObj_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=130&typ=N&sys=3","","",""); return false;
131~@~   2.  25.70313:D:   50:*:*:S: Change table ScreenCri~@~54~@~50~@~D~@~~@~~@~S~@~~@~Change table ScreenCri~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenCri_Screen'') ALTER TABLE dbo.ScreenCri DROP CONSTRAINT FK_ScreenCri_Screen CREATE TABLE dbo.Tmp_ScreenCri (ColumnId numeric (10,0) NOT NULL, ColumnSize numeric (5,0) NULL, DdlKeyColumnId numeric (10,0) NULL, DdlRefColumnId numeric (10,0) NULL, DdlSrtColumnId numeric (10,0) NULL, DisplayModeId numeric (3,0) NOT NULL, RequiredValid char(1) NOT NULL, RowSize numeric (5,0) NULL, ScreenCriDesc varchar(100) NULL, ScreenCriId numeric (10,0) NOT NULL, ScreenGrpId numeric (10,0) NOT NULL, ScreenId numeric (10,0) NOT NULL, TabIndex numeric (5,0) NOT NULL)')
EXEC('INSERT INTO dbo.Tmp_ScreenCri (ColumnId, ColumnSize, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DisplayModeId, RequiredValid, RowSize, ScreenCriDesc, ScreenCriId, ScreenGrpId, ScreenId, TabIndex) SELECT ColumnId, ColumnSize, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DisplayModeId, RequiredValid, RowSize, ScreenCriDesc, ScreenCriId, ScreenGrpId, ScreenId, TabIndex FROM dbo.ScreenCri IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenCri) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenCri) = 0 DROP TABLE dbo.ScreenCri')EXEC (' CREATE TABLE dbo.ScreenCri (ScreenCriId numeric (10,0) IDENTITY NOT NULL, ScreenId numeric (10,0) NOT NULL, ScreenCriDesc VarChar(100) NULL, ScreenGrpId numeric (10,0) NOT NULL, ColumnId numeric (10,0) NOT NULL, TabIndex numeric (5,0) NOT NULL, DisplayModeId numeric (3,0) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize numeric (5,0) NULL, RowSize numeric (5,0) NULL, DdlKeyColumnId numeric (10,0) NULL, DdlRefColumnId numeric (10,0) NULL, DdlSrtColumnId numeric (10,0) NULL, RequiredValid Char(1) NOT NULL, CONSTRAINT PK_ScreenCri PRIMARY KEY CLUSTERED (ScreenCriId))')EXEC (' SET IDENTITY_INSERT dbo.ScreenCri ON INSERT INTO dbo.ScreenCri (ScreenCriId, ScreenId, ScreenCriDesc, ScreenGrpId, ColumnId, TabIndex, DisplayModeId, ColumnSize, RowSize, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, RequiredValid) SELECT ScreenCriId, ScreenId, ScreenCriDesc, ScreenGrpId, ColumnId, TabIndex, DisplayModeId, ColumnSize, RowSize, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, RequiredValid FROM dbo.Tmp_ScreenCri SET IDENTITY_INSERT dbo.ScreenCri OFF IF (SELECT COUNT(1) FROM dbo.ScreenCri) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenCri) = 0 DROP TABLE dbo.Tmp_ScreenCri CREATE UNIQUE NONCLUSTERED INDEX IX_ScreenCri_ScreenId ON dbo.ScreenCri (ScreenId,TabIndex,ColumnId) ALTER TABLE dbo.ScreenCri  ADD CONSTRAINT FK_ScreenCri_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=131&typ=N&sys=3","","",""); return false;
134~@~   2.  25.70326:D:   10:*:*:*: Update table CtEvent~@~55~@~10~@~D~@~~@~~@~~@~~@~Update table CtEvent~@~N~@~IF NOT EXISTS (SELECT 1 FROM CtEvent WHERE EventId = 12)
BEGIN
	UPDATE CtEvent SET EventDesc = 'GridItemDataBound (before)' WHERE EventId = 8
	INSERT CtEvent (EventId, EventCode, EventDesc) VALUES (12, 'ITMDTA', 'GridItemDataBound (after)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=134&typ=N&sys=3","","",""); return false;
138~@~   2.  28.70517:D:   10:*:*:M: Change table DbTable~@~58~@~10~@~D~@~~@~~@~M~@~~@~Change table DbTable~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_DbKey_DbTable'') ALTER TABLE dbo.DbKey DROP CONSTRAINT FK_DbKey_DbTable')
 EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_DbColumn_DbTable'') ALTER TABLE dbo.DbColumn DROP CONSTRAINT FK_DbColumn_DbTable CREATE TABLE dbo.Tmp_DbTable (ModifiedOn datetime NULL, MultiDesignDb char(1) NOT NULL, PrevTblName varchar(20) NULL, SystemId tinyint NOT NULL, TableDesc nvarchar(100) NOT NULL, TableId int NOT NULL, TableName varchar(20) NOT NULL, TblObjective ntext NULL)') EXEC (' INSERT INTO dbo.Tmp_DbTable (ModifiedOn, MultiDesignDb, PrevTblName, SystemId, TableDesc, TableId, TableName, TblObjective) SELECT ModifiedOn, MultiDesignDb, PrevTblName, SystemId, TableDesc, TableId, TableName, TblObjective FROM dbo.DbTable IF (SELECT COUNT(1) FROM dbo.Tmp_DbTable) > 0 OR (SELECT COUNT(1) FROM dbo.DbTable) = 0 DROP TABLE dbo.DbTable') EXEC (' CREATE TABLE dbo.DbTable (TableId Int IDENTITY NOT NULL, SystemId TinyInt NOT NULL, TableName VarChar(20) NOT NULL, TableDesc NVarChar(100) NOT NULL, MultiDesignDb Char(1) NOT NULL, TblObjective NText NULL, PrevTblName VarChar(20) NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, CONSTRAINT PK_DbTable PRIMARY KEY CLUSTERED (TableId))') EXEC (' SET IDENTITY_INSERT dbo.DbTable ON INSERT INTO dbo.DbTable (TableId, SystemId, TableName, TableDesc, MultiDesignDb, TblObjective, PrevTblName, ModifiedOn) SELECT TableId, SystemId, TableName, TableDesc, MultiDesignDb, TblObjective, PrevTblName, ModifiedOn FROM dbo.Tmp_DbTable SET IDENTITY_INSERT dbo.DbTable OFF IF (SELECT COUNT(1) FROM dbo.DbTable) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_DbTable) = 0 DROP TABLE dbo.Tmp_DbTable CREATE  UNIQUE NONCLUSTERED INDEX IX_DbTable_TableName ON dbo.DbTable (TableName) ALTER TABLE dbo.DbColumn WITH NOCHECK ADD CONSTRAINT FK_DbColumn_DbTable FOREIGN KEY (TableId) REFERENCES dbo.DbTable (TableId)')
EXEC ('UPDATE DbTable SET ModifiedBy = 1')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=138&typ=N&sys=3","","",""); return false;
139~@~   2.  28.70517:D:   20:*:*:M: Change table DbTable~@~58~@~20~@~D~@~~@~~@~M~@~~@~Change table DbTable~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_DbColumn_DbTable'') ALTER TABLE dbo.DbColumn DROP CONSTRAINT FK_DbColumn_DbTable CREATE TABLE dbo.Tmp_DbTable (ModifiedBy int NULL, ModifiedOn datetime NULL, MultiDesignDb char(1) NOT NULL, PrevTblName varchar(20) NULL, SystemId tinyint NOT NULL, TableDesc nvarchar(100) NOT NULL, TableId int NOT NULL, TableName varchar(20) NOT NULL, TblObjective ntext NULL)') EXEC (' INSERT INTO dbo.Tmp_DbTable (ModifiedBy, ModifiedOn, MultiDesignDb, PrevTblName, SystemId, TableDesc, TableId, TableName, TblObjective) SELECT ModifiedBy, ModifiedOn, MultiDesignDb, PrevTblName, SystemId, TableDesc, TableId, TableName, TblObjective FROM dbo.DbTable IF (SELECT COUNT(1) FROM dbo.Tmp_DbTable) > 0 OR (SELECT COUNT(1) FROM dbo.DbTable) = 0 DROP TABLE dbo.DbTable') EXEC (' CREATE TABLE dbo.DbTable (TableId Int IDENTITY NOT NULL, SystemId TinyInt NOT NULL, TableName VarChar(20) NOT NULL, TableDesc NVarChar(100) NOT NULL, MultiDesignDb Char(1) NOT NULL, TblObjective NText NULL, PrevTblName VarChar(20) NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastSyncDt DateTime NULL, CONSTRAINT PK_DbTable PRIMARY KEY CLUSTERED (TableId))') EXEC (' SET IDENTITY_INSERT dbo.DbTable ON INSERT INTO dbo.DbTable (TableId, SystemId, TableName, TableDesc, MultiDesignDb, TblObjective, PrevTblName, ModifiedBy, ModifiedOn) SELECT TableId, SystemId, TableName, TableDesc, MultiDesignDb, TblObjective, PrevTblName, ModifiedBy, ModifiedOn FROM dbo.Tmp_DbTable SET IDENTITY_INSERT dbo.DbTable OFF IF (SELECT COUNT(1) FROM dbo.DbTable) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_DbTable) = 0 DROP TABLE dbo.Tmp_DbTable CREATE  UNIQUE NONCLUSTERED INDEX IX_DbTable_TableName ON dbo.DbTable (TableName) ALTER TABLE dbo.DbColumn WITH NOCHECK ADD CONSTRAINT FK_DbColumn_DbTable FOREIGN KEY (TableId) REFERENCES dbo.DbTable (TableId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=139&typ=N&sys=3","","",""); return false;
140~@~   2.  29.70525:D:   30:*:*:M: Increase font-size of calendar~@~60~@~30~@~D~@~~@~~@~M~@~~@~Increase font-size of calendar~@~N~@~DECLARE @dbDesDatabase varchar(50), @sClause varchar(4000)
DECLARE curs CURSOR FAST_FORWARD FOR SELECT dbDesDatabase FROM Systems FOR READ ONLY
OPEN curs FETCH NEXT FROM curs INTO @dbDesDatabase
WHILE @@FETCH_STATUS = 0
BEGIN
	SELECT @sClause = 'UPDATE ' + @dbDesDatabase +'.dbo.ScreenCri SET ColumnSize = 8 WHERE DisplayModeId = 20'
	+ ' UPDATE ' + @dbDesDatabase +'.dbo.ScreenCri SET ColumnSize = 8 WHERE DisplayModeId = 20'
	+ ' UPDATE ' + @dbDesDatabase +'.dbo.ReportCri SET ColumnSize = 8 WHERE DisplayModeId = 20'
	EXEC (@sClause)
	SELECT @sClause = 'UPDATE ' + @dbDesDatabase +'.dbo.ScreenObj SET ColumnSize = 8 WHERE DisplayModeId = 20'
	+ ' UPDATE ' + @dbDesDatabase +'.dbo.ScreenCri SET ColumnSize = 8 WHERE DisplayModeId = 20'
	+ ' UPDATE ' + @dbDesDatabase +'.dbo.ReportCri SET ColumnSize = 8 WHERE DisplayModeId = 20'
	EXEC (@sClause)
	SELECT @sClause = 'UPDATE ' + @dbDesDatabase +'.dbo.ReportCri SET ColumnSize = 8 WHERE DisplayModeId = 20'
	+ ' UPDATE ' + @dbDesDatabase +'.dbo.ScreenCri SET ColumnSize = 8 WHERE DisplayModeId = 20'
	+ ' UPDATE ' + @dbDesDatabase +'.dbo.ReportCri SET ColumnSize = 8 WHERE DisplayModeId = 20'
	EXEC (@sClause)
	FETCH NEXT FROM curs INTO @dbDesDatabase
END
CLOSE curs
DEALLOCATE curs~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=140&typ=N&sys=3","","",""); return false;
141~@~   2.  29.70525:D:   10:*:*:M: Change table ReportGrp~@~60~@~10~@~D~@~~@~~@~M~@~~@~Change table ReportGrp~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_ReportGrp (BorderWidth tinyint NOT NULL, ContentVertical char(1) NOT NULL, LabelVertical char(1) NOT NULL, ParentGrpId int NULL, ReportGrpId int NOT NULL, ReportGrpIndex varchar(20) NULL, ReportGrpName nvarchar(50) NOT NULL, ReportId int NULL, TabIndex smallint NULL)') EXEC (' INSERT INTO dbo.Tmp_ReportGrp (BorderWidth, ContentVertical, LabelVertical, ParentGrpId, ReportGrpId, ReportGrpIndex, ReportGrpName, ReportId, TabIndex) SELECT BorderWidth, ContentVertical, LabelVertical, ParentGrpId, ReportGrpId, ReportGrpIndex, ReportGrpName, ReportId, TabIndex FROM dbo.ReportGrp IF (SELECT COUNT(1) FROM dbo.Tmp_ReportGrp) > 0 OR (SELECT COUNT(1) FROM dbo.ReportGrp) = 0 DROP TABLE dbo.ReportGrp') EXEC (' CREATE TABLE dbo.ReportGrp (ReportGrpId Int IDENTITY NOT NULL, ReportId Int NULL, ParentGrpId Int NULL, ReportGrpName NVarChar(50) NOT NULL, ReportGrpIndex VarChar(20) NULL, TabIndex SmallInt NULL, ContentVertical Char(1) NOT NULL, LabelVertical Char(1) NOT NULL, BorderWidth TinyInt NOT NULL, GrpStyle varchar(200) NULL, CONSTRAINT PK_ReportGrp PRIMARY KEY CLUSTERED (ReportGrpId))') EXEC (' SET IDENTITY_INSERT dbo.ReportGrp ON INSERT INTO dbo.ReportGrp (ReportGrpId, ReportId, ParentGrpId, ReportGrpName, ReportGrpIndex, TabIndex, ContentVertical, LabelVertical, BorderWidth) SELECT ReportGrpId, ReportId, ParentGrpId, ReportGrpName, ReportGrpIndex, TabIndex, ContentVertical, LabelVertical, BorderWidth FROM dbo.Tmp_ReportGrp SET IDENTITY_INSERT dbo.ReportGrp OFF IF (SELECT COUNT(1) FROM dbo.ReportGrp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ReportGrp) = 0 DROP TABLE dbo.Tmp_ReportGrp')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=141&typ=N&sys=3","","",""); return false;
142~@~   2.  29.70525:D:   20:*:*:M: Change table ScreenGrp~@~60~@~20~@~D~@~~@~~@~M~@~~@~Change table ScreenGrp~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_ScreenGrp (BorderWidth tinyint NOT NULL, ContentVertical char(1) NOT NULL, LabelVertical char(1) NOT NULL, ParentGrpId int NULL, ScreenGrpId int NOT NULL, ScreenGrpIndex varchar(20) NULL, ScreenGrpName nvarchar(50) NOT NULL, ScreenGrpTypeCd char(1) NULL, ScreenId int NULL, TabIndex smallint NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenGrp (BorderWidth, ContentVertical, LabelVertical, ParentGrpId, ScreenGrpId, ScreenGrpIndex, ScreenGrpName, ScreenGrpTypeCd, ScreenId, TabIndex) SELECT BorderWidth, ContentVertical, LabelVertical, ParentGrpId, ScreenGrpId, ScreenGrpIndex, ScreenGrpName, ScreenGrpTypeCd, ScreenId, TabIndex FROM dbo.ScreenGrp IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenGrp) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenGrp) = 0 DROP TABLE dbo.ScreenGrp') EXEC (' CREATE TABLE dbo.ScreenGrp (ScreenGrpId Int IDENTITY NOT NULL, ScreenId Int NULL, ScreenGrpTypeCd Char(1) NULL, ParentGrpId Int NULL, ScreenGrpName NVarChar(50) NOT NULL, TabIndex SmallInt NULL, ScreenGrpIndex VarChar(20) NULL, ContentVertical Char(1) NOT NULL, LabelVertical Char(1) NOT NULL, BorderWidth TinyInt NOT NULL, GrpStyle varchar(200) NULL, CONSTRAINT PK_ScreenGrp PRIMARY KEY CLUSTERED (ScreenGrpId))') EXEC (' SET IDENTITY_INSERT dbo.ScreenGrp ON INSERT INTO dbo.ScreenGrp (ScreenGrpId, ScreenId, ScreenGrpTypeCd, ParentGrpId, ScreenGrpName, TabIndex, ScreenGrpIndex, ContentVertical, LabelVertical, BorderWidth) SELECT ScreenGrpId, ScreenId, ScreenGrpTypeCd, ParentGrpId, ScreenGrpName, TabIndex, ScreenGrpIndex, ContentVertical, LabelVertical, BorderWidth FROM dbo.Tmp_ScreenGrp SET IDENTITY_INSERT dbo.ScreenGrp OFF IF (SELECT COUNT(1) FROM dbo.ScreenGrp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenGrp) = 0 DROP TABLE dbo.Tmp_ScreenGrp')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=142&typ=N&sys=3","","",""); return false;
143~@~   2.  29.70525:D:   40:*:*:M: Change table ReportObj~@~60~@~40~@~D~@~~@~~@~M~@~~@~Change table ReportObj~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportObj_Report'') ALTER TABLE dbo.ReportObj DROP CONSTRAINT FK_ReportObj_Report CREATE TABLE dbo.Tmp_ReportObj (ColumnDesc varchar(100) NULL, ColumnFormat varchar(20) NULL, ColumnName varchar(20) NOT NULL, DataTypeId tinyint NOT NULL, OperatorId tinyint NULL, Padding tinyint NULL, ReportCriId int NULL, ReportId int NOT NULL, ReportObjId int NOT NULL, TabIndex smallint NOT NULL)')
EXEC ('INSERT INTO dbo.Tmp_ReportObj (ColumnDesc, ColumnFormat, ColumnName, DataTypeId, OperatorId, Padding, ReportCriId, ReportId, ReportObjId, TabIndex) SELECT ColumnDesc, ColumnFormat, ColumnName, DataTypeId, OperatorId, Padding, ReportCriId, ReportId, ReportObjId, TabIndex FROM dbo.ReportObj IF (SELECT COUNT(1) FROM dbo.Tmp_ReportObj) > 0 OR (SELECT COUNT(1) FROM dbo.ReportObj) = 0 DROP TABLE dbo.ReportObj')
EXEC ('CREATE TABLE dbo.ReportObj (ReportObjId Int IDENTITY NOT NULL, ReportId Int NOT NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(100) NULL, TabIndex SmallInt NOT NULL, ColumnFormat VarChar(20) NULL, PaddSize TinyInt NULL, PaddChar NChar(1) NULL, DataTypeId TinyInt NOT NULL, OperatorId TinyInt NULL, ReportCriId Int NULL, CONSTRAINT PK_ReportObj PRIMARY KEY CLUSTERED (ReportObjId))')
EXEC ('SET IDENTITY_INSERT dbo.ReportObj ON INSERT INTO dbo.ReportObj (ReportObjId, ReportId, ColumnName, ColumnDesc, TabIndex, ColumnFormat, PaddSize, DataTypeId, OperatorId, ReportCriId) SELECT ReportObjId, ReportId, ColumnName, ColumnDesc, TabIndex, ColumnFormat, Padding, DataTypeId, OperatorId, ReportCriId FROM dbo.Tmp_ReportObj SET IDENTITY_INSERT dbo.ReportObj OFF IF (SELECT COUNT(1) FROM dbo.ReportObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ReportObj) = 0 DROP TABLE dbo.Tmp_ReportObj ALTER TABLE dbo.ReportObj WITH NOCHECK ADD CONSTRAINT FK_ReportObj_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=143&typ=N&sys=3","","",""); return false;
144~@~   2.  29.70525:D:   40:*:*:S: Change table ReportObj~@~60~@~40~@~D~@~~@~~@~S~@~~@~Change table ReportObj~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportObj_Report'') ALTER TABLE dbo.ReportObj DROP CONSTRAINT FK_ReportObj_Report CREATE TABLE dbo.Tmp_ReportObj (ColumnDesc varchar(100) NULL, ColumnFormat varchar(20) NULL, ColumnName varchar(20) NOT NULL, DataTypeId numeric (3,0) NOT NULL, OperatorId numeric (3,0) NULL, Padding numeric (3,0) NULL, ReportCriId numeric (10,0) NULL, ReportId numeric (10,0) NOT NULL, ReportObjId numeric (10,0) NOT NULL, TabIndex numeric (5,0) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_ReportObj (ColumnDesc, ColumnFormat, ColumnName, DataTypeId, OperatorId, Padding, ReportCriId, ReportId, ReportObjId, TabIndex) SELECT ColumnDesc, ColumnFormat, ColumnName, DataTypeId, OperatorId, Padding, ReportCriId, ReportId, ReportObjId, TabIndex FROM dbo.ReportObj IF (SELECT COUNT(1) FROM dbo.Tmp_ReportObj) > 0 OR (SELECT COUNT(1) FROM dbo.ReportObj) = 0 DROP TABLE dbo.ReportObj') EXEC (' CREATE TABLE dbo.ReportObj (ReportObjId numeric (10,0) IDENTITY NOT NULL, ReportId numeric (10,0) NOT NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(100) NULL, TabIndex numeric (5,0) NOT NULL, ColumnFormat VarChar(20) NULL, PaddSize numeric (3,0) NULL, PaddChar NChar(1) NULL, DataTypeId numeric (3,0) NOT NULL, OperatorId numeric (3,0) NULL, ReportCriId numeric (10,0) NULL, CONSTRAINT PK_ReportObj PRIMARY KEY CLUSTERED (ReportObjId))') EXEC (' SET IDENTITY_INSERT dbo.ReportObj ON INSERT INTO dbo.ReportObj (ReportObjId, ReportId, ColumnName, ColumnDesc, TabIndex, ColumnFormat, PaddSize, DataTypeId, OperatorId, ReportCriId) SELECT ReportObjId, ReportId, ColumnName, ColumnDesc, TabIndex, ColumnFormat, Padding, DataTypeId, OperatorId, ReportCriId FROM dbo.Tmp_ReportObj SET IDENTITY_INSERT dbo.ReportObj OFF IF (SELECT COUNT(1) FROM dbo.ReportObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ReportObj) = 0 DROP TABLE dbo.Tmp_ReportObj ALTER TABLE dbo.ReportObj  ADD CONSTRAINT FK_ReportObj_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=144&typ=N&sys=3","","",""); return false;
145~@~   2.  29.70525:D:   20:*:*:S: Change table ScreenGrp~@~60~@~20~@~D~@~~@~~@~S~@~~@~Change table ScreenGrp~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_ScreenGrp (BorderWidth numeric (3,0) NOT NULL, ContentVertical char(1) NOT NULL, LabelVertical char(1) NOT NULL, ParentGrpId numeric (10,0) NULL, ScreenGrpId numeric (10,0) NOT NULL, ScreenGrpIndex varchar(20) NULL, ScreenGrpName nvarchar(50) NOT NULL, ScreenGrpTypeCd char(1) NULL, ScreenId numeric (10,0) NULL, TabIndex numeric (5,0) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenGrp (BorderWidth, ContentVertical, LabelVertical, ParentGrpId, ScreenGrpId, ScreenGrpIndex, ScreenGrpName, ScreenGrpTypeCd, ScreenId, TabIndex) SELECT BorderWidth, ContentVertical, LabelVertical, ParentGrpId, ScreenGrpId, ScreenGrpIndex, ScreenGrpName, ScreenGrpTypeCd, ScreenId, TabIndex FROM dbo.ScreenGrp IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenGrp) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenGrp) = 0 DROP TABLE dbo.ScreenGrp') EXEC (' CREATE TABLE dbo.ScreenGrp (ScreenGrpId numeric (10,0) IDENTITY NOT NULL, ScreenId numeric (10,0) NULL, ScreenGrpTypeCd Char(1) NULL, ParentGrpId numeric (10,0) NULL, ScreenGrpName NVarChar(50) NOT NULL, TabIndex numeric (5,0) NULL, ScreenGrpIndex VarChar(20) NULL, ContentVertical Char(1) NOT NULL, LabelVertical Char(1) NOT NULL, BorderWidth numeric (3,0) NOT NULL, GrpStyle varchar(200) NULL, CONSTRAINT PK_ScreenGrp PRIMARY KEY CLUSTERED (ScreenGrpId))') EXEC (' SET IDENTITY_INSERT dbo.ScreenGrp ON INSERT INTO dbo.ScreenGrp (ScreenGrpId, ScreenId, ScreenGrpTypeCd, ParentGrpId, ScreenGrpName, TabIndex, ScreenGrpIndex, ContentVertical, LabelVertical, BorderWidth) SELECT ScreenGrpId, ScreenId, ScreenGrpTypeCd, ParentGrpId, ScreenGrpName, TabIndex, ScreenGrpIndex, ContentVertical, LabelVertical, BorderWidth FROM dbo.Tmp_ScreenGrp SET IDENTITY_INSERT dbo.ScreenGrp OFF IF (SELECT COUNT(1) FROM dbo.ScreenGrp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenGrp) = 0 DROP TABLE dbo.Tmp_ScreenGrp')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=145&typ=N&sys=3","","",""); return false;
146~@~   2.  29.70525:D:   10:*:*:S: Change table ReportGrp~@~60~@~10~@~D~@~~@~~@~S~@~~@~Change table ReportGrp~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_ReportGrp (BorderWidth numeric (3,0) NOT NULL, ContentVertical char(1) NOT NULL, LabelVertical char(1) NOT NULL, ParentGrpId numeric (10,0) NULL, ReportGrpId numeric (10,0) NOT NULL, ReportGrpIndex varchar(20) NULL, ReportGrpName nvarchar(50) NOT NULL, ReportId numeric (10,0) NULL, TabIndex numeric (5,0) NULL)') EXEC (' INSERT INTO dbo.Tmp_ReportGrp (BorderWidth, ContentVertical, LabelVertical, ParentGrpId, ReportGrpId, ReportGrpIndex, ReportGrpName, ReportId, TabIndex) SELECT BorderWidth, ContentVertical, LabelVertical, ParentGrpId, ReportGrpId, ReportGrpIndex, ReportGrpName, ReportId, TabIndex FROM dbo.ReportGrp IF (SELECT COUNT(1) FROM dbo.Tmp_ReportGrp) > 0 OR (SELECT COUNT(1) FROM dbo.ReportGrp) = 0 DROP TABLE dbo.ReportGrp') EXEC (' CREATE TABLE dbo.ReportGrp (ReportGrpId numeric (10,0) IDENTITY NOT NULL, ReportId numeric (10,0) NULL, ParentGrpId numeric (10,0) NULL, ReportGrpName NVarChar(50) NOT NULL, ReportGrpIndex VarChar(20) NULL, TabIndex numeric (5,0) NULL, ContentVertical Char(1) NOT NULL, LabelVertical Char(1) NOT NULL, BorderWidth numeric (3,0) NOT NULL, GrpStyle varchar(200) NULL, CONSTRAINT PK_ReportGrp PRIMARY KEY CLUSTERED (ReportGrpId))') EXEC (' SET IDENTITY_INSERT dbo.ReportGrp ON INSERT INTO dbo.ReportGrp (ReportGrpId, ReportId, ParentGrpId, ReportGrpName, ReportGrpIndex, TabIndex, ContentVertical, LabelVertical, BorderWidth) SELECT ReportGrpId, ReportId, ParentGrpId, ReportGrpName, ReportGrpIndex, TabIndex, ContentVertical, LabelVertical, BorderWidth FROM dbo.Tmp_ReportGrp SET IDENTITY_INSERT dbo.ReportGrp OFF IF (SELECT COUNT(1) FROM dbo.ReportGrp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ReportGrp) = 0 DROP TABLE dbo.Tmp_ReportGrp')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=146&typ=N&sys=3","","",""); return false;
147~@~   2.  28.70517:D:   10:*:*:S: Change table DbTable~@~58~@~10~@~D~@~~@~~@~S~@~~@~Change table DbTable~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_DbKey_DbTable'') ALTER TABLE dbo.DbKey DROP CONSTRAINT FK_DbKey_DbTable')
 EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_DbColumn_DbTable'') ALTER TABLE dbo.DbColumn DROP CONSTRAINT FK_DbColumn_DbTable CREATE TABLE dbo.Tmp_DbTable (ModifiedOn datetime NULL, MultiDesignDb char(1) NOT NULL, PrevTblName varchar(20) NULL, SystemId numeric (3,0) NOT NULL, TableDesc nvarchar(100) NOT NULL, TableId numeric (10,0) NOT NULL, TableName varchar(20) NOT NULL, TblObjective text NULL)') EXEC (' INSERT INTO dbo.Tmp_DbTable (ModifiedOn, MultiDesignDb, PrevTblName, SystemId, TableDesc, TableId, TableName, TblObjective) SELECT ModifiedOn, MultiDesignDb, PrevTblName, SystemId, TableDesc, TableId, TableName, TblObjective FROM dbo.DbTable IF (SELECT COUNT(1) FROM dbo.Tmp_DbTable) > 0 OR (SELECT COUNT(1) FROM dbo.DbTable) = 0 DROP TABLE dbo.DbTable') EXEC (' CREATE TABLE dbo.DbTable (TableId numeric (10,0) IDENTITY NOT NULL, SystemId numeric (3,0) NOT NULL, TableName VarChar(20) NOT NULL, TableDesc NVarChar(100) NOT NULL, MultiDesignDb Char(1) NOT NULL, TblObjective text NULL, PrevTblName VarChar(20) NULL, ModifiedBy numeric (10,0) NULL, ModifiedOn DateTime NULL, CONSTRAINT PK_DbTable PRIMARY KEY CLUSTERED (TableId))') EXEC (' SET IDENTITY_INSERT dbo.DbTable ON INSERT INTO dbo.DbTable (TableId, SystemId, TableName, TableDesc, MultiDesignDb, TblObjective, PrevTblName, ModifiedOn) SELECT TableId, SystemId, TableName, TableDesc, MultiDesignDb, TblObjective, PrevTblName, ModifiedOn FROM dbo.Tmp_DbTable SET IDENTITY_INSERT dbo.DbTable OFF IF (SELECT COUNT(1) FROM dbo.DbTable) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_DbTable) = 0 DROP TABLE dbo.Tmp_DbTable CREATE  UNIQUE NONCLUSTERED INDEX IX_DbTable_TableName ON dbo.DbTable (TableName) ALTER TABLE dbo.DbColumn  ADD CONSTRAINT FK_DbColumn_DbTable FOREIGN KEY (TableId) REFERENCES dbo.DbTable (TableId)')
EXEC ('UPDATE DbTable SET ModifiedBy = 1')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=147&typ=N&sys=3","","",""); return false;
148~@~   2.  28.70517:D:   20:*:*:S: Change table DbTable~@~58~@~20~@~D~@~~@~~@~S~@~~@~Change table DbTable~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_DbColumn_DbTable'') ALTER TABLE dbo.DbColumn DROP CONSTRAINT FK_DbColumn_DbTable CREATE TABLE dbo.Tmp_DbTable (ModifiedBy numeric (10,0) NULL, ModifiedOn datetime NULL, MultiDesignDb char(1) NOT NULL, PrevTblName varchar(20) NULL, SystemId numeric (3,0) NOT NULL, TableDesc nvarchar(100) NOT NULL, TableId numeric (10,0) NOT NULL, TableName varchar(20) NOT NULL, TblObjective text NULL)') EXEC (' INSERT INTO dbo.Tmp_DbTable (ModifiedBy, ModifiedOn, MultiDesignDb, PrevTblName, SystemId, TableDesc, TableId, TableName, TblObjective) SELECT ModifiedBy, ModifiedOn, MultiDesignDb, PrevTblName, SystemId, TableDesc, TableId, TableName, TblObjective FROM dbo.DbTable IF (SELECT COUNT(1) FROM dbo.Tmp_DbTable) > 0 OR (SELECT COUNT(1) FROM dbo.DbTable) = 0 DROP TABLE dbo.DbTable') EXEC (' CREATE TABLE dbo.DbTable (TableId numeric (10,0) IDENTITY NOT NULL, SystemId numeric (3,0) NOT NULL, TableName VarChar(20) NOT NULL, TableDesc NVarChar(100) NOT NULL, MultiDesignDb Char(1) NOT NULL, TblObjective text NULL, PrevTblName VarChar(20) NULL, ModifiedBy numeric (10,0) NULL, ModifiedOn DateTime NULL, LastSyncDt DateTime NULL, CONSTRAINT PK_DbTable PRIMARY KEY CLUSTERED (TableId))') EXEC (' SET IDENTITY_INSERT dbo.DbTable ON INSERT INTO dbo.DbTable (TableId, SystemId, TableName, TableDesc, MultiDesignDb, TblObjective, PrevTblName, ModifiedBy, ModifiedOn) SELECT TableId, SystemId, TableName, TableDesc, MultiDesignDb, TblObjective, PrevTblName, ModifiedBy, ModifiedOn FROM dbo.Tmp_DbTable SET IDENTITY_INSERT dbo.DbTable OFF IF (SELECT COUNT(1) FROM dbo.DbTable) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_DbTable) = 0 DROP TABLE dbo.Tmp_DbTable CREATE  UNIQUE NONCLUSTERED INDEX IX_DbTable_TableName ON dbo.DbTable (TableName) ALTER TABLE dbo.DbColumn  ADD CONSTRAINT FK_DbColumn_DbTable FOREIGN KEY (TableId) REFERENCES dbo.DbTable (TableId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=148&typ=N&sys=3","","",""); return false;
154~@~   2.  30.70608:D:   10:*:*:*: Make BorderWidth zero~@~61~@~10~@~D~@~~@~~@~~@~~@~Make BorderWidth zero~@~Y~@~EXEC ('UPDATE dbo.ScreenGrp SET BorderWidth = 0 WHERE ScreenId is null AND ParentGrpId is null')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=154&typ=N&sys=3","","",""); return false;
155~@~   2.  31.70615:D:   10:*:*:*: Add row LongDateTime to Display Type~@~62~@~10~@~D~@~~@~~@~~@~~@~Add row LongDateTime to Display Type~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.CtDisplayType WHERE TypeDesc = 'LongDateTime')
EXEC ('INSERT dbo.CtDisplayType SELECT 30,''TextBox'',''LongDateTime'',''N''')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=155&typ=N&sys=3","","",""); return false;
156~@~   2.  33.70701:D:   10:*:*:M: Add column SearchWidth to table Screen~@~64~@~10~@~D~@~~@~~@~M~@~~@~Add column SearchWidth to table Screen~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_AuthRow_Screen'') ALTER TABLE dbo.AuthRow DROP CONSTRAINT FK_AuthRow_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenCri_Screen'') ALTER TABLE dbo.ScreenCri DROP CONSTRAINT FK_ScreenCri_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenHlp_Screen'') ALTER TABLE dbo.ScreenHlp DROP CONSTRAINT FK_ScreenHlp_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_Screen'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_Screen CREATE TABLE dbo.Tmp_Screen (DetailTableId int NULL, GenerateSc char(1) NOT NULL, GridClass varchar(30) NULL, GridRows tinyint NULL, GridTitle nvarchar(50) NULL, HasDeleteAll char(1) NOT NULL, MasterTableId int NULL, ProgramName varchar(20) NOT NULL, ScreenDesc nvarchar(50) NULL, ScreenFilter varchar(100) NULL, ScreenId int NOT NULL, ScreenObj varchar(100) NULL, ScreenTypeId tinyint NOT NULL, SearchAscending char(1) NOT NULL, SearchId int NULL, ValidateReq char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (DetailTableId, GenerateSc, GridClass, GridRows, GridTitle, HasDeleteAll, MasterTableId, ProgramName, ScreenDesc, ScreenFilter, ScreenId, ScreenObj, ScreenTypeId, SearchAscending, SearchId, ValidateReq) SELECT DetailTableId, GenerateSc, GridClass, GridRows, GridTitle, HasDeleteAll, MasterTableId, ProgramName, ScreenDesc, ScreenFilter, ScreenId, ScreenObj, ScreenTypeId, SearchAscending, SearchId, ValidateReq FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchId SmallInt NULL, SearchWidth SmallInt NULL, SearchAscending Char(1) NOT NULL, GridRows TinyInt NULL, GridClass VarChar(30) NULL, GridTitle NVarChar(50) NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, CONVERT(SmallInt,SearchId), SearchAscending, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen CREATE  UNIQUE NONCLUSTERED INDEX IX_Screen_ProgramName ON dbo.Screen (ProgramName) ALTER TABLE dbo.AuthRow WITH NOCHECK ADD CONSTRAINT FK_AuthRow_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenCri WITH NOCHECK ADD CONSTRAINT FK_ScreenCri_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenHlp WITH NOCHECK ADD CONSTRAINT FK_ScreenHlp_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenObj WITH NOCHECK ADD CONSTRAINT FK_ScreenObj_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=156&typ=N&sys=3","","",""); return false;
157~@~   2.  34.70711:D:   10:*:*:*: Add row ProjectId to table CtPermKey~@~65~@~10~@~D~@~~@~~@~~@~~@~Add row ProjectId to table CtPermKey~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.CtPermKey WHERE CtPermKeyName = 'ProjectId')
EXEC ('INSERT dbo.CtPermKey (CtPermKeyName, CtPermKeyParam, TableName, ColumnName, AndCondition) VALUES (''ProjectId'',''Projects'',''Project'',''ProjectId'',''N'')')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=157&typ=N&sys=3","","",""); return false;
158~@~   2.  33.70701:D:   10:*:*:S: Add column SearchWidth to table Screen~@~64~@~10~@~D~@~~@~~@~S~@~~@~Add column SearchWidth to table Screen~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_AuthRow_Screen'') ALTER TABLE dbo.AuthRow DROP CONSTRAINT FK_AuthRow_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenCri_Screen'') ALTER TABLE dbo.ScreenCri DROP CONSTRAINT FK_ScreenCri_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenHlp_Screen'') ALTER TABLE dbo.ScreenHlp DROP CONSTRAINT FK_ScreenHlp_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_Screen'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_Screen CREATE TABLE dbo.Tmp_Screen (DetailTableId numeric (10,0) NULL, GenerateSc char(1) NOT NULL, GridClass varchar(30) NULL, GridRows numeric (3,0) NULL, GridTitle nvarchar(50) NULL, HasDeleteAll char(1) NOT NULL, MasterTableId numeric (10,0) NULL, ProgramName varchar(20) NOT NULL, ScreenDesc nvarchar(50) NULL, ScreenFilter varchar(100) NULL, ScreenId numeric (10,0) NOT NULL, ScreenObj varchar(100) NULL, ScreenTypeId numeric (3,0) NOT NULL, SearchAscending char(1) NOT NULL, SearchId numeric (10,0) NULL, ValidateReq char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (DetailTableId, GenerateSc, GridClass, GridRows, GridTitle, HasDeleteAll, MasterTableId, ProgramName, ScreenDesc, ScreenFilter, ScreenId, ScreenObj, ScreenTypeId, SearchAscending, SearchId, ValidateReq) SELECT DetailTableId, GenerateSc, GridClass, GridRows, GridTitle, HasDeleteAll, MasterTableId, ProgramName, ScreenDesc, ScreenFilter, ScreenId, ScreenObj, ScreenTypeId, SearchAscending, SearchId, ValidateReq FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' CREATE TABLE dbo.Screen (ScreenId numeric (10,0) IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId numeric (3,0) NOT NULL, MasterTableId numeric (10,0) NULL, DetailTableId numeric (10,0) NULL, SearchId numeric (5,0) NULL, SearchWidth numeric (5,0) NULL, SearchAscending Char(1) NOT NULL, GridRows numeric (3,0) NULL, GridClass VarChar(30) NULL, GridTitle NVarChar(50) NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, CONVERT(numeric (5,0),SearchId), SearchAscending, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen CREATE  UNIQUE NONCLUSTERED INDEX IX_Screen_ProgramName ON dbo.Screen (ProgramName) ALTER TABLE dbo.AuthRow  ADD CONSTRAINT FK_AuthRow_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenCri  ADD CONSTRAINT FK_ScreenCri_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenHlp  ADD CONSTRAINT FK_ScreenHlp_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenObj  ADD CONSTRAINT FK_ScreenObj_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=158&typ=N&sys=3","","",""); return false;
159~@~   2.  34.70711:D:   20:*:*:M: Add column ProjectId to table UsrPref~@~65~@~20~@~D~@~~@~~@~M~@~~@~Add column ProjectId to table UsrPref~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_UsrPref (AgentId int NULL, BrokerId int NULL, ComListVisible char(1) NOT NULL, CompanyId smallint NULL, CustomerId int NULL, InvestorId int NULL, LoginBannerImg varchar(100) NULL, LoginLink1Href varchar(100) NULL, LoginLink1Text nvarchar(20) NULL, LoginLink2Href varchar(100) NULL, LoginLink2Text nvarchar(20) NULL, LoginLink3Href varchar(100) NULL, LoginLink3Text nvarchar(20) NULL, LoginLink4Href varchar(100) NULL, LoginLink4Text nvarchar(20) NULL, LogoBannerImg varchar(100) NULL, MemberId int NULL, MenuAd1Href varchar(100) NULL, MenuAd1Img varchar(100) NULL, MenuAd2Href varchar(100) NULL, MenuAd2Img varchar(100) NULL, MenuOption char(1) NOT NULL, PageBannerImg varchar(100) NULL, PageLink1Href varchar(100) NULL, PageLink1Text nvarchar(20) NULL, PageLink2Href varchar(100) NULL, PageLink2Text nvarchar(20) NULL, PrefDefault char(1) NOT NULL, SplashImg varchar(100) NULL, SysListVisible char(1) NOT NULL, SystemId tinyint NULL, UsrGroupId smallint NULL, UsrId int NULL, UsrPrefDesc nvarchar(50) NOT NULL, UsrPrefId int NOT NULL, UsrStyleSheet text NULL, VendorId int NULL)') EXEC (' INSERT INTO dbo.Tmp_UsrPref (AgentId, BrokerId, ComListVisible, CompanyId, CustomerId, InvestorId, LoginBannerImg, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, LogoBannerImg, MemberId, MenuAd1Href, MenuAd1Img, MenuAd2Href, MenuAd2Img, MenuOption, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, PrefDefault, SplashImg, SysListVisible, SystemId, UsrGroupId, UsrId, UsrPrefDesc, UsrPrefId, UsrStyleSheet, VendorId) SELECT AgentId, BrokerId, ComListVisible, CompanyId, CustomerId, InvestorId, LoginBannerImg, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, LogoBannerImg, MemberId, MenuAd1Href, MenuAd1Img, MenuAd2Href, MenuAd2Img, MenuOption, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, PrefDefault, SplashImg, SysListVisible, SystemId, UsrGroupId, UsrId, UsrPrefDesc, UsrPrefId, UsrStyleSheet, VendorId FROM dbo.UsrPref IF (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.UsrPref) = 0 DROP TABLE dbo.UsrPref') EXEC (' CREATE TABLE dbo.UsrPref (UsrPrefId Int IDENTITY NOT NULL, UsrId Int NULL, UsrGroupId SmallInt NULL, CompanyId SmallInt NULL, MemberId Int NULL, AgentId Int NULL, BrokerId Int NULL, CustomerId Int NULL, InvestorId Int NULL, VendorId Int NULL, ProjectId SmallInt NULL, SystemId TinyInt NULL, PrefDefault Char(1) NOT NULL, UsrPrefDesc NVarChar(50) NOT NULL, SysListVisible Char(1) NOT NULL, ComListVisible Char(1) NOT NULL, MenuOption Char(1) NOT NULL, LoginBannerImg VarChar(100) NULL, LogoBannerImg VarChar(100) NULL, PageBannerImg VarChar(100) NULL, PageLink1Href VarChar(100) NULL, PageLink1Text NVarChar(20) NULL, PageLink2Href VarChar(100) NULL, PageLink2Text NVarChar(20) NULL, LoginLink1Href VarChar(100) NULL, LoginLink1Text NVarChar(20) NULL, LoginLink2Href VarChar(100) NULL, LoginLink2Text NVarChar(20) NULL, LoginLink3Href VarChar(100) NULL, LoginLink3Text NVarChar(20) NULL, LoginLink4Href VarChar(100) NULL, LoginLink4Text NVarChar(20) NULL, UsrStyleSheet Text NULL, MenuAd1Img VarChar(100) NULL, MenuAd1Href VarChar(100) NULL, MenuAd2Img VarChar(100) NULL, MenuAd2Href VarChar(100) NULL, SplashImg VarChar(100) NULL, CONSTRAINT PK_UsrPref PRIMARY KEY CLUSTERED (UsrPrefId))') EXEC (' SET IDENTITY_INSERT dbo.UsrPref ON INSERT INTO dbo.UsrPref (UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, MenuOption, LoginBannerImg, LogoBannerImg, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, UsrStyleSheet, MenuAd1Img, MenuAd1Href, MenuAd2Img, MenuAd2Href, SplashImg) SELECT UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, MenuOption, LoginBannerImg, LogoBannerImg, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, UsrStyleSheet, MenuAd1Img, MenuAd1Href, MenuAd2Img, MenuAd2Href, SplashImg FROM dbo.Tmp_UsrPref SET IDENTITY_INSERT dbo.UsrPref OFF IF (SELECT COUNT(1) FROM dbo.UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) = 0 DROP TABLE dbo.Tmp_UsrPref CREATE  UNIQUE NONCLUSTERED INDEX IX_UsrPref_UsrPrefDesc ON dbo.UsrPref (UsrPrefDesc)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=159&typ=N&sys=3","","",""); return false;
160~@~   2.  34.70711:D:   30:*:*:M: Add column ProjectId to table MenuPerm~@~65~@~30~@~D~@~~@~~@~M~@~~@~Add column ProjectId to table MenuPerm~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_MenuPerm (AgentId int NULL, BrokerId int NULL, CustomerId int NULL, Everyone char(1) NOT NULL, InvestorId int NULL, MemberId int NULL, MenuId int NOT NULL, MenuPermId int NOT NULL, UsrGroupId smallint NULL, VendorId int NULL)') EXEC (' INSERT INTO dbo.Tmp_MenuPerm (AgentId, BrokerId, CustomerId, Everyone, InvestorId, MemberId, MenuId, MenuPermId, UsrGroupId, VendorId) SELECT AgentId, BrokerId, CustomerId, Everyone, InvestorId, MemberId, MenuId, MenuPermId, UsrGroupId, VendorId FROM dbo.MenuPerm IF (SELECT COUNT(1) FROM dbo.Tmp_MenuPerm) > 0 OR (SELECT COUNT(1) FROM dbo.MenuPerm) = 0 DROP TABLE dbo.MenuPerm') EXEC (' CREATE TABLE dbo.MenuPerm (MenuPermId Int IDENTITY NOT NULL, MenuId Int NOT NULL, Everyone Char(1) NOT NULL, UsrGroupId SmallInt NULL, MemberId Int NULL, CustomerId Int NULL, VendorId Int NULL, InvestorId Int NULL, AgentId Int NULL, BrokerId Int NULL, ProjectId SmallInt NULL, CONSTRAINT PK_MenuPerm PRIMARY KEY CLUSTERED (MenuPermId))') EXEC (' SET IDENTITY_INSERT dbo.MenuPerm ON INSERT INTO dbo.MenuPerm (MenuPermId, MenuId, Everyone, UsrGroupId, MemberId, CustomerId, VendorId, InvestorId, AgentId, BrokerId) SELECT MenuPermId, MenuId, Everyone, UsrGroupId, MemberId, CustomerId, VendorId, InvestorId, AgentId, BrokerId FROM dbo.Tmp_MenuPerm SET IDENTITY_INSERT dbo.MenuPerm OFF IF (SELECT COUNT(1) FROM dbo.MenuPerm) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_MenuPerm) = 0 DROP TABLE dbo.Tmp_MenuPerm CREATE  NONCLUSTERED INDEX IX_MenuPerm_MenuId ON dbo.MenuPerm (MenuId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=160&typ=N&sys=3","","",""); return false;
161~@~   2.  34.70711:D:   40:*:*:M: Add column ProjectId to table Usr~@~65~@~40~@~D~@~~@~~@~M~@~~@~Add column ProjectId to table Usr~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_Usr (Active char(1) NOT NULL, AgentId int NULL, BrokerId int NULL, CompanyId smallint NULL, ConfirmPwd varbinary(32) NULL, CustomerId int NULL, DefCompanyId smallint NULL, DefSystemId tinyint NOT NULL, ExtPassword varbinary(255) NULL, FailedAttempt tinyint NULL, FailedAttemptFP tinyint NULL, HintAnswer nvarchar(50) NULL, HintQuestionId tinyint NULL, InvestorId int NULL, LastFailedDt datetime NULL, LastSuccessDt datetime NULL, LoginName nvarchar(32) NOT NULL, MemberId int NULL, ModifiedOn datetime NOT NULL, UsrEmail nvarchar(50) NULL, UsrGroupId smallint NOT NULL, UsrId int NOT NULL, UsrName nvarchar(50) NULL, UsrPassword varbinary(32) NULL, VendorId int NULL)') EXEC (' INSERT INTO dbo.Tmp_Usr (Active, AgentId, BrokerId, CompanyId, ConfirmPwd, CustomerId, DefCompanyId, DefSystemId, ExtPassword, FailedAttempt, FailedAttemptFP, HintAnswer, HintQuestionId, InvestorId, LastFailedDt, LastSuccessDt, LoginName, MemberId, ModifiedOn, UsrEmail, UsrGroupId, UsrId, UsrName, UsrPassword, VendorId) SELECT Active, AgentId, BrokerId, CompanyId, ConfirmPwd, CustomerId, DefCompanyId, DefSystemId, ExtPassword, FailedAttempt, FailedAttemptFP, HintAnswer, HintQuestionId, InvestorId, LastFailedDt, LastSuccessDt, LoginName, MemberId, ModifiedOn, UsrEmail, UsrGroupId, UsrId, UsrName, UsrPassword, VendorId FROM dbo.Usr IF (SELECT COUNT(1) FROM dbo.Tmp_Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Usr) = 0 DROP TABLE dbo.Usr') EXEC (' CREATE TABLE dbo.Usr (UsrId Int IDENTITY NOT NULL, LoginName NVarChar(32) NOT NULL, UsrEmail NVarChar(50) NULL, UsrName NVarChar(50) NULL, UsrPassword VarBinary(32) NULL, ConfirmPwd VarBinary(32) NULL, ExtPassword VarBinary(255) NULL, UsrGroupId SmallInt NOT NULL, CompanyId SmallInt NULL, InvestorId Int NULL, CustomerId Int NULL, VendorId Int NULL, AgentId Int NULL, BrokerId Int NULL, MemberId Int NULL, ProjectId SmallInt NULL, DefSystemId TinyInt NOT NULL, DefCompanyId SmallInt NULL, FailedAttempt TinyInt NULL, FailedAttemptFP TinyInt NULL, LastFailedDt DateTime NULL, LastSuccessDt DateTime NULL, HintQuestionId TinyInt NULL, HintAnswer NVarChar(50) NULL, Active Char(1) NOT NULL, ModifiedOn DateTime NOT NULL, CONSTRAINT PK_Usr PRIMARY KEY CLUSTERED (UsrId))') EXEC (' SET IDENTITY_INSERT dbo.Usr ON INSERT INTO dbo.Usr (UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, UsrGroupId, CompanyId, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, HintQuestionId, HintAnswer, Active, ModifiedOn) SELECT UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, UsrGroupId, CompanyId, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, HintQuestionId, HintAnswer, Active, ModifiedOn FROM dbo.Tmp_Usr SET IDENTITY_INSERT dbo.Usr OFF IF (SELECT COUNT(1) FROM dbo.Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Usr) = 0 DROP TABLE dbo.Tmp_Usr CREATE  NONCLUSTERED INDEX IX_Usr_UsrName ON dbo.Usr (UsrName) CREATE  UNIQUE NONCLUSTERED INDEX IX_Usr_LoginName ON dbo.Usr (LoginName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=161&typ=N&sys=3","","",""); return false;
162~@~   2.  34.70711:D:   40:*:*:S: Add column ProjectId to table Usr~@~65~@~40~@~D~@~~@~~@~S~@~~@~Add column ProjectId to table Usr~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_Usr (Active char(1) NOT NULL, AgentId numeric (10,0) NULL, BrokerId numeric (10,0) NULL, CompanyId numeric (5,0) NULL, ConfirmPwd varbinary(32) NULL, CustomerId numeric (10,0) NULL, DefCompanyId numeric (5,0) NULL, DefSystemId numeric (3,0) NOT NULL, ExtPassword varbinary(255) NULL, FailedAttempt numeric (3,0) NULL, FailedAttemptFP numeric (3,0) NULL, HintAnswer nvarchar(50) NULL, HintQuestionId numeric (3,0) NULL, InvestorId numeric (10,0) NULL, LastFailedDt datetime NULL, LastSuccessDt datetime NULL, LoginName nvarchar(32) NOT NULL, MemberId numeric (10,0) NULL, ModifiedOn datetime NOT NULL, UsrEmail nvarchar(50) NULL, UsrGroupId numeric (5,0) NOT NULL, UsrId numeric (10,0) NOT NULL, UsrName nvarchar(50) NULL, UsrPassword varbinary(32) NULL, VendorId numeric (10,0) NULL)') EXEC (' INSERT INTO dbo.Tmp_Usr (Active, AgentId, BrokerId, CompanyId, ConfirmPwd, CustomerId, DefCompanyId, DefSystemId, ExtPassword, FailedAttempt, FailedAttemptFP, HintAnswer, HintQuestionId, InvestorId, LastFailedDt, LastSuccessDt, LoginName, MemberId, ModifiedOn, UsrEmail, UsrGroupId, UsrId, UsrName, UsrPassword, VendorId) SELECT Active, AgentId, BrokerId, CompanyId, ConfirmPwd, CustomerId, DefCompanyId, DefSystemId, ExtPassword, FailedAttempt, FailedAttemptFP, HintAnswer, HintQuestionId, InvestorId, LastFailedDt, LastSuccessDt, LoginName, MemberId, ModifiedOn, UsrEmail, UsrGroupId, UsrId, UsrName, UsrPassword, VendorId FROM dbo.Usr IF (SELECT COUNT(1) FROM dbo.Tmp_Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Usr) = 0 DROP TABLE dbo.Usr') EXEC (' CREATE TABLE dbo.Usr (UsrId numeric (10,0) IDENTITY NOT NULL, LoginName NVarChar(32) NOT NULL, UsrEmail NVarChar(50) NULL, UsrName NVarChar(50) NULL, UsrPassword VarBinary(32) NULL, ConfirmPwd VarBinary(32) NULL, ExtPassword VarBinary(255) NULL, UsrGroupId numeric (5,0) NOT NULL, CompanyId numeric (5,0) NULL, InvestorId numeric (10,0) NULL, CustomerId numeric (10,0) NULL, VendorId numeric (10,0) NULL, AgentId numeric (10,0) NULL, BrokerId numeric (10,0) NULL, MemberId numeric (10,0) NULL, ProjectId numeric (5,0) NULL, DefSystemId numeric (3,0) NOT NULL, DefCompanyId numeric (5,0) NULL, FailedAttempt numeric (3,0) NULL, FailedAttemptFP numeric (3,0) NULL, LastFailedDt DateTime NULL, LastSuccessDt DateTime NULL, HintQuestionId numeric (3,0) NULL, HintAnswer NVarChar(50) NULL, Active Char(1) NOT NULL, ModifiedOn DateTime NOT NULL, CONSTRAINT PK_Usr PRIMARY KEY CLUSTERED (UsrId))') EXEC (' SET IDENTITY_INSERT dbo.Usr ON INSERT INTO dbo.Usr (UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, UsrGroupId, CompanyId, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, HintQuestionId, HintAnswer, Active, ModifiedOn) SELECT UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, UsrGroupId, CompanyId, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, HintQuestionId, HintAnswer, Active, ModifiedOn FROM dbo.Tmp_Usr SET IDENTITY_INSERT dbo.Usr OFF IF (SELECT COUNT(1) FROM dbo.Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Usr) = 0 DROP TABLE dbo.Tmp_Usr CREATE  NONCLUSTERED INDEX IX_Usr_UsrName ON dbo.Usr (UsrName) CREATE  UNIQUE NONCLUSTERED INDEX IX_Usr_LoginName ON dbo.Usr (LoginName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=162&typ=N&sys=3","","",""); return false;
163~@~   2.  34.70711:D:   30:*:*:S: Add column ProjectId to table MenuPerm~@~65~@~30~@~D~@~~@~~@~S~@~~@~Add column ProjectId to table MenuPerm~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_MenuPerm (AgentId numeric (10,0) NULL, BrokerId numeric (10,0) NULL, CustomerId numeric (10,0) NULL, Everyone char(1) NOT NULL, InvestorId numeric (10,0) NULL, MemberId numeric (10,0) NULL, MenuId numeric (10,0) NOT NULL, MenuPermId numeric (10,0) NOT NULL, UsrGroupId numeric (5,0) NULL, VendorId numeric (10,0) NULL)') EXEC (' INSERT INTO dbo.Tmp_MenuPerm (AgentId, BrokerId, CustomerId, Everyone, InvestorId, MemberId, MenuId, MenuPermId, UsrGroupId, VendorId) SELECT AgentId, BrokerId, CustomerId, Everyone, InvestorId, MemberId, MenuId, MenuPermId, UsrGroupId, VendorId FROM dbo.MenuPerm IF (SELECT COUNT(1) FROM dbo.Tmp_MenuPerm) > 0 OR (SELECT COUNT(1) FROM dbo.MenuPerm) = 0 DROP TABLE dbo.MenuPerm') EXEC (' CREATE TABLE dbo.MenuPerm (MenuPermId numeric (10,0) IDENTITY NOT NULL, MenuId numeric (10,0) NOT NULL, Everyone Char(1) NOT NULL, UsrGroupId numeric (5,0) NULL, MemberId numeric (10,0) NULL, CustomerId numeric (10,0) NULL, VendorId numeric (10,0) NULL, InvestorId numeric (10,0) NULL, AgentId numeric (10,0) NULL, BrokerId numeric (10,0) NULL, ProjectId numeric (5,0) NULL, CONSTRAINT PK_MenuPerm PRIMARY KEY CLUSTERED (MenuPermId))') EXEC (' SET IDENTITY_INSERT dbo.MenuPerm ON INSERT INTO dbo.MenuPerm (MenuPermId, MenuId, Everyone, UsrGroupId, MemberId, CustomerId, VendorId, InvestorId, AgentId, BrokerId) SELECT MenuPermId, MenuId, Everyone, UsrGroupId, MemberId, CustomerId, VendorId, InvestorId, AgentId, BrokerId FROM dbo.Tmp_MenuPerm SET IDENTITY_INSERT dbo.MenuPerm OFF IF (SELECT COUNT(1) FROM dbo.MenuPerm) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_MenuPerm) = 0 DROP TABLE dbo.Tmp_MenuPerm CREATE  NONCLUSTERED INDEX IX_MenuPerm_MenuId ON dbo.MenuPerm (MenuId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=163&typ=N&sys=3","","",""); return false;
164~@~   2.  34.70711:D:   20:*:*:S: Add column ProjectId to table UsrPref~@~65~@~20~@~D~@~~@~~@~S~@~~@~Add column ProjectId to table UsrPref~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_UsrPref (AgentId numeric (10,0) NULL, BrokerId numeric (10,0) NULL, ComListVisible char(1) NOT NULL, CompanyId numeric (5,0) NULL, CustomerId numeric (10,0) NULL, InvestorId numeric (10,0) NULL, LoginBannerImg varchar(100) NULL, LoginLink1Href varchar(100) NULL, LoginLink1Text nvarchar(20) NULL, LoginLink2Href varchar(100) NULL, LoginLink2Text nvarchar(20) NULL, LoginLink3Href varchar(100) NULL, LoginLink3Text nvarchar(20) NULL, LoginLink4Href varchar(100) NULL, LoginLink4Text nvarchar(20) NULL, LogoBannerImg varchar(100) NULL, MemberId numeric (10,0) NULL, MenuAd1Href varchar(100) NULL, MenuAd1Img varchar(100) NULL, MenuAd2Href varchar(100) NULL, MenuAd2Img varchar(100) NULL, MenuOption char(1) NOT NULL, PageBannerImg varchar(100) NULL, PageLink1Href varchar(100) NULL, PageLink1Text nvarchar(20) NULL, PageLink2Href varchar(100) NULL, PageLink2Text nvarchar(20) NULL, PrefDefault char(1) NOT NULL, SplashImg varchar(100) NULL, SysListVisible char(1) NOT NULL, SystemId numeric (3,0) NULL, UsrGroupId numeric (5,0) NULL, UsrId numeric (10,0) NULL, UsrPrefDesc nvarchar(50) NOT NULL, UsrPrefId numeric (10,0) NOT NULL, UsrStyleSheet text NULL, VendorId numeric (10,0) NULL)') EXEC (' INSERT INTO dbo.Tmp_UsrPref (AgentId, BrokerId, ComListVisible, CompanyId, CustomerId, InvestorId, LoginBannerImg, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, LogoBannerImg, MemberId, MenuAd1Href, MenuAd1Img, MenuAd2Href, MenuAd2Img, MenuOption, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, PrefDefault, SplashImg, SysListVisible, SystemId, UsrGroupId, UsrId, UsrPrefDesc, UsrPrefId, UsrStyleSheet, VendorId) SELECT AgentId, BrokerId, ComListVisible, CompanyId, CustomerId, InvestorId, LoginBannerImg, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, LogoBannerImg, MemberId, MenuAd1Href, MenuAd1Img, MenuAd2Href, MenuAd2Img, MenuOption, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, PrefDefault, SplashImg, SysListVisible, SystemId, UsrGroupId, UsrId, UsrPrefDesc, UsrPrefId, UsrStyleSheet, VendorId FROM dbo.UsrPref IF (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.UsrPref) = 0 DROP TABLE dbo.UsrPref') EXEC (' CREATE TABLE dbo.UsrPref (UsrPrefId numeric (10,0) IDENTITY NOT NULL, UsrId numeric (10,0) NULL, UsrGroupId numeric (5,0) NULL, CompanyId numeric (5,0) NULL, MemberId numeric (10,0) NULL, AgentId numeric (10,0) NULL, BrokerId numeric (10,0) NULL, CustomerId numeric (10,0) NULL, InvestorId numeric (10,0) NULL, VendorId numeric (10,0) NULL, ProjectId numeric (5,0) NULL, SystemId numeric (3,0) NULL, PrefDefault Char(1) NOT NULL, UsrPrefDesc NVarChar(50) NOT NULL, SysListVisible Char(1) NOT NULL, ComListVisible Char(1) NOT NULL, MenuOption Char(1) NOT NULL, LoginBannerImg VarChar(100) NULL, LogoBannerImg VarChar(100) NULL, PageBannerImg VarChar(100) NULL, PageLink1Href VarChar(100) NULL, PageLink1Text NVarChar(20) NULL, PageLink2Href VarChar(100) NULL, PageLink2Text NVarChar(20) NULL, LoginLink1Href VarChar(100) NULL, LoginLink1Text NVarChar(20) NULL, LoginLink2Href VarChar(100) NULL, LoginLink2Text NVarChar(20) NULL, LoginLink3Href VarChar(100) NULL, LoginLink3Text NVarChar(20) NULL, LoginLink4Href VarChar(100) NULL, LoginLink4Text NVarChar(20) NULL, UsrStyleSheet Text NULL, MenuAd1Img VarChar(100) NULL, MenuAd1Href VarChar(100) NULL, MenuAd2Img VarChar(100) NULL, MenuAd2Href VarChar(100) NULL, SplashImg VarChar(100) NULL, CONSTRAINT PK_UsrPref PRIMARY KEY CLUSTERED (UsrPrefId))') EXEC (' SET IDENTITY_INSERT dbo.UsrPref ON INSERT INTO dbo.UsrPref (UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, MenuOption, LoginBannerImg, LogoBannerImg, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, UsrStyleSheet, MenuAd1Img, MenuAd1Href, MenuAd2Img, MenuAd2Href, SplashImg) SELECT UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, MenuOption, LoginBannerImg, LogoBannerImg, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, UsrStyleSheet, MenuAd1Img, MenuAd1Href, MenuAd2Img, MenuAd2Href, SplashImg FROM dbo.Tmp_UsrPref SET IDENTITY_INSERT dbo.UsrPref OFF IF (SELECT COUNT(1) FROM dbo.UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) = 0 DROP TABLE dbo.Tmp_UsrPref CREATE  UNIQUE NONCLUSTERED INDEX IX_UsrPref_UsrPrefDesc ON dbo.UsrPref (UsrPrefDesc)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=164&typ=N&sys=3","","",""); return false;
166~@~   2.  34.70711:D:   50:*:*:M: Add column ProjectId to table CtRowAuthority~@~65~@~50~@~D~@~~@~~@~M~@~~@~Add column ProjectId to table CtRowAuthority~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_CtRowAuthority (AllowAdd char(1) NOT NULL, AllowDel char(1) NOT NULL, AllowSel char(1) NOT NULL, AllowUpd char(1) NOT NULL, OvrideId smallint NULL, RowAuthorityDesc varchar(50) NOT NULL, RowAuthorityId smallint NOT NULL, SelAgent char(1) NOT NULL, SelBroker char(1) NOT NULL, SelCompany char(1) NOT NULL, SelCulture char(1) NOT NULL, SelCustomer char(1) NOT NULL, SelInvestor char(1) NOT NULL, SelMember char(1) NOT NULL, SelUsr char(1) NOT NULL, SelUsrGroup char(1) NOT NULL, SelVendor char(1) NOT NULL, SysAdmin char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_CtRowAuthority (AllowAdd, AllowDel, AllowSel, AllowUpd, OvrideId, RowAuthorityDesc, RowAuthorityId, SelAgent, SelBroker, SelCompany, SelCulture, SelCustomer, SelInvestor, SelMember, SelUsr, SelUsrGroup, SelVendor, SysAdmin) SELECT AllowAdd, AllowDel, AllowSel, AllowUpd, OvrideId, RowAuthorityDesc, RowAuthorityId, SelAgent, SelBroker, SelCompany, SelCulture, SelCustomer, SelInvestor, SelMember, SelUsr, SelUsrGroup, SelVendor, SysAdmin FROM dbo.CtRowAuthority IF (SELECT COUNT(1) FROM dbo.Tmp_CtRowAuthority) > 0 OR (SELECT COUNT(1) FROM dbo.CtRowAuthority) = 0 DROP TABLE dbo.CtRowAuthority') EXEC (' CREATE TABLE dbo.CtRowAuthority (RowAuthorityId SmallInt IDENTITY NOT NULL, RowAuthorityDesc VarChar(50) NOT NULL, AllowSel Char(1) NOT NULL, AllowAdd Char(1) NOT NULL, AllowUpd Char(1) NOT NULL, AllowDel Char(1) NOT NULL, SysAdmin Char(1) NOT NULL, OvrideId SmallInt NULL, SelUsr Char(1) NOT NULL, SelUsrGroup Char(1) NOT NULL, SelCulture Char(1) NOT NULL, SelCompany Char(1) NOT NULL, SelAgent Char(1) NOT NULL, SelBroker Char(1) NOT NULL, SelCustomer Char(1) NOT NULL, SelInvestor Char(1) NOT NULL, SelMember Char(1) NOT NULL, SelVendor Char(1) NOT NULL, SelProject Char(1) NOT NULL, CONSTRAINT PK_CtRowAuthority PRIMARY KEY CLUSTERED (RowAuthorityId))') EXEC (' ALTER TABLE dbo.CtRowAuthority ADD CONSTRAINT DF_CtRowAuthority_SelProject DEFAULT (''S'') FOR SelProject SET IDENTITY_INSERT dbo.CtRowAuthority ON INSERT INTO dbo.CtRowAuthority (RowAuthorityId, RowAuthorityDesc, AllowSel, AllowAdd, AllowUpd, AllowDel, SysAdmin, OvrideId, SelUsr, SelUsrGroup, SelCulture, SelCompany, SelAgent, SelBroker, SelCustomer, SelInvestor, SelMember, SelVendor, SelProject) SELECT RowAuthorityId, RowAuthorityDesc, AllowSel, AllowAdd, AllowUpd, AllowDel, SysAdmin, OvrideId, SelUsr, SelUsrGroup, SelCulture, SelCompany, SelAgent, SelBroker, SelCustomer, SelInvestor, SelMember, SelVendor, ''S'' FROM dbo.Tmp_CtRowAuthority SET IDENTITY_INSERT dbo.CtRowAuthority OFF IF (SELECT COUNT(1) FROM dbo.CtRowAuthority) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtRowAuthority) = 0 DROP TABLE dbo.Tmp_CtRowAuthority')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=166&typ=N&sys=3","","",""); return false;
167~@~   2.  34.70711:D:   60:*:*:M: Add column ProjectId to table AuthRow~@~65~@~60~@~D~@~~@~~@~M~@~~@~Add column ProjectId to table AuthRow~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_AuthRow_Screen'') ALTER TABLE dbo.AuthRow DROP CONSTRAINT FK_AuthRow_Screen CREATE TABLE dbo.Tmp_AuthRow (AllowAdd char(1) NOT NULL, AllowDel char(1) NOT NULL, AllowSel char(1) NOT NULL, AllowUpd char(1) NOT NULL, AuthRowId int NOT NULL, RowAuthorityId tinyint NOT NULL, ScreenId int NOT NULL, SelAgent char(1) NOT NULL, SelBroker char(1) NOT NULL, SelCompany char(1) NOT NULL, SelCulture char(1) NOT NULL, SelCustomer char(1) NOT NULL, SelInvestor char(1) NOT NULL, SelMember char(1) NOT NULL, SelUsr char(1) NOT NULL, SelUsrGroup char(1) NOT NULL, SelVendor char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_AuthRow (AllowAdd, AllowDel, AllowSel, AllowUpd, AuthRowId, RowAuthorityId, ScreenId, SelAgent, SelBroker, SelCompany, SelCulture, SelCustomer, SelInvestor, SelMember, SelUsr, SelUsrGroup, SelVendor) SELECT AllowAdd, AllowDel, AllowSel, AllowUpd, AuthRowId, RowAuthorityId, ScreenId, SelAgent, SelBroker, SelCompany, SelCulture, SelCustomer, SelInvestor, SelMember, SelUsr, SelUsrGroup, SelVendor FROM dbo.AuthRow IF (SELECT COUNT(1) FROM dbo.Tmp_AuthRow) > 0 OR (SELECT COUNT(1) FROM dbo.AuthRow) = 0 DROP TABLE dbo.AuthRow') EXEC (' CREATE TABLE dbo.AuthRow (AuthRowId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, RowAuthorityId TinyInt NOT NULL, AllowSel Char(1) NOT NULL, AllowAdd Char(1) NOT NULL, AllowUpd Char(1) NOT NULL, AllowDel Char(1) NOT NULL, SelUsr Char(1) NOT NULL, SelUsrGroup Char(1) NOT NULL, SelCulture Char(1) NOT NULL, SelCompany Char(1) NOT NULL, SelAgent Char(1) NOT NULL, SelBroker Char(1) NOT NULL, SelCustomer Char(1) NOT NULL, SelInvestor Char(1) NOT NULL, SelMember Char(1) NOT NULL, SelVendor Char(1) NOT NULL, SelProject Char(1) NOT NULL, CONSTRAINT PK_AuthRow PRIMARY KEY CLUSTERED (AuthRowId))') EXEC (' ALTER TABLE dbo.AuthRow ADD CONSTRAINT DF_AuthRow_SelProject DEFAULT (''S'') FOR SelProject SET IDENTITY_INSERT dbo.AuthRow ON INSERT INTO dbo.AuthRow (AuthRowId, ScreenId, RowAuthorityId, AllowSel, AllowAdd, AllowUpd, AllowDel, SelUsr, SelUsrGroup, SelCulture, SelCompany, SelAgent, SelBroker, SelCustomer, SelInvestor, SelMember, SelVendor, SelProject) SELECT AuthRowId, ScreenId, RowAuthorityId, AllowSel, AllowAdd, AllowUpd, AllowDel, SelUsr, SelUsrGroup, SelCulture, SelCompany, SelAgent, SelBroker, SelCustomer, SelInvestor, SelMember, SelVendor, ''S'' FROM dbo.Tmp_AuthRow SET IDENTITY_INSERT dbo.AuthRow OFF IF (SELECT COUNT(1) FROM dbo.AuthRow) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AuthRow) = 0 DROP TABLE dbo.Tmp_AuthRow CREATE  UNIQUE NONCLUSTERED INDEX IX_AuthRow_ScreenId ON dbo.AuthRow (ScreenId,RowAuthorityId) ALTER TABLE dbo.AuthRow WITH NOCHECK ADD CONSTRAINT FK_AuthRow_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=167&typ=N&sys=3","","",""); return false;
168~@~   2.  34.70711:D:   60:*:*:S: Add column ProjectId to table AuthRow~@~65~@~60~@~D~@~~@~~@~S~@~~@~Add column ProjectId to table AuthRow~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_AuthRow_Screen'') ALTER TABLE dbo.AuthRow DROP CONSTRAINT FK_AuthRow_Screen CREATE TABLE dbo.Tmp_AuthRow (AllowAdd char(1) NOT NULL, AllowDel char(1) NOT NULL, AllowSel char(1) NOT NULL, AllowUpd char(1) NOT NULL, AuthRowId numeric (10,0) NOT NULL, RowAuthorityId numeric (3,0) NOT NULL, ScreenId numeric (10,0) NOT NULL, SelAgent char(1) NOT NULL, SelBroker char(1) NOT NULL, SelCompany char(1) NOT NULL, SelCulture char(1) NOT NULL, SelCustomer char(1) NOT NULL, SelInvestor char(1) NOT NULL, SelMember char(1) NOT NULL, SelUsr char(1) NOT NULL, SelUsrGroup char(1) NOT NULL, SelVendor char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_AuthRow (AllowAdd, AllowDel, AllowSel, AllowUpd, AuthRowId, RowAuthorityId, ScreenId, SelAgent, SelBroker, SelCompany, SelCulture, SelCustomer, SelInvestor, SelMember, SelUsr, SelUsrGroup, SelVendor) SELECT AllowAdd, AllowDel, AllowSel, AllowUpd, AuthRowId, RowAuthorityId, ScreenId, SelAgent, SelBroker, SelCompany, SelCulture, SelCustomer, SelInvestor, SelMember, SelUsr, SelUsrGroup, SelVendor FROM dbo.AuthRow IF (SELECT COUNT(1) FROM dbo.Tmp_AuthRow) > 0 OR (SELECT COUNT(1) FROM dbo.AuthRow) = 0 DROP TABLE dbo.AuthRow') EXEC (' CREATE TABLE dbo.AuthRow (AuthRowId numeric (10,0) IDENTITY NOT NULL, ScreenId numeric (10,0) NOT NULL, RowAuthorityId numeric (3,0) NOT NULL, AllowSel Char(1) NOT NULL, AllowAdd Char(1) NOT NULL, AllowUpd Char(1) NOT NULL, AllowDel Char(1) NOT NULL, SelUsr Char(1) NOT NULL, SelUsrGroup Char(1) NOT NULL, SelCulture Char(1) NOT NULL, SelCompany Char(1) NOT NULL, SelAgent Char(1) NOT NULL, SelBroker Char(1) NOT NULL, SelCustomer Char(1) NOT NULL, SelInvestor Char(1) NOT NULL, SelMember Char(1) NOT NULL, SelVendor Char(1) NOT NULL, SelProject Char(1) NOT NULL, CONSTRAINT PK_AuthRow PRIMARY KEY CLUSTERED (AuthRowId))') EXEC (' ALTER TABLE dbo.AuthRow ADD CONSTRAINT DF_AuthRow_SelProject DEFAULT (''S'') FOR SelProject SET IDENTITY_INSERT dbo.AuthRow ON INSERT INTO dbo.AuthRow (AuthRowId, ScreenId, RowAuthorityId, AllowSel, AllowAdd, AllowUpd, AllowDel, SelUsr, SelUsrGroup, SelCulture, SelCompany, SelAgent, SelBroker, SelCustomer, SelInvestor, SelMember, SelVendor, SelProject) SELECT AuthRowId, ScreenId, RowAuthorityId, AllowSel, AllowAdd, AllowUpd, AllowDel, SelUsr, SelUsrGroup, SelCulture, SelCompany, SelAgent, SelBroker, SelCustomer, SelInvestor, SelMember, SelVendor, ''S'' FROM dbo.Tmp_AuthRow SET IDENTITY_INSERT dbo.AuthRow OFF IF (SELECT COUNT(1) FROM dbo.AuthRow) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AuthRow) = 0 DROP TABLE dbo.Tmp_AuthRow CREATE  UNIQUE NONCLUSTERED INDEX IX_AuthRow_ScreenId ON dbo.AuthRow (ScreenId,RowAuthorityId) ALTER TABLE dbo.AuthRow  ADD CONSTRAINT FK_AuthRow_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=168&typ=N&sys=3","","",""); return false;
169~@~   2.  34.70711:D:   50:*:*:S: Add column ProjectId to table CtRowAuthority~@~65~@~50~@~D~@~~@~~@~S~@~~@~Add column ProjectId to table CtRowAuthority~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_CtRowAuthority (AllowAdd char(1) NOT NULL, AllowDel char(1) NOT NULL, AllowSel char(1) NOT NULL, AllowUpd char(1) NOT NULL, OvrideId numeric (5,0) NULL, RowAuthorityDesc varchar(50) NOT NULL, RowAuthorityId numeric (5,0) NOT NULL, SelAgent char(1) NOT NULL, SelBroker char(1) NOT NULL, SelCompany char(1) NOT NULL, SelCulture char(1) NOT NULL, SelCustomer char(1) NOT NULL, SelInvestor char(1) NOT NULL, SelMember char(1) NOT NULL, SelUsr char(1) NOT NULL, SelUsrGroup char(1) NOT NULL, SelVendor char(1) NOT NULL, SysAdmin char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_CtRowAuthority (AllowAdd, AllowDel, AllowSel, AllowUpd, OvrideId, RowAuthorityDesc, RowAuthorityId, SelAgent, SelBroker, SelCompany, SelCulture, SelCustomer, SelInvestor, SelMember, SelUsr, SelUsrGroup, SelVendor, SysAdmin) SELECT AllowAdd, AllowDel, AllowSel, AllowUpd, OvrideId, RowAuthorityDesc, RowAuthorityId, SelAgent, SelBroker, SelCompany, SelCulture, SelCustomer, SelInvestor, SelMember, SelUsr, SelUsrGroup, SelVendor, SysAdmin FROM dbo.CtRowAuthority IF (SELECT COUNT(1) FROM dbo.Tmp_CtRowAuthority) > 0 OR (SELECT COUNT(1) FROM dbo.CtRowAuthority) = 0 DROP TABLE dbo.CtRowAuthority') EXEC (' CREATE TABLE dbo.CtRowAuthority (RowAuthorityId numeric (5,0) IDENTITY NOT NULL, RowAuthorityDesc VarChar(50) NOT NULL, AllowSel Char(1) NOT NULL, AllowAdd Char(1) NOT NULL, AllowUpd Char(1) NOT NULL, AllowDel Char(1) NOT NULL, SysAdmin Char(1) NOT NULL, OvrideId numeric (5,0) NULL, SelUsr Char(1) NOT NULL, SelUsrGroup Char(1) NOT NULL, SelCulture Char(1) NOT NULL, SelCompany Char(1) NOT NULL, SelAgent Char(1) NOT NULL, SelBroker Char(1) NOT NULL, SelCustomer Char(1) NOT NULL, SelInvestor Char(1) NOT NULL, SelMember Char(1) NOT NULL, SelVendor Char(1) NOT NULL, SelProject Char(1) NOT NULL, CONSTRAINT PK_CtRowAuthority PRIMARY KEY CLUSTERED (RowAuthorityId))') EXEC (' ALTER TABLE dbo.CtRowAuthority ADD CONSTRAINT DF_CtRowAuthority_SelProject DEFAULT (''S'') FOR SelProject SET IDENTITY_INSERT dbo.CtRowAuthority ON INSERT INTO dbo.CtRowAuthority (RowAuthorityId, RowAuthorityDesc, AllowSel, AllowAdd, AllowUpd, AllowDel, SysAdmin, OvrideId, SelUsr, SelUsrGroup, SelCulture, SelCompany, SelAgent, SelBroker, SelCustomer, SelInvestor, SelMember, SelVendor, SelProject) SELECT RowAuthorityId, RowAuthorityDesc, AllowSel, AllowAdd, AllowUpd, AllowDel, SysAdmin, OvrideId, SelUsr, SelUsrGroup, SelCulture, SelCompany, SelAgent, SelBroker, SelCustomer, SelInvestor, SelMember, SelVendor, ''S'' FROM dbo.Tmp_CtRowAuthority SET IDENTITY_INSERT dbo.CtRowAuthority OFF IF (SELECT COUNT(1) FROM dbo.CtRowAuthority) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtRowAuthority) = 0 DROP TABLE dbo.Tmp_CtRowAuthority')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=169&typ=N&sys=3","","",""); return false;
170~@~   2.  34.70711:D:   70:*:*:*: Update table AuthRow~@~65~@~70~@~D~@~~@~~@~~@~~@~Update table AuthRow~@~Y~@~EXEC ('UPDATE dbo.AuthRow SET SelProject = SelVendor')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=170&typ=N&sys=3","","",""); return false;
171~@~   2.  34.70711:D:   80:*:*:*: Update table CtRowAuthority~@~65~@~80~@~D~@~~@~~@~~@~~@~Update table CtRowAuthority~@~N~@~EXEC ('UPDATE dbo.CtRowAuthority SET SelProject = SelVendor')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=171&typ=N&sys=3","","",""); return false;
172~@~   2.  35.70717:D:   10:*:*:M: Add table CtUnit~@~68~@~10~@~D~@~~@~~@~M~@~~@~Add table CtUnit~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'CtUnit')
BEGIN
EXEC ('CREATE TABLE dbo.CtUnit (UnitCd Char(2) NOT NULL, UnitDesc NVarChar(50) NOT NULL, UnitRef NVarChar(100) NULL, UnitOrder tinyint NOT NULL
, CONSTRAINT PK_CtUnit PRIMARY KEY CLUSTERED (UnitCd))')
EXEC ('INSERT dbo.CtUnit VALUES (''cm'', ''Centimeters'', ''1 centimeter = 10 millimeters'', 20)
 INSERT dbo.CtUnit VALUES (''mm'', ''Millimeters'', ''1 millimeter = 1/10 centimeter'', 30)
 INSERT dbo.CtUnit VALUES (''in'', ''Inches'', ''1 inch = 2.54 centimeters'', 10)
 INSERT dbo.CtUnit VALUES (''pt'', ''Points'', ''1 point = 1/72 inch'', 40)
 INSERT dbo.CtUnit VALUES (''pc'', ''Picas'', ''1 pica = 12 points'', 50)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=172&typ=N&sys=3","","",""); return false;
173~@~   2.  35.70717:D:   20:*:*:M: Add table UsrProject~@~68~@~20~@~D~@~~@~~@~M~@~~@~Add table UsrProject~@~N~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrProject'')) CREATE TABLE dbo.UsrProject (UsrProjectId Int IDENTITY NOT NULL, UsrId Int NOT NULL, ProjectId SmallInt NOT NULL, RowAuthorityId SmallInt NULL, CONSTRAINT PK_UsrProject PRIMARY KEY CLUSTERED (UsrProjectId))') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=173&typ=N&sys=3","","",""); return false;
174~@~   2.  35.70717:D:   30:*:*:M: Add column PrjListVisible to table UsrPref~@~68~@~30~@~D~@~~@~~@~M~@~~@~Add column PrjListVisible to table UsrPref~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_UsrPref (AgentId int NULL, BrokerId int NULL, ComListVisible char(1) NOT NULL, CompanyId smallint NULL, CustomerId int NULL, InvestorId int NULL, LoginBannerImg varchar(100) NULL, LoginLink1Href varchar(100) NULL, LoginLink1Text nvarchar(20) NULL, LoginLink2Href varchar(100) NULL, LoginLink2Text nvarchar(20) NULL, LoginLink3Href varchar(100) NULL, LoginLink3Text nvarchar(20) NULL, LoginLink4Href varchar(100) NULL, LoginLink4Text nvarchar(20) NULL, LogoBannerImg varchar(100) NULL, MemberId int NULL, MenuAd1Href varchar(100) NULL, MenuAd1Img varchar(100) NULL, MenuAd2Href varchar(100) NULL, MenuAd2Img varchar(100) NULL, MenuOption char(1) NOT NULL, PageBannerImg varchar(100) NULL, PageLink1Href varchar(100) NULL, PageLink1Text nvarchar(20) NULL, PageLink2Href varchar(100) NULL, PageLink2Text nvarchar(20) NULL, PrefDefault char(1) NOT NULL, ProjectId smallint NULL, SplashImg varchar(100) NULL, SysListVisible char(1) NOT NULL, SystemId tinyint NULL, UsrGroupId smallint NULL, UsrId int NULL, UsrPrefDesc nvarchar(50) NOT NULL, UsrPrefId int NOT NULL, UsrStyleSheet text NULL, VendorId int NULL)') EXEC (' INSERT INTO dbo.Tmp_UsrPref (AgentId, BrokerId, ComListVisible, CompanyId, CustomerId, InvestorId, LoginBannerImg, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, LogoBannerImg, MemberId, MenuAd1Href, MenuAd1Img, MenuAd2Href, MenuAd2Img, MenuOption, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, PrefDefault, ProjectId, SplashImg, SysListVisible, SystemId, UsrGroupId, UsrId, UsrPrefDesc, UsrPrefId, UsrStyleSheet, VendorId) SELECT AgentId, BrokerId, ComListVisible, CompanyId, CustomerId, InvestorId, LoginBannerImg, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, LogoBannerImg, MemberId, MenuAd1Href, MenuAd1Img, MenuAd2Href, MenuAd2Img, MenuOption, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, PrefDefault, ProjectId, SplashImg, SysListVisible, SystemId, UsrGroupId, UsrId, UsrPrefDesc, UsrPrefId, UsrStyleSheet, VendorId FROM dbo.UsrPref IF (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.UsrPref) = 0 DROP TABLE dbo.UsrPref') EXEC (' CREATE TABLE dbo.UsrPref (UsrPrefId Int IDENTITY NOT NULL, UsrId Int NULL, UsrGroupId SmallInt NULL, CompanyId SmallInt NULL, MemberId Int NULL, AgentId Int NULL, BrokerId Int NULL, CustomerId Int NULL, InvestorId Int NULL, VendorId Int NULL, ProjectId SmallInt NULL, SystemId TinyInt NULL, PrefDefault Char(1) NOT NULL, UsrPrefDesc NVarChar(50) NOT NULL, SysListVisible Char(1) NOT NULL, ComListVisible Char(1) NOT NULL, PrjListVisible Char(1) NOT NULL, MenuOption Char(1) NOT NULL, LoginBannerImg VarChar(100) NULL, LogoBannerImg VarChar(100) NULL, PageBannerImg VarChar(100) NULL, PageLink1Href VarChar(100) NULL, PageLink1Text NVarChar(20) NULL, PageLink2Href VarChar(100) NULL, PageLink2Text NVarChar(20) NULL, LoginLink1Href VarChar(100) NULL, LoginLink1Text NVarChar(20) NULL, LoginLink2Href VarChar(100) NULL, LoginLink2Text NVarChar(20) NULL, LoginLink3Href VarChar(100) NULL, LoginLink3Text NVarChar(20) NULL, LoginLink4Href VarChar(100) NULL, LoginLink4Text NVarChar(20) NULL, UsrStyleSheet Text NULL, MenuAd1Img VarChar(100) NULL, MenuAd1Href VarChar(100) NULL, MenuAd2Img VarChar(100) NULL, MenuAd2Href VarChar(100) NULL, SplashImg VarChar(100) NULL, CONSTRAINT PK_UsrPref PRIMARY KEY CLUSTERED (UsrPrefId))') EXEC (' ALTER TABLE dbo.UsrPref ADD CONSTRAINT DF_UsrPref_PrjListVisible DEFAULT (''N'') FOR PrjListVisible SET IDENTITY_INSERT dbo.UsrPref ON INSERT INTO dbo.UsrPref (UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOption, LoginBannerImg, LogoBannerImg, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, UsrStyleSheet, MenuAd1Img, MenuAd1Href, MenuAd2Img, MenuAd2Href, SplashImg) SELECT UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, ''N'', MenuOption, LoginBannerImg, LogoBannerImg, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, UsrStyleSheet, MenuAd1Img, MenuAd1Href, MenuAd2Img, MenuAd2Href, SplashImg FROM dbo.Tmp_UsrPref SET IDENTITY_INSERT dbo.UsrPref OFF IF (SELECT COUNT(1) FROM dbo.UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) = 0 DROP TABLE dbo.Tmp_UsrPref CREATE  UNIQUE NONCLUSTERED INDEX IX_UsrPref_UsrPrefDesc ON dbo.UsrPref (UsrPrefDesc)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=174&typ=N&sys=3","","",""); return false;
175~@~   2.  35.70717:D:   40:*:*:M: Remove column ProjectId from table Usr~@~68~@~40~@~D~@~~@~~@~M~@~~@~Remove column ProjectId from table Usr~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_Usr (Active char(1) NOT NULL, AgentId int NULL, BrokerId int NULL, CompanyId smallint NULL, ConfirmPwd varbinary(32) NULL, CustomerId int NULL, DefCompanyId smallint NULL, DefSystemId tinyint NOT NULL, ExtPassword varbinary(255) NULL, FailedAttempt tinyint NULL, FailedAttemptFP tinyint NULL, HintAnswer nvarchar(50) NULL, HintQuestionId tinyint NULL, InvestorId int NULL, LastFailedDt datetime NULL, LastSuccessDt datetime NULL, LoginName nvarchar(32) NOT NULL, MemberId int NULL, ModifiedOn datetime NOT NULL, ProjectId smallint NULL, UsrEmail nvarchar(50) NULL, UsrGroupId smallint NOT NULL, UsrId int NOT NULL, UsrName nvarchar(50) NULL, UsrPassword varbinary(32) NULL, VendorId int NULL)') EXEC (' INSERT INTO dbo.Tmp_Usr (Active, AgentId, BrokerId, CompanyId, ConfirmPwd, CustomerId, DefCompanyId, DefSystemId, ExtPassword, FailedAttempt, FailedAttemptFP, HintAnswer, HintQuestionId, InvestorId, LastFailedDt, LastSuccessDt, LoginName, MemberId, ModifiedOn, ProjectId, UsrEmail, UsrGroupId, UsrId, UsrName, UsrPassword, VendorId) SELECT Active, AgentId, BrokerId, CompanyId, ConfirmPwd, CustomerId, DefCompanyId, DefSystemId, ExtPassword, FailedAttempt, FailedAttemptFP, HintAnswer, HintQuestionId, InvestorId, LastFailedDt, LastSuccessDt, LoginName, MemberId, ModifiedOn, ProjectId, UsrEmail, UsrGroupId, UsrId, UsrName, UsrPassword, VendorId FROM dbo.Usr IF (SELECT COUNT(1) FROM dbo.Tmp_Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Usr) = 0 DROP TABLE dbo.Usr') EXEC (' CREATE TABLE dbo.Usr (UsrId Int IDENTITY NOT NULL, LoginName NVarChar(32) NOT NULL, UsrEmail NVarChar(50) NULL, UsrName NVarChar(50) NULL, UsrPassword VarBinary(32) NULL, ConfirmPwd VarBinary(32) NULL, ExtPassword VarBinary(255) NULL, UsrGroupId SmallInt NOT NULL, CompanyId SmallInt NULL, InvestorId Int NULL, CustomerId Int NULL, VendorId Int NULL, AgentId Int NULL, BrokerId Int NULL, MemberId Int NULL, DefSystemId TinyInt NOT NULL, DefProjectId SmallInt NULL, DefCompanyId SmallInt NULL, FailedAttempt TinyInt NULL, FailedAttemptFP TinyInt NULL, LastFailedDt DateTime NULL, LastSuccessDt DateTime NULL, HintQuestionId TinyInt NULL, HintAnswer NVarChar(50) NULL, Active Char(1) NOT NULL, ModifiedOn DateTime NOT NULL, CONSTRAINT PK_Usr PRIMARY KEY CLUSTERED (UsrId))') EXEC (' SET IDENTITY_INSERT dbo.Usr ON INSERT INTO dbo.Usr (UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, UsrGroupId, CompanyId, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, HintQuestionId, HintAnswer, Active, ModifiedOn) SELECT UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, UsrGroupId, CompanyId, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, HintQuestionId, HintAnswer, Active, ModifiedOn FROM dbo.Tmp_Usr SET IDENTITY_INSERT dbo.Usr OFF IF (SELECT COUNT(1) FROM dbo.Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Usr) = 0 DROP TABLE dbo.Tmp_Usr CREATE  NONCLUSTERED INDEX IX_Usr_UsrName ON dbo.Usr (UsrName) CREATE  UNIQUE NONCLUSTERED INDEX IX_Usr_LoginName ON dbo.Usr (LoginName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=175&typ=N&sys=3","","",""); return false;
176~@~   2.  35.70717:D:   10:*:*:S: Add table CtUnit~@~68~@~10~@~D~@~~@~~@~S~@~~@~Add table CtUnit~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'CtUnit')
BEGIN
EXEC ('CREATE TABLE dbo.CtUnit (UnitCd Char(2) NOT NULL, UnitDesc NVarChar(50) NOT NULL, UnitRef NVarChar(100) NULL, UnitOrder numeric (3,0) NOT NULL
, CONSTRAINT PK_CtUnit PRIMARY KEY CLUSTERED (UnitCd))')
EXEC ('INSERT dbo.CtUnit VALUES (''cm'', ''Centimeters'', ''1 centimeter = 10 millimeters'', 20)
 INSERT dbo.CtUnit VALUES (''mm'', ''Millimeters'', ''1 millimeter = 1/10 centimeter'', 30)
 INSERT dbo.CtUnit VALUES (''in'', ''Inches'', ''1 inch = 2.54 centimeters'', 10)
 INSERT dbo.CtUnit VALUES (''pt'', ''Points'', ''1 point = 1/72 inch'', 40)
 INSERT dbo.CtUnit VALUES (''pc'', ''Picas'', ''1 pica = 12 points'', 50)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=176&typ=N&sys=3","","",""); return false;
177~@~   2.  35.70717:D:   20:*:*:S: Add table UsrProject~@~68~@~20~@~D~@~~@~~@~S~@~~@~Add table UsrProject~@~N~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrProject'')) CREATE TABLE dbo.UsrProject (UsrProjectId numeric (10,0) IDENTITY NOT NULL, UsrId numeric (10,0) NOT NULL, ProjectId numeric (5,0) NOT NULL, RowAuthorityId numeric (5,0) NULL, CONSTRAINT PK_UsrProject PRIMARY KEY CLUSTERED (UsrProjectId))') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=177&typ=N&sys=3","","",""); return false;
178~@~   2.  35.70717:D:   30:*:*:S: Add column PrjListVisible to table UsrPref~@~68~@~30~@~D~@~~@~~@~S~@~~@~Add column PrjListVisible to table UsrPref~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_UsrPref (AgentId numeric (10,0) NULL, BrokerId numeric (10,0) NULL, ComListVisible char(1) NOT NULL, CompanyId numeric (5,0) NULL, CustomerId numeric (10,0) NULL, InvestorId numeric (10,0) NULL, LoginBannerImg varchar(100) NULL, LoginLink1Href varchar(100) NULL, LoginLink1Text nvarchar(20) NULL, LoginLink2Href varchar(100) NULL, LoginLink2Text nvarchar(20) NULL, LoginLink3Href varchar(100) NULL, LoginLink3Text nvarchar(20) NULL, LoginLink4Href varchar(100) NULL, LoginLink4Text nvarchar(20) NULL, LogoBannerImg varchar(100) NULL, MemberId numeric (10,0) NULL, MenuAd1Href varchar(100) NULL, MenuAd1Img varchar(100) NULL, MenuAd2Href varchar(100) NULL, MenuAd2Img varchar(100) NULL, MenuOption char(1) NOT NULL, PageBannerImg varchar(100) NULL, PageLink1Href varchar(100) NULL, PageLink1Text nvarchar(20) NULL, PageLink2Href varchar(100) NULL, PageLink2Text nvarchar(20) NULL, PrefDefault char(1) NOT NULL, ProjectId numeric (5,0) NULL, SplashImg varchar(100) NULL, SysListVisible char(1) NOT NULL, SystemId numeric (3,0) NULL, UsrGroupId numeric (5,0) NULL, UsrId numeric (10,0) NULL, UsrPrefDesc nvarchar(50) NOT NULL, UsrPrefId numeric (10,0) NOT NULL, UsrStyleSheet text NULL, VendorId numeric (10,0) NULL)') EXEC (' INSERT INTO dbo.Tmp_UsrPref (AgentId, BrokerId, ComListVisible, CompanyId, CustomerId, InvestorId, LoginBannerImg, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, LogoBannerImg, MemberId, MenuAd1Href, MenuAd1Img, MenuAd2Href, MenuAd2Img, MenuOption, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, PrefDefault, ProjectId, SplashImg, SysListVisible, SystemId, UsrGroupId, UsrId, UsrPrefDesc, UsrPrefId, UsrStyleSheet, VendorId) SELECT AgentId, BrokerId, ComListVisible, CompanyId, CustomerId, InvestorId, LoginBannerImg, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, LogoBannerImg, MemberId, MenuAd1Href, MenuAd1Img, MenuAd2Href, MenuAd2Img, MenuOption, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, PrefDefault, ProjectId, SplashImg, SysListVisible, SystemId, UsrGroupId, UsrId, UsrPrefDesc, UsrPrefId, UsrStyleSheet, VendorId FROM dbo.UsrPref IF (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.UsrPref) = 0 DROP TABLE dbo.UsrPref') EXEC (' CREATE TABLE dbo.UsrPref (UsrPrefId numeric (10,0) IDENTITY NOT NULL, UsrId numeric (10,0) NULL, UsrGroupId numeric (5,0) NULL, CompanyId numeric (5,0) NULL, MemberId numeric (10,0) NULL, AgentId numeric (10,0) NULL, BrokerId numeric (10,0) NULL, CustomerId numeric (10,0) NULL, InvestorId numeric (10,0) NULL, VendorId numeric (10,0) NULL, ProjectId numeric (5,0) NULL, SystemId numeric (3,0) NULL, PrefDefault Char(1) NOT NULL, UsrPrefDesc NVarChar(50) NOT NULL, SysListVisible Char(1) NOT NULL, ComListVisible Char(1) NOT NULL, PrjListVisible Char(1) NOT NULL, MenuOption Char(1) NOT NULL, LoginBannerImg VarChar(100) NULL, LogoBannerImg VarChar(100) NULL, PageBannerImg VarChar(100) NULL, PageLink1Href VarChar(100) NULL, PageLink1Text NVarChar(20) NULL, PageLink2Href VarChar(100) NULL, PageLink2Text NVarChar(20) NULL, LoginLink1Href VarChar(100) NULL, LoginLink1Text NVarChar(20) NULL, LoginLink2Href VarChar(100) NULL, LoginLink2Text NVarChar(20) NULL, LoginLink3Href VarChar(100) NULL, LoginLink3Text NVarChar(20) NULL, LoginLink4Href VarChar(100) NULL, LoginLink4Text NVarChar(20) NULL, UsrStyleSheet Text NULL, MenuAd1Img VarChar(100) NULL, MenuAd1Href VarChar(100) NULL, MenuAd2Img VarChar(100) NULL, MenuAd2Href VarChar(100) NULL, SplashImg VarChar(100) NULL, CONSTRAINT PK_UsrPref PRIMARY KEY CLUSTERED (UsrPrefId))') EXEC (' ALTER TABLE dbo.UsrPref ADD CONSTRAINT DF_UsrPref_PrjListVisible DEFAULT (''N'') FOR PrjListVisible SET IDENTITY_INSERT dbo.UsrPref ON INSERT INTO dbo.UsrPref (UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOption, LoginBannerImg, LogoBannerImg, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, UsrStyleSheet, MenuAd1Img, MenuAd1Href, MenuAd2Img, MenuAd2Href, SplashImg) SELECT UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, ''N'', MenuOption, LoginBannerImg, LogoBannerImg, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, UsrStyleSheet, MenuAd1Img, MenuAd1Href, MenuAd2Img, MenuAd2Href, SplashImg FROM dbo.Tmp_UsrPref SET IDENTITY_INSERT dbo.UsrPref OFF IF (SELECT COUNT(1) FROM dbo.UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) = 0 DROP TABLE dbo.Tmp_UsrPref CREATE  UNIQUE NONCLUSTERED INDEX IX_UsrPref_UsrPrefDesc ON dbo.UsrPref (UsrPrefDesc)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=178&typ=N&sys=3","","",""); return false;
179~@~   2.  35.70717:D:   40:*:*:S: Remove column ProjectId from table Usr~@~68~@~40~@~D~@~~@~~@~S~@~~@~Remove column ProjectId from table Usr~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_Usr (Active char(1) NOT NULL, AgentId numeric (10,0) NULL, BrokerId numeric (10,0) NULL, CompanyId numeric (5,0) NULL, ConfirmPwd varbinary(32) NULL, CustomerId numeric (10,0) NULL, DefCompanyId numeric (5,0) NULL, DefSystemId numeric (3,0) NOT NULL, ExtPassword varbinary(255) NULL, FailedAttempt numeric (3,0) NULL, FailedAttemptFP numeric (3,0) NULL, HintAnswer nvarchar(50) NULL, HintQuestionId numeric (3,0) NULL, InvestorId numeric (10,0) NULL, LastFailedDt datetime NULL, LastSuccessDt datetime NULL, LoginName nvarchar(32) NOT NULL, MemberId numeric (10,0) NULL, ModifiedOn datetime NOT NULL, ProjectId numeric (5,0) NULL, UsrEmail nvarchar(50) NULL, UsrGroupId numeric (5,0) NOT NULL, UsrId numeric (10,0) NOT NULL, UsrName nvarchar(50) NULL, UsrPassword varbinary(32) NULL, VendorId numeric (10,0) NULL)') EXEC (' INSERT INTO dbo.Tmp_Usr (Active, AgentId, BrokerId, CompanyId, ConfirmPwd, CustomerId, DefCompanyId, DefSystemId, ExtPassword, FailedAttempt, FailedAttemptFP, HintAnswer, HintQuestionId, InvestorId, LastFailedDt, LastSuccessDt, LoginName, MemberId, ModifiedOn, ProjectId, UsrEmail, UsrGroupId, UsrId, UsrName, UsrPassword, VendorId) SELECT Active, AgentId, BrokerId, CompanyId, ConfirmPwd, CustomerId, DefCompanyId, DefSystemId, ExtPassword, FailedAttempt, FailedAttemptFP, HintAnswer, HintQuestionId, InvestorId, LastFailedDt, LastSuccessDt, LoginName, MemberId, ModifiedOn, ProjectId, UsrEmail, UsrGroupId, UsrId, UsrName, UsrPassword, VendorId FROM dbo.Usr IF (SELECT COUNT(1) FROM dbo.Tmp_Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Usr) = 0 DROP TABLE dbo.Usr') EXEC (' CREATE TABLE dbo.Usr (UsrId numeric (10,0) IDENTITY NOT NULL, LoginName NVarChar(32) NOT NULL, UsrEmail NVarChar(50) NULL, UsrName NVarChar(50) NULL, UsrPassword VarBinary(32) NULL, ConfirmPwd VarBinary(32) NULL, ExtPassword VarBinary(255) NULL, UsrGroupId numeric (5,0) NOT NULL, CompanyId numeric (5,0) NULL, InvestorId numeric (10,0) NULL, CustomerId numeric (10,0) NULL, VendorId numeric (10,0) NULL, AgentId numeric (10,0) NULL, BrokerId numeric (10,0) NULL, MemberId numeric (10,0) NULL, DefSystemId numeric (3,0) NOT NULL, DefProjectId numeric (5,0) NULL, DefCompanyId numeric (5,0) NULL, FailedAttempt numeric (3,0) NULL, FailedAttemptFP numeric (3,0) NULL, LastFailedDt DateTime NULL, LastSuccessDt DateTime NULL, HintQuestionId numeric (3,0) NULL, HintAnswer NVarChar(50) NULL, Active Char(1) NOT NULL, ModifiedOn DateTime NOT NULL, CONSTRAINT PK_Usr PRIMARY KEY CLUSTERED (UsrId))') EXEC (' SET IDENTITY_INSERT dbo.Usr ON INSERT INTO dbo.Usr (UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, UsrGroupId, CompanyId, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, HintQuestionId, HintAnswer, Active, ModifiedOn) SELECT UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, UsrGroupId, CompanyId, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, HintQuestionId, HintAnswer, Active, ModifiedOn FROM dbo.Tmp_Usr SET IDENTITY_INSERT dbo.Usr OFF IF (SELECT COUNT(1) FROM dbo.Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Usr) = 0 DROP TABLE dbo.Tmp_Usr CREATE  NONCLUSTERED INDEX IX_Usr_UsrName ON dbo.Usr (UsrName) CREATE  UNIQUE NONCLUSTERED INDEX IX_Usr_LoginName ON dbo.Usr (LoginName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=179&typ=N&sys=3","","",""); return false;
181~@~   2.  35.70717:D:   50:*:*:*: Update table CtPermKey~@~68~@~50~@~D~@~~@~~@~~@~~@~Update table CtPermKey~@~N~@~UPDATE dbo.CtPermKey SET AndCondition = 'Y' WHERE CtPermKeyName = 'ProjectId'~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=181&typ=N&sys=3","","",""); return false;
182~@~   2.  36.70731:D:   10:*:*:M: Add flag SqlRptSrv to table Report~@~69~@~10~@~D~@~~@~~@~M~@~~@~Add flag SqlRptSrv to table Report~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportCri_Report'') ALTER TABLE dbo.ReportCri DROP CONSTRAINT FK_ReportCri_Report IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportObj_Report'') ALTER TABLE dbo.ReportObj DROP CONSTRAINT FK_ReportObj_Report CREATE TABLE dbo.Tmp_Report (CopyReportId int NULL, GenerateRp char(1) NOT NULL, GlobalCriteria char(1) NOT NULL, PrintPortrait char(1) NOT NULL, ProgramName varchar(20) NOT NULL, RegClause varchar(400) NULL, ReportDesc nvarchar(50) NULL, ReportId int NOT NULL, TemplateName varchar(50) NULL, ToXlsOnly char(1) NOT NULL, UpdClause varchar(200) NULL, WhereClause varchar(1000) NULL, XlsClause varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_Report (CopyReportId, GenerateRp, GlobalCriteria, PrintPortrait, ProgramName, RegClause, ReportDesc, ReportId, TemplateName, ToXlsOnly, UpdClause, WhereClause, XlsClause) SELECT CopyReportId, GenerateRp, GlobalCriteria, PrintPortrait, ProgramName, RegClause, ReportDesc, ReportId, TemplateName, ToXlsOnly, UpdClause, WhereClause, XlsClause FROM dbo.Report IF (SELECT COUNT(1) FROM dbo.Tmp_Report) > 0 OR (SELECT COUNT(1) FROM dbo.Report) = 0 DROP TABLE dbo.Report') EXEC (' CREATE TABLE dbo.Report (ReportId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ReportDesc NVarChar(50) NULL, GlobalCriteria Char(1) NOT NULL, PrintPortrait Char(1) NOT NULL, ToXlsOnly Char(1) NOT NULL, TemplateName VarChar(50) NULL, SqlRptSrv Char(1) NOT NULL, CopyReportId Int NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, UpdClause VarChar(200) NULL, XlsClause VarChar(200) NULL, GenerateRp Char(1) NOT NULL, CONSTRAINT PK_Report PRIMARY KEY CLUSTERED (ReportId))') EXEC (' ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_SqlRptSrv DEFAULT (''N'') FOR SqlRptSrv SET IDENTITY_INSERT dbo.Report ON INSERT INTO dbo.Report (ReportId, ProgramName, ReportDesc, GlobalCriteria, PrintPortrait, ToXlsOnly, TemplateName, SqlRptSrv, CopyReportId, WhereClause, RegClause, UpdClause, XlsClause, GenerateRp) SELECT ReportId, ProgramName, ReportDesc, GlobalCriteria, PrintPortrait, ToXlsOnly, TemplateName, ''N'', CopyReportId, WhereClause, RegClause, UpdClause, XlsClause, GenerateRp FROM dbo.Tmp_Report SET IDENTITY_INSERT dbo.Report OFF IF (SELECT COUNT(1) FROM dbo.Report) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Report) = 0 DROP TABLE dbo.Tmp_Report CREATE  UNIQUE NONCLUSTERED INDEX IX_Report_ProgramName ON dbo.Report (ProgramName) ALTER TABLE dbo.ReportCri WITH NOCHECK ADD CONSTRAINT FK_ReportCri_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId) ALTER TABLE dbo.ReportObj WITH NOCHECK ADD CONSTRAINT FK_ReportObj_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=182&typ=N&sys=3","","",""); return false;
183~@~   2.  36.70731:D:   20:*:*:M: Add table CtRptObjType~@~69~@~20~@~D~@~~@~~@~M~@~~@~Add table CtRptObjType~@~N~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtRptObjType'')) CREATE TABLE dbo.CtRptObjType (RptObjTypeCd Char(1) NOT NULL, RptObjTypeName NVarChar(10) NOT NULL, CONSTRAINT PK_CtRptObjType PRIMARY KEY CLUSTERED (RptObjTypeCd))')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.CtRptObjType) INSERT dbo.CtRptObjType VALUES (''P'',''Parameter'') INSERT dbo.CtRptObjType VALUES (''F'',''Field'')')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=183&typ=N&sys=3","","",""); return false;
184~@~   2.  36.70731:D:   30:*:*:M: Add column RptObjTypeCd to table ReportObj~@~69~@~30~@~D~@~~@~~@~M~@~~@~Add column RptObjTypeCd to table ReportObj~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportObj_Report'') ALTER TABLE dbo.ReportObj DROP CONSTRAINT FK_ReportObj_Report CREATE TABLE dbo.Tmp_ReportObj (ColumnDesc varchar(100) NULL, ColumnFormat varchar(20) NULL, ColumnName varchar(20) NOT NULL, DataTypeId tinyint NOT NULL, OperatorId tinyint NULL, PaddChar nchar(1) NULL, PaddSize tinyint NULL, ReportCriId int NULL, ReportId int NOT NULL, ReportObjId int NOT NULL, TabIndex smallint NOT NULL)')
EXEC ('INSERT INTO dbo.Tmp_ReportObj (ColumnDesc, ColumnFormat, ColumnName, DataTypeId, OperatorId, PaddChar, PaddSize, ReportCriId, ReportId, ReportObjId, TabIndex) SELECT ColumnDesc, ColumnFormat, ColumnName, DataTypeId, OperatorId, PaddChar, PaddSize, ReportCriId, ReportId, ReportObjId, TabIndex FROM dbo.ReportObj IF (SELECT COUNT(1) FROM dbo.Tmp_ReportObj) > 0 OR (SELECT COUNT(1) FROM dbo.ReportObj) = 0 DROP TABLE dbo.ReportObj')
EXEC ('CREATE TABLE dbo.ReportObj (ReportObjId Int IDENTITY NOT NULL, ReportId Int NOT NULL, RptObjTypeCd Char(1) NOT NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(100) NULL, TabIndex SmallInt NOT NULL, ColumnFormat VarChar(20) NULL, PaddSize TinyInt NULL, PaddChar NChar(1) NULL, DataTypeId TinyInt NOT NULL, OperatorId TinyInt NULL, ReportCriId Int NULL, CONSTRAINT PK_ReportObj PRIMARY KEY CLUSTERED (ReportObjId))')
EXEC ('ALTER TABLE dbo.ReportObj ADD CONSTRAINT DF_ReportObj_RptObjTypeCd DEFAULT (''F'') FOR RptObjTypeCd SET IDENTITY_INSERT dbo.ReportObj ON INSERT INTO dbo.ReportObj (ReportObjId, ReportId, RptObjTypeCd, ColumnName, ColumnDesc, TabIndex, ColumnFormat, PaddSize, PaddChar, DataTypeId, OperatorId, ReportCriId) SELECT ReportObjId, ReportId, ''F'', ColumnName, ColumnDesc, TabIndex, ColumnFormat, PaddSize, PaddChar, DataTypeId, OperatorId, ReportCriId FROM dbo.Tmp_ReportObj SET IDENTITY_INSERT dbo.ReportObj OFF IF (SELECT COUNT(1) FROM dbo.ReportObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ReportObj) = 0 DROP TABLE dbo.Tmp_ReportObj ALTER TABLE dbo.ReportObj WITH NOCHECK ADD CONSTRAINT FK_ReportObj_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=184&typ=N&sys=3","","",""); return false;
186~@~   2.  36.70731:D:   40:*:*:M: Add code columns to table Report~@~69~@~40~@~D~@~~@~~@~M~@~~@~Add code columns to table Report~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportCri_Report'') ALTER TABLE dbo.ReportCri DROP CONSTRAINT FK_ReportCri_Report IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportObj_Report'') ALTER TABLE dbo.ReportObj DROP CONSTRAINT FK_ReportObj_Report CREATE TABLE dbo.Tmp_Report (CopyReportId int NULL, GenerateRp char(1) NOT NULL, GlobalCriteria char(1) NOT NULL, PrintPortrait char(1) NOT NULL, ProgramName varchar(20) NOT NULL, RegClause varchar(400) NULL, ReportDesc nvarchar(50) NULL, ReportId int NOT NULL, SqlRptSrv char(1) NOT NULL, TemplateName varchar(50) NULL, ToXlsOnly char(1) NOT NULL, UpdClause varchar(200) NULL, WhereClause varchar(1000) NULL, XlsClause varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_Report (CopyReportId, GenerateRp, GlobalCriteria, PrintPortrait, ProgramName, RegClause, ReportDesc, ReportId, SqlRptSrv, TemplateName, ToXlsOnly, UpdClause, WhereClause, XlsClause) SELECT CopyReportId, GenerateRp, GlobalCriteria, PrintPortrait, ProgramName, RegClause, ReportDesc, ReportId, SqlRptSrv, TemplateName, ToXlsOnly, UpdClause, WhereClause, XlsClause FROM dbo.Report IF (SELECT COUNT(1) FROM dbo.Tmp_Report) > 0 OR (SELECT COUNT(1) FROM dbo.Report) = 0 DROP TABLE dbo.Report') EXEC (' CREATE TABLE dbo.Report (ReportId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ReportDesc NVarChar(50) NULL, GlobalCriteria Char(1) NOT NULL, PrintPortrait Char(1) NOT NULL, ToXlsOnly Char(1) NOT NULL, TemplateName VarChar(50) NULL, SqlRptSrv Char(1) NOT NULL, CopyReportId Int NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, RegCode NText NULL, ValClause VarChar(400) NULL, ValCode NText NULL, UpdClause VarChar(200) NULL, UpdCode NText NULL, XlsClause VarChar(200) NULL, XlsCode NText NULL, GenerateRp Char(1) NOT NULL, CONSTRAINT PK_Report PRIMARY KEY CLUSTERED (ReportId))') EXEC (' ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_SqlRptSrv DEFAULT (''N'') FOR SqlRptSrv SET IDENTITY_INSERT dbo.Report ON INSERT INTO dbo.Report (ReportId, ProgramName, ReportDesc, GlobalCriteria, PrintPortrait, ToXlsOnly, TemplateName, SqlRptSrv, CopyReportId, WhereClause, RegClause, UpdClause, XlsClause, GenerateRp) SELECT ReportId, ProgramName, ReportDesc, GlobalCriteria, PrintPortrait, ToXlsOnly, TemplateName, SqlRptSrv, CopyReportId, WhereClause, RegClause, UpdClause, XlsClause, GenerateRp FROM dbo.Tmp_Report SET IDENTITY_INSERT dbo.Report OFF IF (SELECT COUNT(1) FROM dbo.Report) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Report) = 0 DROP TABLE dbo.Tmp_Report CREATE  UNIQUE NONCLUSTERED INDEX IX_Report_ProgramName ON dbo.Report (ProgramName) ALTER TABLE dbo.ReportCri WITH NOCHECK ADD CONSTRAINT FK_ReportCri_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId) ALTER TABLE dbo.ReportObj WITH NOCHECK ADD CONSTRAINT FK_ReportObj_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=186&typ=N&sys=3","","",""); return false;
187~@~   2.  36.70731:D:   50:*:*:M: Add tracking columns to table Report~@~69~@~50~@~D~@~~@~~@~M~@~~@~Add tracking columns to table Report~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportCri_Report'') ALTER TABLE dbo.ReportCri DROP CONSTRAINT FK_ReportCri_Report IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportObj_Report'') ALTER TABLE dbo.ReportObj DROP CONSTRAINT FK_ReportObj_Report CREATE TABLE dbo.Tmp_Report (CopyReportId int NULL, GenerateRp char(1) NOT NULL, GlobalCriteria char(1) NOT NULL, PrintPortrait char(1) NOT NULL, ProgramName varchar(20) NOT NULL, RegClause varchar(400) NULL, RegCode ntext NULL, ReportDesc nvarchar(50) NULL, ReportId int NOT NULL, SqlRptSrv char(1) NOT NULL, TemplateName varchar(50) NULL, ToXlsOnly char(1) NOT NULL, UpdClause varchar(200) NULL, UpdCode ntext NULL, ValClause varchar(400) NULL, ValCode ntext NULL, WhereClause varchar(1000) NULL, XlsClause varchar(200) NULL, XlsCode ntext NULL)') EXEC (' INSERT INTO dbo.Tmp_Report (CopyReportId, GenerateRp, GlobalCriteria, PrintPortrait, ProgramName, RegClause, RegCode, ReportDesc, ReportId, SqlRptSrv, TemplateName, ToXlsOnly, UpdClause, UpdCode, ValClause, ValCode, WhereClause, XlsClause, XlsCode) SELECT CopyReportId, GenerateRp, GlobalCriteria, PrintPortrait, ProgramName, RegClause, RegCode, ReportDesc, ReportId, SqlRptSrv, TemplateName, ToXlsOnly, UpdClause, UpdCode, ValClause, ValCode, WhereClause, XlsClause, XlsCode FROM dbo.Report IF (SELECT COUNT(1) FROM dbo.Tmp_Report) > 0 OR (SELECT COUNT(1) FROM dbo.Report) = 0 DROP TABLE dbo.Report') EXEC (' CREATE TABLE dbo.Report (ReportId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ReportDesc NVarChar(50) NULL, GlobalCriteria Char(1) NOT NULL, PrintPortrait Char(1) NOT NULL, ToXlsOnly Char(1) NOT NULL, TemplateName VarChar(50) NULL, SqlRptSrv Char(1) NOT NULL, CopyReportId Int NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, RegCode NText NULL, ValClause VarChar(400) NULL, ValCode NText NULL, UpdClause VarChar(200) NULL, UpdCode NText NULL, XlsClause VarChar(200) NULL, XlsCode NText NULL, GenerateRp Char(1) NOT NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, CONSTRAINT PK_Report PRIMARY KEY CLUSTERED (ReportId))') EXEC (' ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_SqlRptSrv DEFAULT (''N'') FOR SqlRptSrv SET IDENTITY_INSERT dbo.Report ON INSERT INTO dbo.Report (ReportId, ProgramName, ReportDesc, GlobalCriteria, PrintPortrait, ToXlsOnly, TemplateName, SqlRptSrv, CopyReportId, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp) SELECT ReportId, ProgramName, ReportDesc, GlobalCriteria, PrintPortrait, ToXlsOnly, TemplateName, SqlRptSrv, CopyReportId, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp FROM dbo.Tmp_Report SET IDENTITY_INSERT dbo.Report OFF IF (SELECT COUNT(1) FROM dbo.Report) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Report) = 0 DROP TABLE dbo.Tmp_Report CREATE  UNIQUE NONCLUSTERED INDEX IX_Report_ProgramName ON dbo.Report (ProgramName) ALTER TABLE dbo.ReportCri WITH NOCHECK ADD CONSTRAINT FK_ReportCri_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId) ALTER TABLE dbo.ReportObj WITH NOCHECK ADD CONSTRAINT FK_ReportObj_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId)')
EXEC ('UPDATE dbo.Report SET ModifiedBy=1')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=187&typ=N&sys=3","","",""); return false;
188~@~   2.  36.70731:D:   60:*:*:M: Add table CtRptCtrType~@~69~@~60~@~D~@~~@~~@~M~@~~@~Add table CtRptCtrType~@~N~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtRptCtrType'')) CREATE TABLE dbo.CtRptCtrType (RptCtrTypeCd Char(1) NOT NULL, RptCtrTypeName NVarChar(20) NOT NULL, HasChildCtr Char(1) NOT NULL, CONSTRAINT PK_CtRptCtrType PRIMARY KEY CLUSTERED (RptCtrTypeCd))')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.CtRptCtrType) INSERT dbo.CtRptCtrType VALUES (''R'',''Rectangle'',''Y'') INSERT dbo.CtRptCtrType VALUES (''X'',''Textbox'',''N'') INSERT dbo.CtRptCtrType VALUES (''N'',''Line'',''N'') INSERT dbo.CtRptCtrType VALUES (''I'',''Image'',''N'') INSERT dbo.CtRptCtrType VALUES (''C'',''Chart'',''Y'') INSERT dbo.CtRptCtrType VALUES (''T'',''Table'',''Y'') INSERT dbo.CtRptCtrType VALUES (''L'',''List'',''Y'')')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=188&typ=N&sys=3","","",""); return false;
189~@~   2.  36.70731:D:   70:*:*:M: Add table CtRptTblType~@~69~@~70~@~D~@~~@~~@~M~@~~@~Add table CtRptTblType~@~N~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtRptTblType'')) CREATE TABLE dbo.CtRptTblType (RptTblTypeCd Char(1) NOT NULL, RptTblTypeName NVarChar(20) NOT NULL, CONSTRAINT PK_CtRptTblType PRIMARY KEY CLUSTERED (RptTblTypeCd))')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.CtRptTblType) INSERT dbo.CtRptTblType VALUES (''H'',''Header'') INSERT dbo.CtRptTblType VALUES (''F'',''Footer'') INSERT dbo.CtRptTblType VALUES (''D'',''Details'') INSERT dbo.CtRptTblType VALUES (''C'',''Column'') INSERT dbo.CtRptTblType VALUES (''G'',''Group'')')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=189&typ=N&sys=3","","",""); return false;
190~@~   2.  36.70731:D:   80:*:*:M: Add table CtRptElmType~@~69~@~80~@~D~@~~@~~@~M~@~~@~Add table CtRptElmType~@~N~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtRptElmType'')) CREATE TABLE dbo.CtRptElmType (RptElmTypeCd Char(1) NOT NULL, RptElmTypeName NVarChar(20) NOT NULL, CONSTRAINT PK_CtRptElmType PRIMARY KEY CLUSTERED (RptElmTypeCd))')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.CtRptElmType) INSERT dbo.CtRptElmType VALUES (''H'',''PageHeader'') INSERT dbo.CtRptElmType VALUES (''F'',''PageFooter'') INSERT dbo.CtRptElmType VALUES (''B'',''Body'')')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=190&typ=N&sys=3","","",""); return false;
191~@~   2.  36.70731:D:   90:*:*:M: Add table RptTbl~@~69~@~90~@~D~@~~@~~@~M~@~~@~Add table RptTbl~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptTbl'')) CREATE TABLE dbo.RptTbl (RptTblId Int IDENTITY NOT NULL, RptCtrId Int NOT NULL, RptTblTypeCd Char(1) NOT NULL, TblRepeatNew Char(1) NOT NULL, TblOrder SmallInt NULL, ColWidth VarChar(10) NULL, TblGrouping VarChar(1000) NULL, TblSorting VarChar(1000) NULL, TblVisibility VarChar(1000) NULL, CONSTRAINT PK_RptTbl PRIMARY KEY CLUSTERED (RptTblId))') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=191&typ=N&sys=3","","",""); return false;
193~@~   2.  36.70731:D:  100:*:*:M: Add table RptCtr~@~69~@~100~@~D~@~~@~~@~M~@~~@~Add table RptCtr~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptCtr'')) CREATE TABLE dbo.RptCtr (RptCtrId Int IDENTITY NOT NULL, PRptCtrId Int NULL, RptElmId Int NULL, RptCelId Int NULL, ReportId Int NULL, RptCtrTypeCd Char(1) NOT NULL, RptCtrName NVarChar(20) NOT NULL, CtrStyle VarChar(1000) NULL, CtrTop VarChar(10) NULL, CtrLeft VarChar(10) NULL, CtrHeight VarChar(10) NULL, CtrWidth VarChar(10) NULL, CtrZIndex SmallInt NULL, CtrAction VarChar(1000) NULL, CtrVisibility VarChar(1000) NULL, CtrToolTip VarChar(200) NULL, CtrPgBrStart Char(1) NOT NULL, CtrPgBrEnd Char(1) NOT NULL, CtrValue VarChar(1000) NULL, CtrCanGrow Char(1) NOT NULL, CtrCanShrink Char(1) NOT NULL, CtrTogether Char(1) NOT NULL, CtrGrouping VarChar(1000) NULL, CtrSorting VarChar(1000) NULL, CONSTRAINT PK_RptCtr PRIMARY KEY CLUSTERED (RptCtrId))') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=193&typ=N&sys=3","","",""); return false;
196~@~   2.  36.70731:D:  130:*:*:M: Add column DataTypeRdlParm to table CtDataType~@~69~@~130~@~D~@~~@~~@~M~@~~@~Add column DataTypeRdlParm to table CtDataType~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_CtDataType (DataTypeDByteOle varchar(20) NOT NULL, DataTypeDesc varchar(80) NOT NULL, DataTypeId tinyint NOT NULL, DataTypeName varchar(20) NOT NULL, DataTypeSByteOle varchar(20) NOT NULL, DataTypeSqlName varchar(20) NOT NULL, DataTypeSysName varchar(20) NOT NULL, DoubleByte char(1) NOT NULL, NumericData char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_CtDataType (DataTypeDByteOle, DataTypeDesc, DataTypeId, DataTypeName, DataTypeSByteOle, DataTypeSqlName, DataTypeSysName, DoubleByte, NumericData) SELECT DataTypeDByteOle, DataTypeDesc, DataTypeId, DataTypeName, DataTypeSByteOle, DataTypeSqlName, DataTypeSysName, DoubleByte, NumericData FROM dbo.CtDataType IF (SELECT COUNT(1) FROM dbo.Tmp_CtDataType) > 0 OR (SELECT COUNT(1) FROM dbo.CtDataType) = 0 DROP TABLE dbo.CtDataType') EXEC (' CREATE TABLE dbo.CtDataType (DataTypeId TinyInt IDENTITY NOT NULL, DataTypeName VarChar(20) NOT NULL, DataTypeSqlName VarChar(20) NOT NULL, DataTypeSysName VarChar(20) NOT NULL, DataTypeSByteOle VarChar(20) NOT NULL, DataTypeDByteOle VarChar(20) NOT NULL, DataTypeRdlParm VarChar(20) NULL, DataTypeDesc VarChar(80) NOT NULL, NumericData Char(1) NOT NULL, DoubleByte Char(1) NOT NULL, CONSTRAINT PK_CtDataType PRIMARY KEY CLUSTERED (DataTypeId))') EXEC (' SET IDENTITY_INSERT dbo.CtDataType ON INSERT INTO dbo.CtDataType (DataTypeId, DataTypeName, DataTypeSqlName, DataTypeSysName, DataTypeSByteOle, DataTypeDByteOle, DataTypeDesc, NumericData, DoubleByte) SELECT DataTypeId, DataTypeName, DataTypeSqlName, DataTypeSysName, DataTypeSByteOle, DataTypeDByteOle, DataTypeDesc, NumericData, DoubleByte FROM dbo.Tmp_CtDataType SET IDENTITY_INSERT dbo.CtDataType OFF IF (SELECT COUNT(1) FROM dbo.CtDataType) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtDataType) = 0 DROP TABLE dbo.Tmp_CtDataType CREATE  UNIQUE NONCLUSTERED INDEX IX_CtDataType ON dbo.CtDataType (DataTypeName)')
EXEC ('UPDATE dbo.CtDataType SET DataTypeRdlParm = CASE WHEN DataTypeId IN (1,2,3,4) THEN ''Integer'' WHEN DataTypeId IN (5,6,7,18) THEN ''Float'' WHEN DataTypeId IN (12,16,21) THEN ''DateTime'' ELSE ''String'' END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=196&typ=N&sys=3","","",""); return false;
197~@~   2.  36.70731:D:  110:*:*:M: Add table RptElm~@~69~@~110~@~D~@~~@~~@~M~@~~@~Add table RptElm~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptElm'')) CREATE TABLE dbo.RptElm (RptElmId Int IDENTITY NOT NULL, ReportId Int NOT NULL, RptElmTypeCd Char(1) NOT NULL, ElmStyle NVarChar(1000) NULL, ElmHeight VarChar(10) NOT NULL, ElmColumns SmallInt NULL, ElmColSpacing VarChar(10) NULL, ElmPrintFirst Char(1) NOT NULL, ElmPrintLast Char(1) NOT NULL, CONSTRAINT PK_RptElm PRIMARY KEY CLUSTERED (RptElmId))') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=197&typ=N&sys=3","","",""); return false;
228~@~   2.  36.70731:D:  120:*:*:M: Add table RptCel~@~69~@~120~@~D~@~~@~~@~M~@~~@~Add table RptCel~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptCel'')) CREATE TABLE dbo.RptCel (RptCelId Int IDENTITY NOT NULL, RptTblId Int NOT NULL, RowNum SmallInt NOT NULL, RowHeight VarChar(10) NOT NULL, RowVisibility VarChar(1000) NULL, CellNum SmallInt NOT NULL, CelColSpan SmallInt NULL, CONSTRAINT PK_RptCel PRIMARY KEY CLUSTERED (RptCelId))') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=228&typ=N&sys=3","","",""); return false;
232~@~   2.  36.70821:D:   10:*:*:M: Add column TabFolderDef to table ScreenTab~@~70~@~10~@~D~@~~@~~@~M~@~~@~Add column TabFolderDef to table ScreenTab~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_ScreenTab'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_ScreenTab IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenTabHlp_ScreenTab'') ALTER TABLE dbo.ScreenTabHlp DROP CONSTRAINT FK_ScreenTabHlp_ScreenTab CREATE TABLE dbo.Tmp_ScreenTab (ScreenTabId int NOT NULL, TabFolderName varchar(30) NOT NULL, TabFolderOrder tinyint NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenTab (ScreenTabId, TabFolderName, TabFolderOrder) SELECT ScreenTabId, TabFolderName, TabFolderOrder FROM dbo.ScreenTab IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenTab) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenTab) = 0 DROP TABLE dbo.ScreenTab') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenTab'')) CREATE TABLE dbo.ScreenTab (ScreenTabId Int IDENTITY NOT NULL, TabFolderName VarChar(30) NOT NULL, TabFolderOrder TinyInt NOT NULL, TabFolderDef Char(1) NOT NULL, CONSTRAINT PK_ScreenTab PRIMARY KEY CLUSTERED (ScreenTabId))') EXEC (' ALTER TABLE dbo.ScreenTab ADD CONSTRAINT DF_ScreenTab_TabFolderDef DEFAULT (''N'') FOR TabFolderDef SET IDENTITY_INSERT dbo.ScreenTab ON INSERT INTO dbo.ScreenTab (ScreenTabId, TabFolderName, TabFolderOrder, TabFolderDef) SELECT ScreenTabId, TabFolderName, TabFolderOrder, ''N'' FROM dbo.Tmp_ScreenTab SET IDENTITY_INSERT dbo.ScreenTab OFF IF (SELECT COUNT(1) FROM dbo.ScreenTab) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenTab) = 0 DROP TABLE dbo.Tmp_ScreenTab CREATE  UNIQUE NONCLUSTERED INDEX IX_ScreenTab_Name ON dbo.ScreenTab (TabFolderName) ALTER TABLE dbo.ScreenObj WITH NOCHECK ADD CONSTRAINT FK_ScreenObj_ScreenTab FOREIGN KEY (TabFolderId) REFERENCES dbo.ScreenTab (ScreenTabId) ALTER TABLE dbo.ScreenTabHlp WITH NOCHECK ADD CONSTRAINT FK_ScreenTabHlp_ScreenTab FOREIGN KEY (ScreenTabId) REFERENCES dbo.ScreenTab (ScreenTabId)')
EXEC ('UPDATE dbo.ScreenTab SET TabFolderDef = ''Y'' WHERE TabFolderOrder = (SELECT min(TabFolderOrder) FROM dbo.ScreenTab)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=232&typ=N&sys=3","","",""); return false;
233~@~   2.  36.70821:D:   20:*:*:M: Change column DefaultHlpMsg in table ScreenHlp~@~70~@~20~@~D~@~~@~~@~M~@~~@~Change column DefaultHlpMsg in table ScreenHlp~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenHlp_Screen'') ALTER TABLE dbo.ScreenHlp DROP CONSTRAINT FK_ScreenHlp_Screen CREATE TABLE dbo.Tmp_ScreenHlp (AddMsg nvarchar(100) NULL, CultureId tinyint NOT NULL, DefaultHlpMsg nvarchar(400) NOT NULL, DelMsg nvarchar(100) NULL, FootNote nvarchar(400) NULL, ScreenHlpId int NOT NULL, ScreenId int NOT NULL, ScreenTitle nvarchar(50) NOT NULL, UpdMsg nvarchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenHlp (AddMsg, CultureId, DefaultHlpMsg, DelMsg, FootNote, ScreenHlpId, ScreenId, ScreenTitle, UpdMsg) SELECT AddMsg, CultureId, DefaultHlpMsg, DelMsg, FootNote, ScreenHlpId, ScreenId, ScreenTitle, UpdMsg FROM dbo.ScreenHlp IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenHlp) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenHlp) = 0 DROP TABLE dbo.ScreenHlp') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenHlp'')) CREATE TABLE dbo.ScreenHlp (ScreenHlpId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, CultureId TinyInt NOT NULL, DefaultHlpMsg NText NOT NULL, FootNote NVarChar(400) NULL, ScreenTitle NVarChar(50) NOT NULL, AddMsg NVarChar(100) NULL, UpdMsg NVarChar(100) NULL, DelMsg NVarChar(100) NULL, CONSTRAINT PK_ScreenHlp PRIMARY KEY CLUSTERED (ScreenHlpId))') EXEC (' SET IDENTITY_INSERT dbo.ScreenHlp ON INSERT INTO dbo.ScreenHlp (ScreenHlpId, ScreenId, CultureId, DefaultHlpMsg, FootNote, ScreenTitle, AddMsg, UpdMsg, DelMsg) SELECT ScreenHlpId, ScreenId, CultureId, CONVERT(NText,DefaultHlpMsg), FootNote, ScreenTitle, AddMsg, UpdMsg, DelMsg FROM dbo.Tmp_ScreenHlp SET IDENTITY_INSERT dbo.ScreenHlp OFF IF (SELECT COUNT(1) FROM dbo.ScreenHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenHlp) = 0 DROP TABLE dbo.Tmp_ScreenHlp CREATE  UNIQUE NONCLUSTERED INDEX IX_ScreenHlp_ScreenId ON dbo.ScreenHlp (CultureId,ScreenId) ALTER TABLE dbo.ScreenHlp WITH NOCHECK ADD CONSTRAINT FK_ScreenHlp_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=233&typ=N&sys=3","","",""); return false;
234~@~   2.  36.70821:D:   30:*:*:M: Change column DefaultHlpMsg in table ReportHlp~@~70~@~30~@~D~@~~@~~@~M~@~~@~Change column DefaultHlpMsg in table ReportHlp~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_ReportHlp (CultureId tinyint NOT NULL, DefaultHlpMsg nvarchar(400) NOT NULL, ReportHlpId int NOT NULL, ReportId int NOT NULL, ReportTitle nvarchar(50) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_ReportHlp (CultureId, DefaultHlpMsg, ReportHlpId, ReportId, ReportTitle) SELECT CultureId, DefaultHlpMsg, ReportHlpId, ReportId, ReportTitle FROM dbo.ReportHlp IF (SELECT COUNT(1) FROM dbo.Tmp_ReportHlp) > 0 OR (SELECT COUNT(1) FROM dbo.ReportHlp) = 0 DROP TABLE dbo.ReportHlp') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ReportHlp'')) CREATE TABLE dbo.ReportHlp (ReportHlpId Int IDENTITY NOT NULL, ReportId Int NOT NULL, CultureId TinyInt NOT NULL, DefaultHlpMsg NText NOT NULL, ReportTitle NVarChar(50) NOT NULL, CONSTRAINT PK_ReportHlp PRIMARY KEY CLUSTERED (ReportHlpId))') EXEC (' SET IDENTITY_INSERT dbo.ReportHlp ON INSERT INTO dbo.ReportHlp (ReportHlpId, ReportId, CultureId, DefaultHlpMsg, ReportTitle) SELECT ReportHlpId, ReportId, CultureId, CONVERT(NText,DefaultHlpMsg), ReportTitle FROM dbo.Tmp_ReportHlp SET IDENTITY_INSERT dbo.ReportHlp OFF IF (SELECT COUNT(1) FROM dbo.ReportHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ReportHlp) = 0 DROP TABLE dbo.Tmp_ReportHlp CREATE  UNIQUE NONCLUSTERED INDEX IX_ReportHlp_ReportId ON dbo.ReportHlp (CultureId,ReportId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=234&typ=N&sys=3","","",""); return false;
235~@~   2.  37.70822:D:   10:*:*:M: Add column TrimOnEntry to table ScreenObj~@~71~@~10~@~D~@~~@~~@~M~@~~@~Add column TrimOnEntry to table ScreenObj~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_Screen'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_ScreenTab'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_ScreenTab CREATE TABLE dbo.Tmp_ScreenObj (AggregateCd char(1) NULL, ColumnDesc varchar(100) NULL, ColumnHeight smallint NULL, ColumnId int NULL, ColumnJustify char(1) NULL, ColumnLink varchar(100) NULL, ColumnName varchar(20) NOT NULL, ColumnSize smallint NULL, ColumnWrap char(1) NOT NULL, DdlAdnColumnId int NULL, DdlFtrColumnId int NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DefaultValue nvarchar(100) NULL, DisplayModeId tinyint NOT NULL, GenerateSp char(1) NOT NULL, MaskValid varchar(50) NULL, MasterTable char(1) NOT NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, RangeValidType varchar(50) NULL, RefreshOnCUD char(1) NOT NULL, RequiredValid char(1) NOT NULL, ScreenGrpId int NOT NULL, ScreenId int NOT NULL, ScreenObjId int NOT NULL, SortOrder smallint NULL, SystemValue nvarchar(100) NULL, TabFolderId int NULL, TabIndex smallint NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObj (AggregateCd, ColumnDesc, ColumnHeight, ColumnId, ColumnJustify, ColumnLink, ColumnName, ColumnSize, ColumnWrap, DdlAdnColumnId, DdlFtrColumnId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DefaultValue, DisplayModeId, GenerateSp, MaskValid, MasterTable, RangeValidMax, RangeValidMin, RangeValidType, RefreshOnCUD, RequiredValid, ScreenGrpId, ScreenId, ScreenObjId, SortOrder, SystemValue, TabFolderId, TabIndex) SELECT AggregateCd, ColumnDesc, ColumnHeight, ColumnId, ColumnJustify, ColumnLink, ColumnName, ColumnSize, ColumnWrap, DdlAdnColumnId, DdlFtrColumnId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DefaultValue, DisplayModeId, GenerateSp, MaskValid, MasterTable, RangeValidMax, RangeValidMin, RangeValidType, RefreshOnCUD, RequiredValid, ScreenGrpId, ScreenId, ScreenObjId, SortOrder, SystemValue, TabFolderId, TabIndex FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObj'')) CREATE TABLE dbo.ScreenObj (ScreenObjId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, ScreenGrpId Int NOT NULL, ColumnId Int NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(100) NULL, DefaultValue NVarChar(100) NULL, SystemValue NVarChar(100) NULL, ColumnWrap Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, ColumnHeight SmallInt NULL, DisplayModeId TinyInt NOT NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlAdnColumnId Int NULL, DdlFtrColumnId Int NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId Int NULL, TabIndex SmallInt NOT NULL, SortOrder SmallInt NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(50) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(100) NULL, RefreshOnCUD Char(1) NOT NULL, TrimOnEntry Char(1) NOT NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))') EXEC (' ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_TrimOnEntry DEFAULT (''Y'') FOR TrimOnEntry SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry) SELECT ScreenObjId, ScreenId, MasterTable, ScreenGrpId, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, ''Y'' FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj CREATE  NONCLUSTERED INDEX IX_ScreenObj_ScreenId ON dbo.ScreenObj (ScreenId,TabIndex) ALTER TABLE dbo.ScreenObj WITH NOCHECK ADD CONSTRAINT FK_ScreenObj_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenObj WITH NOCHECK ADD CONSTRAINT FK_ScreenObj_ScreenTab FOREIGN KEY (TabFolderId) REFERENCES dbo.ScreenTab (ScreenTabId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=235&typ=N&sys=3","","",""); return false;
236~@~   2.  37.70910:D:   10:*:*:M: Add column CultureTypeSrt to table CtCultureType~@~72~@~10~@~D~@~~@~~@~M~@~~@~Add column CultureTypeSrt to table CtCultureType~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_CtCultureType (CultureDefault char(1) NOT NULL, CultureId tinyint NOT NULL, CultureTypeDesc nvarchar(50) NOT NULL, CultureTypeName varchar(6) NOT NULL, EnNumberRule char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_CtCultureType (CultureDefault, CultureId, CultureTypeDesc, CultureTypeName, EnNumberRule) SELECT CultureDefault, CultureId, CultureTypeDesc, CultureTypeName, EnNumberRule FROM dbo.CtCultureType IF (SELECT COUNT(1) FROM dbo.Tmp_CtCultureType) > 0 OR (SELECT COUNT(1) FROM dbo.CtCultureType) = 0 DROP TABLE dbo.CtCultureType') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtCultureType'')) CREATE TABLE dbo.CtCultureType (CultureId TinyInt NOT NULL, CultureTypeName VarChar(6) NOT NULL, CultureTypeDesc NVarChar(50) NOT NULL, CultureDefault Char(1) NOT NULL, EnNumberRule Char(1) NOT NULL, CultureTypeSrt SmallInt NOT NULL, CONSTRAINT PK_CtCultureType PRIMARY KEY CLUSTERED (CultureId))') EXEC (' ALTER TABLE dbo.CtCultureType ADD CONSTRAINT DF_CtCultureType_CultureTypeSrt DEFAULT (1) FOR CultureTypeSrt INSERT INTO dbo.CtCultureType (CultureId, CultureTypeName, CultureTypeDesc, CultureDefault, EnNumberRule, CultureTypeSrt) SELECT CultureId, CultureTypeName, CultureTypeDesc, CultureDefault, EnNumberRule, 1 FROM dbo.Tmp_CtCultureType IF (SELECT COUNT(1) FROM dbo.CtCultureType) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtCultureType) = 0 DROP TABLE dbo.Tmp_CtCultureType')
EXEC ('UPDATE CtCultureType SET CultureTypeSrt = CultureId * 10')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=236&typ=N&sys=3","","",""); return false;
237~@~   2.  39.70926:D:   10:*:*:M: Add column ParentId to table RptTbl~@~75~@~10~@~D~@~~@~~@~M~@~~@~Add column ParentId to table RptTbl~@~Y~@~IF NOT EXISTS (SELECT 1 from dbo.SysColumns WHERE id =  object_id('dbo.RptTbl') AND name = 'ParentId')
BEGIN
EXEC (' CREATE TABLE dbo.Tmp_RptTbl (ColWidth varchar(10) NULL, RptCtrId int NOT NULL, RptTblId int NOT NULL, RptTblTypeCd char(1) NOT NULL, TblGrouping varchar(1000) NULL, TblOrder smallint NULL, TblRepeatNew char(1) NOT NULL, TblSorting varchar(1000) NULL, TblVisibility varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_RptTbl (ColWidth, RptCtrId, RptTblId, RptTblTypeCd, TblGrouping, TblOrder, TblRepeatNew, TblSorting, TblVisibility) SELECT ColWidth, RptCtrId, RptTblId, RptTblTypeCd, TblGrouping, TblOrder, TblRepeatNew, TblSorting, TblVisibility FROM dbo.RptTbl IF (SELECT COUNT(1) FROM dbo.Tmp_RptTbl) > 0 OR (SELECT COUNT(1) FROM dbo.RptTbl) = 0 DROP TABLE dbo.RptTbl') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptTbl'')) CREATE TABLE dbo.RptTbl (RptTblId Int IDENTITY NOT NULL, ParentId Int NULL, RptCtrId Int NOT NULL, RptTblTypeCd Char(1) NOT NULL, TblRepeatNew Char(1) NOT NULL, TblOrder SmallInt NULL, ColWidth VarChar(10) NULL, TblGrouping VarChar(1000) NULL, TblSorting VarChar(1000) NULL, TblVisibility VarChar(1000) NULL, CONSTRAINT PK_RptTbl PRIMARY KEY CLUSTERED (RptTblId))') EXEC (' SET IDENTITY_INSERT dbo.RptTbl ON INSERT INTO dbo.RptTbl (RptTblId, RptCtrId, RptTblTypeCd, TblRepeatNew, TblOrder, ColWidth, TblGrouping, TblSorting, TblVisibility) SELECT RptTblId, RptCtrId, RptTblTypeCd, TblRepeatNew, TblOrder, ColWidth, TblGrouping, TblSorting, TblVisibility FROM dbo.Tmp_RptTbl SET IDENTITY_INSERT dbo.RptTbl OFF IF (SELECT COUNT(1) FROM dbo.RptTbl) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptTbl) = 0 DROP TABLE dbo.Tmp_RptTbl')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=237&typ=N&sys=3","","",""); return false;
238~@~   2.  39.70926:D:   20:*:*:M: Add unit columns to table Report~@~75~@~20~@~D~@~~@~~@~M~@~~@~Add unit columns to table Report~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportCri_Report'') ALTER TABLE dbo.ReportCri DROP CONSTRAINT FK_ReportCri_Report 
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportObj_Report'') ALTER TABLE dbo.ReportObj DROP CONSTRAINT FK_ReportObj_Report 
CREATE TABLE dbo.Tmp_Report (CopyReportId int NULL, GenerateRp char(1) NOT NULL, GlobalCriteria char(1) NOT NULL, LastGenDt datetime NULL, ModifiedBy int NULL, ModifiedOn datetime NULL, PrintPortrait char(1) NOT NULL, ProgramName varchar(20) NOT NULL, RegClause varchar(400) NULL, RegCode ntext NULL, ReportDesc nvarchar(50) NULL, ReportId int NOT NULL, SqlRptSrv char(1) NOT NULL, TemplateName varchar(50) NULL, ToXlsOnly char(1) NOT NULL, UpdClause varchar(200) NULL, UpdCode ntext NULL, ValClause varchar(400) NULL, ValCode ntext NULL, WhereClause varchar(1000) NULL, XlsClause varchar(200) NULL, XlsCode ntext NULL)') 
EXEC (' INSERT INTO dbo.Tmp_Report (CopyReportId, GenerateRp, GlobalCriteria, LastGenDt, ModifiedBy, ModifiedOn, PrintPortrait, ProgramName, RegClause, RegCode, ReportDesc, ReportId, SqlRptSrv, TemplateName, ToXlsOnly, UpdClause, UpdCode, ValClause, ValCode, WhereClause, XlsClause, XlsCode) SELECT CopyReportId, GenerateRp, GlobalCriteria, LastGenDt, ModifiedBy, ModifiedOn, PrintPortrait, ProgramName, RegClause, RegCode, ReportDesc, ReportId, SqlRptSrv, TemplateName, ToXlsOnly, UpdClause, UpdCode, ValClause, ValCode, WhereClause, XlsClause, XlsCode FROM dbo.Report 
IF (SELECT COUNT(1) FROM dbo.Tmp_Report) > 0 OR (SELECT COUNT(1) FROM dbo.Report) = 0 DROP TABLE dbo.Report') 
EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Report'')) CREATE TABLE dbo.Report (ReportId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ReportDesc NVarChar(50) NULL, GlobalCriteria Char(1) NOT NULL, PrintPortrait Char(1) NOT NULL, ToXlsOnly Char(1) NOT NULL, TemplateName VarChar(50) NULL, SqlRptSrv Char(1) NOT NULL, CopyReportId Int NULL, TopMargin Decimal(8,2) NOT NULL, BottomMargin Decimal(8,2) NOT NULL, LeftMargin Decimal(8,2) NOT NULL, RightMargin Decimal(8,2) NOT NULL, PageHeight Decimal(8,2) NOT NULL, PageWidth Decimal(8,2) NOT NULL, UnitCd Char(2) NOT NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, RegCode NText NULL, ValClause VarChar(400) NULL, ValCode NText NULL, UpdClause VarChar(200) NULL, UpdCode NText NULL, XlsClause VarChar(200) NULL, XlsCode NText NULL, GenerateRp Char(1) NOT NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, CONSTRAINT PK_Report PRIMARY KEY CLUSTERED (ReportId))') 
EXEC (' ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_SqlRptSrv DEFAULT (''N'') FOR SqlRptSrv 
ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_TopMargin DEFAULT (1) FOR TopMargin 
ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_BottomMargin DEFAULT (1) FOR BottomMargin 
ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_LeftMargin DEFAULT (1) FOR LeftMargin 
ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_RightMargin DEFAULT (1) FOR RightMargin 
ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_PageHeight DEFAULT (11) FOR PageHeight 
ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_PageWidth DEFAULT (8.5) FOR PageWidth 
ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_UnitCd DEFAULT (''in'') FOR UnitCd 
SET IDENTITY_INSERT dbo.Report ON INSERT INTO dbo.Report (ReportId, ProgramName, ReportDesc, GlobalCriteria, PrintPortrait, ToXlsOnly, TemplateName, SqlRptSrv, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, ModifiedBy, ModifiedOn, LastGenDt) 
SELECT ReportId, ProgramName, ReportDesc, GlobalCriteria, PrintPortrait, ToXlsOnly, TemplateName, SqlRptSrv, CopyReportId, 1, 1, 1, 1, 11, 8.5, ''in'', WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, ModifiedBy, ModifiedOn, LastGenDt FROM dbo.Tmp_Report SET IDENTITY_INSERT dbo.Report OFF 
IF (SELECT COUNT(1) FROM dbo.Report) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Report) = 0 DROP TABLE dbo.Tmp_Report 
CREATE UNIQUE NONCLUSTERED INDEX IX_Report_ProgramName ON dbo.Report (ProgramName) 
ALTER TABLE dbo.ReportCri WITH NOCHECK ADD CONSTRAINT FK_ReportCri_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId) 
ALTER TABLE dbo.ReportObj WITH NOCHECK ADD CONSTRAINT FK_ReportObj_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=238&typ=N&sys=3","","",""); return false;
239~@~   2.  39.70926:D:   30:*:*:M: Add table CtBorderStyle~@~75~@~30~@~D~@~~@~~@~M~@~~@~Add table CtBorderStyle~@~N~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtBorderStyle'')) BEGIN
CREATE TABLE dbo.CtBorderStyle (BorderStyleId TinyInt NOT NULL, BorderStyleName VarChar(20) NOT NULL, CONSTRAINT PK_CtBorderStyle PRIMARY KEY CLUSTERED (BorderStyleId))
INSERT CtBorderStyle VALUES (1,''None'')
INSERT CtBorderStyle VALUES (2,''Dotted'')
INSERT CtBorderStyle VALUES (3,''Dashed'')
INSERT CtBorderStyle VALUES (4,''Solid'')
INSERT CtBorderStyle VALUES (5,''Double'')
INSERT CtBorderStyle VALUES (6,''Groove'')
INSERT CtBorderStyle VALUES (7,''Ridge'')
INSERT CtBorderStyle VALUES (8,''Inset'')
INSERT CtBorderStyle VALUES (9,''WindowInset'')
INSERT CtBorderStyle VALUES (10,''Outset'')
END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=239&typ=N&sys=3","","",""); return false;
241~@~   2.  39.70926:D:   50:*:*:M: Add table CtBgGradType~@~75~@~50~@~D~@~~@~~@~M~@~~@~Add table CtBgGradType~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtBgGradType'')) BEGIN
CREATE TABLE dbo.CtBgGradType (BgGradTypeId TinyInt NOT NULL, BgGradTypeName VarChar(20) NOT NULL, BgGradTypeDesc VarChar(20) NOT NULL, CONSTRAINT PK_CtBgGradType PRIMARY KEY CLUSTERED (BgGradTypeId))
INSERT CtBgGradType VALUES (1,''None'',''None'')
INSERT CtBgGradType VALUES (2,''LeftRight'',''Left to Right'')
INSERT CtBgGradType VALUES (3,''TopBottom'',''Top to Bottom'')
INSERT CtBgGradType VALUES (4,''Center'',''Center'')
INSERT CtBgGradType VALUES (5,''DiagonalLeft'',''Diagonal Left'')
INSERT CtBgGradType VALUES (6,''DiagonalRight'',''Diagonal Right'')
INSERT CtBgGradType VALUES (7,''HorizontalCenter'',''Horizontal Center'')
INSERT CtBgGradType VALUES (8,''VerticalCenter'',''Vertical Center'')
END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=241&typ=N&sys=3","","",""); return false;
242~@~   2.  39.70926:D:   60:*:*:M: Add table CtFontStyle~@~75~@~60~@~D~@~~@~~@~M~@~~@~Add table CtFontStyle~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtFontStyle'')) BEGIN
CREATE TABLE dbo.CtFontStyle (FontStyleCd Char(1) NOT NULL, FontStyleName VarChar(10) NOT NULL, CONSTRAINT PK_CtFontStyle PRIMARY KEY CLUSTERED (FontStyleCd))
INSERT CtFontStyle VALUES (''N'',''Normal'')
INSERT CtFontStyle VALUES (''I'',''Italic'')
END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=242&typ=N&sys=3","","",""); return false;
243~@~   2.  39.70926:D:   70:*:*:M: Add table CtFontWeight~@~75~@~70~@~D~@~~@~~@~M~@~~@~Add table CtFontWeight~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtFontWeight'')) BEGIN
CREATE TABLE dbo.CtFontWeight (FontWeightCd TinyInt NOT NULL, FontWeightName VarChar(10) NOT NULL, FontWeightDesc NVarChar(20) NOT NULL, CONSTRAINT PK_CtFontWeight PRIMARY KEY CLUSTERED (FontWeightCd))
INSERT CtFontWeight VALUES (1,''100'',''Lightest 100'')
INSERT CtFontWeight VALUES (2,''200'',''Lighter 200'')
INSERT CtFontWeight VALUES (3,''300'',''Light 300'')
INSERT CtFontWeight VALUES (4,''400'',''Light 400'')
INSERT CtFontWeight VALUES (5,''500'',''Normal 500'')
INSERT CtFontWeight VALUES (6,''600'',''Bold 600'')
INSERT CtFontWeight VALUES (7,''700'',''Bold 700'')
INSERT CtFontWeight VALUES (8,''800'',''Bolder 800'')
INSERT CtFontWeight VALUES (9,''900'',''Boldest 900'')
END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=243&typ=N&sys=3","","",""); return false;
244~@~   2.  39.70926:D:   80:*:*:M: Add table CtTextDecor~@~75~@~80~@~D~@~~@~~@~M~@~~@~Add table CtTextDecor~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtTextDecor'')) BEGIN
CREATE TABLE dbo.CtTextDecor (TextDecorCd Char(1) NOT NULL, TextDecorName VarChar(20) NOT NULL, TextDecorDesc NVarChar(20) NOT NULL, CONSTRAINT PK_CtTextDecor PRIMARY KEY CLUSTERED (TextDecorCd))
INSERT CtTextDecor VALUES (''U'',''Underline'',''Underline'')
INSERT CtTextDecor VALUES (''O'',''Overline'',''Overline'')
INSERT CtTextDecor VALUES (''L'',''LineThrough'',''Line Through'')
INSERT CtTextDecor VALUES (''N'',''None'',''None'')
END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=244&typ=N&sys=3","","",""); return false;
245~@~   2.  39.70926:D:   90:*:*:M: Add table CtTextAlign~@~75~@~90~@~D~@~~@~~@~M~@~~@~Add table CtTextAlign~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtTextAlign'')) BEGIN
CREATE TABLE dbo.CtTextAlign (TextAlignCd Char(1) NOT NULL, TextAlignName VarChar(20) NOT NULL, CONSTRAINT PK_CtTextAlign PRIMARY KEY CLUSTERED (TextAlignCd))
INSERT CtTextAlign VALUES (''L'',''Left'')
INSERT CtTextAlign VALUES (''C'',''Center'')
INSERT CtTextAlign VALUES (''R'',''Right'')
INSERT CtTextAlign VALUES (''G'',''General'')
END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=245&typ=N&sys=3","","",""); return false;
246~@~   2.  39.70926:D:  100:*:*:M: Add table CtVerticalAlign~@~75~@~100~@~D~@~~@~~@~M~@~~@~Add table CtVerticalAlign~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtVerticalAlign'')) BEGIN
CREATE TABLE dbo.CtVerticalAlign (VerticalAlignCd Char(1) NOT NULL, VerticalAlignName VarChar(20) NOT NULL, CONSTRAINT PK_CtVerticalAlign PRIMARY KEY CLUSTERED (VerticalAlignCd))
INSERT CtVerticalAlign VALUES (''T'',''Top'')
INSERT CtVerticalAlign VALUES (''M'',''Middle'')
INSERT CtVerticalAlign VALUES (''B'',''Bottom'')
END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=246&typ=N&sys=3","","",""); return false;
247~@~   2.  39.70926:D:  110:*:*:M: Add table CtDirection~@~75~@~110~@~D~@~~@~~@~M~@~~@~Add table CtDirection~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtDirection'')) BEGIN
CREATE TABLE dbo.CtDirection (DirectionCd Char(1) NOT NULL, DirectionName VarChar(10) NOT NULL, DirectionDesc NVarChar(20) NOT NULL, CONSTRAINT PK_CtDirection PRIMARY KEY CLUSTERED (DirectionCd))
INSERT CtDirection VALUES (''L'',''LTR'',''Left to Right'')
INSERT CtDirection VALUES (''R'',''RTL'',''Right to Left'')
END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=247&typ=N&sys=3","","",""); return false;
248~@~   2.  39.70926:D:  120:*:*:M: Add table CtWritingMode~@~75~@~120~@~D~@~~@~~@~M~@~~@~Add table CtWritingMode~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtWritingMode'')) BEGIN
CREATE TABLE dbo.CtWritingMode (WritingModeCd Char(1) NOT NULL, WritingModeName VarChar(10) NOT NULL, WritingModeDesc NVarChar(20) NOT NULL, CONSTRAINT PK_CtWritingMode PRIMARY KEY CLUSTERED (WritingModeCd))
INSERT CtWritingMode VALUES (''H'',''lr-tb'',''Horizontally'')
INSERT CtWritingMode VALUES (''V'',''tb-rl'',''Vertically'')
END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=248&typ=N&sys=3","","",""); return false;
250~@~   2.  39.70926:D:  130:*:*:M: Add table CtRptStyDef~@~75~@~130~@~D~@~~@~~@~M~@~~@~Add table CtRptStyDef~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtRptStyDef'')) BEGIN
CREATE TABLE dbo.CtRptStyDef (DefaultCd Char(2) NOT NULL, DefaultName NVarChar(20) NOT NULL, CONSTRAINT PK_CtRptStyDef PRIMARY KEY CLUSTERED (DefaultCd))
INSERT CtRptStyDef VALUES (''TT'',''Title'')
INSERT CtRptStyDef VALUES (''S1'',''1st SubTitle'')
INSERT CtRptStyDef VALUES (''S2'',''2ns SubTitle'')
END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=250&typ=N&sys=3","","",""); return false;
251~@~   2.  39.70926:D:  140:*:*:M: Add table RptStyle~@~75~@~140~@~D~@~~@~~@~M~@~~@~Add table RptStyle~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptStyle'')) CREATE TABLE dbo.RptStyle (RptStyleId Int IDENTITY NOT NULL, RptStyleDesc NVarChar(300) NOT NULL, BorderColorD VarChar(10) NULL, BorderColorL VarChar(10) NULL, BorderColorR VarChar(10) NULL, BorderColorT VarChar(10) NULL, BorderColorB VarChar(10) NULL, BorderStyleD TinyInt NULL, BorderStyleL TinyInt NULL, BorderStyleR TinyInt NULL, BorderStyleT TinyInt NULL, BorderStyleB TinyInt NULL, BorderWidthD TinyInt NULL, BorderWidthL TinyInt NULL, BorderWidthR TinyInt NULL, BorderWidthT TinyInt NULL, BorderWidthB TinyInt NULL, BgColor VarChar(10) NULL, BgGradType TinyInt NULL, BgGradColor VarChar(10) NULL, BgImage VarChar(200) NULL, FontStyle Char(1) NULL, FontFamily VarChar(100) NULL, FontSize TinyInt NULL, FontWeight TinyInt NULL, Format VarChar(100) NULL, TextDecor Char(1) NULL, TextAlign Char(1) NULL, VerticalAlign Char(1) NULL, Color VarChar(10) NULL, PadLeft SmallInt NULL, PadRight SmallInt NULL, PadTop SmallInt NULL, PadBottom SmallInt NULL, LineHeight SmallInt NULL, Direction Char(1) NULL, WritingMode Char(1) NULL, DefaultCd Char(2) NULL, CONSTRAINT PK_RptStyle PRIMARY KEY CLUSTERED (RptStyleId))') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=251&typ=N&sys=3","","",""); return false;
252~@~   2.  40.71009:D:   10:*:*:M: Remove column LogoBannerImg from table UsrPref~@~76~@~10~@~D~@~~@~~@~M~@~~@~Remove column LogoBannerImg from table UsrPref~@~N~@~IF EXISTS (SELECT 1 from dbo.SysColumns WHERE id =  object_id('dbo.UsrPref') AND name = 'LogoBannerImg')
BEGIN
EXEC (' CREATE TABLE dbo.Tmp_UsrPref (AgentId int NULL, BrokerId int NULL, ComListVisible char(1) NOT NULL, CompanyId smallint NULL, CustomerId int NULL, InvestorId int NULL, LoginBannerImg varchar(100) NULL, LoginLink1Href varchar(100) NULL, LoginLink1Text nvarchar(20) NULL, LoginLink2Href varchar(100) NULL, LoginLink2Text nvarchar(20) NULL, LoginLink3Href varchar(100) NULL, LoginLink3Text nvarchar(20) NULL, LoginLink4Href varchar(100) NULL, LoginLink4Text nvarchar(20) NULL, LogoBannerImg varchar(100) NULL, MemberId int NULL, MenuAd1Href varchar(100) NULL, MenuAd1Img varchar(100) NULL, MenuAd2Href varchar(100) NULL, MenuAd2Img varchar(100) NULL, MenuOption char(1) NOT NULL, PageBannerImg varchar(100) NULL, PageLink1Href varchar(100) NULL, PageLink1Text nvarchar(20) NULL, PageLink2Href varchar(100) NULL, PageLink2Text nvarchar(20) NULL, PrefDefault char(1) NOT NULL, PrjListVisible char(1) NOT NULL, ProjectId smallint NULL, SplashImg varchar(100) NULL, SysListVisible char(1) NOT NULL, SystemId tinyint NULL, UsrGroupId smallint NULL, UsrId int NULL, UsrPrefDesc nvarchar(50) NOT NULL, UsrPrefId int NOT NULL, UsrStyleSheet text NULL, VendorId int NULL)')
EXEC (' INSERT INTO dbo.Tmp_UsrPref (AgentId, BrokerId, ComListVisible, CompanyId, CustomerId, InvestorId, LoginBannerImg, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, LogoBannerImg, MemberId, MenuAd1Href, MenuAd1Img, MenuAd2Href, MenuAd2Img, MenuOption, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, PrefDefault, PrjListVisible, ProjectId, SplashImg, SysListVisible, SystemId, UsrGroupId, UsrId, UsrPrefDesc, UsrPrefId, UsrStyleSheet, VendorId) SELECT AgentId, BrokerId, ComListVisible, CompanyId, CustomerId, InvestorId, LoginBannerImg, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, LogoBannerImg, MemberId, MenuAd1Href, MenuAd1Img, MenuAd2Href, MenuAd2Img, MenuOption, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, PrefDefault, PrjListVisible, ProjectId, SplashImg, SysListVisible, SystemId, UsrGroupId, UsrId, UsrPrefDesc, UsrPrefId, UsrStyleSheet, VendorId FROM dbo.UsrPref IF (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.UsrPref) = 0 DROP TABLE dbo.UsrPref')
EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrPref'')) CREATE TABLE dbo.UsrPref (UsrPrefId Int IDENTITY NOT NULL, UsrId Int NULL, UsrGroupId SmallInt NULL, CompanyId SmallInt NULL, MemberId Int NULL, AgentId Int NULL, BrokerId Int NULL, CustomerId Int NULL, InvestorId Int NULL, VendorId Int NULL, ProjectId SmallInt NULL, SystemId TinyInt NULL, PrefDefault Char(1) NOT NULL, UsrPrefDesc NVarChar(50) NOT NULL, SysListVisible Char(1) NOT NULL, ComListVisible Char(1) NOT NULL, PrjListVisible Char(1) NOT NULL, MenuOption Char(1) NOT NULL, PageBannerImg VarChar(100) NULL, PageLink1Href VarChar(100) NULL, PageLink1Text NVarChar(20) NULL, PageLink2Href VarChar(100) NULL, PageLink2Text NVarChar(20) NULL, LoginLink1Href VarChar(100) NULL, LoginLink1Text NVarChar(20) NULL, LoginLink2Href VarChar(100) NULL, LoginLink2Text NVarChar(20) NULL, LoginLink3Href VarChar(100) NULL, LoginLink3Text NVarChar(20) NULL, LoginLink4Href VarChar(100) NULL, LoginLink4Text NVarChar(20) NULL, UsrStyleSheet Text NULL, MenuAd1Img VarChar(100) NULL, MenuAd1Href VarChar(100) NULL, MenuAd2Img VarChar(100) NULL, MenuAd2Href VarChar(100) NULL, SplashImg VarChar(100) NULL, CONSTRAINT PK_UsrPref PRIMARY KEY CLUSTERED (UsrPrefId))')
EXEC (' ALTER TABLE dbo.UsrPref ADD CONSTRAINT DF_UsrPref_PrjListVisible DEFAULT (''N'') FOR PrjListVisible SET IDENTITY_INSERT dbo.UsrPref ON INSERT INTO dbo.UsrPref (UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOption, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, UsrStyleSheet, MenuAd1Img, MenuAd1Href, MenuAd2Img, MenuAd2Href, SplashImg) SELECT UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOption, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, UsrStyleSheet, MenuAd1Img, MenuAd1Href, MenuAd2Img, MenuAd2Href, SplashImg FROM dbo.Tmp_UsrPref SET IDENTITY_INSERT dbo.UsrPref OFF IF (SELECT COUNT(1) FROM dbo.UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) = 0 DROP TABLE dbo.Tmp_UsrPref CREATE  UNIQUE NONCLUSTERED INDEX IX_UsrPref_UsrPrefDesc ON dbo.UsrPref (UsrPrefDesc)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=252&typ=N&sys=3","","",""); return false;
254~@~   2.  40.71009:D:   30:*:*:M: Rename ElmStyle to RptStyleId in table RptElm~@~76~@~30~@~D~@~~@~~@~M~@~~@~Rename ElmStyle to RptStyleId in table RptElm~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_RptElm (ElmColSpacing varchar(10) NULL, ElmColumns smallint NULL, ElmHeight varchar(10) NOT NULL, ElmPrintFirst char(1) NOT NULL, ElmPrintLast char(1) NOT NULL, ElmStyle nvarchar(1000) NULL, ReportId int NOT NULL, RptElmId int NOT NULL, RptElmTypeCd char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_RptElm (ElmColSpacing, ElmColumns, ElmHeight, ElmPrintFirst, ElmPrintLast, ElmStyle, ReportId, RptElmId, RptElmTypeCd) SELECT ElmColSpacing, ElmColumns, ElmHeight, ElmPrintFirst, ElmPrintLast, ElmStyle, ReportId, RptElmId, RptElmTypeCd FROM dbo.RptElm IF (SELECT COUNT(1) FROM dbo.Tmp_RptElm) > 0 OR (SELECT COUNT(1) FROM dbo.RptElm) = 0 DROP TABLE dbo.RptElm') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptElm'')) CREATE TABLE dbo.RptElm (RptElmId Int IDENTITY NOT NULL, ReportId Int NOT NULL, RptElmTypeCd Char(1) NOT NULL, RptStyleId Int NULL, ElmHeight VarChar(10) NOT NULL, ElmColumns SmallInt NULL, ElmColSpacing VarChar(10) NULL, ElmPrintFirst Char(1) NOT NULL, ElmPrintLast Char(1) NOT NULL, CONSTRAINT PK_RptElm PRIMARY KEY CLUSTERED (RptElmId))') EXEC (' SET IDENTITY_INSERT dbo.RptElm ON INSERT INTO dbo.RptElm (RptElmId, ReportId, RptElmTypeCd, RptStyleId, ElmHeight, ElmColumns, ElmColSpacing, ElmPrintFirst, ElmPrintLast) SELECT RptElmId, ReportId, RptElmTypeCd, ElmStyle, ElmHeight, ElmColumns, ElmColSpacing, ElmPrintFirst, ElmPrintLast FROM dbo.Tmp_RptElm SET IDENTITY_INSERT dbo.RptElm OFF IF (SELECT COUNT(1) FROM dbo.RptElm) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptElm) = 0 DROP TABLE dbo.Tmp_RptElm')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=254&typ=N&sys=3","","",""); return false;
255~@~   2.  40.71009:D:   20:*:*:M: Rename CtrStyle to RptStyleId in table RptCtr~@~76~@~20~@~D~@~~@~~@~M~@~~@~Rename CtrStyle to RptStyleId in table RptCtr~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_RptCtr (CtrAction varchar(1000) NULL, CtrCanGrow char(1) NOT NULL, CtrCanShrink char(1) NOT NULL, CtrGrouping varchar(1000) NULL, CtrHeight varchar(10) NULL, CtrLeft varchar(10) NULL, CtrPgBrEnd char(1) NOT NULL, CtrPgBrStart char(1) NOT NULL, CtrSorting varchar(1000) NULL, CtrStyle int NULL, CtrTogether char(1) NOT NULL, CtrToolTip varchar(200) NULL, CtrTop varchar(10) NULL, CtrValue varchar(1000) NULL, CtrVisibility varchar(1000) NULL, CtrWidth varchar(10) NULL, CtrZIndex smallint NULL, PRptCtrId int NULL, ReportId int NULL, RptCelId int NULL, RptCtrId int NOT NULL, RptCtrName nvarchar(20) NOT NULL, RptCtrTypeCd char(1) NOT NULL, RptElmId int NULL)') EXEC (' INSERT INTO dbo.Tmp_RptCtr (CtrAction, CtrCanGrow, CtrCanShrink, CtrGrouping, CtrHeight, CtrLeft, CtrPgBrEnd, CtrPgBrStart, CtrSorting, CtrStyle, CtrTogether, CtrToolTip, CtrTop, CtrValue, CtrVisibility, CtrWidth, CtrZIndex, PRptCtrId, ReportId, RptCelId, RptCtrId, RptCtrName, RptCtrTypeCd, RptElmId) SELECT CtrAction, CtrCanGrow, CtrCanShrink, CtrGrouping, CtrHeight, CtrLeft, CtrPgBrEnd, CtrPgBrStart, CtrSorting, convert(int,CtrStyle), CtrTogether, CtrToolTip, CtrTop, CtrValue, CtrVisibility, CtrWidth, CtrZIndex, PRptCtrId, ReportId, RptCelId, RptCtrId, RptCtrName, RptCtrTypeCd, RptElmId FROM dbo.RptCtr IF (SELECT COUNT(1) FROM dbo.Tmp_RptCtr) > 0 OR (SELECT COUNT(1) FROM dbo.RptCtr) = 0 DROP TABLE dbo.RptCtr') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptCtr'')) CREATE TABLE dbo.RptCtr (RptCtrId Int IDENTITY NOT NULL, PRptCtrId Int NULL, RptElmId Int NULL, RptCelId Int NULL, ReportId Int NULL, RptCtrTypeCd Char(1) NOT NULL, RptCtrName NVarChar(20) NOT NULL, RptStyleId Int NULL, CtrTop VarChar(10) NULL, CtrLeft VarChar(10) NULL, CtrHeight VarChar(10) NULL, CtrWidth VarChar(10) NULL, CtrZIndex SmallInt NULL, CtrAction VarChar(1000) NULL, CtrVisibility VarChar(1000) NULL, CtrToolTip VarChar(200) NULL, CtrPgBrStart Char(1) NOT NULL, CtrPgBrEnd Char(1) NOT NULL, CtrValue VarChar(1000) NULL, CtrCanGrow Char(1) NOT NULL, CtrCanShrink Char(1) NOT NULL, CtrTogether Char(1) NOT NULL, CtrGrouping VarChar(1000) NULL, CtrSorting VarChar(1000) NULL, CONSTRAINT PK_RptCtr PRIMARY KEY CLUSTERED (RptCtrId))') EXEC (' SET IDENTITY_INSERT dbo.RptCtr ON INSERT INTO dbo.RptCtr (RptCtrId, PRptCtrId, RptElmId, RptCelId, ReportId, RptCtrTypeCd, RptCtrName, RptStyleId, CtrTop, CtrLeft, CtrHeight, CtrWidth, CtrZIndex, CtrAction, CtrVisibility, CtrToolTip, CtrPgBrStart, CtrPgBrEnd, CtrValue, CtrCanGrow, CtrCanShrink, CtrTogether, CtrGrouping, CtrSorting) SELECT RptCtrId, PRptCtrId, RptElmId, RptCelId, ReportId, RptCtrTypeCd, RptCtrName, CtrStyle, CtrTop, CtrLeft, CtrHeight, CtrWidth, CtrZIndex, CtrAction, CtrVisibility, CtrToolTip, CtrPgBrStart, CtrPgBrEnd, CtrValue, CtrCanGrow, CtrCanShrink, CtrTogether, CtrGrouping, CtrSorting FROM dbo.Tmp_RptCtr SET IDENTITY_INSERT dbo.RptCtr OFF IF (SELECT COUNT(1) FROM dbo.RptCtr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptCtr) = 0 DROP TABLE dbo.Tmp_RptCtr')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=255&typ=N&sys=3","","",""); return false;
267~@~   2.  41.71018:D:   30:*:*:M: Add column RptElmDesc to table RptElm~@~77~@~30~@~D~@~~@~~@~M~@~~@~Add column RptElmDesc to table RptElm~@~Y~@~EXEC ('UPDATE RptElm SET ElmHeight = replace(ElmHeight,''in'','''')')
EXEC ('CREATE TABLE dbo.Tmp_RptElm (RptElmId int NOT NULL, ReportId int NOT NULL, RptElmTypeCd char(1) NOT NULL, RptStyleId int NULL, ElmHeight decimal(8,2) NOT NULL, ElmColumns smallint NULL, ElmColSpacing decimal(8,2) NULL, ElmPrintFirst char(1) NOT NULL, ElmPrintLast char(1) NOT NULL)')
EXEC ('INSERT INTO dbo.Tmp_RptElm (RptElmId, ReportId, RptElmTypeCd, RptStyleId, ElmHeight, ElmColumns, ElmColSpacing, ElmPrintFirst, ElmPrintLast) SELECT convert(int,RptElmId), convert(int,ReportId), RptElmTypeCd, convert(int,RptStyleId), convert(decimal(8,2),ElmHeight), convert(smallint,ElmColumns), convert(decimal(8,2),ElmColSpacing), ElmPrintFirst, ElmPrintLast FROM dbo.RptElm IF (SELECT COUNT(1) FROM dbo.Tmp_RptElm) > 0 OR (SELECT COUNT(1) FROM dbo.RptElm) = 0 DROP TABLE dbo.RptElm') 
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptElm'')) CREATE TABLE dbo.RptElm (RptElmId Int IDENTITY NOT NULL, RptElmDesc NVarChar(200) NULL, ReportId Int NOT NULL, RptElmTypeCd Char(1) NOT NULL, RptStyleId Int NULL, ElmHeight Decimal(8,2) NOT NULL, ElmColumns SmallInt NULL, ElmColSpacing Decimal(8,2) NULL, ElmPrintFirst Char(1) NOT NULL, ElmPrintLast Char(1) NOT NULL, CONSTRAINT PK_RptElm PRIMARY KEY CLUSTERED (RptElmId))')
EXEC ('SET IDENTITY_INSERT dbo.RptElm ON INSERT INTO dbo.RptElm (RptElmId, ReportId, RptElmTypeCd, RptStyleId, ElmHeight, ElmColumns, ElmColSpacing, ElmPrintFirst, ElmPrintLast) SELECT RptElmId, ReportId, RptElmTypeCd, RptStyleId, ElmHeight, ElmColumns, ElmColSpacing, ElmPrintFirst, ElmPrintLast FROM dbo.Tmp_RptElm SET IDENTITY_INSERT dbo.RptElm OFF IF (SELECT COUNT(1) FROM dbo.RptElm) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptElm) = 0 DROP TABLE dbo.Tmp_RptElm')
EXEC ('UPDATE RptElm SET RptElmDesc = b.ReportDesc + '' ['' + c.RptElmTypeName + '']'' FROM RptElm a INNER JOIN Report b ON a.ReportId = b.ReportId INNER JOIN [[?]]Design.dbo.CtRptElmType c ON a.RptElmTypeCd = c.RptElmTypeCd')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=267&typ=N&sys=3","","",""); return false;
268~@~   2.  41.71018:D:   40:*:*:M: Add column RptCtrDesc to table RptCtr~@~77~@~40~@~D~@~~@~~@~M~@~~@~Add column RptCtrDesc to table RptCtr~@~Y~@~EXEC ('UPDATE RptCtr SET CtrTop = replace(CtrTop,''in'',''''), CtrLeft = replace(CtrLeft,''in'',''''), CtrHeight = replace(CtrHeight,''in'',''''), CtrWidth = replace(CtrWidth,''in'','''')')
EXEC ('CREATE TABLE dbo.Tmp_RptCtr (RptCtrId int NOT NULL, PRptCtrId int NULL, RptElmId int NULL, RptCelId int NULL, ReportId int NULL, RptCtrTypeCd char(1) NOT NULL, RptCtrName nvarchar(20) NOT NULL, RptStyleId int NULL, CtrTop varchar(10) NULL, CtrLeft varchar(10) NULL, CtrHeight varchar(10) NULL, CtrWidth varchar(10) NULL, CtrZIndex smallint NULL, CtrAction varchar(1000) NULL, CtrVisibility varchar(1000) NULL, CtrToolTip varchar(200) NULL, CtrPgBrStart char(1) NOT NULL, CtrPgBrEnd char(1) NOT NULL, CtrValue varchar(1000) NULL, CtrCanGrow char(1) NOT NULL, CtrCanShrink char(1) NOT NULL, CtrTogether char(1) NOT NULL, CtrGrouping varchar(1000) NULL, CtrSorting varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_RptCtr (RptCtrId, PRptCtrId, RptElmId, RptCelId, ReportId, RptCtrTypeCd, RptCtrName, RptStyleId, CtrTop, CtrLeft, CtrHeight, CtrWidth, CtrZIndex, CtrAction, CtrVisibility, CtrToolTip, CtrPgBrStart, CtrPgBrEnd, CtrValue, CtrCanGrow, CtrCanShrink, CtrTogether, CtrGrouping, CtrSorting) SELECT convert(int,RptCtrId), convert(int,PRptCtrId), convert(int,RptElmId), convert(int,RptCelId), convert(int,ReportId), RptCtrTypeCd, RptCtrName, convert(int,RptStyleId), CtrTop, CtrLeft, CtrHeight, CtrWidth, convert(smallint,CtrZIndex), CtrAction, CtrVisibility, CtrToolTip, CtrPgBrStart, CtrPgBrEnd, CtrValue, CtrCanGrow, CtrCanShrink, CtrTogether, CtrGrouping, CtrSorting FROM dbo.RptCtr IF (SELECT COUNT(1) FROM dbo.Tmp_RptCtr) > 0 OR (SELECT COUNT(1) FROM dbo.RptCtr) = 0 DROP TABLE dbo.RptCtr') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptCtr'')) CREATE TABLE dbo.RptCtr (RptCtrId Int IDENTITY NOT NULL, RptCtrDesc NVarChar(200) NULL, PRptCtrId Int NULL, RptElmId Int NULL, RptCelId Int NULL, ReportId Int NOT NULL, RptCtrTypeCd Char(1) NOT NULL, RptCtrName NVarChar(100) NOT NULL, RptStyleId Int NULL, CtrTop Decimal(8,2) NULL, CtrLeft Decimal(8,2) NULL, CtrHeight Decimal(8,2) NULL, CtrWidth Decimal(8,2) NULL, CtrZIndex SmallInt NULL, CtrAction VarChar(1000) NULL, CtrVisibility VarChar(1000) NULL, CtrToolTip VarChar(200) NULL, CtrPgBrStart Char(1) NOT NULL, CtrPgBrEnd Char(1) NOT NULL, CtrValue VarChar(1000) NULL, CtrCanGrow Char(1) NOT NULL, CtrCanShrink Char(1) NOT NULL, CtrTogether Char(1) NOT NULL, CtrGrouping VarChar(1000) NULL, CtrSorting VarChar(1000) NULL, CONSTRAINT PK_RptCtr PRIMARY KEY CLUSTERED (RptCtrId))') EXEC (' SET IDENTITY_INSERT dbo.RptCtr ON INSERT INTO dbo.RptCtr (RptCtrId, PRptCtrId, RptElmId, RptCelId, ReportId, RptCtrTypeCd, RptCtrName, RptStyleId, CtrTop, CtrLeft, CtrHeight, CtrWidth, CtrZIndex, CtrAction, CtrVisibility, CtrToolTip, CtrPgBrStart, CtrPgBrEnd, CtrValue, CtrCanGrow, CtrCanShrink, CtrTogether, CtrGrouping, CtrSorting) SELECT RptCtrId, PRptCtrId, RptElmId, RptCelId, ReportId, RptCtrTypeCd, RptCtrName, RptStyleId, CONVERT(Decimal(8,2),CtrTop), CONVERT(Decimal(8,2),CtrLeft), CONVERT(Decimal(8,2),CtrHeight), CONVERT(Decimal(8,2),CtrWidth), CtrZIndex, CtrAction, CtrVisibility, CtrToolTip, CtrPgBrStart, CtrPgBrEnd, CtrValue, CtrCanGrow, CtrCanShrink, CtrTogether, CtrGrouping, CtrSorting FROM dbo.Tmp_RptCtr SET IDENTITY_INSERT dbo.RptCtr OFF IF (SELECT COUNT(1) FROM dbo.RptCtr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptCtr) = 0 DROP TABLE dbo.Tmp_RptCtr')
EXEC ('UPDATE dbo.RptCtr SET
	RptCtrDesc = case when e.RptElmDesc is not null then e.RptElmDesc when f.RptCelDesc is not null then f.RptCelDesc else b.ReportDesc end
		+ case when d.RptCtrTypeName is null then '''' else '' ['' + d.RptCtrTypeName + ''] '' + d.RptCtrName + '': '' end + '' ['' + c.RptCtrTypeName + ''] '' + a.RptCtrName
	FROM dbo.RptCtr a
	INNER JOIN dbo.Report b ON a.ReportId = b.ReportId
	INNER JOIN [[?]]Design.dbo.CtRptCtrType c ON a.RptCtrTypeCd = c.RptCtrTypeCd
	LEFT OUTER JOIN (SELECT x.RptCtrId, y.RptCtrTypeName, x.RptCtrName FROM dbo.RptCtr x
		INNER JOIN [[?]]Design.dbo.CtRptCtrType y ON x.RptCtrTypeCd = y.RptCtrTypeCd) d ON a.PRptCtrId = d.RptCtrId
	LEFT OUTER JOIN dbo.RptElm e ON a.RptElmId = e.RptElmId
	LEFT OUTER JOIN dbo.RptCel f ON a.RptCelId = f.RptCelId')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=268&typ=N&sys=3","","",""); return false;
269~@~   2.  41.71018:D:   50:*:*:M: Add column RptTblDesc to table RptTbl~@~77~@~50~@~D~@~~@~~@~M~@~~@~Add column RptTblDesc to table RptTbl~@~Y~@~EXEC ('UPDATE RptTbl SET ColWidth = replace(ColWidth,''in'','''')')
EXEC ('CREATE TABLE dbo.Tmp_RptTbl (RptTblId int NOT NULL, ParentId int NULL, RptCtrId int NOT NULL, RptTblTypeCd char(1) NOT NULL, TblRepeatNew char(1) NOT NULL, TblOrder smallint NULL, ColWidth varchar(10) NULL, TblGrouping varchar(1000) NULL, TblSorting varchar(1000) NULL, TblVisibility varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_RptTbl (RptTblId, ParentId, RptCtrId, RptTblTypeCd, TblRepeatNew, TblOrder, ColWidth, TblGrouping, TblSorting, TblVisibility) SELECT convert(int,RptTblId), convert(int,ParentId), convert(int,RptCtrId), RptTblTypeCd, TblRepeatNew, convert(smallint,TblOrder), ColWidth, TblGrouping, TblSorting, TblVisibility FROM dbo.RptTbl IF (SELECT COUNT(1) FROM dbo.Tmp_RptTbl) > 0 OR (SELECT COUNT(1) FROM dbo.RptTbl) = 0 DROP TABLE dbo.RptTbl') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptTbl'')) CREATE TABLE dbo.RptTbl (RptTblId Int IDENTITY NOT NULL, RptTblDesc NVarChar(200) NULL, ParentId Int NULL, RptCtrId Int NOT NULL, RptTblTypeCd Char(1) NOT NULL, TblRepeatNew Char(1) NOT NULL, TblOrder SmallInt NULL, ColWidth Decimal(8,2) NULL, TblGrouping VarChar(1000) NULL, TblSorting VarChar(1000) NULL, TblVisibility VarChar(1000) NULL, CONSTRAINT PK_RptTbl PRIMARY KEY CLUSTERED (RptTblId))') EXEC (' SET IDENTITY_INSERT dbo.RptTbl ON INSERT INTO dbo.RptTbl (RptTblId, ParentId, RptCtrId, RptTblTypeCd, TblRepeatNew, TblOrder, ColWidth, TblGrouping, TblSorting, TblVisibility) SELECT RptTblId, ParentId, RptCtrId, RptTblTypeCd, TblRepeatNew, TblOrder, CONVERT(Decimal(8,2),ColWidth), TblGrouping, TblSorting, TblVisibility FROM dbo.Tmp_RptTbl SET IDENTITY_INSERT dbo.RptTbl OFF IF (SELECT COUNT(1) FROM dbo.RptTbl) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptTbl) = 0 DROP TABLE dbo.Tmp_RptTbl')
EXEC ('UPDATE RptTbl SET RptTblDesc = b.RptCtrDesc + case when d.RptTblTypeName is null then '''' else '' ['' + d.RptTblTypeName + '']: '' end + '' ['' + c.RptTblTypeName + '']'' + convert(varchar,a.TblOrder)
FROM RptTbl a INNER JOIN RptCtr b ON a.RptCtrId = b.RptCtrId INNER JOIN [[?]]Design.dbo.CtRptTblType c ON a.RptTblTypeCd = c.RptTblTypeCd LEFT OUTER JOIN (SELECT x.RptTblId, y.RptTblTypeName FROM RptTbl x
INNER JOIN [[?]]Design.dbo.CtRptTblType y ON x.RptTblTypeCd = y.RptTblTypeCd) d ON a.ParentId = d.RptTblId')
EXEC ('UPDATE RptCel SET RptCelDesc = b.RptTblDesc + convert(varchar,a.RowNum) + '' ['' + c.RptTblDesc + '']'' 
FROM RptCel a INNER JOIN RptTbl b ON a.RptTblId = b.RptTblId INNER JOIN RptTbl c ON a.CelNum = c.RptTblId')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=269&typ=N&sys=3","","",""); return false;
270~@~   2.  41.71018:D:   10:*:*:M: Add column RptCelDesc to table RptCel~@~77~@~10~@~D~@~~@~~@~M~@~~@~Add column RptCelDesc to table RptCel~@~Y~@~EXEC ('UPDATE RptCel SET RowHeight = replace(RowHeight,''in'','''')')
EXEC ('CREATE TABLE dbo.Tmp_RptCel (RptCelId int NOT NULL, RptTblId int NOT NULL, RowNum smallint NOT NULL, RowHeight varchar(10) NOT NULL, RowVisibility varchar(1000) NULL, CelNum int NOT NULL, CelColSpan smallint NULL)') EXEC ('INSERT INTO dbo.Tmp_RptCel (RptCelId, RptTblId, RowNum, RowHeight, RowVisibility, CelNum, CelColSpan) SELECT convert(int,RptCelId), convert(int,RptTblId), convert(smallint,RowNum), RowHeight, RowVisibility, convert(int,CellNum), convert(smallint,CelColSpan) FROM dbo.RptCel IF (SELECT COUNT(1) FROM dbo.Tmp_RptCel) > 0 OR (SELECT COUNT(1) FROM dbo.RptCel) = 0 DROP TABLE dbo.RptCel') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptCel'')) CREATE TABLE dbo.RptCel (RptCelId Int IDENTITY NOT NULL, RptCelDesc NVarChar(200) NULL, RptTblId Int NOT NULL, RowNum SmallInt NOT NULL, RowHeight Decimal(8,2) NOT NULL, RowVisibility VarChar(1000) NULL, CelNum Int NOT NULL, CelColSpan SmallInt NULL, CONSTRAINT PK_RptCel PRIMARY KEY CLUSTERED (RptCelId))') EXEC (' SET IDENTITY_INSERT dbo.RptCel ON INSERT INTO dbo.RptCel (RptCelId, RptTblId, RowNum, RowHeight, RowVisibility, CelNum, CelColSpan) SELECT RptCelId, RptTblId, RowNum, CONVERT(Decimal(8,2),RowHeight), RowVisibility, CelNum, CelColSpan FROM dbo.Tmp_RptCel SET IDENTITY_INSERT dbo.RptCel OFF IF (SELECT COUNT(1) FROM dbo.RptCel) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptCel) = 0 DROP TABLE dbo.Tmp_RptCel')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=270&typ=N&sys=3","","",""); return false;
271~@~   2.  41.71018:D:   60:*:*:M: Add rows to CtEvent~@~77~@~60~@~D~@~~@~~@~M~@~~@~Add rows to CtEvent~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM CtEvent WHERE EventId = 13)
BEGIN
	UPDATE CtEvent SET EventDesc = ''Delete Grid Row (before)'' WHERE EventId = 5
	INSERT CtEvent SELECT 13, ''DELROR'', ''Delete Grid Row (Replace)''
	INSERT CtEvent SELECT 14, ''BUTCLR'', ''Button Click (Replace)''
	INSERT CtEvent SELECT 15, ''ITMDTR'', ''GridItemDataBound (Replace)''
	INSERT CtEvent SELECT 16, ''FUNPRO'', ''Custom Function/Procedure''
END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=271&typ=N&sys=3","","",""); return false;
272~@~   2.  41.71018:D:   70:*:*:M: Update mandatory error messages for ComboBox~@~77~@~70~@~D~@~~@~~@~M~@~~@~Update mandatory error messages for ComboBox~@~Y~@~EXEC ('UPDATE ScreenObjHlp SET ErrMessage = isnull(replace(a.ToolTip,''This is '',''Please enter ''),''Error!'') FROM ScreenObjHlp a INNER JOIN ScreenObj b ON a.ScreenObjId = b.ScreenObjId WHERE b.RequiredValid = ''Y'' AND b.DisplayModeId in (18,22) AND a.CultureId = 1')
EXEC ('DELETE FROM ScreenObjHlp WHERE CultureId <> 1 AND EXISTS (SELECT 1 FROM ScreenObj b WHERE ScreenObjHlp.ScreenObjId = b.ScreenObjId AND b.RequiredValid = ''Y'' AND b.DisplayModeId in (18,22))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=272&typ=N&sys=3","","",""); return false;
273~@~   2.  42.71020:D:   10:*:*:M: Change table AdvRule~@~78~@~10~@~D~@~~@~~@~M~@~~@~Change table AdvRule~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AdvRule'')) CREATE TABLE dbo.AdvRule (AdvRuleId Int IDENTITY NOT NULL, RuleLayerCd Char(1) NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, ScreenId Int NOT NULL, RmFuncProc VarChar(100) NULL, AdvRuleProg NText NOT NULL, CONSTRAINT PK_AdvRule PRIMARY KEY CLUSTERED (AdvRuleId))') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=273&typ=N&sys=3","","",""); return false;
274~@~   2.  42.71020:D:   20:*:*:M: Add table CtRuleLayer~@~78~@~20~@~D~@~~@~~@~M~@~~@~Add table CtRuleLayer~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtRuleLayer'))
BEGIN
EXEC ('CREATE TABLE dbo.CtRuleLayer (RuleLayerCd Char(1) NOT NULL, RuleLayerDesc NVarChar(50) NOT NULL, CONSTRAINT PK_CtRuleLayer PRIMARY KEY CLUSTERED (RuleLayerCd))')
EXEC ('INSERT CtRuleLayer VALUES (''A'',''Data Access'')')
EXEC ('INSERT CtRuleLayer VALUES (''S'',''Business Facade'')')
EXEC ('INSERT CtRuleLayer VALUES (''R'',''Business Rule'')')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=274&typ=N&sys=3","","",""); return false;
275~@~   2.  42.71020:D:   30:*:*:M: Update screen help messages~@~78~@~30~@~D~@~~@~~@~M~@~~@~Update screen help messages~@~Y~@~EXEC ('UPDATE ScreenHlp SET DefaultHlpMsg = replace(convert(nvarchar(4000),DefaultHlpMsg),''Update'',''Save'')')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=275&typ=N&sys=3","","",""); return false;
277~@~   3.   0.71119:D:   10:*:*:M: Add rows to CtAggregate~@~81~@~10~@~D~@~~@~~@~M~@~~@~Add rows to CtAggregate~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM CtAggregate WHERE AggregateCd = ''M'')
BEGIN
	INSERT CtAggregate SELECT ''M'', ''Max''
	INSERT CtAggregate SELECT ''I'', ''Min''
END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=277&typ=N&sys=3","","",""); return false;
279~@~   3.   0.71119:D:   20:*:*:M: Add table RptwizCat~@~81~@~20~@~D~@~~@~~@~M~@~~@~Add table RptwizCat~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptwizCat'')) CREATE TABLE dbo.RptwizCat (RptwizCatId SmallInt IDENTITY NOT NULL, RptwizCatName NVarChar(100) NOT NULL, RptwizCatDesc NVarChar(400) NOT NULL, RptwizCatImg VarChar(100) NULL, CONSTRAINT PK_RptwizCat PRIMARY KEY CLUSTERED (RptwizCatId))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=279&typ=N&sys=3","","",""); return false;
280~@~   3.   0.71119:D:   30:*:*:M: Add table RptwizCatDtl~@~81~@~30~@~D~@~~@~~@~M~@~~@~Add table RptwizCatDtl~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptwizCatDtl'')) CREATE TABLE dbo.RptwizCatDtl (RptwizCatDtlId Int IDENTITY NOT NULL, RptwizCatId SmallInt NOT NULL, TableId Int NOT NULL, KeyId Int NULL, CONSTRAINT PK_RptwizCatDtl PRIMARY KEY CLUSTERED (RptwizCatDtlId))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=280&typ=N&sys=3","","",""); return false;
281~@~   3.   0.71119:D:   40:*:*:M: Add table Rptwiz~@~81~@~40~@~D~@~~@~~@~M~@~~@~Add table Rptwiz~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Rptwiz'')) CREATE TABLE dbo.Rptwiz (RptwizId Int IDENTITY NOT NULL, RptwizName NVarChar(50) NOT NULL, RptwizDesc NVarChar(400) NOT NULL, RptwizTypeCd Char(1) NOT NULL, RptwizCatId SmallInt NULL, ReportId Int NULL, Changeable Char(1) NOT NULL, UsrId Int NOT NULL, CONSTRAINT PK_Rptwiz PRIMARY KEY CLUSTERED (RptwizId))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=281&typ=N&sys=3","","",""); return false;
282~@~   3.   0.71119:D:   50:*:*:M: Add table RptwizDtl~@~81~@~50~@~D~@~~@~~@~M~@~~@~Add table RptwizDtl~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptwizDtl'')) CREATE TABLE dbo.RptwizDtl (RptwizDtlId Int IDENTITY NOT NULL, RptwizId Int NOT NULL, ColumnId Int NOT NULL, CriOperatorId TinyInt NULL, CriSelect SmallInt NULL, ColSelect SmallInt NULL, ColGroup1 SmallInt NULL, ColGroup2 SmallInt NULL, ColGroup3 SmallInt NULL, ColSort SmallInt NULL, AggregateCd Char(1) NULL, CONSTRAINT PK_RptwizDtl PRIMARY KEY CLUSTERED (RptwizDtlId))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=282&typ=N&sys=3","","",""); return false;
283~@~   3.   0.71119:D:   60:*:*:M: Change table CtAggregate content~@~81~@~60~@~D~@~~@~~@~M~@~~@~Change table CtAggregate content~@~N~@~update CtAggregate SET AggregateName = 'Average' WHERE AggregateCd = 'A'
update CtAggregate SET AggregateName = 'Count' WHERE AggregateCd = 'C'
update CtAggregate SET AggregateName = 'Minimum' WHERE AggregateCd = 'I'
update CtAggregate SET AggregateName = 'Maximum' WHERE AggregateCd = 'M'
update CtAggregate SET AggregateName = 'Summary' WHERE AggregateCd = 'S'~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=283&typ=N&sys=3","","",""); return false;
284~@~   3.   0.71119:D:   70:*:*:M: Change table CtOperator~@~81~@~70~@~D~@~~@~~@~M~@~~@~Change table CtOperator~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_CtOperator (OperatorId tinyint NOT NULL, OperatorName varchar(10) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_CtOperator (OperatorId, OperatorName) SELECT convert(tinyint,OperatorId), OperatorName FROM dbo.CtOperator IF (SELECT COUNT(1) FROM dbo.Tmp_CtOperator) > 0 OR (SELECT COUNT(1) FROM dbo.CtOperator) = 0 DROP TABLE dbo.CtOperator') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtOperator'')) CREATE TABLE dbo.CtOperator (OperatorId TinyInt NOT NULL, OperatorName VarChar(10) NOT NULL, OperatorDesc NVarChar(20) NULL, CONSTRAINT PK_CtOperator PRIMARY KEY CLUSTERED (OperatorId))') EXEC (' INSERT INTO dbo.CtOperator (OperatorId, OperatorName) SELECT OperatorId, OperatorName FROM dbo.Tmp_CtOperator IF (SELECT COUNT(1) FROM dbo.CtOperator) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtOperator) = 0 DROP TABLE dbo.Tmp_CtOperator')
EXEC ('update CtOperator set OperatorDesc = ''equal to'' where OperatorId = 1')
EXEC ('update CtOperator set OperatorDesc = ''greater or equal'' where OperatorId = 2')
EXEC ('update CtOperator set OperatorDesc = ''less or equal'' where OperatorId = 3')
EXEC ('update CtOperator set OperatorDesc = ''greater than'' where OperatorId = 4')
EXEC ('update CtOperator set OperatorDesc = ''less than'' where OperatorId = 5')
EXEC ('update CtOperator set OperatorDesc = ''like'' where OperatorId = 6')
EXEC ('update CtOperator set OperatorDesc = ''in'' where OperatorId = 7')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=284&typ=N&sys=3","","",""); return false;
285~@~   3.   0.71119:D:   80:*:*:M: Add rows to CtRptStyDef~@~81~@~80~@~D~@~~@~~@~M~@~~@~Add rows to CtRptStyDef~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM CtRptStyDef WHERE DefaultCd = ''PL'')
BEGIN
insert CtRptStyDef values (''PL'',''Page Left'')
insert CtRptStyDef values (''PR'',''Page Right'')
insert CtRptStyDef values (''CH'',''Column Heading'')
insert CtRptStyDef values (''CD'',''Column Value Date'')
insert CtRptStyDef values (''CS'',''Column Value String'')
insert CtRptStyDef values (''CN'',''Column Value Number'')
insert CtRptStyDef values (''CM'',''Column Value Money'')
END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=285&typ=N&sys=3","","",""); return false;
286~@~   3.   1.71130:D:   10:*:*:M: Add table RptwizTyp~@~82~@~10~@~D~@~~@~~@~M~@~~@~Add table RptwizTyp~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptwizTyp'')) CREATE TABLE dbo.RptwizTyp (RptwizTypId SmallInt IDENTITY NOT NULL, RptwizTypName NVarChar(100) NOT NULL, CONSTRAINT PK_RptwizTyp PRIMARY KEY CLUSTERED (RptwizTypId))')
EXEC ('INSERT dbo.RptwizTyp (RptwizTypName) VALUES (''General'')')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=286&typ=N&sys=3","","",""); return false;
287~@~   3.   1.71130:D:   20:*:*:M: Add column to table RptwizCat~@~82~@~20~@~D~@~~@~~@~M~@~~@~Add column to table RptwizCat~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_RptwizCat (RptwizCatId smallint NOT NULL, RptwizCatName nvarchar(100) NOT NULL, RptwizCatDesc nvarchar(200) NOT NULL, RptwizCatImg varchar(100) NULL)')
EXEC ('INSERT INTO dbo.Tmp_RptwizCat (RptwizCatId, RptwizCatName, RptwizCatDesc, RptwizCatImg) SELECT convert(smallint,RptwizCatId), RptwizCatName, isnull(RptwizCatDesc,RptwizCatName), RptwizCatImg FROM dbo.RptwizCat IF (SELECT COUNT(1) FROM dbo.Tmp_RptwizCat) > 0 OR (SELECT COUNT(1) FROM dbo.RptwizCat) = 0 DROP TABLE dbo.RptwizCat')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptwizCat'')) CREATE TABLE dbo.RptwizCat (RptwizCatId SmallInt IDENTITY NOT NULL, RptwizTypId SmallInt NOT NULL, RptwizCatName NVarChar(100) NOT NULL, RptwizCatDesc NVarChar(200) NULL, CatDescription nvarchar(400) NOT NULL, RptwizCatImg VarChar(100) NULL, CONSTRAINT PK_RptwizCat PRIMARY KEY CLUSTERED (RptwizCatId))')
EXEC ('ALTER TABLE dbo.RptwizCat ADD CONSTRAINT DF_RptwizCat_RptwizTypId DEFAULT (1) FOR RptwizTypId SET IDENTITY_INSERT dbo.RptwizCat ON INSERT INTO dbo.RptwizCat (RptwizCatId, RptwizTypId, RptwizCatName, CatDescription, RptwizCatImg) SELECT RptwizCatId, 1, RptwizCatName, RptwizCatDesc, RptwizCatImg FROM dbo.Tmp_RptwizCat SET IDENTITY_INSERT dbo.RptwizCat OFF IF (SELECT COUNT(1) FROM dbo.RptwizCat) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptwizCat) = 0 DROP TABLE dbo.Tmp_RptwizCat')
EXEC ('UPDATE dbo.RptwizCat SET RptwizCatDesc = b.RptwizTypName + '': '' + a.RptwizCatName FROM dbo.RptwizCat a INNER JOIN dbo.RptwizTyp b ON a.RptwizTypId = b.RptwizTypId')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=287&typ=N&sys=3","","",""); return false;
288~@~   3.   1.71130:D:   30:*:*:M: Add margin columns to table Rptwiz~@~82~@~30~@~D~@~~@~~@~M~@~~@~Add margin columns to table Rptwiz~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_Rptwiz (RptwizId int NOT NULL, RptwizName nvarchar(50) NOT NULL, RptwizDesc nvarchar(400) NOT NULL, RptwizTypeCd char(1) NOT NULL, RptwizCatId smallint NULL, ReportId int NULL, Changeable char(1) NOT NULL, UsrId int NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_Rptwiz (RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, ReportId, Changeable, UsrId) SELECT convert(int,RptwizId), RptwizName, RptwizDesc, RptwizTypeCd, convert(smallint,RptwizCatId), convert(int,ReportId), Changeable, convert(int,UsrId) FROM dbo.Rptwiz IF (SELECT COUNT(1) FROM dbo.Tmp_Rptwiz) > 0 OR (SELECT COUNT(1) FROM dbo.Rptwiz) = 0 DROP TABLE dbo.Rptwiz') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Rptwiz'')) CREATE TABLE dbo.Rptwiz (RptwizId Int IDENTITY NOT NULL, RptwizName NVarChar(50) NOT NULL, RptwizDesc NVarChar(400) NOT NULL, RptwizTypeCd Char(1) NOT NULL, RptwizCatId SmallInt NULL, ReportId Int NULL, Changeable Char(1) NOT NULL, UsrId Int NOT NULL, TopMargin Decimal(8,2) NULL, BottomMargin Decimal(8,2) NULL, LeftMargin Decimal(8,2) NULL, RightMargin Decimal(8,2) NULL, Portrait Char(1) NOT NULL, CONSTRAINT PK_Rptwiz PRIMARY KEY CLUSTERED (RptwizId))') EXEC (' ALTER TABLE dbo.Rptwiz ADD CONSTRAINT DF_Rptwiz_Portrait DEFAULT (''Y'') FOR Portrait SET IDENTITY_INSERT dbo.Rptwiz ON INSERT INTO dbo.Rptwiz (RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, ReportId, Changeable, UsrId, Portrait) SELECT RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, ReportId, Changeable, UsrId, ''Y'' FROM dbo.Tmp_Rptwiz SET IDENTITY_INSERT dbo.Rptwiz OFF IF (SELECT COUNT(1) FROM dbo.Rptwiz) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Rptwiz) = 0 DROP TABLE dbo.Tmp_Rptwiz')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=288&typ=N&sys=3","","",""); return false;
289~@~   3.   1.71130:D:   40:*:*:M: Add column UnitCd to table Rptwiz~@~82~@~40~@~D~@~~@~~@~M~@~~@~Add column UnitCd to table Rptwiz~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_Rptwiz (RptwizId int NOT NULL, RptwizName nvarchar(50) NOT NULL, RptwizDesc nvarchar(400) NOT NULL, RptwizTypeCd char(1) NOT NULL, RptwizCatId smallint NULL, ReportId int NULL, Changeable char(1) NOT NULL, UsrId int NOT NULL, TopMargin decimal(8,2) NULL, BottomMargin decimal(8,2) NULL, LeftMargin decimal(8,2) NULL, RightMargin decimal(8,2) NULL, Portrait char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_Rptwiz (RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, Portrait) SELECT convert(int,RptwizId), RptwizName, RptwizDesc, RptwizTypeCd, convert(smallint,RptwizCatId), convert(int,ReportId), Changeable, convert(int,UsrId), convert(decimal(8,2),TopMargin), convert(decimal(8,2),BottomMargin), convert(decimal(8,2),LeftMargin), convert(decimal(8,2),RightMargin), Portrait FROM dbo.Rptwiz IF (SELECT COUNT(1) FROM dbo.Tmp_Rptwiz) > 0 OR (SELECT COUNT(1) FROM dbo.Rptwiz) = 0 DROP TABLE dbo.Rptwiz') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Rptwiz'')) CREATE TABLE dbo.Rptwiz (RptwizId Int IDENTITY NOT NULL, RptwizName NVarChar(50) NOT NULL, RptwizDesc NVarChar(400) NOT NULL, RptwizTypeCd Char(1) NOT NULL, RptwizCatId SmallInt NULL, ReportId Int NULL, Changeable Char(1) NOT NULL, UsrId Int NOT NULL, TopMargin Decimal(8,2) NULL, BottomMargin Decimal(8,2) NULL, LeftMargin Decimal(8,2) NULL, RightMargin Decimal(8,2) NULL, Portrait Char(1) NOT NULL, UnitCd Char(2) NOT NULL, CONSTRAINT PK_Rptwiz PRIMARY KEY CLUSTERED (RptwizId))') EXEC (' ALTER TABLE dbo.Rptwiz ADD CONSTRAINT DF_Rptwiz_Portrait DEFAULT (''Y'') FOR Portrait ALTER TABLE dbo.Rptwiz ADD CONSTRAINT DF_Rptwiz_UnitCd DEFAULT (''in'') FOR UnitCd SET IDENTITY_INSERT dbo.Rptwiz ON INSERT INTO dbo.Rptwiz (RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, Portrait, UnitCd) SELECT RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, Portrait, ''in'' FROM dbo.Tmp_Rptwiz SET IDENTITY_INSERT dbo.Rptwiz OFF IF (SELECT COUNT(1) FROM dbo.Rptwiz) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Rptwiz) = 0 DROP TABLE dbo.Tmp_Rptwiz')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=289&typ=N&sys=3","","",""); return false;
290~@~   3.   1.71130:D:   50:*:*:M: Add RptCtrTypeDesc to table CtRptCtrType~@~82~@~50~@~D~@~~@~~@~M~@~~@~Add RptCtrTypeDesc to table CtRptCtrType~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_CtRptCtrType (RptCtrTypeCd char(1) NOT NULL, RptCtrTypeName nvarchar(20) NOT NULL, HasChildCtr char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_CtRptCtrType (RptCtrTypeCd, RptCtrTypeName, HasChildCtr) SELECT RptCtrTypeCd, RptCtrTypeName, HasChildCtr FROM dbo.CtRptCtrType IF (SELECT COUNT(1) FROM dbo.Tmp_CtRptCtrType) > 0 OR (SELECT COUNT(1) FROM dbo.CtRptCtrType) = 0 DROP TABLE dbo.CtRptCtrType') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtRptCtrType'')) CREATE TABLE dbo.CtRptCtrType (RptCtrTypeCd Char(1) NOT NULL, RptCtrTypeName NVarChar(20) NOT NULL, RptCtrTypeDesc NVarChar(400) NULL, HasChildCtr Char(1) NOT NULL, CONSTRAINT PK_CtRptCtrType PRIMARY KEY CLUSTERED (RptCtrTypeCd))') EXEC (' ALTER TABLE dbo.CtRptCtrType ADD CONSTRAINT DF_CtRptCtrType_HasChildCtr DEFAULT (''N'') FOR HasChildCtr INSERT INTO dbo.CtRptCtrType (RptCtrTypeCd, RptCtrTypeName, HasChildCtr) SELECT RptCtrTypeCd, RptCtrTypeName, HasChildCtr FROM dbo.Tmp_CtRptCtrType IF (SELECT COUNT(1) FROM dbo.CtRptCtrType) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtRptCtrType) = 0 DROP TABLE dbo.Tmp_CtRptCtrType')
EXEC ('UPDATE dbo.CtRptCtrType SET RptCtrTypeDesc = ''Chart is the graphical representation of summary data.'' WHERE RptCtrTypeCd = ''C''')
EXEC ('UPDATE dbo.CtRptCtrType SET RptCtrTypeDesc = ''Image is any jpeg or gif file.'' WHERE RptCtrTypeCd = ''I''')
EXEC ('UPDATE dbo.CtRptCtrType SET RptCtrTypeDesc = ''List is the simplest and fastest way to list your data, grouped or ungrouped.'' WHERE RptCtrTypeCd = ''L''')
EXEC ('UPDATE dbo.CtRptCtrType SET RptCtrTypeDesc = ''This is a horizontal line.'' WHERE RptCtrTypeCd = ''N''')
EXEC ('UPDATE dbo.CtRptCtrType SET RptCtrTypeDesc = ''This is rectangle and it can be a container for other report controls.'' WHERE RptCtrTypeCd = ''R''')
EXEC ('UPDATE dbo.CtRptCtrType SET RptCtrTypeDesc = ''Table list your data with subtotals and other summary information.'' WHERE RptCtrTypeCd = ''T''')
EXEC ('UPDATE dbo.CtRptCtrType SET RptCtrTypeDesc = ''Textbox is commonely used to display a field.'' WHERE RptCtrTypeCd = ''X''')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=290&typ=N&sys=3","","",""); return false;
292~@~   3.   1.71130:D:   60:*:*:M: Add AggregateSort to table CtAggregate~@~82~@~60~@~D~@~~@~~@~M~@~~@~Add AggregateSort to table CtAggregate~@~N~@~EXEC ('CREATE TABLE dbo.Tmp_CtAggregate (AggregateCd char(1) NOT NULL, AggregateName nvarchar(10) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_CtAggregate (AggregateCd, AggregateName) SELECT AggregateCd, AggregateName FROM dbo.CtAggregate IF (SELECT COUNT(1) FROM dbo.Tmp_CtAggregate) > 0 OR (SELECT COUNT(1) FROM dbo.CtAggregate) = 0 DROP TABLE dbo.CtAggregate') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtAggregate'')) CREATE TABLE dbo.CtAggregate (AggregateCd Char(1) NOT NULL, AggregateName NVarChar(10) NOT NULL, AggregateSort TinyInt NULL, CONSTRAINT PK_CtAggregate PRIMARY KEY CLUSTERED (AggregateCd))') EXEC (' INSERT INTO dbo.CtAggregate (AggregateCd, AggregateName) SELECT AggregateCd, AggregateName FROM dbo.Tmp_CtAggregate IF (SELECT COUNT(1) FROM dbo.CtAggregate) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtAggregate) = 0 DROP TABLE dbo.Tmp_CtAggregate')
EXEC ('UPDATE dbo.CtAggregate SET AggregateSort = case when AggregateCd = ''C'' then 10 when AggregateCd = ''S'' then 20 when AggregateCd = ''A'' then 30 when AggregateCd = ''M'' then 40 else 50 end')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=292&typ=N&sys=3","","",""); return false;
293~@~   3.   1.71130:D:   70:*:*:M: Consolidate ColGroups in table RptwizDtl~@~82~@~70~@~D~@~~@~~@~M~@~~@~Consolidate ColGroups in table RptwizDtl~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_RptwizDtl (RptwizDtlId int NOT NULL, RptwizId int NOT NULL, ColumnId int NOT NULL, CriOperatorId tinyint NULL, CriSelect smallint NULL, ColSelect smallint NULL, ColGroup1 smallint NULL, ColGroup2 smallint NULL, ColGroup3 smallint NULL, ColSort smallint NULL, AggregateCd char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_RptwizDtl (RptwizDtlId, RptwizId, ColumnId, CriOperatorId, CriSelect, ColSelect, ColGroup1, ColGroup2, ColGroup3, ColSort, AggregateCd) SELECT convert(int,RptwizDtlId), convert(int,RptwizId), convert(int,ColumnId), convert(tinyint,CriOperatorId), convert(smallint,CriSelect), convert(smallint,ColSelect), convert(smallint,ColGroup1), convert(smallint,ColGroup2), convert(smallint,ColGroup3), convert(smallint,ColSort), AggregateCd FROM dbo.RptwizDtl IF (SELECT COUNT(1) FROM dbo.Tmp_RptwizDtl) > 0 OR (SELECT COUNT(1) FROM dbo.RptwizDtl) = 0 DROP TABLE dbo.RptwizDtl') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptwizDtl'')) CREATE TABLE dbo.RptwizDtl (RptwizDtlId Int IDENTITY NOT NULL, RptwizId Int NOT NULL, ColumnId Int NOT NULL, CriOperatorId TinyInt NULL, CriSelect SmallInt NULL, ColSelect SmallInt NULL, ColGroup SmallInt NULL, ColSort SmallInt NULL, AggregateCd Char(1) NULL, CONSTRAINT PK_RptwizDtl PRIMARY KEY CLUSTERED (RptwizDtlId))') EXEC (' SET IDENTITY_INSERT dbo.RptwizDtl ON INSERT INTO dbo.RptwizDtl (RptwizDtlId, RptwizId, ColumnId, CriOperatorId, CriSelect, ColSelect, ColGroup, ColSort, AggregateCd) SELECT RptwizDtlId, RptwizId, ColumnId, CriOperatorId, CriSelect, ColSelect, ColGroup1, ColSort, AggregateCd FROM dbo.Tmp_RptwizDtl SET IDENTITY_INSERT dbo.RptwizDtl OFF IF (SELECT COUNT(1) FROM dbo.RptwizDtl) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptwizDtl) = 0 DROP TABLE dbo.Tmp_RptwizDtl')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=293&typ=N&sys=3","","",""); return false;
294~@~   3.   1.71130:D:   80:*:*:M: Add table CtRptGroup~@~82~@~80~@~D~@~~@~~@~M~@~~@~Add table CtRptGroup~@~N~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtRptGroup'')) CREATE TABLE dbo.CtRptGroup (RptGroupId TinyInt NOT NULL, RptGroupName NVarChar(100) NOT NULL, CONSTRAINT PK_CtRptGroup PRIMARY KEY CLUSTERED (RptGroupId))')
EXEC ('INSERT dbo.CtRptGroup VALUES (1,''Group data by [1]'')')
EXEC ('INSERT dbo.CtRptGroup VALUES (2,''and then by [2]'')')
EXEC ('INSERT dbo.CtRptGroup VALUES (3,''and finally by [3]'')')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=294&typ=N&sys=3","","",""); return false;
295~@~   3.   1.71130:D:   90:*:*:M: Change table CtOperator~@~82~@~90~@~D~@~~@~~@~M~@~~@~Change table CtOperator~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_CtOperator (OperatorId tinyint NOT NULL, OperatorName varchar(10) NOT NULL, OperatorDesc nvarchar(20) NULL)') EXEC (' INSERT INTO dbo.Tmp_CtOperator (OperatorId, OperatorName, OperatorDesc) SELECT convert(tinyint,OperatorId), OperatorName, OperatorDesc FROM dbo.CtOperator IF (SELECT COUNT(1) FROM dbo.Tmp_CtOperator) > 0 OR (SELECT COUNT(1) FROM dbo.CtOperator) = 0 DROP TABLE dbo.CtOperator') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtOperator'')) CREATE TABLE dbo.CtOperator (OperatorId TinyInt NOT NULL, OperatorName VarChar(10) NOT NULL, OperatorDesc NVarChar(30) NULL, CONSTRAINT PK_CtOperator PRIMARY KEY CLUSTERED (OperatorId))') EXEC (' INSERT INTO dbo.CtOperator (OperatorId, OperatorName, OperatorDesc) SELECT OperatorId, OperatorName, OperatorDesc FROM dbo.Tmp_CtOperator IF (SELECT COUNT(1) FROM dbo.CtOperator) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtOperator) = 0 DROP TABLE dbo.Tmp_CtOperator')
EXEC ('update CtOperator set OperatorDesc = ''equal'' where OperatorId = 1')
EXEC ('update CtOperator set OperatorDesc = ''greater than or equal'' where OperatorId = 2')
EXEC ('update CtOperator set OperatorDesc = ''less than or equal'' where OperatorId = 3')
EXEC ('update CtOperator set OperatorDesc = ''greater than'' where OperatorId = 4')
EXEC ('update CtOperator set OperatorDesc = ''less than'' where OperatorId = 5')
EXEC ('update CtOperator set OperatorDesc = ''contains'' where OperatorId = 6')
EXEC ('update CtOperator set OperatorDesc = ''in the list'' where OperatorId = 7')
EXEC ('insert CtOperator values (''8'',''not like'',''does not contain'')')
EXEC ('insert CtOperator values (''9'',''not in'',''not in the list'')')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=295&typ=N&sys=3","","",""); return false;
296~@~   3.   1.71130:D:  100:*:*:M: Change content of CtMenuOption~@~82~@~100~@~D~@~~@~~@~M~@~~@~Change content of CtMenuOption~@~N~@~exec ('update CtMenuOption SET MenuOptionDesc = ''Side Menu Solid'' WHERE MenuOptionCode = ''S''')
exec ('update CtMenuOption SET MenuOptionDesc = ''Top Menu Float'' WHERE MenuOptionCode = ''T''')
exec ('insert CtMenuOption VALUES (''F'',''Side Menu Float'')')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=296&typ=N&sys=3","","",""); return false;
297~@~   3.   2.71212:D:   10:*:*:M: Add columns to table RptwizDtl~@~83~@~10~@~D~@~~@~~@~M~@~~@~Add columns to table RptwizDtl~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_RptwizDtl (RptwizDtlId int NOT NULL, RptwizId int NOT NULL, ColumnId int NOT NULL, CriOperatorId tinyint NULL, CriSelect smallint NULL, ColSelect smallint NULL, ColGroup smallint NULL, ColSort smallint NULL, AggregateCd char(1) NULL)')
EXEC ('INSERT INTO dbo.Tmp_RptwizDtl (RptwizDtlId, RptwizId, ColumnId, CriOperatorId, CriSelect, ColSelect, ColGroup, ColSort, AggregateCd) SELECT convert(int,RptwizDtlId), convert(int,RptwizId), convert(int,ColumnId), convert(tinyint,CriOperatorId), convert(smallint,CriSelect), convert(smallint,ColSelect), convert(smallint,ColGroup), convert(smallint,ColSort), AggregateCd FROM dbo.RptwizDtl IF (SELECT COUNT(1) FROM dbo.Tmp_RptwizDtl) > 0 OR (SELECT COUNT(1) FROM dbo.RptwizDtl) = 0 DROP TABLE dbo.RptwizDtl')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptwizDtl'')) CREATE TABLE dbo.RptwizDtl (RptwizDtlId Int IDENTITY NOT NULL, RptwizId Int NOT NULL, ColumnId Int NOT NULL, ColHeader NVarChar(50) NULL, CriOperatorId TinyInt NULL, CriSelect SmallInt NULL, CriHeader NVarChar(50) NULL, ColSelect SmallInt NULL, ColGroup SmallInt NULL, ColSort SmallInt NULL, AggregateCd Char(1) NULL, CONSTRAINT PK_RptwizDtl PRIMARY KEY CLUSTERED (RptwizDtlId))')
EXEC ('SET IDENTITY_INSERT dbo.RptwizDtl ON INSERT INTO dbo.RptwizDtl (RptwizDtlId, RptwizId, ColumnId, CriOperatorId, CriSelect, ColSelect, ColGroup, ColSort, AggregateCd) SELECT RptwizDtlId, RptwizId, ColumnId, CriOperatorId, CriSelect, ColSelect, ColGroup, ColSort, AggregateCd FROM dbo.Tmp_RptwizDtl SET IDENTITY_INSERT dbo.RptwizDtl OFF IF (SELECT COUNT(1) FROM dbo.RptwizDtl) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptwizDtl) = 0 DROP TABLE dbo.Tmp_RptwizDtl')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=297&typ=N&sys=3","","",""); return false;
299~@~   3.   2.71212:D:   20:*:*:M: Add table CtOrientation~@~83~@~20~@~D~@~~@~~@~M~@~~@~Add table CtOrientation~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtOrientation'')) BEGIN
CREATE TABLE dbo.CtOrientation (OrientationCd Char(1) NOT NULL, OrientationName nvarChar(30) NOT NULL, CONSTRAINT PK_CtOrientation PRIMARY KEY CLUSTERED (OrientationCd))
INSERT CtOrientation VALUES (''P'',''Portrait'')
INSERT CtOrientation VALUES (''L'',''Landscape'')
END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=299&typ=N&sys=3","","",""); return false;
300~@~   3.   2.71212:D:   30:*:*:M: Change OrientationCd in table Rptwiz~@~83~@~30~@~D~@~~@~~@~M~@~~@~Change OrientationCd in table Rptwiz~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_Rptwiz (RptwizId int NOT NULL, RptwizName nvarchar(50) NOT NULL, RptwizDesc nvarchar(400) NOT NULL, RptwizTypeCd char(1) NOT NULL, RptwizCatId smallint NULL, ReportId int NULL, Changeable char(1) NOT NULL, UsrId int NOT NULL, TopMargin decimal(8,2) NULL, BottomMargin decimal(8,2) NULL, LeftMargin decimal(8,2) NULL, RightMargin decimal(8,2) NULL, Portrait char(1) NOT NULL, UnitCd char(2) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_Rptwiz (RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, Portrait, UnitCd) SELECT convert(int,RptwizId), RptwizName, RptwizDesc, RptwizTypeCd, convert(smallint,RptwizCatId), convert(int,ReportId), Changeable, convert(int,UsrId), convert(decimal(8,2),TopMargin), convert(decimal(8,2),BottomMargin), convert(decimal(8,2),LeftMargin), convert(decimal(8,2),RightMargin), Portrait, UnitCd FROM dbo.Rptwiz IF (SELECT COUNT(1) FROM dbo.Tmp_Rptwiz) > 0 OR (SELECT COUNT(1) FROM dbo.Rptwiz) = 0 DROP TABLE dbo.Rptwiz') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Rptwiz'')) CREATE TABLE dbo.Rptwiz (RptwizId Int IDENTITY NOT NULL, RptwizName NVarChar(50) NOT NULL, RptwizDesc NVarChar(400) NOT NULL, RptwizTypeCd Char(1) NOT NULL, RptwizCatId SmallInt NULL, ReportId Int NULL, Changeable Char(1) NOT NULL, UsrId Int NOT NULL, TopMargin Decimal(8,2) NULL, BottomMargin Decimal(8,2) NULL, LeftMargin Decimal(8,2) NULL, RightMargin Decimal(8,2) NULL, OrientationCd Char(1) NOT NULL, UnitCd Char(2) NOT NULL, CONSTRAINT PK_Rptwiz PRIMARY KEY CLUSTERED (RptwizId))') EXEC (' ALTER TABLE dbo.Rptwiz ADD CONSTRAINT DF_Rptwiz_OrientationCd DEFAULT (''Y'') FOR OrientationCd ALTER TABLE dbo.Rptwiz ADD CONSTRAINT DF_Rptwiz_UnitCd DEFAULT (''in'') FOR UnitCd SET IDENTITY_INSERT dbo.Rptwiz ON INSERT INTO dbo.Rptwiz (RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, OrientationCd, UnitCd) SELECT RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, Portrait, UnitCd FROM dbo.Tmp_Rptwiz SET IDENTITY_INSERT dbo.Rptwiz OFF IF (SELECT COUNT(1) FROM dbo.Rptwiz) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Rptwiz) = 0 DROP TABLE dbo.Tmp_Rptwiz')
EXEC ('UPDATE Rptwiz SET OrientationCd = ''P'' WHERE OrientationCd = ''Y'' UPDATE Rptwiz SET OrientationCd = ''L'' WHERE OrientationCd = ''N''')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=300&typ=N&sys=3","","",""); return false;
301~@~   3.   2.71212:D:   40:*:*:M: Change OrientationCd in table Report~@~83~@~40~@~D~@~~@~~@~M~@~~@~Change OrientationCd in table Report~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportCri_Report'') ALTER TABLE dbo.ReportCri DROP CONSTRAINT FK_ReportCri_Report IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportObj_Report'') ALTER TABLE dbo.ReportObj DROP CONSTRAINT FK_ReportObj_Report CREATE TABLE dbo.Tmp_Report (ReportId int NOT NULL, ProgramName varchar(20) NOT NULL, ReportDesc nvarchar(50) NULL, GlobalCriteria char(1) NOT NULL, PrintPortrait char(1) NOT NULL, ToXlsOnly char(1) NOT NULL, TemplateName varchar(50) NULL, SqlRptSrv char(1) NOT NULL, CopyReportId int NULL, TopMargin decimal(8,2) NOT NULL, BottomMargin decimal(8,2) NOT NULL, LeftMargin decimal(8,2) NOT NULL, RightMargin decimal(8,2) NOT NULL, PageHeight decimal(8,2) NOT NULL, PageWidth decimal(8,2) NOT NULL, UnitCd char(2) NOT NULL, WhereClause varchar(1000) NULL, RegClause varchar(400) NULL, RegCode ntext NULL, ValClause varchar(400) NULL, ValCode ntext NULL, UpdClause varchar(200) NULL, UpdCode ntext NULL, XlsClause varchar(200) NULL, XlsCode ntext NULL, GenerateRp char(1) NOT NULL, ModifiedBy int NULL, ModifiedOn datetime NULL, LastGenDt datetime NULL)') EXEC (' INSERT INTO dbo.Tmp_Report (ReportId, ProgramName, ReportDesc, GlobalCriteria, PrintPortrait, ToXlsOnly, TemplateName, SqlRptSrv, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, ModifiedBy, ModifiedOn, LastGenDt) SELECT convert(int,ReportId), ProgramName, ReportDesc, GlobalCriteria, PrintPortrait, ToXlsOnly, TemplateName, SqlRptSrv, convert(int,CopyReportId), convert(decimal(8,2),TopMargin), convert(decimal(8,2),BottomMargin), convert(decimal(8,2),LeftMargin), convert(decimal(8,2),RightMargin), convert(decimal(8,2),PageHeight), convert(decimal(8,2),PageWidth), UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, convert(int,ModifiedBy), ModifiedOn, LastGenDt FROM dbo.Report IF (SELECT COUNT(1) FROM dbo.Tmp_Report) > 0 OR (SELECT COUNT(1) FROM dbo.Report) = 0 DROP TABLE dbo.Report') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Report'')) CREATE TABLE dbo.Report (ReportId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ReportDesc NVarChar(50) NULL, GlobalCriteria Char(1) NOT NULL, OrientationCd Char(1) NOT NULL, ToXlsOnly Char(1) NOT NULL, TemplateName VarChar(50) NULL, SqlRptSrv Char(1) NOT NULL, CopyReportId Int NULL, TopMargin Decimal(8,2) NOT NULL, BottomMargin Decimal(8,2) NOT NULL, LeftMargin Decimal(8,2) NOT NULL, RightMargin Decimal(8,2) NOT NULL, PageHeight Decimal(8,2) NOT NULL, PageWidth Decimal(8,2) NOT NULL, UnitCd Char(2) NOT NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, RegCode NText NULL, ValClause VarChar(400) NULL, ValCode NText NULL, UpdClause VarChar(200) NULL, UpdCode NText NULL, XlsClause VarChar(200) NULL, XlsCode NText NULL, GenerateRp Char(1) NOT NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, CONSTRAINT PK_Report PRIMARY KEY CLUSTERED (ReportId))') EXEC (' ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_SqlRptSrv DEFAULT (''N'') FOR SqlRptSrv ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_TopMargin DEFAULT (1) FOR TopMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_BottomMargin DEFAULT (1) FOR BottomMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_LeftMargin DEFAULT (1) FOR LeftMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_RightMargin DEFAULT (1) FOR RightMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_PageHeight DEFAULT (11) FOR PageHeight ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_PageWidth DEFAULT (8.5) FOR PageWidth ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_UnitCd DEFAULT (''in'') FOR UnitCd SET IDENTITY_INSERT dbo.Report ON INSERT INTO dbo.Report (ReportId, ProgramName, ReportDesc, GlobalCriteria, OrientationCd, ToXlsOnly, TemplateName, SqlRptSrv, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, ModifiedBy, ModifiedOn, LastGenDt) SELECT ReportId, ProgramName, ReportDesc, GlobalCriteria, PrintPortrait, ToXlsOnly, TemplateName, SqlRptSrv, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, ModifiedBy, ModifiedOn, LastGenDt FROM dbo.Tmp_Report SET IDENTITY_INSERT dbo.Report OFF IF (SELECT COUNT(1) FROM dbo.Report) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Report) = 0 DROP TABLE dbo.Tmp_Report CREATE  UNIQUE NONCLUSTERED INDEX IX_Report_ProgramName ON dbo.Report (ProgramName) ALTER TABLE dbo.ReportCri WITH NOCHECK ADD CONSTRAINT FK_ReportCri_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId) ALTER TABLE dbo.ReportObj WITH NOCHECK ADD CONSTRAINT FK_ReportObj_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId)')
EXEC ('UPDATE Report SET OrientationCd = ''P'' WHERE OrientationCd = ''Y'' UPDATE Report SET OrientationCd = ''L'' WHERE OrientationCd = ''N''')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=301&typ=N&sys=3","","",""); return false;
302~@~   3.   2.71212:D:   50:*:*:M: Add rows to CtDisplayType~@~83~@~50~@~D~@~~@~~@~M~@~~@~Add rows to CtDisplayType~@~N~@~EXEC ('INSERT CtDisplayType select 17, ''RadioButtonList'', ''RadioButtonList'', ''N''')
EXEC ('INSERT CtDisplayType select 31, ''TextBox'', ''ShortDateTime'', ''N''')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=302&typ=N&sys=3","","",""); return false;
303~@~   3.   3.80102:D:   10:*:*:M: Add rows to CtRptStyDef~@~84~@~10~@~D~@~~@~~@~M~@~~@~Add rows to CtRptStyDef~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM CtRptStyDef WHERE DefaultCd = ''GD'')
BEGIN
insert CtRptStyDef values (''GD'',''Group Value Date'')
insert CtRptStyDef values (''GS'',''Group Value String'')
insert CtRptStyDef values (''GN'',''Group Value Number'')
insert CtRptStyDef values (''GM'',''Group Value Money'')
END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=303&typ=N&sys=3","","",""); return false;
304~@~   3.   3.80102:D:   20:*:*:M: Add column ReportId to table RptTbl~@~84~@~20~@~D~@~~@~~@~M~@~~@~Add column ReportId to table RptTbl~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_RptTbl (RptTblId int NOT NULL, RptTblDesc nvarchar(200) NULL, ParentId int NULL, RptCtrId int NOT NULL, RptTblTypeCd char(1) NOT NULL, TblRepeatNew char(1) NOT NULL, TblOrder smallint NULL, ColWidth decimal(8,2) NULL, TblGrouping varchar(1000) NULL, TblSorting varchar(1000) NULL, TblVisibility varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_RptTbl (RptTblId, RptTblDesc, ParentId, RptCtrId, RptTblTypeCd, TblRepeatNew, TblOrder, ColWidth, TblGrouping, TblSorting, TblVisibility) SELECT convert(int,RptTblId), RptTblDesc, convert(int,ParentId), convert(int,RptCtrId), RptTblTypeCd, TblRepeatNew, convert(smallint,TblOrder), convert(decimal(8,2),ColWidth), TblGrouping, TblSorting, TblVisibility FROM dbo.RptTbl IF (SELECT COUNT(1) FROM dbo.Tmp_RptTbl) > 0 OR (SELECT COUNT(1) FROM dbo.RptTbl) = 0 DROP TABLE dbo.RptTbl') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptTbl'')) CREATE TABLE dbo.RptTbl (RptTblId Int IDENTITY NOT NULL, RptTblDesc NVarChar(200) NULL, ParentId Int NULL, RptCtrId Int NOT NULL, ReportId Int NULL, RptTblTypeCd Char(1) NOT NULL, TblRepeatNew Char(1) NOT NULL, TblOrder SmallInt NULL, ColWidth Decimal(8,2) NULL, TblGrouping VarChar(1000) NULL, TblSorting VarChar(1000) NULL, TblVisibility VarChar(1000) NULL, CONSTRAINT PK_RptTbl PRIMARY KEY CLUSTERED (RptTblId))') EXEC (' SET IDENTITY_INSERT dbo.RptTbl ON INSERT INTO dbo.RptTbl (RptTblId, RptTblDesc, ParentId, RptCtrId, RptTblTypeCd, TblRepeatNew, TblOrder, ColWidth, TblGrouping, TblSorting, TblVisibility) SELECT RptTblId, RptTblDesc, ParentId, RptCtrId, RptTblTypeCd, TblRepeatNew, TblOrder, ColWidth, TblGrouping, TblSorting, TblVisibility FROM dbo.Tmp_RptTbl SET IDENTITY_INSERT dbo.RptTbl OFF IF (SELECT COUNT(1) FROM dbo.RptTbl) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptTbl) = 0 DROP TABLE dbo.Tmp_RptTbl')
EXEC ('update dbo.RptTbl SET ReportId = b.ReportId
from dbo.RptTbl a inner join dbo.RptCtr b on a.RptCtrId = b.RptCtrId
update dbo.RptTbl SET ReportId = b.ReportId
from dbo.RptTbl a inner join (select RptTblId, ReportId from dbo.RptTbl) b on a.ParentId = b.RptTblId')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=304&typ=N&sys=3","","",""); return false;
305~@~   3.   3.80102:D:   30:*:*:M: Change table RptTbl~@~84~@~30~@~D~@~~@~~@~M~@~~@~Change table RptTbl~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_RptTbl (RptTblId int NOT NULL, RptTblDesc nvarchar(200) NULL, ParentId int NULL, RptCtrId int NOT NULL, ReportId int NULL, RptTblTypeCd char(1) NOT NULL, TblRepeatNew char(1) NOT NULL, TblOrder smallint NULL, ColWidth decimal(8,2) NULL, TblGrouping varchar(1000) NULL, TblSorting varchar(1000) NULL, TblVisibility varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_RptTbl (RptTblId, RptTblDesc, ParentId, RptCtrId, ReportId, RptTblTypeCd, TblRepeatNew, TblOrder, ColWidth, TblGrouping, TblSorting, TblVisibility) SELECT convert(int,RptTblId), RptTblDesc, convert(int,ParentId), convert(int,RptCtrId), convert(int,ReportId), RptTblTypeCd, TblRepeatNew, convert(smallint,TblOrder), convert(decimal(8,2),ColWidth), TblGrouping, TblSorting, TblVisibility FROM dbo.RptTbl IF (SELECT COUNT(1) FROM dbo.Tmp_RptTbl) > 0 OR (SELECT COUNT(1) FROM dbo.RptTbl) = 0 DROP TABLE dbo.RptTbl') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptTbl'')) CREATE TABLE dbo.RptTbl (RptTblId Int IDENTITY NOT NULL, RptTblDesc NVarChar(200) NULL, ParentId Int NULL, RptCtrId Int NOT NULL, ReportId Int NULL, RptTblTypeCd Char(1) NOT NULL, TblRepeatNew Char(1) NOT NULL, TblOrder SmallInt NULL, ColWidth Decimal(8,2) NULL, TblGrouping Int NULL, TblVisibility Char(1) NULL, TblToggle Int NULL, CONSTRAINT PK_RptTbl PRIMARY KEY CLUSTERED (RptTblId))') EXEC (' SET IDENTITY_INSERT dbo.RptTbl ON INSERT INTO dbo.RptTbl (RptTblId, RptTblDesc, ParentId, RptCtrId, ReportId, RptTblTypeCd, TblRepeatNew, TblOrder, ColWidth, TblGrouping, TblVisibility) SELECT RptTblId, RptTblDesc, ParentId, RptCtrId, ReportId, RptTblTypeCd, TblRepeatNew, TblOrder, ColWidth, CONVERT(Int,TblGrouping), CONVERT(Char,TblVisibility) FROM dbo.Tmp_RptTbl SET IDENTITY_INSERT dbo.RptTbl OFF IF (SELECT COUNT(1) FROM dbo.RptTbl) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptTbl) = 0 DROP TABLE dbo.Tmp_RptTbl')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=305&typ=N&sys=3","","",""); return false;
306~@~   3.   3.80102:D:   40:*:*:M: Change table RptCtr~@~84~@~40~@~D~@~~@~~@~M~@~~@~Change table RptCtr~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_RptCtr (RptCtrId int NOT NULL, RptCtrDesc nvarchar(200) NULL, PRptCtrId int NULL, RptElmId int NULL, RptCelId int NULL, ReportId int NOT NULL, RptCtrTypeCd char(1) NOT NULL, RptCtrName nvarchar(100) NOT NULL, RptStyleId int NULL, CtrTop decimal(8,2) NULL, CtrLeft decimal(8,2) NULL, CtrHeight decimal(8,2) NULL, CtrWidth decimal(8,2) NULL, CtrZIndex smallint NULL, CtrAction varchar(1000) NULL, CtrVisibility varchar(1000) NULL, CtrToolTip varchar(200) NULL, CtrPgBrStart char(1) NOT NULL, CtrPgBrEnd char(1) NOT NULL, CtrValue varchar(1000) NULL, CtrCanGrow char(1) NOT NULL, CtrCanShrink char(1) NOT NULL, CtrTogether char(1) NOT NULL, CtrGrouping varchar(1000) NULL, CtrSorting varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_RptCtr (RptCtrId, RptCtrDesc, PRptCtrId, RptElmId, RptCelId, ReportId, RptCtrTypeCd, RptCtrName, RptStyleId, CtrTop, CtrLeft, CtrHeight, CtrWidth, CtrZIndex, CtrAction, CtrVisibility, CtrToolTip, CtrPgBrStart, CtrPgBrEnd, CtrValue, CtrCanGrow, CtrCanShrink, CtrTogether, CtrGrouping, CtrSorting) SELECT convert(int,RptCtrId), RptCtrDesc, convert(int,PRptCtrId), convert(int,RptElmId), convert(int,RptCelId), convert(int,ReportId), RptCtrTypeCd, RptCtrName, convert(int,RptStyleId), convert(decimal(8,2),CtrTop), convert(decimal(8,2),CtrLeft), convert(decimal(8,2),CtrHeight), convert(decimal(8,2),CtrWidth), convert(smallint,CtrZIndex), CtrAction, CtrVisibility, CtrToolTip, CtrPgBrStart, CtrPgBrEnd, CtrValue, CtrCanGrow, CtrCanShrink, CtrTogether, CtrGrouping, CtrSorting FROM dbo.RptCtr IF (SELECT COUNT(1) FROM dbo.Tmp_RptCtr) > 0 OR (SELECT COUNT(1) FROM dbo.RptCtr) = 0 DROP TABLE dbo.RptCtr') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptCtr'')) CREATE TABLE dbo.RptCtr (RptCtrId Int IDENTITY NOT NULL, RptCtrDesc NVarChar(200) NULL, PRptCtrId Int NULL, RptElmId Int NULL, RptCelId Int NULL, ReportId Int NOT NULL, RptCtrTypeCd Char(1) NOT NULL, RptCtrName NVarChar(100) NOT NULL, RptStyleId Int NULL, CtrTop Decimal(8,2) NULL, CtrLeft Decimal(8,2) NULL, CtrHeight Decimal(8,2) NULL, CtrWidth Decimal(8,2) NULL, CtrZIndex SmallInt NULL, CtrAction VarChar(500) NULL, CtrGrouping Int NULL, CtrVisibility Char(1) NULL, CtrToggle Int NULL, CtrToolTip VarChar(200) NULL, CtrPgBrStart Char(1) NOT NULL, CtrPgBrEnd Char(1) NOT NULL, CtrValue VarChar(1000) NULL, CtrCanGrow Char(1) NOT NULL, CtrCanShrink Char(1) NOT NULL, CtrTogether Char(1) NOT NULL, CONSTRAINT PK_RptCtr PRIMARY KEY CLUSTERED (RptCtrId))') EXEC (' SET IDENTITY_INSERT dbo.RptCtr ON INSERT INTO dbo.RptCtr (RptCtrId, RptCtrDesc, PRptCtrId, RptElmId, RptCelId, ReportId, RptCtrTypeCd, RptCtrName, RptStyleId, CtrTop, CtrLeft, CtrHeight, CtrWidth, CtrZIndex, CtrAction, CtrGrouping, CtrVisibility, CtrToolTip, CtrPgBrStart, CtrPgBrEnd, CtrValue, CtrCanGrow, CtrCanShrink, CtrTogether) SELECT RptCtrId, RptCtrDesc, PRptCtrId, RptElmId, RptCelId, ReportId, RptCtrTypeCd, RptCtrName, RptStyleId, CtrTop, CtrLeft, CtrHeight, CtrWidth, CtrZIndex, CtrAction, CONVERT(Int,CtrGrouping), CONVERT(Char,CtrVisibility), CtrToolTip, CtrPgBrStart, CtrPgBrEnd, CtrValue, CtrCanGrow, CtrCanShrink, CtrTogether FROM dbo.Tmp_RptCtr SET IDENTITY_INSERT dbo.RptCtr OFF IF (SELECT COUNT(1) FROM dbo.RptCtr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptCtr) = 0 DROP TABLE dbo.Tmp_RptCtr')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=306&typ=N&sys=3","","",""); return false;
307~@~   3.   7.80129:D:   10:*:*:M: Change table AppInfo~@~88~@~10~@~D~@~~@~~@~M~@~~@~Change table AppInfo~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_AppInfo (AppInfoId int NOT NULL, AppInfoDesc varchar(50) NULL, VersionMa smallint NOT NULL, VersionMi smallint NOT NULL, VersionDt datetime NULL, DeployZip varchar(100) NULL, Prerequisite nvarchar(200) NULL, Readme ntext NULL, AppItemLink varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_AppInfo (AppInfoId, AppInfoDesc, VersionMa, VersionMi, VersionDt, DeployZip, Prerequisite, Readme, AppItemLink) SELECT convert(int,AppInfoId), AppInfoDesc, convert(smallint,VersionMa), convert(smallint,VersionMi), VersionDt, DeployZip, Prerequisite, Readme, AppItemLink FROM dbo.AppInfo IF (SELECT COUNT(1) FROM dbo.Tmp_AppInfo) > 0 OR (SELECT COUNT(1) FROM dbo.AppInfo) = 0 DROP TABLE dbo.AppInfo') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AppInfo'')) CREATE TABLE dbo.AppInfo (AppInfoId Int IDENTITY NOT NULL, AppInfoDesc VarChar(50) NULL, VersionMa SmallInt NOT NULL, VersionMi SmallInt NOT NULL, VersionDt DateTime NULL, AppZipId Int NULL, Prerequisite NVarChar(200) NULL, Readme NText NULL, AppItemLink VarChar(200) NULL, CONSTRAINT PK_AppInfo PRIMARY KEY CLUSTERED (AppInfoId))') EXEC (' SET IDENTITY_INSERT dbo.AppInfo ON INSERT INTO dbo.AppInfo (AppInfoId, AppInfoDesc, VersionMa, VersionMi, VersionDt, Prerequisite, Readme, AppItemLink) SELECT AppInfoId, AppInfoDesc, VersionMa, VersionMi, VersionDt, Prerequisite, Readme, AppItemLink FROM dbo.Tmp_AppInfo SET IDENTITY_INSERT dbo.AppInfo OFF IF (SELECT COUNT(1) FROM dbo.AppInfo) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AppInfo) = 0 DROP TABLE dbo.Tmp_AppInfo')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=307&typ=N&sys=3","","",""); return false;
309~@~   3.   7.80129:D:   20:*:*:M: Add table AppZip~@~88~@~20~@~D~@~~@~~@~M~@~~@~Add table AppZip~@~Y~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AppZip'')) BEGIN CREATE TABLE dbo.AppZip (DocId Int IDENTITY NOT NULL, MasterId Int NOT NULL, DocName NVarChar(50) NOT NULL, MimeType VarChar(30) NOT NULL, DocSize BigInt NOT NULL, DocImage VarBinary(max) NOT NULL, InputBy Int NULL, InputOn DateTime NULL, Active Char(1) NOT NULL, CONSTRAINT PK_AppZip PRIMARY KEY CLUSTERED (DocId)) CREATE NONCLUSTERED INDEX IX_AppZip on dbo.AppZip(MasterId,DocName) END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=309&typ=N&sys=3","","",""); return false;
310~@~   3.   7.80129:D:   30:*:*:M: Remove Attchmt from AppItem~@~88~@~30~@~D~@~~@~~@~M~@~~@~Remove Attchmt from AppItem~@~Y~@~IF EXISTS (SELECT 1 from sysindexes WHERE name = 'IX_AppItem_Atmt') DROP INDEX AppItem.IX_AppItem_Atmt
IF EXISTS (SELECT 1 FROM syscolumns where id = object_id('dbo.AppItem') AND name = 'Attachmt') ALTER table dbo.AppItem DROP column Attachmt~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=310&typ=N&sys=3","","",""); return false;
311~@~   3.   7.80129:D:   40:*:*:M: Remove Attchmt from CustomDtl~@~88~@~40~@~D~@~~@~~@~M~@~~@~Remove Attchmt from CustomDtl~@~Y~@~IF EXISTS (SELECT 1 from sysindexes WHERE name = 'IX_CustomDtl_Atmt') DROP INDEX CustomDtl.IX_CustomDtl_Atmt
IF EXISTS (SELECT 1 FROM syscolumns where id = object_id('dbo.CustomDtl') AND name = 'Attachmt') ALTER table dbo.CustomDtl DROP column Attachmt~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=311&typ=N&sys=3","","",""); return false;
312~@~   3.   8.80207:D:   10:*:*:M: Add table CtRptDisplay~@~89~@~10~@~D~@~~@~~@~M~@~~@~Add table CtRptDisplay~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtRptDisplay'))
BEGIN
EXEC (' CREATE TABLE dbo.CtRptDisplay (TypeId TinyInt NOT NULL, TypeName VarChar(20) NOT NULL, DisplayDefault Char(1) NOT NULL, CONSTRAINT PK_CtRptDisplay PRIMARY KEY CLUSTERED (TypeId))')
insert CtRptDisplay values (1, 'Text', 'Y')
insert CtRptDisplay values (8, 'LongDate', 'N')
insert CtRptDisplay values (9, 'Currency', 'N')
insert CtRptDisplay values (16, 'Money', 'N')
insert CtRptDisplay values (19, 'ShortDate', 'N')
insert CtRptDisplay values (30, 'LongDateTime', 'N')
insert CtRptDisplay values (31, 'ShortDateTime', 'N')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=312&typ=N&sys=3","","",""); return false;
313~@~   3.   8.80207:D:   20:*:*:M: Add table CtReportType~@~89~@~20~@~D~@~~@~~@~M~@~~@~Add table CtReportType~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtReportType'))
BEGIN
EXEC (' CREATE TABLE dbo.CtReportType (ReportTypeCd Char(1) NOT NULL, ReportTypeDesc nvarchar(50) NOT NULL, CONSTRAINT PK_CtReportType PRIMARY KEY CLUSTERED (ReportTypeCd))')
insert CtReportType values ('G', 'Global Criteria')
insert CtReportType values ('T', 'TXT Document Merging')
insert CtReportType values ('R', 'RTF Document Merging')
insert CtReportType values ('S', 'Sql Reporting Service')
insert CtReportType values ('X', 'Excel Reporting Only')
insert CtReportType values ('C', 'Crystal Reporting')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=313&typ=N&sys=3","","",""); return false;
314~@~   3.   8.80207:D:   30:*:*:M: Change table Rptwiz~@~89~@~30~@~D~@~~@~~@~M~@~~@~Change table Rptwiz~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Rptwiz (RptwizId int NOT NULL, RptwizName nvarchar(50) NOT NULL, RptwizDesc nvarchar(400) NOT NULL, RptwizTypeCd char(1) NOT NULL, RptwizCatId smallint NULL, ReportId int NULL, Changeable char(1) NOT NULL, UsrId int NOT NULL, TopMargin decimal(8,2) NULL, BottomMargin decimal(8,2) NULL, LeftMargin decimal(8,2) NULL, RightMargin decimal(8,2) NULL, OrientationCd char(1) NOT NULL, UnitCd char(2) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_Rptwiz (RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, OrientationCd, UnitCd) SELECT convert(int,RptwizId), RptwizName, RptwizDesc, RptwizTypeCd, convert(smallint,RptwizCatId), convert(int,ReportId), Changeable, convert(int,UsrId), convert(decimal(8,2),TopMargin), convert(decimal(8,2),BottomMargin), convert(decimal(8,2),LeftMargin), convert(decimal(8,2),RightMargin), OrientationCd, UnitCd FROM dbo.Rptwiz IF (SELECT COUNT(1) FROM dbo.Tmp_Rptwiz) > 0 OR (SELECT COUNT(1) FROM dbo.Rptwiz) = 0 DROP TABLE dbo.Rptwiz') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Rptwiz'')) CREATE TABLE dbo.Rptwiz (RptwizId Int IDENTITY NOT NULL, RptwizName NVarChar(50) NOT NULL, RptwizDesc NVarChar(400) NOT NULL, RptwizTypeCd Char(1) NOT NULL, RptwizCatId SmallInt NULL, TemplateName VarChar(50) NULL, ReportId Int NULL, Changeable Char(1) NOT NULL, UsrId Int NOT NULL, TopMargin Decimal(8,2) NULL, BottomMargin Decimal(8,2) NULL, LeftMargin Decimal(8,2) NULL, RightMargin Decimal(8,2) NULL, OrientationCd Char(1) NOT NULL, UnitCd Char(2) NOT NULL, CONSTRAINT PK_Rptwiz PRIMARY KEY CLUSTERED (RptwizId))') EXEC (' ALTER TABLE dbo.Rptwiz ADD CONSTRAINT DF_Rptwiz_OrientationCd DEFAULT (''Y'') FOR OrientationCd ALTER TABLE dbo.Rptwiz ADD CONSTRAINT DF_Rptwiz_UnitCd DEFAULT (''in'') FOR UnitCd SET IDENTITY_INSERT dbo.Rptwiz ON INSERT INTO dbo.Rptwiz (RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, OrientationCd, UnitCd) SELECT RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, OrientationCd, UnitCd FROM dbo.Tmp_Rptwiz SET IDENTITY_INSERT dbo.Rptwiz OFF IF (SELECT COUNT(1) FROM dbo.Rptwiz) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Rptwiz) = 0 DROP TABLE dbo.Tmp_Rptwiz')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=314&typ=N&sys=3","","",""); return false;
315~@~   3.   8.80207:D:   40:*:*:M: Add table RptTemplate~@~89~@~40~@~D~@~~@~~@~M~@~~@~Add table RptTemplate~@~Y~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptTemplate'')) BEGIN CREATE TABLE dbo.RptTemplate (DocId Int IDENTITY NOT NULL, MasterId Int NOT NULL, DocName NVarChar(50) NOT NULL, MimeType VarChar(30) NOT NULL, DocSize BigInt NOT NULL, DocImage VarBinary(max) NOT NULL, InputBy Int NULL, InputOn DateTime NULL, Active Char(1) NOT NULL, CONSTRAINT PK_RptTemplate PRIMARY KEY CLUSTERED (DocId)) CREATE NONCLUSTERED INDEX IX_RptTemplate on dbo.RptTemplate(MasterId,DocName) END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=315&typ=N&sys=3","","",""); return false;
316~@~   3.   8.80207:D:   50:*:*:M: Change table Report~@~89~@~50~@~D~@~~@~~@~M~@~~@~Change table Report~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportCri_Report'') ALTER TABLE dbo.ReportCri DROP CONSTRAINT FK_ReportCri_Report
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportObj_Report'') ALTER TABLE dbo.ReportObj DROP CONSTRAINT FK_ReportObj_Report
CREATE TABLE dbo.Tmp_Report (ReportId int NOT NULL, ProgramName varchar(20) NOT NULL, ReportDesc nvarchar(50) NULL, GlobalCriteria char(1) NOT NULL, OrientationCd char(1) NOT NULL, ToXlsOnly char(1) NOT NULL, TemplateName varchar(50) NULL, SqlRptSrv char(1) NOT NULL, CopyReportId int NULL, TopMargin decimal(8,2) NOT NULL, BottomMargin decimal(8,2) NOT NULL, LeftMargin decimal(8,2) NOT NULL, RightMargin decimal(8,2) NOT NULL, PageHeight decimal(8,2) NOT NULL, PageWidth decimal(8,2) NOT NULL, UnitCd char(2) NOT NULL, WhereClause varchar(1000) NULL, RegClause varchar(400) NULL, RegCode ntext NULL, ValClause varchar(400) NULL, ValCode ntext NULL, UpdClause varchar(200) NULL, UpdCode ntext NULL, XlsClause varchar(200) NULL, XlsCode ntext NULL, GenerateRp char(1) NOT NULL, ModifiedBy int NULL, ModifiedOn datetime NULL, LastGenDt datetime NULL)')
EXEC ('INSERT INTO dbo.Tmp_Report (ReportId, ProgramName, ReportDesc, GlobalCriteria, OrientationCd, ToXlsOnly, TemplateName, SqlRptSrv, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, ModifiedBy, ModifiedOn, LastGenDt)
SELECT convert(int,ReportId), ProgramName, ReportDesc, GlobalCriteria, OrientationCd, ToXlsOnly, TemplateName, SqlRptSrv, convert(int,CopyReportId), convert(decimal(8,2),TopMargin), convert(decimal(8,2),BottomMargin), convert(decimal(8,2),LeftMargin), convert(decimal(8,2),RightMargin), convert(decimal(8,2),PageHeight), convert(decimal(8,2),PageWidth), UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, convert(int,ModifiedBy), ModifiedOn, LastGenDt FROM dbo.Report
IF (SELECT COUNT(1) FROM dbo.Tmp_Report) > 0 OR (SELECT COUNT(1) FROM dbo.Report) = 0 DROP TABLE dbo.Report')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Report''))
CREATE TABLE dbo.Report (ReportId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ReportDesc NVarChar(50) NULL, OrientationCd Char(1) NOT NULL, ReportTypeCd Char(1) NOT NULL, TemplateName VarChar(50) NULL, RptTemplateId Int NULL, CopyReportId Int NULL, TopMargin Decimal(8,2) NOT NULL, BottomMargin Decimal(8,2) NOT NULL, LeftMargin Decimal(8,2) NOT NULL, RightMargin Decimal(8,2) NOT NULL, PageHeight Decimal(8,2) NOT NULL, PageWidth Decimal(8,2) NOT NULL, UnitCd Char(2) NOT NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, RegCode NText NULL, ValClause VarChar(400) NULL, ValCode NText NULL, UpdClause VarChar(200) NULL, UpdCode NText NULL, XlsClause VarChar(200) NULL, XlsCode NText NULL, GenerateRp Char(1) NOT NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, CONSTRAINT PK_Report PRIMARY KEY CLUSTERED (ReportId))')
EXEC ('ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_TopMargin DEFAULT (1) FOR TopMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_BottomMargin DEFAULT (1) FOR BottomMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_LeftMargin DEFAULT (1) FOR LeftMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_RightMargin DEFAULT (1) FOR RightMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_PageHeight DEFAULT (11) FOR PageHeight ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_PageWidth DEFAULT (8.5) FOR PageWidth ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_UnitCd DEFAULT (''in'') FOR UnitCd
SET IDENTITY_INSERT dbo.Report ON INSERT INTO dbo.Report (ReportId, ProgramName, ReportDesc, OrientationCd
, ReportTypeCd, TemplateName, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, ModifiedBy, ModifiedOn, LastGenDt)
SELECT ReportId, ProgramName, ReportDesc, OrientationCd
, case when GlobalCriteria = ''Y'' then ''G'' when ToXlsOnly = ''Y'' then ''X'' when SqlRptSrv = ''Y'' then ''S'' when charindex(''.rtf'',TemplateName) > 0 then ''R'' when charindex(''.txt'',TemplateName) > 0 then ''T'' else ''C'' end, TemplateName, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, ModifiedBy, ModifiedOn, LastGenDt FROM dbo.Tmp_Report
SET IDENTITY_INSERT dbo.Report OFF IF (SELECT COUNT(1) FROM dbo.Report) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Report) = 0 DROP TABLE dbo.Tmp_Report
CREATE  UNIQUE NONCLUSTERED INDEX IX_Report_ProgramName ON dbo.Report (ProgramName) ALTER TABLE dbo.ReportCri WITH NOCHECK ADD CONSTRAINT FK_ReportCri_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId) ALTER TABLE dbo.ReportObj WITH NOCHECK ADD CONSTRAINT FK_ReportObj_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=316&typ=N&sys=3","","",""); return false;
317~@~   3.   8.80221:D:   60:*:*:M: Miscellaneous cleaning~@~90~@~60~@~D~@~~@~~@~M~@~~@~Miscellaneous cleaning~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AtchmtInUse1362'')) DROP PROCEDURE dbo.AtchmtInUse1362')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Ir_DelReportTmpl'')) DROP PROCEDURE dbo.Ir_DelReportTmpl')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.GetTemplate'')) DROP PROCEDURE dbo.GetTemplate')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.GetImportClause'')) DROP PROCEDURE dbo.GetImportClause')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ReportTmpl'')) DROP TABLE dbo.ReportTmpl')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=317&typ=N&sys=3","","",""); return false;
318~@~   3.   8.80221:D:   70:*:*:M: Add table CtRptChaType~@~90~@~70~@~D~@~~@~~@~M~@~~@~Add table CtRptChaType~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtRptChaType'))
BEGIN
EXEC ('CREATE TABLE dbo.CtRptChaType (RptChaTypeCd Char(2) NOT NULL, RptChaTypeName NVarChar(30) NOT NULL, CONSTRAINT PK_CtRptChaType PRIMARY KEY CLUSTERED (RptChaTypeCd))')
EXEC ('INSERT dbo.CtRptChaType VALUES (''CP'',''Vertical Column - Plain'')')
EXEC ('INSERT dbo.CtRptChaType VALUES (''CS'',''Vertical Column - Stacked'')')
EXEC ('INSERT dbo.CtRptChaType VALUES (''CH'',''Vertical Column - 100% Stacked'')')
EXEC ('INSERT dbo.CtRptChaType VALUES (''BP'',''Horizontal Bar - Plain'')')
EXEC ('INSERT dbo.CtRptChaType VALUES (''BS'',''Horizontal Bar - Stacked'')')
EXEC ('INSERT dbo.CtRptChaType VALUES (''BH'',''Horizontal Bar - 100% Stacked'')')
EXEC ('INSERT dbo.CtRptChaType VALUES (''AP'',''Area - Plain'')')
EXEC ('INSERT dbo.CtRptChaType VALUES (''AS'',''Area - Stacked'')')
EXEC ('INSERT dbo.CtRptChaType VALUES (''AH'',''Area - 100% Stacked'')')
EXEC ('INSERT dbo.CtRptChaType VALUES (''LP'',''Line - Plain'')')
EXEC ('INSERT dbo.CtRptChaType VALUES (''LS'',''Line - Smooth'')')
EXEC ('INSERT dbo.CtRptChaType VALUES (''PP'',''Pie - Plain'')')
EXEC ('INSERT dbo.CtRptChaType VALUES (''PE'',''Pie - Exploded'')')
EXEC ('INSERT dbo.CtRptChaType VALUES (''DP'',''Doughnut - Plain'')')
EXEC ('INSERT dbo.CtRptChaType VALUES (''DE'',''Doughnut - Exploded'')')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=318&typ=N&sys=3","","",""); return false;
320~@~   3.   8.80221:D:   80:*:*:M: Add table RptCha~@~90~@~80~@~D~@~~@~~@~M~@~~@~Add table RptCha~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptCha'')) CREATE TABLE dbo.RptCha (RptChaId Int IDENTITY NOT NULL, RptChaDesc NVarChar(200) NULL, RptCtrId Int NOT NULL, ReportId Int NULL, RptChaTypeCd Char(2) NOT NULL, ThreeD Char(1) NOT NULL, CategoryGrp Int NOT NULL, ChartData NVarChar(1000) NOT NULL, SeriesGrp Int NULL, CONSTRAINT PK_RptCha PRIMARY KEY CLUSTERED (RptChaId))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=320&typ=N&sys=3","","",""); return false;
321~@~   3.   8.80221:D:   90:*:*:M: Change table RptCtr to nvarchar~@~90~@~90~@~D~@~~@~~@~M~@~~@~Change table RptCtr to nvarchar~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_RptCtr (RptCtrId int NOT NULL, RptCtrDesc nvarchar(200) NULL, PRptCtrId int NULL, RptElmId int NULL, RptCelId int NULL, ReportId int NOT NULL, RptCtrTypeCd char(1) NOT NULL, RptCtrName nvarchar(100) NOT NULL, RptStyleId int NULL, CtrTop decimal(8,2) NULL, CtrLeft decimal(8,2) NULL, CtrHeight decimal(8,2) NULL, CtrWidth decimal(8,2) NULL, CtrZIndex smallint NULL, CtrAction varchar(500) NULL, CtrGrouping int NULL, CtrVisibility char(1) NULL, CtrToggle int NULL, CtrToolTip varchar(200) NULL, CtrPgBrStart char(1) NOT NULL, CtrPgBrEnd char(1) NOT NULL, CtrValue varchar(1000) NULL, CtrCanGrow char(1) NOT NULL, CtrCanShrink char(1) NOT NULL, CtrTogether char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_RptCtr (RptCtrId, RptCtrDesc, PRptCtrId, RptElmId, RptCelId, ReportId, RptCtrTypeCd, RptCtrName, RptStyleId, CtrTop, CtrLeft, CtrHeight, CtrWidth, CtrZIndex, CtrAction, CtrGrouping, CtrVisibility, CtrToggle, CtrToolTip, CtrPgBrStart, CtrPgBrEnd, CtrValue, CtrCanGrow, CtrCanShrink, CtrTogether) SELECT convert(int,RptCtrId), RptCtrDesc, convert(int,PRptCtrId), convert(int,RptElmId), convert(int,RptCelId), convert(int,ReportId), RptCtrTypeCd, RptCtrName, convert(int,RptStyleId), convert(decimal(8,2),CtrTop), convert(decimal(8,2),CtrLeft), convert(decimal(8,2),CtrHeight), convert(decimal(8,2),CtrWidth), convert(smallint,CtrZIndex), CtrAction, convert(int,CtrGrouping), CtrVisibility, convert(int,CtrToggle), CtrToolTip, CtrPgBrStart, CtrPgBrEnd, CtrValue, CtrCanGrow, CtrCanShrink, CtrTogether FROM dbo.RptCtr IF (SELECT COUNT(1) FROM dbo.Tmp_RptCtr) > 0 OR (SELECT COUNT(1) FROM dbo.RptCtr) = 0 DROP TABLE dbo.RptCtr') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptCtr'')) CREATE TABLE dbo.RptCtr (RptCtrId Int IDENTITY NOT NULL, RptCtrDesc NVarChar(200) NULL, PRptCtrId Int NULL, RptElmId Int NULL, RptCelId Int NULL, ReportId Int NOT NULL, RptCtrTypeCd Char(1) NOT NULL, RptCtrName NVarChar(100) NOT NULL, RptStyleId Int NULL, CtrTop Decimal(8,2) NULL, CtrLeft Decimal(8,2) NULL, CtrHeight Decimal(8,2) NULL, CtrWidth Decimal(8,2) NULL, CtrZIndex SmallInt NULL, CtrAction VarChar(500) NULL, CtrGrouping Int NULL, CtrVisibility Char(1) NULL, CtrToggle Int NULL, CtrToolTip NVarChar(200) NULL, CtrPgBrStart Char(1) NOT NULL, CtrPgBrEnd Char(1) NOT NULL, CtrValue NVarChar(1000) NULL, CtrCanGrow Char(1) NOT NULL, CtrCanShrink Char(1) NOT NULL, CtrTogether Char(1) NOT NULL, CONSTRAINT PK_RptCtr PRIMARY KEY CLUSTERED (RptCtrId))') EXEC (' SET IDENTITY_INSERT dbo.RptCtr ON INSERT INTO dbo.RptCtr (RptCtrId, RptCtrDesc, PRptCtrId, RptElmId, RptCelId, ReportId, RptCtrTypeCd, RptCtrName, RptStyleId, CtrTop, CtrLeft, CtrHeight, CtrWidth, CtrZIndex, CtrAction, CtrGrouping, CtrVisibility, CtrToggle, CtrToolTip, CtrPgBrStart, CtrPgBrEnd, CtrValue, CtrCanGrow, CtrCanShrink, CtrTogether) SELECT RptCtrId, RptCtrDesc, PRptCtrId, RptElmId, RptCelId, ReportId, RptCtrTypeCd, RptCtrName, RptStyleId, CtrTop, CtrLeft, CtrHeight, CtrWidth, CtrZIndex, CtrAction, CtrGrouping, CtrVisibility, CtrToggle, CONVERT(NVarChar(200),CtrToolTip), CtrPgBrStart, CtrPgBrEnd, CONVERT(NVarChar(1000),CtrValue), CtrCanGrow, CtrCanShrink, CtrTogether FROM dbo.Tmp_RptCtr SET IDENTITY_INSERT dbo.RptCtr OFF IF (SELECT COUNT(1) FROM dbo.RptCtr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptCtr) = 0 DROP TABLE dbo.Tmp_RptCtr')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=321&typ=N&sys=3","","",""); return false;
322~@~   3.   8.80221:D:  100:*:*:M: Add table CtRptChart~@~90~@~100~@~D~@~~@~~@~M~@~~@~Add table CtRptChart~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtRptChart'))
BEGIN
EXEC ('CREATE TABLE dbo.CtRptChart (RptChartCd Char(1) NOT NULL, RptChartName NVarChar(100) NOT NULL, CONSTRAINT PK_CtRptChart PRIMARY KEY CLUSTERED (RptChartCd))')
EXEC ('INSERT dbo.CtRptChart VALUES (''C'',''Category Grouping'')')
EXEC ('INSERT dbo.CtRptChart VALUES (''V'',''Scalar Value'')')
EXEC ('INSERT dbo.CtRptChart VALUES (''S'',''Series Grouping'')')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=322&typ=N&sys=3","","",""); return false;
323~@~   3.   8.80221:D:  110:*:*:M: Add columns to table Rptwiz~@~90~@~110~@~D~@~~@~~@~M~@~~@~Add columns to table Rptwiz~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_Rptwiz (RptwizId int NOT NULL, RptwizName nvarchar(50) NOT NULL, RptwizDesc nvarchar(400) NOT NULL, RptwizTypeCd char(1) NOT NULL, RptwizCatId smallint NULL, TemplateName varchar(50) NULL, ReportId int NULL, Changeable char(1) NOT NULL, UsrId int NOT NULL, TopMargin decimal(8,2) NULL, BottomMargin decimal(8,2) NULL, LeftMargin decimal(8,2) NULL, RightMargin decimal(8,2) NULL, OrientationCd char(1) NOT NULL, UnitCd char(2) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_Rptwiz (RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, TemplateName, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, OrientationCd, UnitCd) SELECT convert(int,RptwizId), RptwizName, RptwizDesc, RptwizTypeCd, convert(smallint,RptwizCatId), TemplateName, convert(int,ReportId), Changeable, convert(int,UsrId), convert(decimal(8,2),TopMargin), convert(decimal(8,2),BottomMargin), convert(decimal(8,2),LeftMargin), convert(decimal(8,2),RightMargin), OrientationCd, UnitCd FROM dbo.Rptwiz IF (SELECT COUNT(1) FROM dbo.Tmp_Rptwiz) > 0 OR (SELECT COUNT(1) FROM dbo.Rptwiz) = 0 DROP TABLE dbo.Rptwiz') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Rptwiz'')) CREATE TABLE dbo.Rptwiz (RptwizId Int IDENTITY NOT NULL, RptwizName NVarChar(50) NOT NULL, RptwizDesc NVarChar(400) NOT NULL, RptwizTypeCd Char(1) NOT NULL, RptwizCatId SmallInt NULL, TemplateName VarChar(50) NULL, ReportId Int NULL, Changeable Char(1) NOT NULL, UsrId Int NOT NULL, TopMargin Decimal(8,2) NULL, BottomMargin Decimal(8,2) NULL, LeftMargin Decimal(8,2) NULL, RightMargin Decimal(8,2) NULL, OrientationCd Char(1) NOT NULL, UnitCd Char(2) NOT NULL, RptChaTypeCd Char(2) NULL, ThreeD Char(1) NOT NULL, CONSTRAINT PK_Rptwiz PRIMARY KEY CLUSTERED (RptwizId))') EXEC (' ALTER TABLE dbo.Rptwiz ADD CONSTRAINT DF_Rptwiz_OrientationCd DEFAULT (''Y'') FOR OrientationCd ALTER TABLE dbo.Rptwiz ADD CONSTRAINT DF_Rptwiz_UnitCd DEFAULT (''in'') FOR UnitCd ALTER TABLE dbo.Rptwiz ADD CONSTRAINT DF_Rptwiz_ThreeD DEFAULT (''N'') FOR ThreeD SET IDENTITY_INSERT dbo.Rptwiz ON INSERT INTO dbo.Rptwiz (RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, TemplateName, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, OrientationCd, UnitCd, ThreeD) SELECT RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, TemplateName, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, OrientationCd, UnitCd, ''N'' FROM dbo.Tmp_Rptwiz SET IDENTITY_INSERT dbo.Rptwiz OFF IF (SELECT COUNT(1) FROM dbo.Rptwiz) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Rptwiz) = 0 DROP TABLE dbo.Tmp_Rptwiz')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=323&typ=N&sys=3","","",""); return false;
324~@~   3.   8.80221:D:  120:*:*:M: Add colume to table RptwizDtl~@~90~@~120~@~D~@~~@~~@~M~@~~@~Add colume to table RptwizDtl~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_RptwizDtl (RptwizDtlId int NOT NULL, RptwizId int NOT NULL, ColumnId int NOT NULL, ColHeader nvarchar(50) NULL, CriOperatorId tinyint NULL, CriSelect smallint NULL, CriHeader nvarchar(50) NULL, ColSelect smallint NULL, ColGroup smallint NULL, ColSort smallint NULL, AggregateCd char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_RptwizDtl (RptwizDtlId, RptwizId, ColumnId, ColHeader, CriOperatorId, CriSelect, CriHeader, ColSelect, ColGroup, ColSort, AggregateCd) SELECT convert(int,RptwizDtlId), convert(int,RptwizId), convert(int,ColumnId), ColHeader, convert(tinyint,CriOperatorId), convert(smallint,CriSelect), CriHeader, convert(smallint,ColSelect), convert(smallint,ColGroup), convert(smallint,ColSort), AggregateCd FROM dbo.RptwizDtl IF (SELECT COUNT(1) FROM dbo.Tmp_RptwizDtl) > 0 OR (SELECT COUNT(1) FROM dbo.RptwizDtl) = 0 DROP TABLE dbo.RptwizDtl') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptwizDtl'')) CREATE TABLE dbo.RptwizDtl (RptwizDtlId Int IDENTITY NOT NULL, RptwizId Int NOT NULL, ColumnId Int NOT NULL, ColHeader NVarChar(50) NULL, CriOperatorId TinyInt NULL, CriSelect SmallInt NULL, CriHeader NVarChar(50) NULL, ColSelect SmallInt NULL, ColGroup SmallInt NULL, ColSort SmallInt NULL, AggregateCd Char(1) NULL, RptChartCd Char(1) NULL, CONSTRAINT PK_RptwizDtl PRIMARY KEY CLUSTERED (RptwizDtlId))') EXEC (' SET IDENTITY_INSERT dbo.RptwizDtl ON INSERT INTO dbo.RptwizDtl (RptwizDtlId, RptwizId, ColumnId, ColHeader, CriOperatorId, CriSelect, CriHeader, ColSelect, ColGroup, ColSort, AggregateCd) SELECT RptwizDtlId, RptwizId, ColumnId, ColHeader, CriOperatorId, CriSelect, CriHeader, ColSelect, ColGroup, ColSort, AggregateCd FROM dbo.Tmp_RptwizDtl SET IDENTITY_INSERT dbo.RptwizDtl OFF IF (SELECT COUNT(1) FROM dbo.RptwizDtl) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptwizDtl) = 0 DROP TABLE dbo.Tmp_RptwizDtl')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=324&typ=N&sys=3","","",""); return false;
325~@~   3.   8.80221:D:  130:*:*:M: Cleanup DataGridLink~@~90~@~130~@~D~@~~@~~@~M~@~~@~Cleanup DataGridLink~@~Y~@~UPDATE dbo.AppItem SET AppItemLink = replace(AppItemLink,'javascript:',space(0)) + ' return false;' WHERE charindex('return false;',AppItemLink) = 0
UPDATE dbo.CustomDtl SET CustomDtlLink = replace(CustomDtlLink,'javascript:',space(0)) + ' return false;' WHERE charindex('return false;',CustomDtlLink) = 0~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=325&typ=N&sys=3","","",""); return false;
328~@~   3.   9.80310:D:   10:*:*:M: Add Ls columns to table Usr~@~91~@~10~@~D~@~~@~~@~M~@~~@~Add Ls columns to table Usr~@~N~@~EXEC ('CREATE TABLE dbo.Tmp_Usr (UsrId int NOT NULL, LoginName nvarchar(32) NOT NULL, UsrEmail nvarchar(50) NULL, UsrName nvarchar(50) NULL, UsrPassword varbinary(32) NULL, ConfirmPwd varbinary(32) NULL, ExtPassword varbinary(255) NULL, UsrGroupId smallint NOT NULL, CompanyId smallint NULL, InvestorId int NULL, CustomerId int NULL, VendorId int NULL, AgentId int NULL, BrokerId int NULL, MemberId int NULL, DefSystemId tinyint NOT NULL, DefProjectId smallint NULL, DefCompanyId smallint NULL, FailedAttempt tinyint NULL, FailedAttemptFP tinyint NULL, LastFailedDt datetime NULL, LastSuccessDt datetime NULL, HintQuestionId tinyint NULL, HintAnswer nvarchar(50) NULL, Active char(1) NOT NULL, ModifiedOn datetime NOT NULL)')
EXEC ('INSERT INTO dbo.Tmp_Usr (UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, UsrGroupId, CompanyId, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, HintQuestionId, HintAnswer, Active, ModifiedOn) SELECT convert(int,UsrId), LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, convert(smallint,UsrGroupId), convert(smallint,CompanyId), convert(int,InvestorId), convert(int,CustomerId), convert(int,VendorId), convert(int,AgentId), convert(int,BrokerId), convert(int,MemberId), convert(tinyint,DefSystemId), convert(smallint,DefProjectId), convert(smallint,DefCompanyId), convert(tinyint,FailedAttempt), convert(tinyint,FailedAttemptFP), LastFailedDt, LastSuccessDt, convert(tinyint,HintQuestionId), HintAnswer, Active, ModifiedOn FROM dbo.Usr IF (SELECT COUNT(1) FROM dbo.Tmp_Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Usr) = 0 DROP TABLE dbo.Usr')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Usr'')) CREATE TABLE dbo.Usr (UsrId Int IDENTITY NOT NULL, LoginName NVarChar(32) NOT NULL, UsrEmail NVarChar(50) NULL, UsrName NVarChar(50) NULL, UsrPassword VarBinary(32) NULL, ConfirmPwd VarBinary(32) NULL, ExtPassword VarBinary(255) NULL, UsrGroupId SmallInt NOT NULL, UsrGroupLs VarChar(1000) NOT NULL, CompanyLs VarChar(1000) NULL, ProjectLs VarChar(1000) NULL, CompanyId SmallInt NULL, InvestorId Int NULL, CustomerId Int NULL, VendorId Int NULL, AgentId Int NULL, BrokerId Int NULL, MemberId Int NULL, DefSystemId TinyInt NOT NULL, DefProjectId SmallInt NULL, DefCompanyId SmallInt NULL, FailedAttempt TinyInt NULL, FailedAttemptFP TinyInt NULL, LastFailedDt DateTime NULL, LastSuccessDt DateTime NULL, HintQuestionId TinyInt NULL, HintAnswer NVarChar(50) NULL, Active Char(1) NOT NULL, ModifiedOn DateTime NOT NULL, CONSTRAINT PK_Usr PRIMARY KEY CLUSTERED (UsrId))')
EXEC ('SET IDENTITY_INSERT dbo.Usr ON INSERT INTO dbo.Usr (UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, UsrGroupId, UsrGroupLs, CompanyLs, ProjectLs, CompanyId, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, HintQuestionId, HintAnswer, Active, ModifiedOn) SELECT UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, UsrGroupId, ''('' + convert(varchar,UsrGroupId) + '')'', ''('' + convert(varchar,CompanyId) + '')'', null, CompanyId, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, HintQuestionId, HintAnswer, Active, ModifiedOn FROM dbo.Tmp_Usr SET IDENTITY_INSERT dbo.Usr OFF IF (SELECT COUNT(1) FROM dbo.Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Usr) = 0 DROP TABLE dbo.Tmp_Usr CREATE  NONCLUSTERED INDEX IX_Usr_UsrName ON dbo.Usr (UsrName) CREATE  UNIQUE NONCLUSTERED INDEX IX_Usr_LoginName ON dbo.Usr (LoginName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=328&typ=N&sys=3","","",""); return false;
330~@~   3.   9.80310:D:   20:*:*:M: Add columns to UsrGroupAuth~@~91~@~20~@~D~@~~@~~@~M~@~~@~Add columns to UsrGroupAuth~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_UsrGroupAuth (UsrGroupAuthId int NOT NULL, UsrGroupId smallint NOT NULL, SystemId tinyint NOT NULL, SysRowAuthorityId tinyint NOT NULL, SysColAuthorityId tinyint NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_UsrGroupAuth (UsrGroupAuthId, UsrGroupId, SystemId, SysRowAuthorityId, SysColAuthorityId) SELECT convert(int,UsrGroupAuthId), convert(smallint,UsrGroupId), convert(tinyint,SystemId), convert(tinyint,SysRowAuthorityId), convert(tinyint,SysColAuthorityId) FROM dbo.UsrGroupAuth IF (SELECT COUNT(1) FROM dbo.Tmp_UsrGroupAuth) > 0 OR (SELECT COUNT(1) FROM dbo.UsrGroupAuth) = 0 DROP TABLE dbo.UsrGroupAuth') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrGroupAuth'')) CREATE TABLE dbo.UsrGroupAuth (UsrGroupAuthId Int IDENTITY NOT NULL, UsrGroupId SmallInt NOT NULL, CompanyId SmallInt NULL, ProjectId SmallInt NULL, SystemId TinyInt NULL, SysRowAuthorityId TinyInt NOT NULL, SysColAuthorityId TinyInt NOT NULL, CONSTRAINT PK_UsrGroupAuth PRIMARY KEY CLUSTERED (UsrGroupAuthId))') EXEC (' SET IDENTITY_INSERT dbo.UsrGroupAuth ON INSERT INTO dbo.UsrGroupAuth (UsrGroupAuthId, UsrGroupId, SystemId, SysRowAuthorityId, SysColAuthorityId) SELECT UsrGroupAuthId, UsrGroupId, SystemId, SysRowAuthorityId, SysColAuthorityId FROM dbo.Tmp_UsrGroupAuth SET IDENTITY_INSERT dbo.UsrGroupAuth OFF IF (SELECT COUNT(1) FROM dbo.UsrGroupAuth) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrGroupAuth) = 0 DROP TABLE dbo.Tmp_UsrGroupAuth CREATE  UNIQUE NONCLUSTERED INDEX IX_UsrGroupAuth_UsrGroupId ON dbo.UsrGroupAuth (UsrGroupId,SystemId)')
IF EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = 'IX_UsrGroupAuth_UsrGroupId')
BEGIN
EXEC ('DROP INDEX UsrGroupAuth.IX_UsrGroupAuth_UsrGroupId')
EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_UsrGroupAuth ON dbo.UsrGroupAuth (UsrGroupId, CompanyId, ProjectId, SystemId)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=330&typ=N&sys=3","","",""); return false;
331~@~   3.   9.80310:D:   30:*:*:M: Remove columns from UsrGroup~@~91~@~30~@~D~@~~@~~@~M~@~~@~Remove columns from UsrGroup~@~N~@~EXEC ('CREATE TABLE dbo.Tmp_UsrGroup (UsrGroupId smallint NOT NULL, UsrGroupName nvarchar(50) NOT NULL, UsrCultureId tinyint NOT NULL, RowAuthorityId tinyint NOT NULL, ColAuthorityId tinyint NOT NULL, InternalUsr char(1) NOT NULL, TechnicalUsr char(1) NOT NULL)')
EXEC ('INSERT INTO dbo.Tmp_UsrGroup (UsrGroupId, UsrGroupName, UsrCultureId, RowAuthorityId, ColAuthorityId, InternalUsr, TechnicalUsr) SELECT convert(smallint,UsrGroupId), UsrGroupName, convert(tinyint,UsrCultureId), convert(tinyint,RowAuthorityId), convert(tinyint,ColAuthorityId), InternalUsr, TechnicalUsr FROM dbo.UsrGroup IF (SELECT COUNT(1) FROM dbo.Tmp_UsrGroup) > 0 OR (SELECT COUNT(1) FROM dbo.UsrGroup) = 0 DROP TABLE dbo.UsrGroup')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrGroup'')) CREATE TABLE dbo.UsrGroup (UsrGroupId SmallInt IDENTITY NOT NULL, UsrGroupName NVarChar(50) NOT NULL, RowAuthorityId TinyInt NOT NULL, ColAuthorityId TinyInt NOT NULL, CompanyId SmallInt null, CONSTRAINT PK_UsrGroup PRIMARY KEY CLUSTERED (UsrGroupId))')
EXEC ('SET IDENTITY_INSERT dbo.UsrGroup ON INSERT INTO dbo.UsrGroup (UsrGroupId, UsrGroupName, RowAuthorityId, ColAuthorityId) SELECT UsrGroupId, UsrGroupName, RowAuthorityId, ColAuthorityId FROM dbo.Tmp_UsrGroup SET IDENTITY_INSERT dbo.UsrGroup OFF IF (SELECT COUNT(1) FROM dbo.UsrGroup) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrGroup) = 0 DROP TABLE dbo.Tmp_UsrGroup CREATE  UNIQUE NONCLUSTERED INDEX IX_UsrGroup_UsrGroupName ON dbo.UsrGroup (UsrGroupName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=331&typ=N&sys=3","","",""); return false;
332~@~   3.   9.80310:D:   40:*:*:M: Add and remove columns from table Usr~@~91~@~40~@~D~@~~@~~@~M~@~~@~Add and remove columns from table Usr~@~N~@~EXEC ('CREATE TABLE dbo.Tmp_Usr (UsrId int NOT NULL, LoginName nvarchar(32) NOT NULL, UsrEmail nvarchar(50) NULL, UsrName nvarchar(50) NULL, UsrPassword varbinary(32) NULL, ConfirmPwd varbinary(32) NULL, ExtPassword varbinary(255) NULL, UsrGroupLs varchar(1000) NOT NULL, CompanyLs varchar(1000) NULL, ProjectLs varchar(1000) NULL, InvestorId int NULL, CustomerId int NULL, VendorId int NULL, AgentId int NULL, BrokerId int NULL, MemberId int NULL, DefSystemId tinyint NOT NULL, DefProjectId smallint NULL, DefCompanyId smallint NULL, FailedAttempt tinyint NULL, FailedAttemptFP tinyint NULL, LastFailedDt datetime NULL, LastSuccessDt datetime NULL, HintQuestionId tinyint NULL, HintAnswer nvarchar(50) NULL, Active char(1) NOT NULL, ModifiedOn datetime NOT NULL)')
EXEC ('INSERT INTO dbo.Tmp_Usr (UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, HintQuestionId, HintAnswer, Active, ModifiedOn) SELECT convert(int,UsrId), LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, UsrGroupLs, CompanyLs, ProjectLs, convert(int,InvestorId), convert(int,CustomerId), convert(int,VendorId), convert(int,AgentId), convert(int,BrokerId), convert(int,MemberId), convert(tinyint,DefSystemId), convert(smallint,DefProjectId), convert(smallint,DefCompanyId), convert(tinyint,FailedAttempt), convert(tinyint,FailedAttemptFP), LastFailedDt, LastSuccessDt, convert(tinyint,HintQuestionId), HintAnswer, Active, ModifiedOn FROM dbo.Usr IF (SELECT COUNT(1) FROM dbo.Tmp_Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Usr) = 0 DROP TABLE dbo.Usr')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Usr'')) CREATE TABLE dbo.Usr (UsrId Int IDENTITY NOT NULL, LoginName NVarChar(32) NOT NULL, UsrEmail NVarChar(50) NULL, UsrName NVarChar(50) NULL, UsrPassword VarBinary(32) NULL, ConfirmPwd VarBinary(32) NULL, ExtPassword VarBinary(255) NULL, CultureId TinyInt NOT NULL, InternalUsr Char(1) NOT NULL, TechnicalUsr Char(1) NOT NULL, UsrGroupLs VarChar(1000) NOT NULL, CompanyLs VarChar(1000) NULL, ProjectLs VarChar(1000) NULL, InvestorId Int NULL, CustomerId Int NULL, VendorId Int NULL, AgentId Int NULL, BrokerId Int NULL, MemberId Int NULL, DefSystemId TinyInt NOT NULL, DefProjectId SmallInt NULL, DefCompanyId SmallInt NULL, FailedAttempt TinyInt NULL, FailedAttemptFP TinyInt NULL, LastFailedDt DateTime NULL, LastSuccessDt DateTime NULL, HintQuestionId TinyInt NULL, HintAnswer NVarChar(50) NULL, Active Char(1) NOT NULL, ModifiedOn DateTime NOT NULL, UsrImprLink Varchar(200) NULL, CONSTRAINT PK_Usr PRIMARY KEY CLUSTERED (UsrId))')
EXEC ('ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_CultureId DEFAULT (1) FOR CultureId ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_InternalUsr DEFAULT (''N'') FOR InternalUsr ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_TechnicalUsr DEFAULT (''N'') FOR TechnicalUsr SET IDENTITY_INSERT dbo.Usr ON INSERT INTO dbo.Usr (UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, HintQuestionId, HintAnswer, Active, ModifiedOn) SELECT UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, HintQuestionId, HintAnswer, Active, ModifiedOn FROM dbo.Tmp_Usr SET IDENTITY_INSERT dbo.Usr OFF IF (SELECT COUNT(1) FROM dbo.Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Usr) = 0 DROP TABLE dbo.Tmp_Usr CREATE  NONCLUSTERED INDEX IX_Usr_UsrName ON dbo.Usr (UsrName) CREATE  UNIQUE NONCLUSTERED INDEX IX_Usr_LoginName ON dbo.Usr (LoginName)')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.UsrProject')) BEGIN EXEC ('DROP TABLE dbo.UsrProject') END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=332&typ=N&sys=3","","",""); return false;
333~@~   3.   9.80310:D:   50:*:*:M: Add columns to table UsrImpr~@~91~@~50~@~D~@~~@~~@~M~@~~@~Add columns to table UsrImpr~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_UsrImpr (UsrImprId int NOT NULL, UsrId int NOT NULL, ImprUsrId int NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_UsrImpr (UsrImprId, UsrId, ImprUsrId) SELECT convert(int,UsrImprId), convert(int,UsrId), convert(int,ImprUsrId) FROM dbo.UsrImpr IF (SELECT COUNT(1) FROM dbo.Tmp_UsrImpr) > 0 OR (SELECT COUNT(1) FROM dbo.UsrImpr) = 0 DROP TABLE dbo.UsrImpr') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrImpr'')) CREATE TABLE dbo.UsrImpr (UsrImprId Int IDENTITY NOT NULL, UsrId Int NOT NULL, ImprUsrId Int NOT NULL, UsrImprDesc NVarChar(200) NULL, UsrImprLink VarChar(200) NULL, CONSTRAINT PK_UsrImpr PRIMARY KEY CLUSTERED (UsrImprId))') EXEC (' SET IDENTITY_INSERT dbo.UsrImpr ON INSERT INTO dbo.UsrImpr (UsrImprId, UsrId, ImprUsrId) SELECT UsrImprId, UsrId, ImprUsrId FROM dbo.Tmp_UsrImpr SET IDENTITY_INSERT dbo.UsrImpr OFF IF (SELECT COUNT(1) FROM dbo.UsrImpr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrImpr) = 0 DROP TABLE dbo.Tmp_UsrImpr CREATE  UNIQUE NONCLUSTERED INDEX IX_UsrImpr_UsrId ON dbo.UsrImpr (UsrId,ImprUsrId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=333&typ=N&sys=3","","",""); return false;
334~@~   3.   9.80310:D:   60:*:*:M: Change table CtPermKey~@~91~@~60~@~D~@~~@~~@~M~@~~@~Change table CtPermKey~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_CtPermKey (CtPermKeyId smallint NOT NULL, CtPermKeyName varchar(50) NOT NULL, CtPermKeyParam varchar(20) NOT NULL, TableName varchar(50) NOT NULL, ColumnName varchar(50) NOT NULL, AndCondition char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_CtPermKey (CtPermKeyId, CtPermKeyName, CtPermKeyParam, TableName, ColumnName, AndCondition) SELECT convert(smallint,CtPermKeyId), CtPermKeyName, CtPermKeyParam, TableName, ColumnName, AndCondition FROM dbo.CtPermKey IF (SELECT COUNT(1) FROM dbo.Tmp_CtPermKey) > 0 OR (SELECT COUNT(1) FROM dbo.CtPermKey) = 0 DROP TABLE dbo.CtPermKey') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtPermKey'')) CREATE TABLE dbo.CtPermKey (CtPermKeyId SmallInt IDENTITY NOT NULL, CtPermKeyName VarChar(50) NOT NULL, CtPermKeyParam VarChar(20) NOT NULL, TableName VarChar(50) NOT NULL, ColumnName VarChar(50) NOT NULL, AndCondition Char(1) NOT NULL, MultiValue Char(1) NOT NULL, CONSTRAINT PK_CtPermKey PRIMARY KEY CLUSTERED (CtPermKeyId))') EXEC (' ALTER TABLE dbo.CtPermKey ADD CONSTRAINT DF_CtPermKey_MultiValue DEFAULT (''N'') FOR MultiValue SET IDENTITY_INSERT dbo.CtPermKey ON INSERT INTO dbo.CtPermKey (CtPermKeyId, CtPermKeyName, CtPermKeyParam, TableName, ColumnName, AndCondition, MultiValue) SELECT CtPermKeyId, CtPermKeyName, CtPermKeyParam, TableName, ColumnName, AndCondition, ''N'' FROM dbo.Tmp_CtPermKey SET IDENTITY_INSERT dbo.CtPermKey OFF IF (SELECT COUNT(1) FROM dbo.CtPermKey) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtPermKey) = 0 DROP TABLE dbo.Tmp_CtPermKey CREATE  UNIQUE NONCLUSTERED INDEX IX_CtPermKey ON dbo.CtPermKey (CtPermKeyName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=334&typ=N&sys=3","","",""); return false;
335~@~   3.   9.80310:D:   70:*:*:M: Add column ReportId to AuthRow~@~91~@~70~@~D~@~~@~~@~M~@~~@~Add column ReportId to AuthRow~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_AuthRow_Screen'') ALTER TABLE dbo.AuthRow DROP CONSTRAINT FK_AuthRow_Screen CREATE TABLE dbo.Tmp_AuthRow (AuthRowId int NOT NULL, ScreenId int NOT NULL, RowAuthorityId tinyint NOT NULL, AllowSel char(1) NOT NULL, AllowAdd char(1) NOT NULL, AllowUpd char(1) NOT NULL, AllowDel char(1) NOT NULL, SelUsr char(1) NOT NULL, SelUsrGroup char(1) NOT NULL, SelCulture char(1) NOT NULL, SelCompany char(1) NOT NULL, SelAgent char(1) NOT NULL, SelBroker char(1) NOT NULL, SelCustomer char(1) NOT NULL, SelInvestor char(1) NOT NULL, SelMember char(1) NOT NULL, SelVendor char(1) NOT NULL, SelProject char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_AuthRow (AuthRowId, ScreenId, RowAuthorityId, AllowSel, AllowAdd, AllowUpd, AllowDel, SelUsr, SelUsrGroup, SelCulture, SelCompany, SelAgent, SelBroker, SelCustomer, SelInvestor, SelMember, SelVendor, SelProject) SELECT convert(int,AuthRowId), convert(int,ScreenId), convert(tinyint,RowAuthorityId), AllowSel, AllowAdd, AllowUpd, AllowDel, SelUsr, SelUsrGroup, SelCulture, SelCompany, SelAgent, SelBroker, SelCustomer, SelInvestor, SelMember, SelVendor, SelProject FROM dbo.AuthRow IF (SELECT COUNT(1) FROM dbo.Tmp_AuthRow) > 0 OR (SELECT COUNT(1) FROM dbo.AuthRow) = 0 DROP TABLE dbo.AuthRow') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AuthRow'')) CREATE TABLE dbo.AuthRow (AuthRowId Int IDENTITY NOT NULL, ScreenId Int NULL, ReportId Int NULL, RowAuthorityId TinyInt NOT NULL, AllowSel Char(1) NOT NULL, AllowAdd Char(1) NOT NULL, AllowUpd Char(1) NOT NULL, AllowDel Char(1) NOT NULL, SelUsr Char(1) NOT NULL, SelUsrGroup Char(1) NOT NULL, SelCulture Char(1) NOT NULL, SelCompany Char(1) NOT NULL, SelProject Char(1) NOT NULL, SelAgent Char(1) NOT NULL, SelBroker Char(1) NOT NULL, SelCustomer Char(1) NOT NULL, SelInvestor Char(1) NOT NULL, SelMember Char(1) NOT NULL, SelVendor Char(1) NOT NULL, CONSTRAINT PK_AuthRow PRIMARY KEY CLUSTERED (AuthRowId))') EXEC (' ALTER TABLE dbo.AuthRow ADD CONSTRAINT DF_AuthRow_SelProject DEFAULT (''S'') FOR SelProject SET IDENTITY_INSERT dbo.AuthRow ON INSERT INTO dbo.AuthRow (AuthRowId, ScreenId, RowAuthorityId, AllowSel, AllowAdd, AllowUpd, AllowDel, SelUsr, SelUsrGroup, SelCulture, SelCompany, SelProject, SelAgent, SelBroker, SelCustomer, SelInvestor, SelMember, SelVendor) SELECT AuthRowId, ScreenId, RowAuthorityId, AllowSel, AllowAdd, AllowUpd, AllowDel, SelUsr, SelUsrGroup, SelCulture, SelCompany, SelProject, SelAgent, SelBroker, SelCustomer, SelInvestor, SelMember, SelVendor FROM dbo.Tmp_AuthRow SET IDENTITY_INSERT dbo.AuthRow OFF IF (SELECT COUNT(1) FROM dbo.AuthRow) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AuthRow) = 0 DROP TABLE dbo.Tmp_AuthRow CREATE  UNIQUE NONCLUSTERED INDEX IX_AuthRow_ScreenId ON dbo.AuthRow (ScreenId,RowAuthorityId) ALTER TABLE dbo.AuthRow WITH NOCHECK ADD CONSTRAINT FK_AuthRow_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=335&typ=N&sys=3","","",""); return false;
336~@~   3.   9.80310:D:   80:*:*:M: Add table RptMemCriDtl~@~91~@~80~@~D~@~~@~~@~M~@~~@~Add table RptMemCriDtl~@~Y~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptMemCriDtl'')) CREATE TABLE dbo.RptMemCriDtl (RptMemCriDtlId Int IDENTITY NOT NULL, RptMemCriId Int NOT NULL, ReportCriId Int NOT NULL, MemCriteria NVarChar(900) NULL, CONSTRAINT PK_RptMemCriDtl PRIMARY KEY CLUSTERED (RptMemCriDtlId))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=336&typ=N&sys=3","","",""); return false;
337~@~   3.   9.80310:D:   90:*:*:M: Add table RptMemCri~@~91~@~90~@~D~@~~@~~@~M~@~~@~Add table RptMemCri~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptMemCri'')) CREATE TABLE dbo.RptMemCri (RptMemCriId Int IDENTITY NOT NULL, ReportId Int NOT NULL, RptMemCriName NVarChar(200) NOT NULL, UsrGroupId SmallInt NULL, UsrId Int NULL, CONSTRAINT PK_RptMemCri PRIMARY KEY CLUSTERED (RptMemCriId))') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=337&typ=N&sys=3","","",""); return false;
338~@~   3.   9.80310:D:  100:*:*:M: Add CompanyId to MenuPerm~@~91~@~100~@~D~@~~@~~@~M~@~~@~Add CompanyId to MenuPerm~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_MenuPerm (MenuPermId int NOT NULL, MenuId int NOT NULL, Everyone char(1) NOT NULL, UsrGroupId smallint NULL, MemberId int NULL, CustomerId int NULL, VendorId int NULL, InvestorId int NULL, AgentId int NULL, BrokerId int NULL, ProjectId smallint NULL)') EXEC (' INSERT INTO dbo.Tmp_MenuPerm (MenuPermId, MenuId, Everyone, UsrGroupId, MemberId, CustomerId, VendorId, InvestorId, AgentId, BrokerId, ProjectId) SELECT convert(int,MenuPermId), convert(int,MenuId), Everyone, convert(smallint,UsrGroupId), convert(int,MemberId), convert(int,CustomerId), convert(int,VendorId), convert(int,InvestorId), convert(int,AgentId), convert(int,BrokerId), convert(smallint,ProjectId) FROM dbo.MenuPerm IF (SELECT COUNT(1) FROM dbo.Tmp_MenuPerm) > 0 OR (SELECT COUNT(1) FROM dbo.MenuPerm) = 0 DROP TABLE dbo.MenuPerm') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.MenuPerm'')) CREATE TABLE dbo.MenuPerm (MenuPermId Int IDENTITY NOT NULL, MenuId Int NOT NULL, Everyone Char(1) NOT NULL, UsrGroupId SmallInt NULL, MemberId Int NULL, CustomerId Int NULL, VendorId Int NULL, InvestorId Int NULL, AgentId Int NULL, BrokerId Int NULL, ProjectId SmallInt NULL, CompanyId SmallInt NULL, CONSTRAINT PK_MenuPerm PRIMARY KEY CLUSTERED (MenuPermId))') EXEC (' SET IDENTITY_INSERT dbo.MenuPerm ON INSERT INTO dbo.MenuPerm (MenuPermId, MenuId, Everyone, UsrGroupId, MemberId, CustomerId, VendorId, InvestorId, AgentId, BrokerId, ProjectId) SELECT MenuPermId, MenuId, Everyone, UsrGroupId, MemberId, CustomerId, VendorId, InvestorId, AgentId, BrokerId, ProjectId FROM dbo.Tmp_MenuPerm SET IDENTITY_INSERT dbo.MenuPerm OFF IF (SELECT COUNT(1) FROM dbo.MenuPerm) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_MenuPerm) = 0 DROP TABLE dbo.Tmp_MenuPerm CREATE  NONCLUSTERED INDEX IX_MenuPerm_MenuId ON dbo.MenuPerm (MenuId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=338&typ=N&sys=3","","",""); return false;
339~@~   3.  10.80326:D:   10:*:*:M: Remove UsrGroupId from RptMemCri~@~92~@~10~@~D~@~~@~~@~M~@~~@~Remove UsrGroupId from RptMemCri~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_RptMemCri (RptMemCriId int NOT NULL, ReportId int NOT NULL, RptMemCriName nvarchar(200) NOT NULL, UsrId int NULL)')
EXEC ('INSERT INTO dbo.Tmp_RptMemCri (RptMemCriId, ReportId, RptMemCriName, UsrId) SELECT convert(int,RptMemCriId), convert(int,ReportId), RptMemCriName, convert(int,UsrId) FROM dbo.RptMemCri IF (SELECT COUNT(1) FROM dbo.Tmp_RptMemCri) > 0 OR (SELECT COUNT(1) FROM dbo.RptMemCri) = 0 DROP TABLE dbo.RptMemCri')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptMemCri'')) CREATE TABLE dbo.RptMemCri (RptMemCriId Int IDENTITY NOT NULL, RptMemCriName NVarChar(200) NOT NULL, ReportId Int NOT NULL, UsrId Int NULL, CONSTRAINT PK_RptMemCri PRIMARY KEY CLUSTERED (RptMemCriId))')
EXEC ('SET IDENTITY_INSERT dbo.RptMemCri ON INSERT INTO dbo.RptMemCri (RptMemCriId, RptMemCriName, ReportId, UsrId) SELECT RptMemCriId, RptMemCriName, ReportId, UsrId FROM dbo.Tmp_RptMemCri SET IDENTITY_INSERT dbo.RptMemCri OFF IF (SELECT COUNT(1) FROM dbo.RptMemCri) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptMemCri) = 0 DROP TABLE dbo.Tmp_RptMemCri CREATE  NONCLUSTERED INDEX IX_RptMemCri ON dbo.RptMemCri (UsrId,ReportId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=339&typ=N&sys=3","","",""); return false;
340~@~   3.  10.80326:D:   20:*:*:M: Add table ScrMemCri~@~92~@~20~@~D~@~~@~~@~M~@~~@~Add table ScrMemCri~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScrMemCri'')) CREATE TABLE dbo.ScrMemCri (ScrMemCriId Int IDENTITY NOT NULL, ScrMemCriName NVarChar(200) NOT NULL, ScreenId Int NOT NULL, UsrId Int NULL, CONSTRAINT PK_ScrMemCri PRIMARY KEY CLUSTERED (ScrMemCriId))') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=340&typ=N&sys=3","","",""); return false;
341~@~   3.  10.80326:D:   30:*:*:M: Add table ScrMemCriDtl~@~92~@~30~@~D~@~~@~~@~M~@~~@~Add table ScrMemCriDtl~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScrMemCriDtl'')) CREATE TABLE dbo.ScrMemCriDtl (ScrMemCriDtlId Int IDENTITY NOT NULL, ScrMemCriId Int NOT NULL, ScreenCriId Int NOT NULL, MemCriteria NVarChar(900) NULL, CONSTRAINT PK_ScrMemCriDtl PRIMARY KEY CLUSTERED (ScrMemCriDtlId))') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=341&typ=N&sys=3","","",""); return false;
342~@~   3.  10.80326:D:   40:*:*:M: Add columns to DbTable~@~92~@~40~@~D~@~~@~~@~M~@~~@~Add columns to DbTable~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_DbColumn_DbTable'') ALTER TABLE dbo.DbColumn DROP CONSTRAINT FK_DbColumn_DbTable CREATE TABLE dbo.Tmp_DbTable (TableId int NOT NULL, SystemId tinyint NOT NULL, TableName varchar(20) NOT NULL, TableDesc nvarchar(100) NOT NULL, MultiDesignDb char(1) NOT NULL, TblObjective ntext NULL, PrevTblName varchar(20) NULL, ModifiedBy int NULL, ModifiedOn datetime NULL, LastSyncDt datetime NULL)') EXEC (' INSERT INTO dbo.Tmp_DbTable (TableId, SystemId, TableName, TableDesc, MultiDesignDb, TblObjective, PrevTblName, ModifiedBy, ModifiedOn, LastSyncDt) SELECT convert(int,TableId), convert(tinyint,SystemId), TableName, TableDesc, MultiDesignDb, TblObjective, PrevTblName, convert(int,ModifiedBy), ModifiedOn, LastSyncDt FROM dbo.DbTable IF (SELECT COUNT(1) FROM dbo.Tmp_DbTable) > 0 OR (SELECT COUNT(1) FROM dbo.DbTable) = 0 DROP TABLE dbo.DbTable') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.DbTable'')) CREATE TABLE dbo.DbTable (TableId Int IDENTITY NOT NULL, SystemId TinyInt NOT NULL, TableName VarChar(20) NOT NULL, TableDesc NVarChar(100) NOT NULL, MultiDesignDb Char(1) NOT NULL, VirtualTbl Char(1) NOT NULL, VirtualSql NVarChar(max) NULL, TblObjective NVarChar(500) NULL, PrevTblName VarChar(20) NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastSyncDt DateTime NULL, CONSTRAINT PK_DbTable PRIMARY KEY CLUSTERED (TableId))') EXEC (' ALTER TABLE dbo.DbTable ADD CONSTRAINT DF_DbTable_VirtualTbl DEFAULT (''N'') FOR VirtualTbl SET IDENTITY_INSERT dbo.DbTable ON INSERT INTO dbo.DbTable (TableId, SystemId, TableName, TableDesc, MultiDesignDb, VirtualTbl, TblObjective, PrevTblName, ModifiedBy, ModifiedOn, LastSyncDt) SELECT TableId, SystemId, TableName, TableDesc, MultiDesignDb, ''N'', CONVERT(NVarChar(500),TblObjective), PrevTblName, ModifiedBy, ModifiedOn, LastSyncDt FROM dbo.Tmp_DbTable SET IDENTITY_INSERT dbo.DbTable OFF IF (SELECT COUNT(1) FROM dbo.DbTable) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_DbTable) = 0 DROP TABLE dbo.Tmp_DbTable CREATE  UNIQUE NONCLUSTERED INDEX IX_DbTable_TableName ON dbo.DbTable (TableName) ALTER TABLE dbo.DbColumn WITH NOCHECK ADD CONSTRAINT FK_DbColumn_DbTable FOREIGN KEY (TableId) REFERENCES dbo.DbTable (TableId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=342&typ=N&sys=3","","",""); return false;
343~@~   3.  10.80326:D:   50:*:*:M: Add table RptMemFld~@~92~@~50~@~D~@~~@~~@~M~@~~@~Add table RptMemFld~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptMemFld'')) CREATE TABLE dbo.RptMemFld (RptMemFldId Int IDENTITY NOT NULL, RptMemFldName NVarChar(200) NOT NULL, UsrId Int NULL, InputBy Int NULL, CONSTRAINT PK_RptMemFld PRIMARY KEY CLUSTERED (RptMemFldId))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=343&typ=N&sys=3","","",""); return false;
344~@~   3.  10.80326:D:   60:*:*:M: Add columns to RptMemCri~@~92~@~60~@~D~@~~@~~@~M~@~~@~Add columns to RptMemCri~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_RptMemCri (RptMemCriId int NOT NULL, RptMemCriName nvarchar(200) NOT NULL, ReportId int NOT NULL, UsrId int NULL)') EXEC (' INSERT INTO dbo.Tmp_RptMemCri (RptMemCriId, RptMemCriName, ReportId, UsrId) SELECT convert(int,RptMemCriId), RptMemCriName, convert(int,ReportId), convert(int,UsrId) FROM dbo.RptMemCri IF (SELECT COUNT(1) FROM dbo.Tmp_RptMemCri) > 0 OR (SELECT COUNT(1) FROM dbo.RptMemCri) = 0 DROP TABLE dbo.RptMemCri') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptMemCri'')) CREATE TABLE dbo.RptMemCri (RptMemCriId Int IDENTITY NOT NULL, RptMemFldId Int NOT NULL, RptMemCriName NVarChar(200) NOT NULL, RptMemCriDesc NVarChar(500) NULL, RptMemCriLink VarChar(200) NULL, ReportId Int NOT NULL, UsrId Int NULL, InputBy Int NULL, InputOn DateTime NULL, ModifiedOn DateTime NULL, ViewedOn DateTime NULL, CONSTRAINT PK_RptMemCri PRIMARY KEY CLUSTERED (RptMemCriId))') EXEC (' SET IDENTITY_INSERT dbo.RptMemCri ON INSERT INTO dbo.RptMemCri (RptMemCriId, RptMemFldId, RptMemCriName, ReportId, UsrId) SELECT RptMemCriId, 1, RptMemCriName, ReportId, UsrId FROM dbo.Tmp_RptMemCri SET IDENTITY_INSERT dbo.RptMemCri OFF IF (SELECT COUNT(1) FROM dbo.RptMemCri) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptMemCri) = 0 DROP TABLE dbo.Tmp_RptMemCri CREATE  NONCLUSTERED INDEX IX_RptMemCri ON dbo.RptMemCri (UsrId,ReportId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=344&typ=N&sys=3","","",""); return false;
345~@~   3.  10.80326:D:   70:*:*:M: Update DropDownList ErrMsg~@~92~@~70~@~D~@~~@~~@~M~@~~@~Update DropDownList ErrMsg~@~Y~@~UPDATE ScreenObjHlp SET ErrMessage = isnull(replace(ToolTip,'This is','Please select'),'Please select ' + ColumnHeader + '.')
FROM ScreenObjHlp a INNER JOIN ScreenObj b ON a.ScreenObjId = b.ScreenObjId
WHERE b.DisplayModeId = 3 AND b.RequiredValid = 'Y' AND a.ErrMessage is null~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=345&typ=N&sys=3","","",""); return false;
346~@~   3.  11.80415:D:   10:*:*:M: Add AllowSelect to Report~@~93~@~10~@~D~@~~@~~@~M~@~~@~Add AllowSelect to Report~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportCri_Report'') ALTER TABLE dbo.ReportCri DROP CONSTRAINT FK_ReportCri_Report IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportObj_Report'') ALTER TABLE dbo.ReportObj DROP CONSTRAINT FK_ReportObj_Report CREATE TABLE dbo.Tmp_Report (ReportId int NOT NULL, ProgramName varchar(20) NOT NULL, ReportDesc nvarchar(50) NULL, OrientationCd char(1) NOT NULL, ReportTypeCd char(1) NOT NULL, TemplateName varchar(50) NULL, RptTemplateId int NULL, CopyReportId int NULL, TopMargin decimal(8,2) NOT NULL, BottomMargin decimal(8,2) NOT NULL, LeftMargin decimal(8,2) NOT NULL, RightMargin decimal(8,2) NOT NULL, PageHeight decimal(8,2) NOT NULL, PageWidth decimal(8,2) NOT NULL, UnitCd char(2) NOT NULL, WhereClause varchar(1000) NULL, RegClause varchar(400) NULL, RegCode ntext NULL, ValClause varchar(400) NULL, ValCode ntext NULL, UpdClause varchar(200) NULL, UpdCode ntext NULL, XlsClause varchar(200) NULL, XlsCode ntext NULL, GenerateRp char(1) NOT NULL, ModifiedBy int NULL, ModifiedOn datetime NULL, LastGenDt datetime NULL)') EXEC (' INSERT INTO dbo.Tmp_Report (ReportId, ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, RptTemplateId, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, ModifiedBy, ModifiedOn, LastGenDt) SELECT convert(int,ReportId), ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, convert(int,RptTemplateId), convert(int,CopyReportId), convert(decimal(8,2),TopMargin), convert(decimal(8,2),BottomMargin), convert(decimal(8,2),LeftMargin), convert(decimal(8,2),RightMargin), convert(decimal(8,2),PageHeight), convert(decimal(8,2),PageWidth), UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, convert(int,ModifiedBy), ModifiedOn, LastGenDt FROM dbo.Report IF (SELECT COUNT(1) FROM dbo.Tmp_Report) > 0 OR (SELECT COUNT(1) FROM dbo.Report) = 0 DROP TABLE dbo.Report') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Report'')) CREATE TABLE dbo.Report (ReportId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ReportDesc NVarChar(50) NULL, OrientationCd Char(1) NOT NULL, ReportTypeCd Char(1) NOT NULL, TemplateName VarChar(50) NULL, RptTemplateId Int NULL, CopyReportId Int NULL, TopMargin Decimal(8,2) NOT NULL, BottomMargin Decimal(8,2) NOT NULL, LeftMargin Decimal(8,2) NOT NULL, RightMargin Decimal(8,2) NOT NULL, PageHeight Decimal(8,2) NOT NULL, PageWidth Decimal(8,2) NOT NULL, UnitCd Char(2) NOT NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, RegCode NText NULL, ValClause VarChar(400) NULL, ValCode NText NULL, UpdClause VarChar(200) NULL, UpdCode NText NULL, XlsClause VarChar(200) NULL, XlsCode NText NULL, GenerateRp Char(1) NOT NULL, AllowSelect Char(1) NOT NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, CONSTRAINT PK_Report PRIMARY KEY CLUSTERED (ReportId))') EXEC (' ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_TopMargin DEFAULT (1) FOR TopMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_BottomMargin DEFAULT (1) FOR BottomMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_LeftMargin DEFAULT (1) FOR LeftMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_RightMargin DEFAULT (1) FOR RightMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_PageHeight DEFAULT (11) FOR PageHeight ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_PageWidth DEFAULT (8.5) FOR PageWidth ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_UnitCd DEFAULT (''in'') FOR UnitCd ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_AllowSelect DEFAULT (''N'') FOR AllowSelect SET IDENTITY_INSERT dbo.Report ON INSERT INTO dbo.Report (ReportId, ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, RptTemplateId, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, ModifiedBy, ModifiedOn, LastGenDt) SELECT ReportId, ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, RptTemplateId, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, ''N'', ModifiedBy, ModifiedOn, LastGenDt FROM dbo.Tmp_Report SET IDENTITY_INSERT dbo.Report OFF IF (SELECT COUNT(1) FROM dbo.Report) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Report) = 0 DROP TABLE dbo.Tmp_Report CREATE  UNIQUE NONCLUSTERED INDEX IX_Report_ProgramName ON dbo.Report (ProgramName) ALTER TABLE dbo.ReportCri WITH NOCHECK ADD CONSTRAINT FK_ReportCri_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId) ALTER TABLE dbo.ReportObj WITH NOCHECK ADD CONSTRAINT FK_ReportObj_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=346&typ=N&sys=3","","",""); return false;
347~@~   3.  11.80415:D:   20:*:*:M: Add table Label~@~93~@~20~@~D~@~~@~~@~M~@~~@~Add table Label~@~Y~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Label''))
BEGIN
CREATE TABLE dbo.Label (LabelId Int IDENTITY NOT NULL, CultureId TinyInt NOT NULL, LabelCat VarChar(50) NULL, LabelKey VarChar(50) NOT NULL, LabelText NVarChar(1000) NOT NULL, CompanyId SmallInt NULL, SortOrder SmallInt NULL, CONSTRAINT PK_Label PRIMARY KEY CLUSTERED (LabelId))
CREATE NONCLUSTERED INDEX IX_Label ON dbo.Label(CultureId,LabelCat,LabelKey)
END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=347&typ=N&sys=3","","",""); return false;
348~@~   3.  12.80707:D:   10:*:*:M: Add IsIndex to table DbColumn~@~94~@~10~@~D~@~~@~~@~M~@~~@~Add IsIndex to table DbColumn~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_DbColumn_DbTable'') ALTER TABLE dbo.DbColumn DROP CONSTRAINT FK_DbColumn_DbTable CREATE TABLE dbo.Tmp_DbColumn (ColumnId int NOT NULL, TableId int NOT NULL, ExternalTable varchar(50) NULL, ColumnName varchar(20) NOT NULL, ColumnDesc varchar(100) NULL, DataType tinyint NOT NULL, ColumnLength smallint NOT NULL, ColumnScale tinyint NULL, AllowNulls char(1) NOT NULL, ColumnIdentity char(1) NOT NULL, PrimaryKey char(1) NOT NULL, ColObjective nvarchar(200) NULL, PrevColName varchar(20) NULL, ColumnIndex smallint NULL, DefaultValue nvarchar(50) NULL)') EXEC (' INSERT INTO dbo.Tmp_DbColumn (ColumnId, TableId, ExternalTable, ColumnName, ColumnDesc, DataType, ColumnLength, ColumnScale, AllowNulls, ColumnIdentity, PrimaryKey, ColObjective, PrevColName, ColumnIndex, DefaultValue) SELECT convert(int,ColumnId), convert(int,TableId), ExternalTable, ColumnName, ColumnDesc, convert(tinyint,DataType), convert(smallint,ColumnLength), convert(tinyint,ColumnScale), AllowNulls, ColumnIdentity, PrimaryKey, ColObjective, PrevColName, convert(smallint,ColumnIndex), DefaultValue FROM dbo.DbColumn IF (SELECT COUNT(1) FROM dbo.Tmp_DbColumn) > 0 OR (SELECT COUNT(1) FROM dbo.DbColumn) = 0 DROP TABLE dbo.DbColumn') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.DbColumn'')) CREATE TABLE dbo.DbColumn (ColumnId Int IDENTITY NOT NULL, TableId Int NOT NULL, ExternalTable VarChar(50) NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(100) NULL, DataType TinyInt NOT NULL, ColumnLength SmallInt NOT NULL, ColumnScale TinyInt NULL, AllowNulls Char(1) NOT NULL, ColumnIdentity Char(1) NOT NULL, PrimaryKey Char(1) NOT NULL, IsIndex Char(1) NOT NULL, ColObjective NVarChar(200) NULL, PrevColName VarChar(20) NULL, ColumnIndex SmallInt NULL, DefaultValue NVarChar(50) NULL, CONSTRAINT PK_DbColumn PRIMARY KEY CLUSTERED (ColumnId))') EXEC (' ALTER TABLE dbo.DbColumn ADD CONSTRAINT DF_DbColumn_IsIndex DEFAULT (''N'') FOR IsIndex SET IDENTITY_INSERT dbo.DbColumn ON INSERT INTO dbo.DbColumn (ColumnId, TableId, ExternalTable, ColumnName, ColumnDesc, DataType, ColumnLength, ColumnScale, AllowNulls, ColumnIdentity, PrimaryKey, IsIndex, ColObjective, PrevColName, ColumnIndex, DefaultValue) SELECT ColumnId, TableId, ExternalTable, ColumnName, ColumnDesc, DataType, ColumnLength, ColumnScale, AllowNulls, ColumnIdentity, PrimaryKey, ''N'', ColObjective, PrevColName, ColumnIndex, DefaultValue FROM dbo.Tmp_DbColumn SET IDENTITY_INSERT dbo.DbColumn OFF IF (SELECT COUNT(1) FROM dbo.DbColumn) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_DbColumn) = 0 DROP TABLE dbo.Tmp_DbColumn CREATE  UNIQUE NONCLUSTERED INDEX IX_DbColumn ON dbo.DbColumn (TableId,ColumnName) ALTER TABLE dbo.DbColumn WITH NOCHECK ADD CONSTRAINT FK_DbColumn_DbTable FOREIGN KEY (TableId) REFERENCES dbo.DbTable (TableId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=348&typ=N&sys=3","","",""); return false;
365~@~   3.  12.80707:D:   40:*:*:M: Add table QueryStr~@~94~@~40~@~D~@~~@~~@~M~@~~@~Add table QueryStr~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.QueryStr'')) CREATE TABLE dbo.QueryStr (QueryStrId VarChar(500) NOT NULL, QueryStrParm NVarChar(1000) NOT NULL, CONSTRAINT PK_QueryStr PRIMARY KEY CLUSTERED (QueryStrId))') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=365&typ=N&sys=3","","",""); return false;
366~@~   3.  12.80707:D:   50:*:*:M: Add gauge columns to Rptwiz~@~94~@~50~@~D~@~~@~~@~M~@~~@~Add gauge columns to Rptwiz~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_Rptwiz (RptwizId int NOT NULL, RptwizName nvarchar(50) NOT NULL, RptwizDesc nvarchar(400) NOT NULL, RptwizTypeCd char(1) NOT NULL, RptwizCatId smallint NULL, TemplateName varchar(50) NULL, ReportId int NULL, Changeable char(1) NOT NULL, UsrId int NOT NULL, TopMargin decimal(8,2) NULL, BottomMargin decimal(8,2) NULL, LeftMargin decimal(8,2) NULL, RightMargin decimal(8,2) NULL, OrientationCd char(1) NOT NULL, UnitCd char(2) NOT NULL, RptChaTypeCd char(2) NULL, ThreeD char(1) NOT NULL)')
EXEC ('INSERT INTO dbo.Tmp_Rptwiz (RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, TemplateName, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, OrientationCd, UnitCd, RptChaTypeCd, ThreeD) SELECT convert(int,RptwizId), RptwizName, RptwizDesc, RptwizTypeCd, convert(smallint,RptwizCatId), TemplateName, convert(int,ReportId), Changeable, convert(int,UsrId), convert(decimal(8,2),TopMargin), convert(decimal(8,2),BottomMargin), convert(decimal(8,2),LeftMargin), convert(decimal(8,2),RightMargin), OrientationCd, UnitCd, RptChaTypeCd, ThreeD FROM dbo.Rptwiz IF (SELECT COUNT(1) FROM dbo.Tmp_Rptwiz) > 0 OR (SELECT COUNT(1) FROM dbo.Rptwiz) = 0 DROP TABLE dbo.Rptwiz')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Rptwiz'')) CREATE TABLE dbo.Rptwiz (RptwizId Int IDENTITY NOT NULL, RptwizName NVarChar(50) NOT NULL, RptwizDesc NVarChar(400) NOT NULL, RptwizTypeCd Char(1) NOT NULL, RptwizCatId SmallInt NULL, TemplateName VarChar(50) NULL, ReportId Int NULL, Changeable Char(1) NOT NULL, UsrId Int NOT NULL, TopMargin Decimal(8,2) NULL, BottomMargin Decimal(8,2) NULL, LeftMargin Decimal(8,2) NULL, RightMargin Decimal(8,2) NULL, OrientationCd Char(1) NOT NULL, UnitCd Char(2) NOT NULL, RptChaTypeCd Char(2) NULL, ThreeD Char(1) NOT NULL, GMinValue Decimal(19,4) NULL, GLowRange Decimal(19,4) NULL, GMidRange Decimal(19,4) NULL, GMaxValue Decimal(19,4) NULL, GFormat char(1) NULL, CONSTRAINT PK_Rptwiz PRIMARY KEY CLUSTERED (RptwizId))')
EXEC ('ALTER TABLE dbo.Rptwiz ADD CONSTRAINT DF_Rptwiz_OrientationCd DEFAULT (''Y'') FOR OrientationCd ALTER TABLE dbo.Rptwiz ADD CONSTRAINT DF_Rptwiz_UnitCd DEFAULT (''in'') FOR UnitCd ALTER TABLE dbo.Rptwiz ADD CONSTRAINT DF_Rptwiz_ThreeD DEFAULT (''N'') FOR ThreeD SET IDENTITY_INSERT dbo.Rptwiz ON INSERT INTO dbo.Rptwiz (RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, TemplateName, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, OrientationCd, UnitCd, RptChaTypeCd, ThreeD) SELECT RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, TemplateName, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, OrientationCd, UnitCd, RptChaTypeCd, ThreeD FROM dbo.Tmp_Rptwiz SET IDENTITY_INSERT dbo.Rptwiz OFF IF (SELECT COUNT(1) FROM dbo.Rptwiz) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Rptwiz) = 0 DROP TABLE dbo.Tmp_Rptwiz')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=366&typ=N&sys=3","","",""); return false;
367~@~   3.  12.80707:D:   60:*:*:M: Add table CtFormat~@~94~@~60~@~D~@~~@~~@~M~@~~@~Add table CtFormat~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtFormat'))
BEGIN
EXEC ('CREATE TABLE dbo.CtFormat (FormatCd Char(1) NOT NULL, FormatName NVarChar(10) NOT NULL, FormatSort TinyInt NULL, CONSTRAINT PK_CtFormat PRIMARY KEY CLUSTERED (FormatCd))')
EXEC ('INSERT dbo.CtFormat VALUES (''g'',''Numeric'',3)')
EXEC ('INSERT dbo.CtFormat VALUES (''c'',''Currency'',2)')
EXEC ('INSERT dbo.CtFormat VALUES (''n'',''Money'',1)')
EXEC ('INSERT dbo.CtFormat VALUES (''p'',''Percent'',4)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=367&typ=N&sys=3","","",""); return false;
368~@~   3.  12.80707:D:   70:*:*:M: Add table DshFld~@~94~@~70~@~D~@~~@~~@~M~@~~@~Add table DshFld~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.DshFld'')) CREATE TABLE dbo.DshFld (DshFldId Int IDENTITY NOT NULL, DshFldName NVarChar(200) NOT NULL, UsrId Int NULL, InputBy Int NULL, CompanyLs VarChar(1000) NULL, CONSTRAINT PK_DshFld PRIMARY KEY CLUSTERED (DshFldId))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=368&typ=N&sys=3","","",""); return false;
369~@~   3.  12.80707:D:   80:*:*:M: Add table DshFldDtl~@~94~@~80~@~D~@~~@~~@~M~@~~@~Add table DshFldDtl~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.DshFldDtl'')) CREATE TABLE dbo.DshFldDtl (DshFldDtlId Int IDENTITY NOT NULL, DshFldId Int NOT NULL, DshFldDtlName NVarChar(200) NOT NULL, DshFldDtlDesc NVarChar(500) NULL, DshFldDtlLink VarChar(200) NULL, DshFldDtlCfg VarChar(200) NULL, UsrId Int NULL, InputBy Int NULL, InputOn DateTime NULL, ModifiedOn DateTime NULL, ViewedOn DateTime NULL, CONSTRAINT PK_DshFldDtl PRIMARY KEY CLUSTERED (DshFldDtlId))') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=369&typ=N&sys=3","","",""); return false;
370~@~   3.  12.80707:D:   90:*:*:M: Add CompanyLs to table RptMemFld~@~94~@~90~@~D~@~~@~~@~M~@~~@~Add CompanyLs to table RptMemFld~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_RptMemFld (RptMemFldId int NOT NULL, RptMemFldName nvarchar(200) NOT NULL, UsrId int NULL, InputBy int NULL)') EXEC (' INSERT INTO dbo.Tmp_RptMemFld (RptMemFldId, RptMemFldName, UsrId, InputBy) SELECT convert(int,RptMemFldId), RptMemFldName, convert(int,UsrId), convert(int,InputBy) FROM dbo.RptMemFld IF (SELECT COUNT(1) FROM dbo.Tmp_RptMemFld) > 0 OR (SELECT COUNT(1) FROM dbo.RptMemFld) = 0 DROP TABLE dbo.RptMemFld') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptMemFld'')) CREATE TABLE dbo.RptMemFld (RptMemFldId Int IDENTITY NOT NULL, RptMemFldName NVarChar(200) NOT NULL, UsrId Int NULL, InputBy Int NULL, CompanyLs VarChar(1000) NULL, CONSTRAINT PK_RptMemFld PRIMARY KEY CLUSTERED (RptMemFldId))') EXEC (' SET IDENTITY_INSERT dbo.RptMemFld ON INSERT INTO dbo.RptMemFld (RptMemFldId, RptMemFldName, UsrId, InputBy) SELECT RptMemFldId, RptMemFldName, UsrId, InputBy FROM dbo.Tmp_RptMemFld SET IDENTITY_INSERT dbo.RptMemFld OFF IF (SELECT COUNT(1) FROM dbo.RptMemFld) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptMemFld) = 0 DROP TABLE dbo.Tmp_RptMemFld')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=370&typ=N&sys=3","","",""); return false;
371~@~   3.  12.80707:D:  100:*:*:M: Add table DshAvail~@~94~@~100~@~D~@~~@~~@~M~@~~@~Add table DshAvail~@~N~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.DshAvail'')) CREATE TABLE dbo.DshAvail (DshAvailCd VarChar(100) NOT NULL, IsAvailable Char(1) NOT NULL, CONSTRAINT PK_DshAvail PRIMARY KEY CLUSTERED (DshAvailCd))') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=371&typ=N&sys=3","","",""); return false;
372~@~   3.  12.80707:D:  110:*:*:M: Change ColumnLink in table ScreenObj~@~94~@~110~@~D~@~~@~~@~M~@~~@~Change ColumnLink in table ScreenObj~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_Screen'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_ScreenTab'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_ScreenTab CREATE TABLE dbo.Tmp_ScreenObj (ScreenObjId int NOT NULL, ScreenId int NOT NULL, MasterTable char(1) NOT NULL, ScreenGrpId int NOT NULL, ColumnId int NULL, ColumnName varchar(20) NOT NULL, ColumnDesc varchar(100) NULL, DefaultValue nvarchar(100) NULL, SystemValue nvarchar(100) NULL, ColumnWrap char(1) NOT NULL, ColumnJustify char(1) NULL, ColumnSize smallint NULL, ColumnHeight smallint NULL, DisplayModeId tinyint NOT NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DdlAdnColumnId int NULL, DdlFtrColumnId int NULL, AggregateCd char(1) NULL, GenerateSp char(1) NOT NULL, TabFolderId int NULL, TabIndex smallint NOT NULL, SortOrder smallint NULL, RequiredValid char(1) NOT NULL, MaskValid varchar(50) NULL, RangeValidType varchar(50) NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, ColumnLink varchar(100) NULL, RefreshOnCUD char(1) NOT NULL, TrimOnEntry char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry) SELECT convert(int,ScreenObjId), convert(int,ScreenId), MasterTable, convert(int,ScreenGrpId), convert(int,ColumnId), ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, convert(smallint,ColumnSize), convert(smallint,ColumnHeight), convert(tinyint,DisplayModeId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), convert(int,DdlAdnColumnId), convert(int,DdlFtrColumnId), AggregateCd, GenerateSp, convert(int,TabFolderId), convert(smallint,TabIndex), convert(smallint,SortOrder), RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObj'')) CREATE TABLE dbo.ScreenObj (ScreenObjId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, ScreenGrpId Int NOT NULL, ColumnId Int NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(100) NULL, DefaultValue NVarChar(100) NULL, SystemValue NVarChar(100) NULL, ColumnWrap Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, ColumnHeight SmallInt NULL, DisplayModeId TinyInt NOT NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlAdnColumnId Int NULL, DdlFtrColumnId Int NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId Int NULL, TabIndex SmallInt NOT NULL, SortOrder SmallInt NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(50) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(1000) NULL, RefreshOnCUD Char(1) NOT NULL, TrimOnEntry Char(1) NOT NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))') EXEC (' ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_TrimOnEntry DEFAULT (''Y'') FOR TrimOnEntry SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry) SELECT ScreenObjId, ScreenId, MasterTable, ScreenGrpId, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj CREATE  NONCLUSTERED INDEX IX_ScreenObj_ScreenId ON dbo.ScreenObj (ScreenId,TabIndex) ALTER TABLE dbo.ScreenObj WITH NOCHECK ADD CONSTRAINT FK_ScreenObj_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenObj WITH NOCHECK ADD CONSTRAINT FK_ScreenObj_ScreenTab FOREIGN KEY (TabFolderId) REFERENCES dbo.ScreenTab (ScreenTabId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=372&typ=N&sys=3","","",""); return false;
373~@~   3.  12.80707:D:  120:*:*:M: Add table CtLinkType~@~94~@~120~@~D~@~~@~~@~M~@~~@~Add table CtLinkType~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtLinkType'))
BEGIN
	EXEC ('CREATE TABLE dbo.CtLinkType (LinkTypeCd Char(1) NOT NULL, LinkTypeName NVarChar(50) NOT NULL, LinkTypeSort TinyInt NULL, CONSTRAINT PK_CtLinkType PRIMARY KEY CLUSTERED (LinkTypeCd))')
	EXEC ('INSERT dbo.CtLinkType VALUES(''P'',''Page'',null)')
	EXEC ('INSERT dbo.CtLinkType VALUES(''L'',''Login'',null)')
	EXEC ('INSERT dbo.CtLinkType VALUES(''M'',''Menu'',null)')
	EXEC ('INSERT dbo.CtLinkType VALUES(''S'',''Shortcut'',null)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=373&typ=N&sys=3","","",""); return false;
374~@~   3.  12.80707:D:  130:*:*:M: Add table UsrLink~@~94~@~130~@~D~@~~@~~@~M~@~~@~Add table UsrLink~@~N~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrLink'')) CREATE TABLE dbo.UsrLink (UsrLinkId Int IDENTITY NOT NULL, UsrPrefId Int NOT NULL, LinkTypeCd Char(1) NOT NULL, Popup Char(1) NOT NULL, UsrLinkRef VarChar(200) NOT NULL, UsrLinkTxt NVarChar(50) NULL, UsrLinkImg VarChar(200) NULL, UsrLinkAlt VarChar(200) NULL, UsrLinkOrd SmallInt NULL, CONSTRAINT PK_UsrLink PRIMARY KEY CLUSTERED (UsrLinkId))') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=374&typ=N&sys=3","","",""); return false;
375~@~   3.  12.80707:D:  140:*:*:M: Remove columns from UsrPref~@~94~@~140~@~D~@~~@~~@~M~@~~@~Remove columns from UsrPref~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_UsrPref (UsrPrefId int NOT NULL, UsrId int NULL, UsrGroupId smallint NULL, CompanyId smallint NULL, MemberId int NULL, AgentId int NULL, BrokerId int NULL, CustomerId int NULL, InvestorId int NULL, VendorId int NULL, ProjectId smallint NULL, SystemId tinyint NULL, PrefDefault char(1) NOT NULL, UsrPrefDesc nvarchar(50) NOT NULL, SysListVisible char(1) NOT NULL, ComListVisible char(1) NOT NULL, PrjListVisible char(1) NOT NULL, MenuOption char(1) NOT NULL, PageBannerImg varchar(100) NULL, PageLink1Href varchar(100) NULL, PageLink1Text nvarchar(20) NULL, PageLink2Href varchar(100) NULL, PageLink2Text nvarchar(20) NULL, LoginLink1Href varchar(100) NULL, LoginLink1Text nvarchar(20) NULL, LoginLink2Href varchar(100) NULL, LoginLink2Text nvarchar(20) NULL, LoginLink3Href varchar(100) NULL, LoginLink3Text nvarchar(20) NULL, LoginLink4Href varchar(100) NULL, LoginLink4Text nvarchar(20) NULL, UsrStyleSheet text NULL, MenuAd1Img varchar(100) NULL, MenuAd1Href varchar(100) NULL, MenuAd2Img varchar(100) NULL, MenuAd2Href varchar(100) NULL, SplashImg varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_UsrPref (UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOption, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, UsrStyleSheet, MenuAd1Img, MenuAd1Href, MenuAd2Img, MenuAd2Href, SplashImg) SELECT convert(int,UsrPrefId), convert(int,UsrId), convert(smallint,UsrGroupId), convert(smallint,CompanyId), convert(int,MemberId), convert(int,AgentId), convert(int,BrokerId), convert(int,CustomerId), convert(int,InvestorId), convert(int,VendorId), convert(smallint,ProjectId), convert(tinyint,SystemId), PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOption, PageBannerImg, PageLink1Href, PageLink1Text, PageLink2Href, PageLink2Text, LoginLink1Href, LoginLink1Text, LoginLink2Href, LoginLink2Text, LoginLink3Href, LoginLink3Text, LoginLink4Href, LoginLink4Text, UsrStyleSheet, MenuAd1Img, MenuAd1Href, MenuAd2Img, MenuAd2Href, SplashImg FROM dbo.UsrPref IF (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.UsrPref) = 0 DROP TABLE dbo.UsrPref') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrPref'')) CREATE TABLE dbo.UsrPref (UsrPrefId Int IDENTITY NOT NULL, UsrId Int NULL, UsrGroupId SmallInt NULL, CompanyId SmallInt NULL, MemberId Int NULL, AgentId Int NULL, BrokerId Int NULL, CustomerId Int NULL, InvestorId Int NULL, VendorId Int NULL, ProjectId SmallInt NULL, SystemId TinyInt NULL, PrefDefault Char(1) NOT NULL, UsrPrefDesc NVarChar(50) NOT NULL, SysListVisible Char(1) NOT NULL, ComListVisible Char(1) NOT NULL, PrjListVisible Char(1) NOT NULL, MenuOption Char(1) NOT NULL, PageBannerImg VarChar(100) NULL, UsrStyleSheet Text NULL, SplashImg VarChar(100) NULL, CONSTRAINT PK_UsrPref PRIMARY KEY CLUSTERED (UsrPrefId))') EXEC (' ALTER TABLE dbo.UsrPref ADD CONSTRAINT DF_UsrPref_PrjListVisible DEFAULT (''N'') FOR PrjListVisible SET IDENTITY_INSERT dbo.UsrPref ON INSERT INTO dbo.UsrPref (UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOption, PageBannerImg, UsrStyleSheet, SplashImg) SELECT UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOption, PageBannerImg, UsrStyleSheet, SplashImg FROM dbo.Tmp_UsrPref SET IDENTITY_INSERT dbo.UsrPref OFF IF (SELECT COUNT(1) FROM dbo.UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) = 0 DROP TABLE dbo.Tmp_UsrPref CREATE  UNIQUE NONCLUSTERED INDEX IX_UsrPref_UsrPrefDesc ON dbo.UsrPref (UsrPrefDesc)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=375&typ=N&sys=3","","",""); return false;
376~@~   3.  15.80724:D:   10:*:*:M: Drop table ReportItem~@~98~@~10~@~D~@~~@~~@~M~@~~@~Drop table ReportItem~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ReportItem'')) DROP TABLE dbo.ReportItem')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=376&typ=N&sys=3","","",""); return false;
377~@~   3.  17.80825:D:   10:*:*:M: Add column MatchCd to ScreenObj~@~100~@~10~@~D~@~~@~~@~M~@~~@~Add column MatchCd to ScreenObj~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_Screen'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_ScreenTab'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_ScreenTab CREATE TABLE dbo.Tmp_ScreenObj (ScreenObjId int NOT NULL, ScreenId int NOT NULL, MasterTable char(1) NOT NULL, ScreenGrpId int NOT NULL, ColumnId int NULL, ColumnName varchar(20) NOT NULL, ColumnDesc varchar(100) NULL, DefaultValue nvarchar(100) NULL, SystemValue nvarchar(100) NULL, ColumnWrap char(1) NOT NULL, ColumnJustify char(1) NULL, ColumnSize smallint NULL, ColumnHeight smallint NULL, DisplayModeId tinyint NOT NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DdlAdnColumnId int NULL, DdlFtrColumnId int NULL, AggregateCd char(1) NULL, GenerateSp char(1) NOT NULL, TabFolderId int NULL, TabIndex smallint NOT NULL, SortOrder smallint NULL, RequiredValid char(1) NOT NULL, MaskValid varchar(50) NULL, RangeValidType varchar(50) NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, ColumnLink varchar(1000) NULL, RefreshOnCUD char(1) NOT NULL, TrimOnEntry char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry) SELECT convert(int,ScreenObjId), convert(int,ScreenId), MasterTable, convert(int,ScreenGrpId), convert(int,ColumnId), ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, convert(smallint,ColumnSize), convert(smallint,ColumnHeight), convert(tinyint,DisplayModeId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), convert(int,DdlAdnColumnId), convert(int,DdlFtrColumnId), AggregateCd, GenerateSp, convert(int,TabFolderId), convert(smallint,TabIndex), convert(smallint,SortOrder), RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObj'')) CREATE TABLE dbo.ScreenObj (ScreenObjId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, ScreenGrpId Int NOT NULL, ColumnId Int NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(100) NULL, DefaultValue NVarChar(100) NULL, SystemValue NVarChar(100) NULL, ColumnWrap Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, ColumnHeight SmallInt NULL, DisplayModeId TinyInt NOT NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlAdnColumnId Int NULL, DdlFtrColumnId Int NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId Int NULL, TabIndex SmallInt NOT NULL, SortOrder SmallInt NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(50) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(1000) NULL, RefreshOnCUD Char(1) NOT NULL, TrimOnEntry Char(1) NOT NULL, MatchCd Char(1) NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))') EXEC (' ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_TrimOnEntry DEFAULT (''Y'') FOR TrimOnEntry SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry) SELECT ScreenObjId, ScreenId, MasterTable, ScreenGrpId, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj CREATE  NONCLUSTERED INDEX IX_ScreenObj_ScreenId ON dbo.ScreenObj (ScreenId,TabIndex) ALTER TABLE dbo.ScreenObj WITH NOCHECK ADD CONSTRAINT FK_ScreenObj_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenObj WITH NOCHECK ADD CONSTRAINT FK_ScreenObj_ScreenTab FOREIGN KEY (TabFolderId) REFERENCES dbo.ScreenTab (ScreenTabId)')
EXEC ('UPDATE ScreenObj SET MatchCd = ''2'' WHERE TabFolderId is null and DdlKeyColumnId is not null AND DdlRefColumnId is not null AND MatchCd is null
')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=377&typ=N&sys=3","","",""); return false;
378~@~   3.  17.80825:D:   20:*:*:M: Add table CtMatch~@~100~@~20~@~D~@~~@~~@~M~@~~@~Add table CtMatch~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtMatch'))
BEGIN
EXEC ('CREATE TABLE dbo.CtMatch (MatchCd Char(1) NOT NULL, MatchName NVarChar(50) NOT NULL, MatchSort TinyInt NULL, CONSTRAINT PK_CtMatch PRIMARY KEY CLUSTERED (MatchCd))')
EXEC ('INSERT dbo.CtMatch VALUES (''1'',''Key Match Only'',1)')
EXEC ('INSERT dbo.CtMatch VALUES (''2'',''All above then Exact Name'',2)')
EXEC ('INSERT dbo.CtMatch VALUES (''3'',''All above then StartsWith'',3)')
EXEC ('INSERT dbo.CtMatch VALUES (''4'',''All above then Wild Search'',4)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=378&typ=N&sys=3","","",""); return false;
380~@~   3.  18.80908:D:   10:*:*:M: Add column WsProgramPath to ClientTier~@~101~@~10~@~D~@~~@~~@~M~@~~@~Add column WsProgramPath to ClientTier~@~N~@~IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.ClientTier'))
BEGIN
EXEC ('CREATE TABLE dbo.Tmp_ClientTier (ClientTierId tinyint NOT NULL, ClientTierName nvarchar(50) NOT NULL, EntityId smallint NOT NULL, LanguageCd char(1) NOT NULL, FrameworkCd char(1) NOT NULL, DevProgramPath varchar(100) NOT NULL, IsDefault char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_ClientTier (ClientTierId, ClientTierName, EntityId, LanguageCd, FrameworkCd, DevProgramPath, IsDefault) SELECT convert(tinyint,ClientTierId), ClientTierName, convert(smallint,EntityId), LanguageCd, FrameworkCd, DevProgramPath, IsDefault FROM dbo.ClientTier IF (SELECT COUNT(1) FROM dbo.Tmp_ClientTier) > 0 OR (SELECT COUNT(1) FROM dbo.ClientTier) = 0 DROP TABLE dbo.ClientTier') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ClientTier'')) CREATE TABLE dbo.ClientTier (ClientTierId TinyInt NOT NULL, ClientTierName NVarChar(50) NOT NULL, EntityId Int NOT NULL, LanguageCd Char(1) NOT NULL, FrameworkCd Char(1) NOT NULL, DevProgramPath VarChar(100) NOT NULL, WsProgramPath VarChar(100) NULL, IsDefault Char(1) NOT NULL, CONSTRAINT PK_ClientTier PRIMARY KEY CLUSTERED (ClientTierId))') EXEC (' INSERT INTO dbo.ClientTier (ClientTierId, ClientTierName, EntityId, LanguageCd, FrameworkCd, DevProgramPath, IsDefault) SELECT ClientTierId, ClientTierName, CONVERT(Int,EntityId), LanguageCd, FrameworkCd, DevProgramPath, IsDefault FROM dbo.Tmp_ClientTier IF (SELECT COUNT(1) FROM dbo.ClientTier) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ClientTier) = 0 DROP TABLE dbo.Tmp_ClientTier')
EXEC ('UPDATE dbo.ClientTier SET WsProgramPath = replace(DevProgramPath,''\Web\'',''Ws\'')')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=380&typ=N&sys=3","","",""); return false;
381~@~   3.  18.80908:D:   20:*:*:M: Remove 2 columns from ReleaseDtl~@~101~@~20~@~D~@~~@~~@~M~@~~@~Remove 2 columns from ReleaseDtl~@~N~@~IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.ReleaseDtl'))
BEGIN
EXEC ('CREATE TABLE dbo.Tmp_ReleaseDtl (ReleaseDtlId int NOT NULL, ReleaseId smallint NOT NULL, RunOrder smallint NULL, ObjectName text NOT NULL, SrcObject varchar(50) NULL, ObjectExempt text NULL, ObjectType char(1) NOT NULL, SrcClientTierId tinyint NULL, TarClientTierId tinyint NULL, SrcRuleTierId tinyint NULL, TarRuleTierId tinyint NULL, SrcDataTierId tinyint NULL, TarDataTierId tinyint NULL, SProcOnly char(1) NOT NULL, DoSpEncrypt char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_ReleaseDtl (ReleaseDtlId, ReleaseId, RunOrder, ObjectName, SrcObject, ObjectExempt, ObjectType, SrcClientTierId, TarClientTierId, SrcRuleTierId, TarRuleTierId, SrcDataTierId, TarDataTierId, SProcOnly, DoSpEncrypt) SELECT convert(int,ReleaseDtlId), convert(smallint,ReleaseId), convert(smallint,RunOrder), ObjectName, SrcObject, ObjectExempt, ObjectType, convert(tinyint,SrcClientTierId), convert(tinyint,TarClientTierId), convert(tinyint,SrcRuleTierId), convert(tinyint,TarRuleTierId), convert(tinyint,SrcDataTierId), convert(tinyint,TarDataTierId), SProcOnly, DoSpEncrypt FROM dbo.ReleaseDtl IF (SELECT COUNT(1) FROM dbo.Tmp_ReleaseDtl) > 0 OR (SELECT COUNT(1) FROM dbo.ReleaseDtl) = 0 DROP TABLE dbo.ReleaseDtl') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ReleaseDtl'')) CREATE TABLE dbo.ReleaseDtl (ReleaseDtlId Int IDENTITY NOT NULL, ReleaseId SmallInt NOT NULL, RunOrder SmallInt NULL, ObjectName Text NOT NULL, SrcObject VarChar(50) NULL, ObjectExempt Text NULL, ObjectType Char(1) NOT NULL, SrcClientTierId TinyInt NULL, SrcRuleTierId TinyInt NULL, SrcDataTierId TinyInt NULL, TarDataTierId TinyInt NULL, SProcOnly Char(1) NOT NULL, DoSpEncrypt Char(1) NOT NULL, CONSTRAINT PK_ReleaseDtl PRIMARY KEY CLUSTERED (ReleaseDtlId))') EXEC (' ALTER TABLE dbo.ReleaseDtl ADD CONSTRAINT DF_ReleaseDtl_SProcOnly DEFAULT (''Y'') FOR SProcOnly ALTER TABLE dbo.ReleaseDtl ADD CONSTRAINT DF_ReleaseDtl_DoSpEncrypt DEFAULT (''Y'') FOR DoSpEncrypt SET IDENTITY_INSERT dbo.ReleaseDtl ON INSERT INTO dbo.ReleaseDtl (ReleaseDtlId, ReleaseId, RunOrder, ObjectName, SrcObject, ObjectExempt, ObjectType, SrcClientTierId, SrcRuleTierId, SrcDataTierId, TarDataTierId, SProcOnly, DoSpEncrypt) SELECT ReleaseDtlId, ReleaseId, RunOrder, ObjectName, SrcObject, ObjectExempt, ObjectType, SrcClientTierId, SrcRuleTierId, SrcDataTierId, TarDataTierId, SProcOnly, DoSpEncrypt FROM dbo.Tmp_ReleaseDtl SET IDENTITY_INSERT dbo.ReleaseDtl OFF IF (SELECT COUNT(1) FROM dbo.ReleaseDtl) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ReleaseDtl) = 0 DROP TABLE dbo.Tmp_ReleaseDtl')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=381&typ=N&sys=3","","",""); return false;
382~@~   3.  18.80911:D:   10:*:*:M: Add column ImportFileName to CtCultureType~@~102~@~10~@~D~@~~@~~@~M~@~~@~Add column ImportFileName to CtCultureType~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_CtCultureType (CultureId tinyint NOT NULL, CultureTypeName varchar(6) NOT NULL, CultureTypeDesc nvarchar(50) NOT NULL, CultureDefault char(1) NOT NULL, EnNumberRule char(1) NOT NULL, CultureTypeSrt smallint NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_CtCultureType (CultureId, CultureTypeName, CultureTypeDesc, CultureDefault, EnNumberRule, CultureTypeSrt) SELECT convert(tinyint,CultureId), CultureTypeName, CultureTypeDesc, CultureDefault, EnNumberRule, convert(smallint,CultureTypeSrt) FROM dbo.CtCultureType IF (SELECT COUNT(1) FROM dbo.Tmp_CtCultureType) > 0 OR (SELECT COUNT(1) FROM dbo.CtCultureType) = 0 DROP TABLE dbo.CtCultureType') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtCultureType'')) CREATE TABLE dbo.CtCultureType (CultureId TinyInt NOT NULL, CultureTypeName VarChar(6) NOT NULL, CultureTypeDesc NVarChar(50) NOT NULL, CultureDefault Char(1) NOT NULL, EnNumberRule Char(1) NOT NULL, CultureTypeSrt SmallInt NOT NULL, ImportFileName NVarChar(30) NULL, CONSTRAINT PK_CtCultureType PRIMARY KEY CLUSTERED (CultureId))') EXEC (' ALTER TABLE dbo.CtCultureType ADD CONSTRAINT DF_CtCultureType_CultureTypeSrt DEFAULT (1) FOR CultureTypeSrt INSERT INTO dbo.CtCultureType (CultureId, CultureTypeName, CultureTypeDesc, CultureDefault, EnNumberRule, CultureTypeSrt) SELECT CultureId, CultureTypeName, CultureTypeDesc, CultureDefault, EnNumberRule, CultureTypeSrt FROM dbo.Tmp_CtCultureType IF (SELECT COUNT(1) FROM dbo.CtCultureType) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtCultureType) = 0 DROP TABLE dbo.Tmp_CtCultureType')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=382&typ=N&sys=3","","",""); return false;
383~@~   3.  18.80917:D:   10:*:*:M: Resize column TabFolderName in ScreenTabHlp~@~103~@~10~@~D~@~~@~~@~M~@~~@~Resize column TabFolderName in ScreenTabHlp~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenTabHlp_ScreenTab'') ALTER TABLE dbo.ScreenTabHlp DROP CONSTRAINT FK_ScreenTabHlp_ScreenTab CREATE TABLE dbo.Tmp_ScreenTabHlp (ScreenTabHlpId int NOT NULL, ScreenTabId int NOT NULL, CultureId tinyint NOT NULL, TabFolderName nvarchar(30) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenTabHlp (ScreenTabHlpId, ScreenTabId, CultureId, TabFolderName) SELECT convert(int,ScreenTabHlpId), convert(int,ScreenTabId), convert(tinyint,CultureId), TabFolderName FROM dbo.ScreenTabHlp IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenTabHlp) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenTabHlp) = 0 DROP TABLE dbo.ScreenTabHlp') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenTabHlp'')) CREATE TABLE dbo.ScreenTabHlp (ScreenTabHlpId Int IDENTITY NOT NULL, ScreenTabId Int NOT NULL, CultureId TinyInt NOT NULL, TabFolderName NVarChar(50) NOT NULL, CONSTRAINT PK_ScreenTabHlp PRIMARY KEY CLUSTERED (ScreenTabHlpId))') EXEC (' SET IDENTITY_INSERT dbo.ScreenTabHlp ON INSERT INTO dbo.ScreenTabHlp (ScreenTabHlpId, ScreenTabId, CultureId, TabFolderName) SELECT ScreenTabHlpId, ScreenTabId, CultureId, TabFolderName FROM dbo.Tmp_ScreenTabHlp SET IDENTITY_INSERT dbo.ScreenTabHlp OFF IF (SELECT COUNT(1) FROM dbo.ScreenTabHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenTabHlp) = 0 DROP TABLE dbo.Tmp_ScreenTabHlp CREATE  UNIQUE NONCLUSTERED INDEX IX_ScreenTabHlp_ScreenTabId ON dbo.ScreenTabHlp (CultureId,ScreenTabId) ALTER TABLE dbo.ScreenTabHlp WITH NOCHECK ADD CONSTRAINT FK_ScreenTabHlp_ScreenTab FOREIGN KEY (ScreenTabId) REFERENCES dbo.ScreenTab (ScreenTabId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=383&typ=N&sys=3","","",""); return false;
384~@~   3.  20.81008:D:   10:*:*:M: Add column ApplytoMst to ScreenFilter~@~105~@~10~@~D~@~~@~~@~M~@~~@~Add column ApplytoMst to ScreenFilter~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_FilterHlp_ScreenFilter'') ALTER TABLE dbo.ScreenFilterHlp DROP CONSTRAINT FK_FilterHlp_ScreenFilter CREATE TABLE dbo.Tmp_ScreenFilter (ScreenFilterId int NOT NULL, ScreenId int NOT NULL, ScreenFilterName varchar(50) NOT NULL, ScreenFilterDesc varchar(100) NULL, FilterClause varchar(1500) NOT NULL, FilterOrder tinyint NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenFilter (ScreenFilterId, ScreenId, ScreenFilterName, ScreenFilterDesc, FilterClause, FilterOrder) SELECT convert(int,ScreenFilterId), convert(int,ScreenId), ScreenFilterName, ScreenFilterDesc, FilterClause, convert(tinyint,FilterOrder) FROM dbo.ScreenFilter IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenFilter) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenFilter) = 0 DROP TABLE dbo.ScreenFilter') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenFilter'')) CREATE TABLE dbo.ScreenFilter (ScreenFilterId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, ScreenFilterName VarChar(50) NOT NULL, ScreenFilterDesc VarChar(100) NULL, FilterClause VarChar(1500) NOT NULL, FilterOrder TinyInt NOT NULL, ApplyToMst Char(1) NOT NULL, CONSTRAINT PK_ScreenFilter PRIMARY KEY CLUSTERED (ScreenFilterId))') EXEC (' ALTER TABLE dbo.ScreenFilter ADD CONSTRAINT DF_ScreenFilter_ApplyToMst DEFAULT (''Y'') FOR ApplyToMst SET IDENTITY_INSERT dbo.ScreenFilter ON INSERT INTO dbo.ScreenFilter (ScreenFilterId, ScreenId, ScreenFilterName, ScreenFilterDesc, FilterClause, FilterOrder, ApplyToMst) SELECT ScreenFilterId, ScreenId, ScreenFilterName, ScreenFilterDesc, FilterClause, FilterOrder, ''Y'' FROM dbo.Tmp_ScreenFilter SET IDENTITY_INSERT dbo.ScreenFilter OFF IF (SELECT COUNT(1) FROM dbo.ScreenFilter) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenFilter) = 0 DROP TABLE dbo.Tmp_ScreenFilter CREATE  UNIQUE NONCLUSTERED INDEX IX_ScreenFilter_Id_Name ON dbo.ScreenFilter (ScreenId,ScreenFilterName) ALTER TABLE dbo.ScreenFilterHlp WITH NOCHECK ADD CONSTRAINT FK_FilterHlp_ScreenFilter FOREIGN KEY (ScreenFilterId) REFERENCES dbo.ScreenFilter (ScreenFilterId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=384&typ=N&sys=3","","",""); return false;
385~@~   3.  20.81008:D:   20:*:*:M: Add column AccessCd to RptMemFld~@~105~@~20~@~D~@~~@~~@~M~@~~@~Add column AccessCd to RptMemFld~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_RptMemFld (RptMemFldId int NOT NULL, RptMemFldName nvarchar(200) NOT NULL, UsrId int NULL, InputBy int NULL, CompanyLs varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_RptMemFld (RptMemFldId, RptMemFldName, UsrId, InputBy, CompanyLs) SELECT convert(int,RptMemFldId), RptMemFldName, convert(int,UsrId), convert(int,InputBy), CompanyLs FROM dbo.RptMemFld IF (SELECT COUNT(1) FROM dbo.Tmp_RptMemFld) > 0 OR (SELECT COUNT(1) FROM dbo.RptMemFld) = 0 DROP TABLE dbo.RptMemFld') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptMemFld'')) CREATE TABLE dbo.RptMemFld (RptMemFldId Int IDENTITY NOT NULL, RptMemFldName NVarChar(200) NOT NULL, UsrId Int NULL, InputBy Int NULL, CompanyLs VarChar(1000) NULL, AccessCd Char(1) NOT NULL, CONSTRAINT PK_RptMemFld PRIMARY KEY CLUSTERED (RptMemFldId))') EXEC (' ALTER TABLE dbo.RptMemFld ADD CONSTRAINT DF_RptMemFld_AccessCd DEFAULT (''V'') FOR AccessCd SET IDENTITY_INSERT dbo.RptMemFld ON INSERT INTO dbo.RptMemFld (RptMemFldId, RptMemFldName, UsrId, InputBy, CompanyLs, AccessCd) SELECT RptMemFldId, RptMemFldName, UsrId, InputBy, CompanyLs, ''V'' FROM dbo.Tmp_RptMemFld SET IDENTITY_INSERT dbo.RptMemFld OFF IF (SELECT COUNT(1) FROM dbo.RptMemFld) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptMemFld) = 0 DROP TABLE dbo.Tmp_RptMemFld')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=385&typ=N&sys=3","","",""); return false;
386~@~   3.  20.81008:D:   30:*:*:M: Add table CtAccess~@~105~@~30~@~D~@~~@~~@~M~@~~@~Add table CtAccess~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtAccess'))
BEGIN
EXEC ('CREATE TABLE dbo.CtAccess (AccessCd Char(1) NOT NULL, AccessName NVarChar(10) NOT NULL, AccessSort TinyInt NULL, CONSTRAINT PK_CtAccess PRIMARY KEY CLUSTERED (AccessCd))')
EXEC ('INSERT dbo.CtAccess VALUES (''P'', ''Public'', 1)')
EXEC ('INSERT dbo.CtAccess VALUES (''V'', ''My Reports'', 2)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=386&typ=N&sys=3","","",""); return false;
387~@~   3.  20.81008:D:   40:*:*:M: Add column AccessCd to DshFld~@~105~@~40~@~D~@~~@~~@~M~@~~@~Add column AccessCd to DshFld~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_DshFld (DshFldId int NOT NULL, DshFldName nvarchar(200) NOT NULL, UsrId int NULL, InputBy int NULL, CompanyLs varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_DshFld (DshFldId, DshFldName, UsrId, InputBy, CompanyLs) SELECT convert(int,DshFldId), DshFldName, convert(int,UsrId), convert(int,InputBy), CompanyLs FROM dbo.DshFld IF (SELECT COUNT(1) FROM dbo.Tmp_DshFld) > 0 OR (SELECT COUNT(1) FROM dbo.DshFld) = 0 DROP TABLE dbo.DshFld') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.DshFld'')) CREATE TABLE dbo.DshFld (DshFldId Int IDENTITY NOT NULL, DshFldName NVarChar(200) NOT NULL, UsrId Int NULL, InputBy Int NULL, CompanyLs VarChar(1000) NULL, AccessCd Char(1) NOT NULL, CONSTRAINT PK_DshFld PRIMARY KEY CLUSTERED (DshFldId))') EXEC (' ALTER TABLE dbo.DshFld ADD CONSTRAINT DF_DshFld_AccessCd DEFAULT (''V'') FOR AccessCd SET IDENTITY_INSERT dbo.DshFld ON INSERT INTO dbo.DshFld (DshFldId, DshFldName, UsrId, InputBy, CompanyLs, AccessCd) SELECT DshFldId, DshFldName, UsrId, InputBy, CompanyLs, ''V'' FROM dbo.Tmp_DshFld SET IDENTITY_INSERT dbo.DshFld OFF IF (SELECT COUNT(1) FROM dbo.DshFld) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_DshFld) = 0 DROP TABLE dbo.Tmp_DshFld')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=387&typ=N&sys=3","","",""); return false;
388~@~   3.  20.81008:D:   50:*:*:M: Add column MenuDesc to Menu~@~105~@~50~@~D~@~~@~~@~M~@~~@~Add column MenuDesc to Menu~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_MenuHlp_Menu'') ALTER TABLE dbo.MenuHlp DROP CONSTRAINT FK_MenuHlp_Menu CREATE TABLE dbo.Tmp_Menu (MenuId int NOT NULL, ParentId int NULL, MenuIndex smallint NOT NULL, MenuName varchar(50) NOT NULL, ScreenId int NULL, ReportId int NULL, WizardId int NULL, Miscellaneous varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_Menu (MenuId, ParentId, MenuIndex, MenuName, ScreenId, ReportId, WizardId, Miscellaneous) SELECT convert(int,MenuId), convert(int,ParentId), convert(smallint,MenuIndex), MenuName, convert(int,ScreenId), convert(int,ReportId), convert(int,WizardId), Miscellaneous FROM dbo.Menu IF (SELECT COUNT(1) FROM dbo.Tmp_Menu) > 0 OR (SELECT COUNT(1) FROM dbo.Menu) = 0 DROP TABLE dbo.Menu') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Menu'')) CREATE TABLE dbo.Menu (MenuId Int IDENTITY NOT NULL, MenuIndex SmallInt NOT NULL, MenuName VarChar(30) NOT NULL, MenuDesc NVarChar(100) NULL, Miscellaneous VarChar(50) NULL, ParentId Int NULL, ReportId Int NULL, ScreenId Int NULL, WizardId Int NULL, CONSTRAINT PK_Menu PRIMARY KEY CLUSTERED (MenuId))') EXEC (' SET IDENTITY_INSERT dbo.Menu ON INSERT INTO dbo.Menu (MenuId, MenuIndex, MenuName, Miscellaneous, ParentId, ReportId, ScreenId, WizardId) SELECT MenuId, MenuIndex, MenuName, Miscellaneous, ParentId, ReportId, ScreenId, WizardId FROM dbo.Tmp_Menu SET IDENTITY_INSERT dbo.Menu OFF IF (SELECT COUNT(1) FROM dbo.Menu) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Menu) = 0 DROP TABLE dbo.Tmp_Menu CREATE  NONCLUSTERED INDEX IX_Menu_ParentId ON dbo.Menu (ParentId,MenuIndex) ALTER TABLE dbo.MenuHlp WITH NOCHECK ADD CONSTRAINT FK_MenuHlp_Menu FOREIGN KEY (MenuId) REFERENCES dbo.Menu (MenuId)')
EXEC ('UPDATE dbo.Menu SET MenuDesc = a.MenuName + '' ('' + b.MenuText + '')'' FROM dbo.Menu a INNER JOIN dbo.MenuHlp b ON a.MenuId = b.MenuId AND b.CultureId = 1')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=388&typ=N&sys=3","","",""); return false;
389~@~   3.  21.81016:D:   10:*:*:M: Change EntityCd column in Entity~@~107~@~10~@~D~@~~@~~@~M~@~~@~Change EntityCd column in Entity~@~N~@~IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.Entity'))
BEGIN
EXEC (' CREATE TABLE dbo.Tmp_Entity (EntityId smallint NOT NULL, EntityName nvarchar(100) NOT NULL, EntityCode varchar(10) NOT NULL, DeployPath varchar(100) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_Entity (EntityId, EntityName, EntityCode, DeployPath) SELECT convert(smallint,EntityId), EntityName, EntityCode, DeployPath FROM dbo.Entity IF (SELECT COUNT(1) FROM dbo.Tmp_Entity) > 0 OR (SELECT COUNT(1) FROM dbo.Entity) = 0 DROP TABLE dbo.Entity') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Entity'')) CREATE TABLE dbo.Entity (EntityId SmallInt NOT NULL, EntityName NVarChar(100) NOT NULL, EntityCode VarChar(4) NOT NULL, DeployPath VarChar(100) NOT NULL, CONSTRAINT PK_Entity PRIMARY KEY CLUSTERED (EntityId))') EXEC (' INSERT INTO dbo.Entity (EntityId, EntityName, EntityCode, DeployPath) SELECT EntityId, EntityName, EntityCode, DeployPath FROM dbo.Tmp_Entity IF (SELECT COUNT(1) FROM dbo.Entity) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Entity) = 0 DROP TABLE dbo.Tmp_Entity')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=389&typ=N&sys=3","","",""); return false;
390~@~   3.  29.81219:D:   10:*:*:M: Add Rating to CtDisplayType~@~115~@~10~@~D~@~~@~~@~M~@~~@~Add Rating to CtDisplayType~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.CtDisplayType WHERE TypeId = 35)
EXEC ('INSERT dbo.CtDisplayType VALUES (35,''Rating'',''Rating'',''N'')')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=390&typ=N&sys=3","","",""); return false;
391~@~   3.  36.90208:D:   10:*:*:M: Change ColumnLength representation~@~122~@~10~@~D~@~~@~~@~M~@~~@~Change ColumnLength representation~@~Y~@~update dbo.DbColumn set ColumnLength = 0 WHERE ColumnLength = -1~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=391&typ=N&sys=3","","",""); return false;
392~@~   3.  38.90306:D:   10:*:*:M: Redo Primary keys for ??Design Db~@~125~@~10~@~D~@~~@~~@~M~@~~@~Redo Primary keys for ??Design Db~@~N~@~IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'CtOsType')
AND NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'PK_CtOsType')
ALTER TABLE [dbo].[CtOsType] ADD  CONSTRAINT [PK_CtOsType] PRIMARY KEY CLUSTERED (OsTypeCd)

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'CtReleaseType')
AND NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'PK_CtReleaseType')
ALTER TABLE [dbo].[CtReleaseType] ADD  CONSTRAINT [PK_CtReleaseType] PRIMARY KEY CLUSTERED (ReleaseTypeId)

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'CtSProcOnly')
AND NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'PK_CtSProcOnly')
ALTER TABLE [dbo].[CtSProcOnly] ADD  CONSTRAINT [PK_CtSProcOnly] PRIMARY KEY CLUSTERED (SProcOnlyCd)

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'CtWizardType')
AND NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'PK_CtWizardType')
ALTER TABLE [dbo].[CtWizardType] ADD  CONSTRAINT [PK_CtWizardType] PRIMARY KEY CLUSTERED (WizardTypeId)

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'DataTier')
AND NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'PK_DataTier')
ALTER TABLE [dbo].[DataTier] ADD  CONSTRAINT [PK_DataTier] PRIMARY KEY CLUSTERED (DataTierId)

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'Release')
AND NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'PK_Release')
ALTER TABLE [dbo].[Release] ADD  CONSTRAINT [PK_Release] PRIMARY KEY CLUSTERED (ReleaseId)

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'RuleTier')
AND NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'PK_RuleTier')
ALTER TABLE [dbo].[RuleTier] ADD  CONSTRAINT [PK_RuleTier] PRIMARY KEY CLUSTERED (RuleTierId)

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'SqlToSybMap')
AND NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'PK_SqlToSybMap')
ALTER TABLE [dbo].[SqlToSybMap] ADD  CONSTRAINT [PK_SqlToSybMap] PRIMARY KEY CLUSTERED (SqlToSybMapId)~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=392&typ=N&sys=3","","",""); return false;
393~@~   3.  38.90306:D:   20:*:*:M: Redo Primary keys for all Design Db~@~125~@~20~@~D~@~~@~~@~M~@~~@~Redo Primary keys for all Design Db~@~Y~@~IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'ReportDel')
AND NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'PK_ReportDel')
ALTER TABLE [dbo].[ReportDel] ADD CONSTRAINT [PK_ReportDel] PRIMARY KEY CLUSTERED (ReportId)

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'ScreenDel')
AND NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'PK_ScreenDel')
ALTER TABLE [dbo].[ScreenDel] ADD  CONSTRAINT [PK_ScreenDel] PRIMARY KEY CLUSTERED (ScreenId)

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'PK_Usage')
ALTER TABLE [dbo].[Usage] DROP CONSTRAINT [PK_Usage]

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'WizardDel')
AND NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'PK_WizardDel')
ALTER TABLE [dbo].[WizardDel] ADD  CONSTRAINT [PK_WizardDel] PRIMARY KEY CLUSTERED (WizardId)~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=393&typ=N&sys=3","","",""); return false;
394~@~   3.  40.90401:D:   10:*:*:M: Drop obsolete procedures~@~127~@~10~@~D~@~~@~~@~M~@~~@~Drop obsolete procedures~@~Y~@~exec ('if exists (select 1 from dbo.sysobjects where name = ''GetDdlOriTableId33S1682'') drop procedure GetDdlOriTableId33S1682')
exec ('if exists (select 1 from dbo.sysobjects where name = ''Cr_ChkCatTblFK'') drop procedure Cr_ChkCatTblFK')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=394&typ=N&sys=3","","",""); return false;
396~@~   3.  40.90401:D:   20:*:*:M: Add column to table RptwizCat~@~127~@~20~@~D~@~~@~~@~M~@~~@~Add column to table RptwizCat~@~Y~@~IF NOT EXISTS (SELECT 1 from syscolumns where name = 'TableId' AND id = object_id('dbo.RptWizCat')) AND EXISTS (SELECT 1 from syscolumns where name = 'TableId' AND id = object_id('dbo.RptWizCatDtl'))
BEGIN
EXEC ('CREATE TABLE dbo.Tmp_RptwizCat (RptwizCatId smallint NOT NULL, RptwizTypId smallint NOT NULL, RptwizCatName nvarchar(100) NOT NULL, RptwizCatDesc nvarchar(200) NULL, CatDescription nvarchar(400) NOT NULL, RptwizCatImg varchar(100) NULL)')
EXEC ('INSERT INTO dbo.Tmp_RptwizCat (RptwizCatId, RptwizTypId, RptwizCatName, RptwizCatDesc, CatDescription, RptwizCatImg) SELECT convert(smallint,RptwizCatId), convert(smallint,RptwizTypId), RptwizCatName, RptwizCatDesc, CatDescription, RptwizCatImg FROM dbo.RptwizCat IF (SELECT COUNT(1) FROM dbo.Tmp_RptwizCat) > 0 OR (SELECT COUNT(1) FROM dbo.RptwizCat) = 0 DROP TABLE dbo.RptwizCat')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptwizCat'')) CREATE TABLE dbo.RptwizCat (RptwizCatId SmallInt IDENTITY NOT NULL, RptwizTypId SmallInt NOT NULL, RptwizCatName NVarChar(100) NOT NULL, RptwizCatDesc NVarChar(200) NULL, CatDescription NVarChar(400) NULL, RptwizCatImg VarChar(100) NULL, TableId Int NOT NULL, CONSTRAINT PK_RptwizCat PRIMARY KEY CLUSTERED (RptwizCatId))')
EXEC ('ALTER TABLE dbo.RptwizCat ADD CONSTRAINT DF_RptwizCat_RptwizTypId DEFAULT (1) FOR RptwizTypId ALTER TABLE dbo.RptwizCat ADD CONSTRAINT DF_RptwizCat_TableId DEFAULT (0) FOR TableId SET IDENTITY_INSERT dbo.RptwizCat ON INSERT INTO dbo.RptwizCat (RptwizCatId, RptwizTypId, RptwizCatName, RptwizCatDesc, CatDescription, RptwizCatImg, TableId) SELECT RptwizCatId, RptwizTypId, RptwizCatName, RptwizCatDesc, RptwizCatDesc, RptwizCatImg, 0 FROM dbo.Tmp_RptwizCat SET IDENTITY_INSERT dbo.RptwizCat OFF IF (SELECT COUNT(1) FROM dbo.RptwizCat) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptwizCat) = 0 DROP TABLE dbo.Tmp_RptwizCat')
EXEC ('UPDATE dbo.RptWizCat set TableId = b.TableId from dbo.RptWizCat a INNER JOIN RptWizCatDtl b ON a.RptWizCatId = b.RptWizCatId')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=396&typ=N&sys=3","","",""); return false;
397~@~   3.  40.90401:D:   30:*:*:M: Change table RptwizCatDtl~@~127~@~30~@~D~@~~@~~@~M~@~~@~Change table RptwizCatDtl~@~Y~@~EXEC ('DELETE FROM RptWizCatDtl')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptwizCatDtl'')) DROP TABLE dbo.RptwizCatDtl') 
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptwizCatDtl'')) CREATE TABLE dbo.RptwizCatDtl (RptwizCatDtlId Int IDENTITY NOT NULL, RptwizCatId SmallInt NOT NULL, ColumnId Int NOT NULL, DisplayModeId TinyInt NULL, DdlKeyColNm VarChar(50) null, DdlRefColNm VarChar(50) null, ColumnSize SmallInt NULL, RowSize SmallInt NULL, RegClause VarChar(400) NULL, StoredProc VarChar(max) NULL, CONSTRAINT PK_RptwizCatDtl PRIMARY KEY CLUSTERED (RptwizCatDtlId))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=397&typ=N&sys=3","","",""); return false;
398~@~   3.  41.90407:D:   10:*:*:M: Add columns to table Rptwiz~@~128~@~10~@~D~@~~@~~@~M~@~~@~Add columns to table Rptwiz~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_Rptwiz (RptwizId int NOT NULL, RptwizName nvarchar(50) NOT NULL, RptwizDesc nvarchar(400) NOT NULL, RptwizTypeCd char(1) NOT NULL, RptwizCatId smallint NOT NULL, TemplateName varchar(50) NULL, ReportId int NULL, Changeable char(1) NOT NULL, UsrId int NOT NULL, TopMargin decimal(8,2) NULL, BottomMargin decimal(8,2) NULL, LeftMargin decimal(8,2) NULL, RightMargin decimal(8,2) NULL, OrientationCd char(1) NOT NULL, UnitCd char(2) NOT NULL, RptChaTypeCd char(2) NULL, ThreeD char(1) NOT NULL, GMinValue decimal(19,4) NULL, GLowRange decimal(19,4) NULL, GMidRange decimal(19,4) NULL, GMaxValue decimal(19,4) NULL, GFormat char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Rptwiz (RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, TemplateName, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, OrientationCd, UnitCd, RptChaTypeCd, ThreeD, GMinValue, GLowRange, GMidRange, GMaxValue, GFormat) SELECT convert(int,RptwizId), RptwizName, RptwizDesc, RptwizTypeCd, convert(smallint,RptwizCatId), TemplateName, convert(int,ReportId), Changeable, convert(int,UsrId), convert(decimal(8,2),TopMargin), convert(decimal(8,2),BottomMargin), convert(decimal(8,2),LeftMargin), convert(decimal(8,2),RightMargin), OrientationCd, UnitCd, RptChaTypeCd, ThreeD, convert(decimal(19,4),GMinValue), convert(decimal(19,4),GLowRange), convert(decimal(19,4),GMidRange), convert(decimal(19,4),GMaxValue), GFormat FROM dbo.Rptwiz IF (SELECT COUNT(1) FROM dbo.Tmp_Rptwiz) > 0 OR (SELECT COUNT(1) FROM dbo.Rptwiz) = 0 DROP TABLE dbo.Rptwiz') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Rptwiz'')) CREATE TABLE dbo.Rptwiz (RptwizId Int IDENTITY NOT NULL, RptwizName NVarChar(50) NOT NULL, RptwizDesc NVarChar(400) NOT NULL, RptwizTypeCd Char(1) NOT NULL, RptwizCatId SmallInt NOT NULL, TemplateName VarChar(50) NULL, ReportId Int NULL, Changeable Char(1) NOT NULL, UsrId Int NOT NULL, TopMargin Decimal(8,2) NULL, BottomMargin Decimal(8,2) NULL, LeftMargin Decimal(8,2) NULL, RightMargin Decimal(8,2) NULL, OrientationCd Char(1) NOT NULL, UnitCd Char(2) NOT NULL, RptChaTypeCd Char(2) NULL, ThreeD Char(1) NOT NULL, GMinValue Decimal(19,4) NULL, GLowRange Decimal(19,4) NULL, GMidRange Decimal(19,4) NULL, GMaxValue Decimal(19,4) NULL, GNeedle Decimal(19,4) NULL, GMinValueId Int NULL, GLowRangeId Int NULL, GMidRangeId Int NULL, GMaxValueId Int NULL, GNeedleId Int NULL, GPositive Char(1) NULL, GFormat Char(1) NULL, CONSTRAINT PK_Rptwiz PRIMARY KEY CLUSTERED (RptwizId))') EXEC (' ALTER TABLE dbo.Rptwiz ADD CONSTRAINT DF_Rptwiz_OrientationCd DEFAULT (''Y'') FOR OrientationCd ALTER TABLE dbo.Rptwiz ADD CONSTRAINT DF_Rptwiz_UnitCd DEFAULT (''in'') FOR UnitCd ALTER TABLE dbo.Rptwiz ADD CONSTRAINT DF_Rptwiz_ThreeD DEFAULT (''N'') FOR ThreeD SET IDENTITY_INSERT dbo.Rptwiz ON INSERT INTO dbo.Rptwiz (RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, TemplateName, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, OrientationCd, UnitCd, RptChaTypeCd, ThreeD, GMinValue, GLowRange, GMidRange, GMaxValue, GFormat) SELECT RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, TemplateName, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, OrientationCd, UnitCd, RptChaTypeCd, ThreeD, GMinValue, GLowRange, GMidRange, GMaxValue, GFormat FROM dbo.Tmp_Rptwiz SET IDENTITY_INSERT dbo.Rptwiz OFF IF (SELECT COUNT(1) FROM dbo.Rptwiz) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Rptwiz) = 0 DROP TABLE dbo.Tmp_Rptwiz')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=398&typ=N&sys=3","","",""); return false;
399~@~   3.  51.90507:D:   10:*:*:M: Change table RptStyle~@~133~@~10~@~D~@~~@~~@~M~@~~@~Change table RptStyle~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_RptStyle (RptStyleId int NOT NULL, RptStyleDesc nvarchar(300) NOT NULL, BorderColorD varchar(10) NULL, BorderColorL varchar(10) NULL, BorderColorR varchar(10) NULL, BorderColorT varchar(10) NULL, BorderColorB varchar(10) NULL, BorderStyleD tinyint NULL, BorderStyleL tinyint NULL, BorderStyleR tinyint NULL, BorderStyleT tinyint NULL, BorderStyleB tinyint NULL, BorderWidthD tinyint NULL, BorderWidthL tinyint NULL, BorderWidthR tinyint NULL, BorderWidthT tinyint NULL, BorderWidthB tinyint NULL, BgColor varchar(10) NULL, BgGradType tinyint NULL, BgGradColor varchar(10) NULL, BgImage varchar(200) NULL, FontStyle char(1) NULL, FontFamily varchar(100) NULL, FontSize tinyint NULL, FontWeight tinyint NULL, Format varchar(100) NULL, TextDecor char(1) NULL, TextAlign char(1) NULL, VerticalAlign char(1) NULL, Color varchar(10) NULL, PadLeft smallint NULL, PadRight smallint NULL, PadTop smallint NULL, PadBottom smallint NULL, LineHeight smallint NULL, Direction char(1) NULL, WritingMode char(1) NULL, DefaultCd char(2) NULL)') EXEC (' INSERT INTO dbo.Tmp_RptStyle (RptStyleId, RptStyleDesc, BorderColorD, BorderColorL, BorderColorR, BorderColorT, BorderColorB, BorderStyleD, BorderStyleL, BorderStyleR, BorderStyleT, BorderStyleB, BorderWidthD, BorderWidthL, BorderWidthR, BorderWidthT, BorderWidthB, BgColor, BgGradType, BgGradColor, BgImage, FontStyle, FontFamily, FontSize, FontWeight, Format, TextDecor, TextAlign, VerticalAlign, Color, PadLeft, PadRight, PadTop, PadBottom, LineHeight, Direction, WritingMode, DefaultCd) SELECT convert(int,RptStyleId), RptStyleDesc, BorderColorD, BorderColorL, BorderColorR, BorderColorT, BorderColorB, convert(tinyint,BorderStyleD), convert(tinyint,BorderStyleL), convert(tinyint,BorderStyleR), convert(tinyint,BorderStyleT), convert(tinyint,BorderStyleB), convert(tinyint,BorderWidthD), convert(tinyint,BorderWidthL), convert(tinyint,BorderWidthR), convert(tinyint,BorderWidthT), convert(tinyint,BorderWidthB), BgColor, convert(tinyint,BgGradType), BgGradColor, BgImage, FontStyle, FontFamily, convert(tinyint,FontSize), convert(tinyint,FontWeight), Format, TextDecor, TextAlign, VerticalAlign, Color, convert(smallint,PadLeft), convert(smallint,PadRight), convert(smallint,PadTop), convert(smallint,PadBottom), convert(smallint,LineHeight), Direction, WritingMode, DefaultCd FROM dbo.RptStyle IF (SELECT COUNT(1) FROM dbo.Tmp_RptStyle) > 0 OR (SELECT COUNT(1) FROM dbo.RptStyle) = 0 DROP TABLE dbo.RptStyle') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptStyle'')) CREATE TABLE dbo.RptStyle (RptStyleId Int IDENTITY NOT NULL, RptStyleDesc NVarChar(300) NOT NULL, BorderColorD VarChar(100) NULL, BorderColorL VarChar(100) NULL, BorderColorR VarChar(100) NULL, BorderColorT VarChar(100) NULL, BorderColorB VarChar(100) NULL, BorderStyleD TinyInt NULL, BorderStyleL TinyInt NULL, BorderStyleR TinyInt NULL, BorderStyleT TinyInt NULL, BorderStyleB TinyInt NULL, BorderWidthD TinyInt NULL, BorderWidthL TinyInt NULL, BorderWidthR TinyInt NULL, BorderWidthT TinyInt NULL, BorderWidthB TinyInt NULL, BgColor VarChar(100) NULL, BgGradType TinyInt NULL, BgGradColor VarChar(100) NULL, BgImage VarChar(200) NULL, FontStyle Char(1) NULL, FontFamily VarChar(100) NULL, FontSize TinyInt NULL, FontWeight TinyInt NULL, Format VarChar(100) NULL, TextDecor Char(1) NULL, TextAlign Char(1) NULL, VerticalAlign Char(1) NULL, Color VarChar(100) NULL, PadLeft SmallInt NULL, PadRight SmallInt NULL, PadTop SmallInt NULL, PadBottom SmallInt NULL, LineHeight SmallInt NULL, Direction Char(1) NULL, WritingMode Char(1) NULL, DefaultCd Char(2) NULL, CONSTRAINT PK_RptStyle PRIMARY KEY CLUSTERED (RptStyleId))') EXEC (' SET IDENTITY_INSERT dbo.RptStyle ON INSERT INTO dbo.RptStyle (RptStyleId, RptStyleDesc, BorderColorD, BorderColorL, BorderColorR, BorderColorT, BorderColorB, BorderStyleD, BorderStyleL, BorderStyleR, BorderStyleT, BorderStyleB, BorderWidthD, BorderWidthL, BorderWidthR, BorderWidthT, BorderWidthB, BgColor, BgGradType, BgGradColor, BgImage, FontStyle, FontFamily, FontSize, FontWeight, Format, TextDecor, TextAlign, VerticalAlign, Color, PadLeft, PadRight, PadTop, PadBottom, LineHeight, Direction, WritingMode, DefaultCd) SELECT RptStyleId, RptStyleDesc, BorderColorD, BorderColorL, BorderColorR, BorderColorT, BorderColorB, BorderStyleD, BorderStyleL, BorderStyleR, BorderStyleT, BorderStyleB, BorderWidthD, BorderWidthL, BorderWidthR, BorderWidthT, BorderWidthB, BgColor, BgGradType, BgGradColor, BgImage, FontStyle, FontFamily, FontSize, FontWeight, Format, TextDecor, TextAlign, VerticalAlign, Color, PadLeft, PadRight, PadTop, PadBottom, LineHeight, Direction, WritingMode, DefaultCd FROM dbo.Tmp_RptStyle SET IDENTITY_INSERT dbo.RptStyle OFF IF (SELECT COUNT(1) FROM dbo.RptStyle) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptStyle) = 0 DROP TABLE dbo.Tmp_RptStyle')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=399&typ=N&sys=3","","",""); return false;
400~@~   3.  55.90610:D:   10:*:*:M: Add table CtEveryone~@~137~@~10~@~D~@~~@~~@~M~@~~@~Add table CtEveryone~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtEveryone'')) CREATE TABLE dbo.CtEveryone (EveryoneCd Char(1) NOT NULL, EveryoneName NVarChar(20) NOT NULL, EveryoneSort TinyInt NOT NULL, CONSTRAINT PK_CtEveryone PRIMARY KEY CLUSTERED (EveryoneCd))')
EXEC ('INSERT INTO CtEveryone values (''Y'',''All'',1)')
EXEC ('INSERT INTO CtEveryone values (''G'',''Grant'',2)')
EXEC ('INSERT INTO CtEveryone values (''D'',''Deny'',3)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=400&typ=N&sys=3","","",""); return false;
402~@~   3.  55.90610:D:   20:*:*:M: Update table MenuPerm~@~137~@~20~@~D~@~~@~~@~M~@~~@~Update table MenuPerm~@~Y~@~EXEC ('UPDATE dbo.MenuPerm SET Everyone = ''G'' WHERE Everyone <> ''Y''')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=402&typ=N&sys=3","","",""); return false;
403~@~   4.   0.90706:D:   10:*:*:M: Add view VwPermKey~@~141~@~10~@~D~@~~@~~@~M~@~~@~Add view VwPermKey~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.VwPermKey'))
EXEC ('CREATE VIEW dbo.VwPermKey AS SELECT PermKeyId = CtPermKeyId, PermKeyDesc = TableName FROM dbo.CtPermKey WHERE CtPermKeyId NOT IN (3,5,13,14,15,16)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=403&typ=N&sys=3","","",""); return false;
404~@~   4.   0.90706:D:   20:*:*:M: Add table MenuPrm~@~141~@~20~@~D~@~~@~~@~M~@~~@~Add table MenuPrm~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.MenuPrm'))
BEGIN
EXEC ('CREATE TABLE dbo.MenuPrm (MenuPrmId Int IDENTITY NOT NULL, MenuId Int NOT NULL, GrantDeny Char(1) NOT NULL, PermKeyId SmallInt NOT NULL, PermId Int NOT NULL, CONSTRAINT PK_MenuPrm PRIMARY KEY CLUSTERED (MenuPrmId))')
EXEC ('INSERT INTO dbo.MenuPrm (MenuId, GrantDeny, PermKeyId, PermId)
	SELECT MenuId, Everyone, 8, UsrGroupId FROM dbo.MenuPerm WHERE Everyone <> ''Y'' AND UsrGroupId is not null')
EXEC ('INSERT INTO dbo.MenuPrm (MenuId, GrantDeny, PermKeyId, PermId)
	SELECT MenuId, Everyone, 1, AgentId FROM dbo.MenuPerm WHERE Everyone <> ''Y'' AND AgentId is not null')
EXEC ('INSERT INTO dbo.MenuPrm (MenuId, GrantDeny, PermKeyId, PermId)
	SELECT MenuId, Everyone, 2, BrokerId FROM dbo.MenuPerm WHERE Everyone <> ''Y'' AND BrokerId is not null')
EXEC ('INSERT INTO dbo.MenuPrm (MenuId, GrantDeny, PermKeyId, PermId)
	SELECT MenuId, Everyone, 4, CustomerId FROM dbo.MenuPerm WHERE Everyone <> ''Y'' AND CustomerId is not null')
EXEC ('INSERT INTO dbo.MenuPrm (MenuId, GrantDeny, PermKeyId, PermId)
	SELECT MenuId, Everyone, 6, InvestorId FROM dbo.MenuPerm WHERE Everyone <> ''Y'' AND InvestorId is not null')
EXEC ('INSERT INTO dbo.MenuPrm (MenuId, GrantDeny, PermKeyId, PermId)
	SELECT MenuId, Everyone, 7, MemberId FROM dbo.MenuPerm WHERE Everyone <> ''Y'' AND MemberId is not null')
EXEC ('INSERT INTO dbo.MenuPrm (MenuId, GrantDeny, PermKeyId, PermId)
	SELECT MenuId, Everyone, 9, VendorId FROM dbo.MenuPerm WHERE Everyone <> ''Y'' AND VendorId is not null')
EXEC ('INSERT INTO dbo.MenuPrm (MenuId, GrantDeny, PermKeyId, PermId)
	SELECT MenuId, Everyone, 10, CompanyId FROM dbo.MenuPerm WHERE Everyone <> ''Y'' AND CompanyId is not null')
EXEC ('INSERT INTO dbo.MenuPrm (MenuId, GrantDeny, PermKeyId, PermId)
	SELECT MenuId, Everyone, 11, ProjectId FROM dbo.MenuPerm WHERE Everyone <> ''Y'' AND ProjectId is not null')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=404&typ=N&sys=3","","",""); return false;
405~@~   4.   0.90706:D:   30:*:*:M: Drop table MenuPerm~@~141~@~30~@~D~@~~@~~@~M~@~~@~Drop table MenuPerm~@~Y~@~IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.MenuPerm'))
BEGIN
	IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.MenuPrm'))
	AND (EXISTS (SELECT 1 FROM dbo.MenuPrm) OR NOT EXISTS (SELECT 1 FROM dbo.MenuPerm))
	EXEC ('DROP TABLE dbo.MenuPerm')
END
EXEC ('DELETE FROM [[?]]Design.dbo.CtEveryone WHERE EveryoneCd = ''Y''')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=405&typ=N&sys=3","","",""); return false;
406~@~   4.   2.90729:D:   10:*:*:M: Change table ReportCri~@~143~@~10~@~D~@~~@~~@~M~@~~@~Change table ReportCri~@~Y~@~ EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportCri_Report'') ALTER TABLE dbo.ReportCri DROP CONSTRAINT FK_ReportCri_Report CREATE TABLE dbo.Tmp_ReportCri (ReportCriId int NOT NULL, ReportId int NOT NULL, ReportCriDesc varchar(100) NULL, ReportGrpId int NOT NULL, TableId int NULL, TableAbbr varchar(10) NULL, ColumnName varchar(20) NOT NULL, TabIndex smallint NOT NULL, DataTypeId tinyint NOT NULL, DataTypeSize smallint NULL, DisplayModeId tinyint NOT NULL, ColumnSize smallint NULL, RowSize smallint NULL, DdlKeyColumnName varchar(50) NULL, DdlRefColumnName varchar(50) NULL, DdlSrtColumnName varchar(50) NULL, RequiredValid char(1) NOT NULL, WhereClause varchar(1000) NULL, RegClause varchar(400) NULL)') EXEC (' INSERT INTO dbo.Tmp_ReportCri (ReportCriId, ReportId, ReportCriDesc, ReportGrpId, TableId, TableAbbr, ColumnName, TabIndex, DataTypeId, DataTypeSize, DisplayModeId, ColumnSize, RowSize, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, RequiredValid, WhereClause, RegClause) SELECT convert(int,ReportCriId), convert(int,ReportId), ReportCriDesc, convert(int,ReportGrpId), convert(int,TableId), TableAbbr, ColumnName, convert(smallint,TabIndex), convert(tinyint,DataTypeId), convert(smallint,DataTypeSize), convert(tinyint,DisplayModeId), convert(smallint,ColumnSize), convert(smallint,RowSize), DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, RequiredValid, WhereClause, RegClause FROM dbo.ReportCri IF (SELECT COUNT(1) FROM dbo.Tmp_ReportCri) > 0 OR (SELECT COUNT(1) FROM dbo.ReportCri) = 0 DROP TABLE dbo.ReportCri') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ReportCri'')) CREATE TABLE dbo.ReportCri (ReportCriId Int IDENTITY NOT NULL, ReportId Int NOT NULL, ReportCriDesc VarChar(100) NULL, ReportGrpId Int NOT NULL, LabelCss VarChar(100) NULL, ContentCss VarChar(100) NULL, TableId Int NULL, TableAbbr VarChar(10) NULL, ColumnName VarChar(20) NOT NULL, TabIndex SmallInt NOT NULL, DataTypeId TinyInt NOT NULL, DataTypeSize SmallInt NULL, DisplayModeId TinyInt NOT NULL, ColumnSize SmallInt NULL, RowSize SmallInt NULL, DdlKeyColumnName VarChar(50) NULL, DdlRefColumnName VarChar(50) NULL, DdlSrtColumnName VarChar(50) NULL, RequiredValid Char(1) NOT NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, CONSTRAINT PK_ReportCri PRIMARY KEY CLUSTERED (ReportCriId))') EXEC (' SET IDENTITY_INSERT dbo.ReportCri ON INSERT INTO dbo.ReportCri (ReportCriId, ReportId, ReportCriDesc, ReportGrpId, TableId, TableAbbr, ColumnName, TabIndex, DataTypeId, DataTypeSize, DisplayModeId, ColumnSize, RowSize, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, RequiredValid, WhereClause, RegClause) SELECT ReportCriId, ReportId, ReportCriDesc, ReportGrpId, TableId, TableAbbr, ColumnName, TabIndex, DataTypeId, DataTypeSize, DisplayModeId, ColumnSize, RowSize, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, RequiredValid, WhereClause, RegClause FROM dbo.Tmp_ReportCri SET IDENTITY_INSERT dbo.ReportCri OFF IF (SELECT COUNT(1) FROM dbo.ReportCri) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ReportCri) = 0 DROP TABLE dbo.Tmp_ReportCri CREATE  UNIQUE NONCLUSTERED INDEX IX_ReportCri_ReportId ON dbo.ReportCri (ReportId,TabIndex,ColumnName) ALTER TABLE dbo.ReportCri WITH NOCHECK ADD CONSTRAINT FK_ReportCri_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=406&typ=N&sys=3","","",""); return false;
407~@~   4.   2.90729:D:   20:*:*:M: Change table ScreenObj~@~143~@~20~@~D~@~~@~~@~M~@~~@~Change table ScreenObj~@~Y~@~ EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_Screen'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_ScreenTab'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_ScreenTab CREATE TABLE dbo.Tmp_ScreenObj (ScreenObjId int NOT NULL, ScreenId int NOT NULL, MasterTable char(1) NOT NULL, ScreenGrpId int NOT NULL, ColumnId int NULL, ColumnName varchar(20) NOT NULL, ColumnDesc varchar(100) NULL, DefaultValue nvarchar(100) NULL, SystemValue nvarchar(100) NULL, ColumnWrap char(1) NOT NULL, ColumnJustify char(1) NULL, ColumnSize smallint NULL, ColumnHeight smallint NULL, DisplayModeId tinyint NOT NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DdlAdnColumnId int NULL, DdlFtrColumnId int NULL, AggregateCd char(1) NULL, GenerateSp char(1) NOT NULL, TabFolderId int NULL, TabIndex smallint NOT NULL, SortOrder smallint NULL, RequiredValid char(1) NOT NULL, MaskValid varchar(50) NULL, RangeValidType varchar(50) NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, ColumnLink varchar(1000) NULL, RefreshOnCUD char(1) NOT NULL, TrimOnEntry char(1) NOT NULL, MatchCd char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd) SELECT convert(int,ScreenObjId), convert(int,ScreenId), MasterTable, convert(int,ScreenGrpId), convert(int,ColumnId), ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, convert(smallint,ColumnSize), convert(smallint,ColumnHeight), convert(tinyint,DisplayModeId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), convert(int,DdlAdnColumnId), convert(int,DdlFtrColumnId), AggregateCd, GenerateSp, convert(int,TabFolderId), convert(smallint,TabIndex), convert(smallint,SortOrder), RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObj'')) CREATE TABLE dbo.ScreenObj (ScreenObjId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, ScreenGrpId Int NOT NULL, LabelCss VarChar(100) NULL, ContentCss VarChar(100) NULL, ColumnId Int NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(100) NULL, DefaultValue NVarChar(100) NULL, SystemValue NVarChar(100) NULL, ColumnWrap Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, ColumnHeight SmallInt NULL, DisplayModeId TinyInt NOT NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlAdnColumnId Int NULL, DdlFtrColumnId Int NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId Int NULL, TabIndex SmallInt NOT NULL, SortOrder SmallInt NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(50) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(1000) NULL, RefreshOnCUD Char(1) NOT NULL, TrimOnEntry Char(1) NOT NULL, MatchCd Char(1) NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))') EXEC (' ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_TrimOnEntry DEFAULT (''Y'') FOR TrimOnEntry SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd) SELECT ScreenObjId, ScreenId, MasterTable, ScreenGrpId, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj CREATE  NONCLUSTERED INDEX IX_ScreenObj_ScreenId ON dbo.ScreenObj (ScreenId,TabIndex) ALTER TABLE dbo.ScreenObj WITH NOCHECK ADD CONSTRAINT FK_ScreenObj_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenObj WITH NOCHECK ADD CONSTRAINT FK_ScreenObj_ScreenTab FOREIGN KEY (TabFolderId) REFERENCES dbo.ScreenTab (ScreenTabId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=407&typ=N&sys=3","","",""); return false;
408~@~   4.   2.90729:D:   30:*:*:M: Change table ScreenCri~@~143~@~30~@~D~@~~@~~@~M~@~~@~Change table ScreenCri~@~Y~@~ EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenCri_Screen'') ALTER TABLE dbo.ScreenCri DROP CONSTRAINT FK_ScreenCri_Screen CREATE TABLE dbo.Tmp_ScreenCri (ScreenCriId int NOT NULL, ScreenId int NOT NULL, ScreenCriDesc varchar(100) NULL, ScreenGrpId int NOT NULL, ColumnId int NOT NULL, TabIndex smallint NOT NULL, DisplayModeId tinyint NOT NULL, ColumnJustify char(1) NULL, ColumnSize smallint NULL, RowSize smallint NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, RequiredValid char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenCri (ScreenCriId, ScreenId, ScreenCriDesc, ScreenGrpId, ColumnId, TabIndex, DisplayModeId, ColumnJustify, ColumnSize, RowSize, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, RequiredValid) SELECT convert(int,ScreenCriId), convert(int,ScreenId), ScreenCriDesc, convert(int,ScreenGrpId), convert(int,ColumnId), convert(smallint,TabIndex), convert(tinyint,DisplayModeId), ColumnJustify, convert(smallint,ColumnSize), convert(smallint,RowSize), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), RequiredValid FROM dbo.ScreenCri IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenCri) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenCri) = 0 DROP TABLE dbo.ScreenCri') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenCri'')) CREATE TABLE dbo.ScreenCri (ScreenCriId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, ScreenCriDesc VarChar(100) NULL, ScreenGrpId Int NOT NULL, LabelCss VarChar(100) NULL, ContentCss VarChar(100) NULL, ColumnId Int NOT NULL, TabIndex SmallInt NOT NULL, DisplayModeId TinyInt NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, RowSize SmallInt NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, RequiredValid Char(1) NOT NULL, CONSTRAINT PK_ScreenCri PRIMARY KEY CLUSTERED (ScreenCriId))') EXEC (' SET IDENTITY_INSERT dbo.ScreenCri ON INSERT INTO dbo.ScreenCri (ScreenCriId, ScreenId, ScreenCriDesc, ScreenGrpId, ColumnId, TabIndex, DisplayModeId, ColumnJustify, ColumnSize, RowSize, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, RequiredValid) SELECT ScreenCriId, ScreenId, ScreenCriDesc, ScreenGrpId, ColumnId, TabIndex, DisplayModeId, ColumnJustify, ColumnSize, RowSize, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, RequiredValid FROM dbo.Tmp_ScreenCri SET IDENTITY_INSERT dbo.ScreenCri OFF IF (SELECT COUNT(1) FROM dbo.ScreenCri) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenCri) = 0 DROP TABLE dbo.Tmp_ScreenCri CREATE  NONCLUSTERED INDEX IX_ScreenCri_ScreenId ON dbo.ScreenCri (ScreenId,TabIndex,ColumnId) ALTER TABLE dbo.ScreenCri WITH NOCHECK ADD CONSTRAINT FK_ScreenCri_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=408&typ=N&sys=3","","",""); return false;
409~@~   4.   2.90729:D:   40:*:*:M: Change table ScreenObjHlp~@~143~@~40~@~D~@~~@~~@~M~@~~@~Change table ScreenObjHlp~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenObjHlp (ScreenObjHlpId int NOT NULL, ScreenObjHlpDesc varchar(200) NULL, ScreenObjId int NOT NULL, CultureId tinyint NOT NULL, ColumnHeader nvarchar(50) NULL, HeaderWidth smallint NULL, ToolTip nvarchar(200) NULL, ErrMessage nvarchar(300) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObjHlp (ScreenObjHlpId, ScreenObjHlpDesc, ScreenObjId, CultureId, ColumnHeader, HeaderWidth, ToolTip, ErrMessage) SELECT convert(int,ScreenObjHlpId), ScreenObjHlpDesc, convert(int,ScreenObjId), convert(tinyint,CultureId), ColumnHeader, convert(smallint,HeaderWidth), ToolTip, ErrMessage FROM dbo.ScreenObjHlp IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObjHlp) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObjHlp) = 0 DROP TABLE dbo.ScreenObjHlp') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObjHlp'')) CREATE TABLE dbo.ScreenObjHlp (ScreenObjHlpId Int IDENTITY NOT NULL, ScreenObjHlpDesc VarChar(200) NULL, ScreenObjId Int NOT NULL, CultureId TinyInt NOT NULL, ColumnHeader NVarChar(50) NULL, ToolTip NVarChar(200) NULL, ErrMessage NVarChar(300) NULL, CONSTRAINT PK_ScreenObjHlp PRIMARY KEY CLUSTERED (ScreenObjHlpId))') EXEC (' SET IDENTITY_INSERT dbo.ScreenObjHlp ON INSERT INTO dbo.ScreenObjHlp (ScreenObjHlpId, ScreenObjHlpDesc, ScreenObjId, CultureId, ColumnHeader, ToolTip, ErrMessage) SELECT ScreenObjHlpId, ScreenObjHlpDesc, ScreenObjId, CultureId, ColumnHeader, ToolTip, ErrMessage FROM dbo.Tmp_ScreenObjHlp SET IDENTITY_INSERT dbo.ScreenObjHlp OFF IF (SELECT COUNT(1) FROM dbo.ScreenObjHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObjHlp) = 0 DROP TABLE dbo.Tmp_ScreenObjHlp CREATE  UNIQUE NONCLUSTERED INDEX IX_ScreenObjHlp_ObjId ON dbo.ScreenObjHlp (CultureId,ScreenObjId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=409&typ=N&sys=3","","",""); return false;
410~@~   4.   2.90729:D:   50:*:*:M: Change table ScreenCriHlp~@~143~@~50~@~D~@~~@~~@~M~@~~@~Change table ScreenCriHlp~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenCriHlp (ScreenCriHlpId int NOT NULL, ScreenCriHlpDesc varchar(200) NULL, ScreenCriId int NOT NULL, CultureId tinyint NOT NULL, ColumnHeader nvarchar(50) NULL, HeaderWidth smallint NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenCriHlp (ScreenCriHlpId, ScreenCriHlpDesc, ScreenCriId, CultureId, ColumnHeader, HeaderWidth) SELECT convert(int,ScreenCriHlpId), ScreenCriHlpDesc, convert(int,ScreenCriId), convert(tinyint,CultureId), ColumnHeader, convert(smallint,HeaderWidth) FROM dbo.ScreenCriHlp IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenCriHlp) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenCriHlp) = 0 DROP TABLE dbo.ScreenCriHlp') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenCriHlp'')) CREATE TABLE dbo.ScreenCriHlp (ScreenCriHlpId Int IDENTITY NOT NULL, ScreenCriHlpDesc VarChar(200) NULL, ScreenCriId Int NOT NULL, CultureId TinyInt NOT NULL, ColumnHeader NVarChar(50) NULL, CONSTRAINT PK_ScreenCriHlp PRIMARY KEY CLUSTERED (ScreenCriHlpId))') EXEC (' SET IDENTITY_INSERT dbo.ScreenCriHlp ON INSERT INTO dbo.ScreenCriHlp (ScreenCriHlpId, ScreenCriHlpDesc, ScreenCriId, CultureId, ColumnHeader) SELECT ScreenCriHlpId, ScreenCriHlpDesc, ScreenCriId, CultureId, ColumnHeader FROM dbo.Tmp_ScreenCriHlp SET IDENTITY_INSERT dbo.ScreenCriHlp OFF IF (SELECT COUNT(1) FROM dbo.ScreenCriHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenCriHlp) = 0 DROP TABLE dbo.Tmp_ScreenCriHlp CREATE  UNIQUE NONCLUSTERED INDEX IX_ScreenCriHlp_ScreenCriId ON dbo.ScreenCriHlp (CultureId,ScreenCriId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=410&typ=N&sys=3","","",""); return false;
411~@~   4.   2.90729:D:   60:*:*:M: Change table ReportCriHlp~@~143~@~60~@~D~@~~@~~@~M~@~~@~Change table ReportCriHlp~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ReportCriHlp (ReportCriHlpId int NOT NULL, ReportCriHlpDesc varchar(200) NULL, ReportCriId int NOT NULL, CultureId tinyint NOT NULL, ColumnHeader nvarchar(50) NULL, HeaderWidth smallint NULL)') EXEC (' INSERT INTO dbo.Tmp_ReportCriHlp (ReportCriHlpId, ReportCriHlpDesc, ReportCriId, CultureId, ColumnHeader, HeaderWidth) SELECT convert(int,ReportCriHlpId), ReportCriHlpDesc, convert(int,ReportCriId), convert(tinyint,CultureId), ColumnHeader, convert(smallint,HeaderWidth) FROM dbo.ReportCriHlp IF (SELECT COUNT(1) FROM dbo.Tmp_ReportCriHlp) > 0 OR (SELECT COUNT(1) FROM dbo.ReportCriHlp) = 0 DROP TABLE dbo.ReportCriHlp') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ReportCriHlp'')) CREATE TABLE dbo.ReportCriHlp (ReportCriHlpId Int IDENTITY NOT NULL, ReportCriHlpDesc VarChar(200) NULL, ReportCriId Int NOT NULL, CultureId TinyInt NOT NULL, ColumnHeader NVarChar(50) NULL, CONSTRAINT PK_ReportCriHlp PRIMARY KEY CLUSTERED (ReportCriHlpId))') EXEC (' SET IDENTITY_INSERT dbo.ReportCriHlp ON INSERT INTO dbo.ReportCriHlp (ReportCriHlpId, ReportCriHlpDesc, ReportCriId, CultureId, ColumnHeader) SELECT ReportCriHlpId, ReportCriHlpDesc, ReportCriId, CultureId, ColumnHeader FROM dbo.Tmp_ReportCriHlp SET IDENTITY_INSERT dbo.ReportCriHlp OFF IF (SELECT COUNT(1) FROM dbo.ReportCriHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ReportCriHlp) = 0 DROP TABLE dbo.Tmp_ReportCriHlp CREATE  UNIQUE NONCLUSTERED INDEX IX_ReportCriHlp_ReportCriId ON dbo.ReportCriHlp (CultureId,ReportCriId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=411&typ=N&sys=3","","",""); return false;
412~@~   4.   2.90729:D:   70:*:*:M: Change table AppInfo~@~143~@~70~@~D~@~~@~~@~M~@~~@~Change table AppInfo~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_AppInfo (AppInfoId int NOT NULL, AppInfoDesc varchar(50) NULL, VersionMa smallint NOT NULL, VersionMi smallint NOT NULL, VersionDt datetime NULL, AppZipId int NULL, Prerequisite nvarchar(200) NULL, Readme ntext NULL, AppItemLink varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_AppInfo (AppInfoId, AppInfoDesc, VersionMa, VersionMi, VersionDt, AppZipId, Prerequisite, Readme, AppItemLink) SELECT convert(int,AppInfoId), AppInfoDesc, convert(smallint,VersionMa), convert(smallint,VersionMi), VersionDt, convert(int,AppZipId), Prerequisite, Readme, AppItemLink FROM dbo.AppInfo IF (SELECT COUNT(1) FROM dbo.Tmp_AppInfo) > 0 OR (SELECT COUNT(1) FROM dbo.AppInfo) = 0 DROP TABLE dbo.AppInfo') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AppInfo'')) CREATE TABLE dbo.AppInfo (AppInfoId Int IDENTITY NOT NULL, AppInfoDesc VarChar(50) NULL, VersionMa SmallInt NOT NULL, VersionMi SmallInt NOT NULL, VersionDt DateTime NULL, AppZipId Int NULL, Prerequisite NVarChar(max) NULL, Readme NVarChar(max) NULL, AppItemLink VarChar(200) NULL, CONSTRAINT PK_AppInfo PRIMARY KEY CLUSTERED (AppInfoId))') EXEC (' SET IDENTITY_INSERT dbo.AppInfo ON INSERT INTO dbo.AppInfo (AppInfoId, AppInfoDesc, VersionMa, VersionMi, VersionDt, AppZipId, Prerequisite, Readme, AppItemLink) SELECT AppInfoId, AppInfoDesc, VersionMa, VersionMi, VersionDt, AppZipId, Prerequisite, CONVERT(NVarChar,Readme), AppItemLink FROM dbo.Tmp_AppInfo SET IDENTITY_INSERT dbo.AppInfo OFF IF (SELECT COUNT(1) FROM dbo.AppInfo) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AppInfo) = 0 DROP TABLE dbo.Tmp_AppInfo')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=412&typ=N&sys=3","","",""); return false;
413~@~   4.   3.90806:D:   10:*:*:M: Add table HomeTab~@~144~@~10~@~D~@~~@~~@~M~@~~@~Add table HomeTab~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.HomeTab'')) CREATE TABLE dbo.HomeTab (HomeTabId SmallInt IDENTITY NOT NULL, HomeTabName VarChar(20) NOT NULL, HomeTabDesc NVarChar(300) NOT NULL, HomeTabOrder TinyInt NULL, CONSTRAINT PK_HomeTab PRIMARY KEY CLUSTERED (HomeTabId))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=413&typ=N&sys=3","","",""); return false;
415~@~   4.   3.90806:D:   20:*:*:M: Change table UsrLink~@~144~@~20~@~D~@~~@~~@~M~@~~@~Change table UsrLink~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_UsrLink (UsrLinkId int NOT NULL, UsrPrefId int NOT NULL, LinkTypeCd char(1) NOT NULL, Popup char(1) NOT NULL, UsrLinkRef varchar(200) NOT NULL, UsrLinkTxt nvarchar(50) NULL, UsrLinkImg varchar(200) NULL, UsrLinkAlt varchar(200) NULL, UsrLinkOrd smallint NULL)') EXEC (' INSERT INTO dbo.Tmp_UsrLink (UsrLinkId, UsrPrefId, LinkTypeCd, Popup, UsrLinkRef, UsrLinkTxt, UsrLinkImg, UsrLinkAlt, UsrLinkOrd) SELECT convert(int,UsrLinkId), convert(int,UsrPrefId), LinkTypeCd, Popup, UsrLinkRef, UsrLinkTxt, UsrLinkImg, UsrLinkAlt, convert(smallint,UsrLinkOrd) FROM dbo.UsrLink IF (SELECT COUNT(1) FROM dbo.Tmp_UsrLink) > 0 OR (SELECT COUNT(1) FROM dbo.UsrLink) = 0 DROP TABLE dbo.UsrLink') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrLink'')) CREATE TABLE dbo.UsrLink (UsrLinkId Int IDENTITY NOT NULL, UsrPrefId Int NOT NULL, LinkTypeCd Char(1) NOT NULL, HomeTabId SmallInt NULL, Popup Char(1) NOT NULL, UsrLinkRef VarChar(200) NOT NULL, UsrLinkTxt NVarChar(50) NULL, UsrLinkImg VarChar(200) NULL, UsrLinkAlt VarChar(200) NULL, UsrLinkOrd SmallInt NULL, CONSTRAINT PK_UsrLink PRIMARY KEY CLUSTERED (UsrLinkId))') EXEC (' ALTER TABLE dbo.UsrLink ADD CONSTRAINT DF_UsrLink_Popup DEFAULT (''Y'') FOR Popup SET IDENTITY_INSERT dbo.UsrLink ON INSERT INTO dbo.UsrLink (UsrLinkId, UsrPrefId, LinkTypeCd, Popup, UsrLinkRef, UsrLinkTxt, UsrLinkImg, UsrLinkAlt, UsrLinkOrd) SELECT UsrLinkId, UsrPrefId, LinkTypeCd, Popup, UsrLinkRef, UsrLinkTxt, UsrLinkImg, UsrLinkAlt, UsrLinkOrd FROM dbo.Tmp_UsrLink SET IDENTITY_INSERT dbo.UsrLink OFF IF (SELECT COUNT(1) FROM dbo.UsrLink) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrLink) = 0 DROP TABLE dbo.Tmp_UsrLink')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=415&typ=N&sys=3","","",""); return false;
416~@~   4.   3.90806:D:   30:*:*:M: Change table Screen~@~144~@~30~@~D~@~~@~~@~M~@~~@~Change table Screen~@~Y~@~ EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenCri_Screen'') ALTER TABLE dbo.ScreenCri DROP CONSTRAINT FK_ScreenCri_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenHlp_Screen'') ALTER TABLE dbo.ScreenHlp DROP CONSTRAINT FK_ScreenHlp_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_Screen'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_Screen CREATE TABLE dbo.Tmp_Screen (ScreenId int NOT NULL, ProgramName varchar(20) NOT NULL, ScreenDesc nvarchar(50) NULL, ScreenTypeId tinyint NOT NULL, MasterTableId int NULL, DetailTableId int NULL, SearchId smallint NULL, SearchWidth smallint NULL, SearchAscending char(1) NOT NULL, GridRows tinyint NULL, GridClass varchar(30) NULL, GridTitle nvarchar(50) NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL, GenerateSc char(1) NOT NULL, HasDeleteAll char(1) NOT NULL, ValidateReq char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq) SELECT convert(int,ScreenId), ProgramName, ScreenDesc, convert(tinyint,ScreenTypeId), convert(int,MasterTableId), convert(int,DetailTableId), convert(smallint,SearchId), convert(smallint,SearchWidth), SearchAscending, convert(tinyint,GridRows), GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchId SmallInt NULL, SearchWidth SmallInt NULL, SearchAscending Char(1) NOT NULL, GridRows TinyInt NULL, GridClass VarChar(30) NULL, GridTitle NVarChar(50) NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq, DeferError) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq, ''N'' FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen CREATE  UNIQUE NONCLUSTERED INDEX IX_Screen_ProgramName ON dbo.Screen (ProgramName) ALTER TABLE dbo.ScreenCri WITH NOCHECK ADD CONSTRAINT FK_ScreenCri_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenHlp WITH NOCHECK ADD CONSTRAINT FK_ScreenHlp_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenObj WITH NOCHECK ADD CONSTRAINT FK_ScreenObj_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=416&typ=N&sys=3","","",""); return false;
417~@~   4.   4.90808:D:   10:*:*:M: Change table UsrLink~@~145~@~10~@~D~@~~@~~@~M~@~~@~Change table UsrLink~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_UsrLink (UsrLinkId int NOT NULL, UsrPrefId int NOT NULL, LinkTypeCd char(1) NOT NULL, HomeTabId smallint NULL, Popup char(1) NOT NULL, UsrLinkRef varchar(200) NOT NULL, UsrLinkTxt nvarchar(1000) NULL, UsrLinkImg varchar(200) NULL, UsrLinkAlt varchar(200) NULL, UsrLinkOrd smallint NULL)') EXEC (' INSERT INTO dbo.Tmp_UsrLink (UsrLinkId, UsrPrefId, LinkTypeCd, HomeTabId, Popup, UsrLinkRef, UsrLinkTxt, UsrLinkImg, UsrLinkAlt, UsrLinkOrd) SELECT convert(int,UsrLinkId), convert(int,UsrPrefId), LinkTypeCd, convert(smallint,HomeTabId), Popup, UsrLinkRef, UsrLinkTxt, UsrLinkImg, UsrLinkAlt, convert(smallint,UsrLinkOrd) FROM dbo.UsrLink IF (SELECT COUNT(1) FROM dbo.Tmp_UsrLink) > 0 OR (SELECT COUNT(1) FROM dbo.UsrLink) = 0 DROP TABLE dbo.UsrLink') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrLink'')) CREATE TABLE dbo.UsrLink (UsrLinkId Int IDENTITY NOT NULL, UsrPrefId Int NOT NULL, LinkTypeCd Char(1) NOT NULL, HomeTabId SmallInt NULL, Popup Char(1) NOT NULL, UsrLinkRef VarChar(200) NOT NULL, UsrLinkTxt NVarChar(1000) NULL, UsrLinkImg VarChar(200) NULL, UsrLinkAlt VarChar(200) NULL, UsrLinkOrd SmallInt NULL, CONSTRAINT PK_UsrLink PRIMARY KEY CLUSTERED (UsrLinkId))') EXEC (' ALTER TABLE dbo.UsrLink ADD CONSTRAINT DF_UsrLink_Popup DEFAULT (''Y'') FOR Popup SET IDENTITY_INSERT dbo.UsrLink ON INSERT INTO dbo.UsrLink (UsrLinkId, UsrPrefId, LinkTypeCd, HomeTabId, Popup, UsrLinkRef, UsrLinkTxt, UsrLinkImg, UsrLinkAlt, UsrLinkOrd) SELECT UsrLinkId, UsrPrefId, LinkTypeCd, HomeTabId, Popup, UsrLinkRef, UsrLinkTxt, UsrLinkImg, UsrLinkAlt, UsrLinkOrd FROM dbo.Tmp_UsrLink SET IDENTITY_INSERT dbo.UsrLink OFF IF (SELECT COUNT(1) FROM dbo.UsrLink) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrLink) = 0 DROP TABLE dbo.Tmp_UsrLink')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=417&typ=N&sys=3","","",""); return false;
418~@~   4.   4.90808:D:   20:*:*:M: Add table MaintMsg~@~145~@~20~@~D~@~~@~~@~M~@~~@~Add table MaintMsg~@~N~@~IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.MaintMsg')) EXEC ('DROP TABLE dbo.MaintMsg')
EXEC ('CREATE TABLE dbo.MaintMsg (MaintMsgId SmallInt IDENTITY NOT NULL, MaintMsgName NVarChar(200) NOT NULL, MaintMessage NVarChar(2000) NOT NULL, ShowOnLogin Char(1) NOT NULL, LastEmailDt DateTime NULL, CONSTRAINT PK_MaintMsg PRIMARY KEY CLUSTERED (MaintMsgId))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=418&typ=N&sys=3","","",""); return false;
419~@~   4.   4.90811:D:   10:*:*:M: Add table CtRowAuth~@~146~@~10~@~D~@~~@~~@~M~@~~@~Add table CtRowAuth~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtRowAuth'))
BEGIN
EXEC ('CREATE TABLE dbo.CtRowAuth (RowAuthId SmallInt IDENTITY NOT NULL, RowAuthName VarChar(50) NOT NULL, AllowSel Char(1) NOT NULL, AllowAdd Char(1) NOT NULL, AllowUpd Char(1) NOT NULL, AllowDel Char(1) NOT NULL, SysAdmin Char(1) NOT NULL, OvrideId SmallInt NULL, CONSTRAINT PK_CtRowAuth PRIMARY KEY CLUSTERED (RowAuthId))')
SET IDENTITY_INSERT dbo.CtRowAuth ON
EXEC ('INSERT dbo.CtRowAuth (RowAuthId, RowAuthName, AllowSel, AllowAdd, AllowUpd, AllowDel, SysAdmin, OvrideId) SELECT RowAuthorityId, RowAuthorityDesc, AllowSel, AllowAdd, AllowUpd, AllowDel, SysAdmin, OvrideId FROM dbo.CtRowAuthority WHERE RowAuthorityId <= 9')
SET IDENTITY_INSERT dbo.CtRowAuth OFF
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=419&typ=N&sys=3","","",""); return false;
420~@~   4.   4.90811:D:   20:*:*:M: Add table CtRowAuthPrm~@~146~@~20~@~D~@~~@~~@~M~@~~@~Add table CtRowAuthPrm~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtRowAuthPrm'))
BEGIN
EXEC ('CREATE TABLE dbo.CtRowAuthPrm (RowAuthPrmId SmallInt IDENTITY NOT NULL, RowAuthId SmallInt NOT NULL, PermKeyId SmallInt NOT NULL, SelLevel Char(1) NOT NULL, CONSTRAINT PK_CtRowAuthPrm PRIMARY KEY CLUSTERED (RowAuthPrmId))')
EXEC ('INSERT dbo.CtRowAuthPrm (RowAuthId, PermKeyId, SelLevel) SELECT 4, 3, ''S''')
EXEC ('INSERT dbo.CtRowAuthPrm (RowAuthId, PermKeyId, SelLevel) SELECT 5, 3, ''S''')
EXEC ('INSERT dbo.CtRowAuthPrm (RowAuthId, PermKeyId, SelLevel) SELECT 6, 3, ''S''')
EXEC ('INSERT dbo.CtRowAuthPrm (RowAuthId, PermKeyId, SelLevel) SELECT 7, 3, ''S''')
EXEC ('INSERT dbo.CtRowAuthPrm (RowAuthId, PermKeyId, SelLevel) SELECT 8, 3, ''S''')
EXEC ('INSERT dbo.CtRowAuthPrm (RowAuthId, PermKeyId, SelLevel) SELECT 9, 3, ''S''')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=420&typ=N&sys=3","","",""); return false;
421~@~   4.   4.90811:D:   30:*:*:M: Add table AtRowAuth~@~146~@~30~@~D~@~~@~~@~M~@~~@~Add table AtRowAuth~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.AtRowAuth'))
BEGIN
EXEC ('CREATE TABLE dbo.AtRowAuth (RowAuthId SmallInt IDENTITY (10000,1) NOT NULL, RowAuthName VarChar(50) NOT NULL, AllowSel Char(1) NOT NULL, AllowAdd Char(1) NOT NULL, AllowUpd Char(1) NOT NULL, AllowDel Char(1) NOT NULL, SysAdmin Char(1) NOT NULL, OvrideId SmallInt NULL, CONSTRAINT PK_AtRowAuth PRIMARY KEY CLUSTERED (RowAuthId))')
SET IDENTITY_INSERT dbo.AtRowAuth ON
EXEC ('INSERT dbo.AtRowAuth (RowAuthId, RowAuthName, AllowSel, AllowAdd, AllowUpd, AllowDel, SysAdmin, OvrideId) SELECT 10000 + RowAuthorityId, RowAuthorityDesc, AllowSel, AllowAdd, AllowUpd, AllowDel, SysAdmin, OvrideId FROM dbo.CtRowAuthority WHERE RowAuthorityId > 9')
SET IDENTITY_INSERT dbo.AtRowAuth OFF
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=421&typ=N&sys=3","","",""); return false;
422~@~   4.   4.90811:D:   40:*:*:M: Add table AtRowAuthPrm~@~146~@~40~@~D~@~~@~~@~M~@~~@~Add table AtRowAuthPrm~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AtRowAuthPrm'')) CREATE TABLE dbo.AtRowAuthPrm (RowAuthPrmId SmallInt IDENTITY (10000,1) NOT NULL, RowAuthId SmallInt NOT NULL, PermKeyId SmallInt NOT NULL, SelLevel Char(1) NOT NULL, CONSTRAINT PK_AtRowAuthPrm PRIMARY KEY CLUSTERED (RowAuthPrmId))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=422&typ=N&sys=3","","",""); return false;
423~@~   4.   4.90811:D:   50:*:*:M: Add view VwRowAuth~@~146~@~50~@~D~@~~@~~@~M~@~~@~Add view VwRowAuth~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.VwRowAuth'))
BEGIN
EXEC ('CREATE VIEW dbo.VwRowAuth AS
	SELECT RowAuthId, RowAuthName, AllowSel, AllowAdd, AllowUpd, AllowDel, SysAdmin, OvrideId
	FROM dbo.CtRowAuth
	UNION
	SELECT RowAuthId, RowAuthName, AllowSel, AllowAdd, AllowUpd, AllowDel, SysAdmin, OvrideId
	FROM dbo.AtRowAuth')
EXEC ('ALTER TABLE AppItem ALTER COLUMN AppItemCode nvarchar(max) null')
EXEC ('ALTER TABLE dbo.UsrGroup ALTER COLUMN RowAuthorityId smallint NOT NULL')
EXEC ('ALTER TABLE dbo.UsrGroupAuth ALTER COLUMN SysRowAuthorityId smallint NOT NULL')
EXEC ('UPDATE dbo.UsrGroup SET RowAuthorityId = 10000 + RowAuthorityId WHERE RowAuthorityId > 9')
EXEC ('UPDATE dbo.UsrGroupAuth SET SysRowAuthorityId = 10000 + SysRowAuthorityId WHERE SysRowAuthorityId > 9')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=423&typ=N&sys=3","","",""); return false;
424~@~   4.   4.90811:D:   60:*:*:M: Add table RowOvrd~@~146~@~60~@~D~@~~@~~@~M~@~~@~Add table RowOvrd~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.RowOvrd'))
BEGIN
EXEC ('CREATE TABLE dbo.RowOvrd (RowOvrdId SmallInt IDENTITY NOT NULL, RowOvrdDesc varchar(200) NULL, ScreenId Int NULL, ReportId Int NULL, RowAuthId SmallInt NOT NULL, AllowSel Char(1) NOT NULL, AllowAdd Char(1) NOT NULL, AllowUpd Char(1) NOT NULL, AllowDel Char(1) NOT NULL, CONSTRAINT PK_RowOvrd PRIMARY KEY CLUSTERED (RowOvrdId))')
SET IDENTITY_INSERT dbo.RowOvrd ON
EXEC ('INSERT dbo.RowOvrd (RowOvrdId, RowOvrdDesc, ScreenId, ReportId, RowAuthId, AllowSel, AllowAdd, AllowUpd, AllowDel)
	SELECT a.AuthRowId, case
		when c.ScreenDesc is not null then ''Screen: '' + c.ScreenDesc + '' - '' + b.RowAuthName
		else ''Report: '' + d.ReportDesc + '' - '' + b.RowAuthName end
	, a.ScreenId, a.ReportId, a.RowAuthorityId, a.AllowSel, a.AllowAdd, a.AllowUpd, a.AllowDel
	FROM dbo.AuthRow a
	INNER JOIN [[?]]Design.dbo.VwRowAuth b ON a.RowAuthorityId = b.RowAuthId
	LEFT OUTER JOIN dbo.Screen c ON a.ScreenId = c.ScreenId
	LEFT OUTER JOIN dbo.Report d ON a.ReportId = d.ReportId
	WHERE c.ScreenDesc is not null OR d.ReportDesc is not null
	')
SET IDENTITY_INSERT dbo.RowOvrd OFF
EXEC ('UPDATE dbo.RowOvrd SET RowAuthId = 10000 + RowAuthId WHERE RowAuthId > 9')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=424&typ=N&sys=3","","",""); return false;
425~@~   4.   4.90811:D:   70:*:*:M: Add table RowOvrdPrm~@~146~@~70~@~D~@~~@~~@~M~@~~@~Add table RowOvrdPrm~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.RowOvrdPrm'))
BEGIN
EXEC ('CREATE TABLE dbo.RowOvrdPrm (RowOvrdPrmId SmallInt IDENTITY NOT NULL, RowOvrdId SmallInt NOT NULL, PermKeyId SmallInt NOT NULL, SelLevel Char(1) NOT NULL, CONSTRAINT PK_RowOvrdPrm PRIMARY KEY CLUSTERED (RowOvrdPrmId))')
EXEC ('INSERT dbo.RowOvrdPrm (RowOvrdId, PermKeyId, SelLevel) SELECT a.AuthRowId, 3, a.SelCulture FROM AuthRow a INNER JOIN [[?]]Design.dbo.VwRowAuth b ON a.RowAuthorityId = b.RowAuthId WHERE a.SelCulture <> ''S''')
EXEC ('INSERT dbo.RowOvrdPrm (RowOvrdId, PermKeyId, SelLevel) SELECT a.AuthRowId, 12, a.SelUsr FROM AuthRow a INNER JOIN [[?]]Design.dbo.VwRowAuth b ON a.RowAuthorityId = b.RowAuthId WHERE a.SelUsr <> b.AllowSel')
EXEC ('INSERT dbo.RowOvrdPrm (RowOvrdId, PermKeyId, SelLevel) SELECT a.AuthRowId, 8, a.SelUsrGroup FROM AuthRow a INNER JOIN [[?]]Design.dbo.VwRowAuth b ON a.RowAuthorityId = b.RowAuthId WHERE a.SelUsrGroup <> b.AllowSel')
EXEC ('INSERT dbo.RowOvrdPrm (RowOvrdId, PermKeyId, SelLevel) SELECT a.AuthRowId, 10, a.SelCompany FROM AuthRow a INNER JOIN [[?]]Design.dbo.VwRowAuth b ON a.RowAuthorityId = b.RowAuthId WHERE a.SelCompany <> b.AllowSel')
EXEC ('INSERT dbo.RowOvrdPrm (RowOvrdId, PermKeyId, SelLevel) SELECT a.AuthRowId, 11, a.SelProject FROM AuthRow a INNER JOIN [[?]]Design.dbo.VwRowAuth b ON a.RowAuthorityId = b.RowAuthId WHERE a.SelProject <> b.AllowSel')
EXEC ('INSERT dbo.RowOvrdPrm (RowOvrdId, PermKeyId, SelLevel) SELECT a.AuthRowId, 1, a.SelAgent FROM AuthRow a INNER JOIN [[?]]Design.dbo.VwRowAuth b ON a.RowAuthorityId = b.RowAuthId WHERE a.SelAgent <> b.AllowSel')
EXEC ('INSERT dbo.RowOvrdPrm (RowOvrdId, PermKeyId, SelLevel) SELECT a.AuthRowId, 2, a.SelBroker FROM AuthRow a INNER JOIN [[?]]Design.dbo.VwRowAuth b ON a.RowAuthorityId = b.RowAuthId WHERE a.SelBroker <> b.AllowSel')
EXEC ('INSERT dbo.RowOvrdPrm (RowOvrdId, PermKeyId, SelLevel) SELECT a.AuthRowId, 4, a.SelCustomer FROM AuthRow a INNER JOIN [[?]]Design.dbo.VwRowAuth b ON a.RowAuthorityId = b.RowAuthId WHERE a.SelCustomer <> b.AllowSel')
EXEC ('INSERT dbo.RowOvrdPrm (RowOvrdId, PermKeyId, SelLevel) SELECT a.AuthRowId, 6, a.SelInvestor FROM AuthRow a INNER JOIN [[?]]Design.dbo.VwRowAuth b ON a.RowAuthorityId = b.RowAuthId WHERE a.SelInvestor <> b.AllowSel')
EXEC ('INSERT dbo.RowOvrdPrm (RowOvrdId, PermKeyId, SelLevel) SELECT a.AuthRowId, 7, a.SelMember FROM AuthRow a INNER JOIN [[?]]Design.dbo.VwRowAuth b ON a.RowAuthorityId = b.RowAuthId WHERE a.SelMember <> b.AllowSel')
EXEC ('INSERT dbo.RowOvrdPrm (RowOvrdId, PermKeyId, SelLevel) SELECT a.AuthRowId, 9, a.SelVendor FROM AuthRow a INNER JOIN [[?]]Design.dbo.VwRowAuth b ON a.RowAuthorityId = b.RowAuthId WHERE a.SelVendor <> b.AllowSel')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=425&typ=N&sys=3","","",""); return false;
426~@~   4.   4.90811:D:   80:*:*:M: Clean up obsolete s.proc. and tables~@~146~@~80~@~D~@~~@~~@~M~@~~@~Clean up obsolete s.proc. and tables~@~Y~@~IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtRowAuth')) AND EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtRowAuthority')) EXEC ('DROP TABLE dbo.CtRowAuthority')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.RowOvrd')) AND EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.AuthRow')) EXEC ('DROP TABLE dbo.AuthRow')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.AuthRowRpt')) EXEC ('DROP TABLE dbo.AuthRowRpt')

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlUsrGroupId3S5')) EXEC ('DROP PROCEDURE dbo.GetDdlUsrGroupId3S5')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlRowAuthorityId3S200')) EXEC ('DROP PROCEDURE dbo.GetDdlRowAuthorityId3S200')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlRowAuthorityId3S1466')) EXEC ('DROP PROCEDURE dbo.GetDdlRowAuthorityId3S1466')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlRowAuthorityId3S1113')) EXEC ('DROP PROCEDURE dbo.GetDdlRowAuthorityId3S1113')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlAccessCd103C40')) EXEC ('DROP PROCEDURE dbo.GetDdlAccessCd103C40')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlAccessCd103C41')) EXEC ('DROP PROCEDURE dbo.GetDdlAccessCd103C41')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlAccessCd105C40')) EXEC ('DROP PROCEDURE dbo.GetDdlAccessCd105C40')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlAccessCd105C41')) EXEC ('DROP PROCEDURE dbo.GetDdlAccessCd105C41')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlCultureId1003C18')) EXEC ('DROP PROCEDURE dbo.GetDdlCultureId1003C18')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlCultureId1003C19')) EXEC ('DROP PROCEDURE dbo.GetDdlCultureId1003C19')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlCultureId2003C10')) EXEC ('DROP PROCEDURE dbo.GetDdlCultureId2003C10')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlCultureId3C10')) EXEC ('DROP PROCEDURE dbo.GetDdlCultureId3C10')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlCultureId3C18')) EXEC ('DROP PROCEDURE dbo.GetDdlCultureId3C18')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlCultureId3C19')) EXEC ('DROP PROCEDURE dbo.GetDdlCultureId3C19')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlDefaultCd103C32')) EXEC ('DROP PROCEDURE dbo.GetDdlDefaultCd103C32')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlDefaultCd3C32')) EXEC ('DROP PROCEDURE dbo.GetDdlDefaultCd3C32')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlEntityId2003C36')) EXEC ('DROP PROCEDURE dbo.GetDdlEntityId2003C36')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlEntityId3C36')) EXEC ('DROP PROCEDURE dbo.GetDdlEntityId3C36')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlInternalUsr3C20')) EXEC ('DROP PROCEDURE dbo.GetDdlInternalUsr3C20')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlObjectTypeCd3C26')) EXEC ('DROP PROCEDURE dbo.GetDdlObjectTypeCd3C26')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlReleaseTypeId3003C37')) EXEC ('DROP PROCEDURE dbo.GetDdlReleaseTypeId3003C37')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlReleaseTypeId3C37')) EXEC ('DROP PROCEDURE dbo.GetDdlReleaseTypeId3C37')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlReportId1003C13')) EXEC ('DROP PROCEDURE dbo.GetDdlReportId1003C13')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlReportId1003C2')) EXEC ('DROP PROCEDURE dbo.GetDdlReportId1003C2')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlReportId1003C4')) EXEC ('DROP PROCEDURE dbo.GetDdlReportId1003C4')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlReportId103C29')) EXEC ('DROP PROCEDURE dbo.GetDdlReportId103C29')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlReportId103C30')) EXEC ('DROP PROCEDURE dbo.GetDdlReportId103C30')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlReportId103C34')) EXEC ('DROP PROCEDURE dbo.GetDdlReportId103C34')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlReportId1503C11')) EXEC ('DROP PROCEDURE dbo.GetDdlReportId1503C11')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlReportId203C39')) EXEC ('DROP PROCEDURE dbo.GetDdlReportId203C39')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlReportId3C11')) EXEC ('DROP PROCEDURE dbo.GetDdlReportId3C11')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlReportId3C13')) EXEC ('DROP PROCEDURE dbo.GetDdlReportId3C13')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlReportId3C2')) EXEC ('DROP PROCEDURE dbo.GetDdlReportId3C2')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlReportId3C29')) EXEC ('DROP PROCEDURE dbo.GetDdlReportId3C29')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlReportId3C30')) EXEC ('DROP PROCEDURE dbo.GetDdlReportId3C30')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlReportId3C34')) EXEC ('DROP PROCEDURE dbo.GetDdlReportId3C34')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlReportId3C39')) EXEC ('DROP PROCEDURE dbo.GetDdlReportId3C39')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlReportId3C4')) EXEC ('DROP PROCEDURE dbo.GetDdlReportId3C4')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlRptCtrId203C31')) EXEC ('DROP PROCEDURE dbo.GetDdlRptCtrId203C31')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlRptCtrId3C31')) EXEC ('DROP PROCEDURE dbo.GetDdlRptCtrId3C31')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlScreenId1003C1')) EXEC ('DROP PROCEDURE dbo.GetDdlScreenId1003C1')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlScreenId1003C12')) EXEC ('DROP PROCEDURE dbo.GetDdlScreenId1003C12')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlScreenId1003C15')) EXEC ('DROP PROCEDURE dbo.GetDdlScreenId1003C15')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlScreenId1003C16')) EXEC ('DROP PROCEDURE dbo.GetDdlScreenId1003C16')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlScreenId1003C3')) EXEC ('DROP PROCEDURE dbo.GetDdlScreenId1003C3')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlScreenId1003C5')) EXEC ('DROP PROCEDURE dbo.GetDdlScreenId1003C5')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlScreenId1003C9')) EXEC ('DROP PROCEDURE dbo.GetDdlScreenId1003C9')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlScreenId103C38')) EXEC ('DROP PROCEDURE dbo.GetDdlScreenId103C38')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlScreenId3C1')) EXEC ('DROP PROCEDURE dbo.GetDdlScreenId3C1')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlScreenId3C12')) EXEC ('DROP PROCEDURE dbo.GetDdlScreenId3C12')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlScreenId3C15')) EXEC ('DROP PROCEDURE dbo.GetDdlScreenId3C15')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlScreenId3C16')) EXEC ('DROP PROCEDURE dbo.GetDdlScreenId3C16')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlScreenId3C3')) EXEC ('DROP PROCEDURE dbo.GetDdlScreenId3C3')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlScreenId3C38')) EXEC ('DROP PROCEDURE dbo.GetDdlScreenId3C38')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlScreenId3C5')) EXEC ('DROP PROCEDURE dbo.GetDdlScreenId3C5')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlScreenId3C9')) EXEC ('DROP PROCEDURE dbo.GetDdlScreenId3C9')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlTechnicalUsr3C21')) EXEC ('DROP PROCEDURE dbo.GetDdlTechnicalUsr3C21')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlUsrGroupId3C24')) EXEC ('DROP PROCEDURE dbo.GetDdlUsrGroupId3C24')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlUsrGroupLs303C24')) EXEC ('DROP PROCEDURE dbo.GetDdlUsrGroupLs303C24')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlUsrGroupLs3C24')) EXEC ('DROP PROCEDURE dbo.GetDdlUsrGroupLs3C24')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlWizardId1003C17')) EXEC ('DROP PROCEDURE dbo.GetDdlWizardId1003C17')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlWizardId3C17')) EXEC ('DROP PROCEDURE dbo.GetDdlWizardId3C17')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetExpAdmUsrImpr66')) EXEC ('DROP PROCEDURE dbo.GetExpAdmUsrImpr66')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlRptTemlateId3S1728')) EXEC ('DROP PROCEDURE dbo.GetDdlRptTemlateId3S1728')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlUsrCultureId3S25')) EXEC ('DROP PROCEDURE dbo.GetDdlUsrCultureId3S25')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlProjectId3S1458')) EXEC ('DROP PROCEDURE dbo.GetDdlProjectId3S1458')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlProjectId3S1465')) EXEC ('DROP PROCEDURE dbo.GetDdlProjectId3S1465')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlCompanyId3S1303')) EXEC ('DROP PROCEDURE dbo.GetDdlCompanyId3S1303')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetAllowScrByLevel')) EXEC ('DROP PROCEDURE dbo.GetAllowScrByLevel')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetAllowRptByLevel')) EXEC ('DROP PROCEDURE dbo.GetAllowRptByLevel')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetAllowMnuByLevel')) EXEC ('DROP PROCEDURE dbo.GetAllowMnuByLevel')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetAllowSelByLevel')) EXEC ('DROP PROCEDURE dbo.GetAllowSelByLevel')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetExpAdmScreenObjHlp11')) EXEC ('DROP PROCEDURE dbo.GetExpAdmScreenObjHlp11')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetExpAdmReportObjHlp68')) EXEC ('DROP PROCEDURE dbo.GetExpAdmReportObjHlp68')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlSystemId3S497')) EXEC ('DROP PROCEDURE dbo.GetDdlSystemId3S497')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=426&typ=N&sys=3","","",""); return false;
427~@~   4.   5.90819:D:   10:*:*:M: Add table ColOvrd~@~147~@~10~@~D~@~~@~~@~M~@~~@~Add table ColOvrd~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.ColOvrd'))
BEGIN
EXEC ('CREATE TABLE dbo.ColOvrd (ColOvrdId Int IDENTITY NOT NULL, ColOvrdDesc varchar(200) NULL, ScreenObjId Int NOT NULL, ScreenId Int NULL, ColVisible Char(1) NOT NULL, ColReadOnly Char(1) NOT NULL, ColExport Char(1) NOT NULL, ToolTip NVarChar(200) NULL, ColumnHeader NVarChar(50) NULL, ErrMessage NVarChar(300) NULL, PermKeyId SmallInt NULL, PermId Int NULL, Priority SmallInt NULL, CONSTRAINT PK_ColOvrd PRIMARY KEY CLUSTERED (ColOvrdId))')
EXEC ('INSERT dbo.ColOvrd (ColOvrdDesc, ScreenObjId, ScreenId, ColVisible, ColReadOnly, ColExport, Priority) SELECT d.ColumnDesc + ''   100 [Default]'', a.ScreenObjId, a.ScreenId, a.ColVisible, a.ColReadOnly, a.ColExport, 100 FROM dbo.AuthCol a INNER JOIN dbo.ScreenObj d ON a.ScreenObjId = d.ScreenObjId WHERE a.ColAuthorityId = 1 AND (a.ColVisible <> ''Y'' OR a.ColReadOnly <> ''N'' OR a.ColExport <> ''Y'')')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.syscolumns where name = ''SysColAuthorityId'') INSERT dbo.ColOvrd (ColOvrdDesc, ScreenObjId, ScreenId, ColVisible, ColReadOnly, ColExport, PermKeyId, PermId, Priority) SELECT d.ColumnDesc + ''    10 [UsrGroup'' + convert(varchar,isnull(c.UsrGroupId,b.UsrGroupId)) + '']'', a.ScreenObjId, a.ScreenId, a.ColVisible, a.ColReadOnly, a.ColExport, 8, isnull(c.UsrGroupId,b.UsrGroupId), 10 FROM dbo.AuthCol a INNER JOIN dbo.ScreenObj d ON a.ScreenObjId = d.ScreenObjId LEFT OUTER JOIN [[?]]Design.dbo.UsrGroup b ON a.ColAuthorityId = b.ColAuthorityId LEFT OUTER JOIN [[?]]Design.dbo.UsrGroupAuth c ON a.ColAuthorityId = c.SysColAuthorityId WHERE a.ColAuthorityId <> 1')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=427&typ=N&sys=3","","",""); return false;
428~@~   4.   5.90819:D:   50:*:*:M: Clean up obsolete s.proc. and tables~@~147~@~50~@~D~@~~@~~@~M~@~~@~Clean up obsolete s.proc. and tables~@~Y~@~IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.ColOvrd')) AND EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.AuthCol')) EXEC ('DROP TABLE dbo.AuthCol')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.ColOvrd')) AND EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtColAuthority')) EXEC ('DROP TABLE dbo.CtColAuthority')

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetScreenObjHlp')) EXEC ('DROP PROCEDURE dbo.GetScreenObjHlp')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetAuthRowByLevel')) EXEC ('DROP PROCEDURE dbo.GetAuthRowByLevel')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetAuthColByLevel')) EXEC ('DROP PROCEDURE dbo.GetAuthColByLevel')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetAuthColExport')) EXEC ('DROP PROCEDURE dbo.GetAuthColExport')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CrOneAuthDefaultOnly')) EXEC ('DROP PROCEDURE dbo.CrOneAuthDefaultOnly')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.Ir_UpdAuthColTabIndex')) EXEC ('DROP PROCEDURE dbo.Ir_UpdAuthColTabIndex')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.Ir_InitAuthCol')) EXEC ('DROP PROCEDURE dbo.Ir_InitAuthCol')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlColAuthorityId3S182')) EXEC ('DROP PROCEDURE dbo.GetDdlColAuthorityId3S182')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlColAuthorityId3S35')) EXEC ('DROP PROCEDURE dbo.GetDdlColAuthorityId3S35')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlSysColAuthorityId3S554')) EXEC ('DROP PROCEDURE dbo.GetDdlSysColAuthorityId3S554')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetAdmAuthCol16DtlById')) EXEC ('DROP PROCEDURE dbo.GetAdmAuthCol16DtlById')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=428&typ=N&sys=3","","",""); return false;
429~@~   4.   5.90819:D:   20:*:*:M: Change table UsrGroup~@~147~@~20~@~D~@~~@~~@~M~@~~@~Change table UsrGroup~@~N~@~EXEC ('CREATE TABLE dbo.Tmp_UsrGroup (UsrGroupId smallint NOT NULL, UsrGroupName nvarchar(50) NOT NULL, RowAuthorityId smallint NOT NULL, CompanyId smallint NULL)')
EXEC ('INSERT INTO dbo.Tmp_UsrGroup (UsrGroupId, UsrGroupName, RowAuthorityId, CompanyId) SELECT convert(smallint,UsrGroupId), UsrGroupName, convert(smallint,RowAuthorityId), convert(smallint,CompanyId) FROM dbo.UsrGroup IF (SELECT COUNT(1) FROM dbo.Tmp_UsrGroup) > 0 OR (SELECT COUNT(1) FROM dbo.UsrGroup) = 0 DROP TABLE dbo.UsrGroup')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrGroup'')) CREATE TABLE dbo.UsrGroup (UsrGroupId SmallInt IDENTITY NOT NULL, UsrGroupName NVarChar(50) NOT NULL, RowAuthorityId SmallInt NOT NULL, CompanyId SmallInt NULL, CONSTRAINT PK_UsrGroup PRIMARY KEY CLUSTERED (UsrGroupId))')
EXEC ('SET IDENTITY_INSERT dbo.UsrGroup ON INSERT INTO dbo.UsrGroup (UsrGroupId, UsrGroupName, RowAuthorityId, CompanyId) SELECT UsrGroupId, UsrGroupName, RowAuthorityId, CompanyId FROM dbo.Tmp_UsrGroup SET IDENTITY_INSERT dbo.UsrGroup OFF IF (SELECT COUNT(1) FROM dbo.UsrGroup) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrGroup) = 0 DROP TABLE dbo.Tmp_UsrGroup CREATE  UNIQUE NONCLUSTERED INDEX IX_UsrGroup_UsrGroupName ON dbo.UsrGroup (UsrGroupName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=429&typ=N&sys=3","","",""); return false;
430~@~   4.   5.90819:D:   30:*:*:M: Change table UsrGroupAuth~@~147~@~30~@~D~@~~@~~@~M~@~~@~Change table UsrGroupAuth~@~N~@~EXEC ('CREATE TABLE dbo.Tmp_UsrGroupAuth (UsrGroupAuthId int NOT NULL, UsrGroupId smallint NOT NULL, CompanyId smallint NULL, ProjectId smallint NULL, SystemId tinyint NULL, SysRowAuthorityId smallint NOT NULL)')
EXEC ('INSERT INTO dbo.Tmp_UsrGroupAuth (UsrGroupAuthId, UsrGroupId, CompanyId, ProjectId, SystemId, SysRowAuthorityId) SELECT convert(int,UsrGroupAuthId), convert(smallint,UsrGroupId), convert(smallint,CompanyId), convert(smallint,ProjectId), convert(tinyint,SystemId), convert(smallint,SysRowAuthorityId) FROM dbo.UsrGroupAuth IF (SELECT COUNT(1) FROM dbo.Tmp_UsrGroupAuth) > 0 OR (SELECT COUNT(1) FROM dbo.UsrGroupAuth) = 0 DROP TABLE dbo.UsrGroupAuth')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrGroupAuth'')) CREATE TABLE dbo.UsrGroupAuth (UsrGroupAuthId Int IDENTITY NOT NULL, UsrGroupId SmallInt NOT NULL, CompanyId SmallInt NULL, ProjectId SmallInt NULL, SystemId TinyInt NULL, SysRowAuthorityId SmallInt NOT NULL, CONSTRAINT PK_UsrGroupAuth PRIMARY KEY CLUSTERED (UsrGroupAuthId))')
EXEC ('SET IDENTITY_INSERT dbo.UsrGroupAuth ON INSERT INTO dbo.UsrGroupAuth (UsrGroupAuthId, UsrGroupId, CompanyId, ProjectId, SystemId, SysRowAuthorityId) SELECT UsrGroupAuthId, UsrGroupId, CompanyId, ProjectId, SystemId, SysRowAuthorityId FROM dbo.Tmp_UsrGroupAuth SET IDENTITY_INSERT dbo.UsrGroupAuth OFF IF (SELECT COUNT(1) FROM dbo.UsrGroupAuth) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrGroupAuth) = 0 DROP TABLE dbo.Tmp_UsrGroupAuth CREATE  UNIQUE NONCLUSTERED INDEX IX_UsrGroupAuth ON dbo.UsrGroupAuth (UsrGroupId,CompanyId,ProjectId,SystemId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=430&typ=N&sys=3","","",""); return false;
431~@~   4.   5.90819:D:   40:*:*:M: Change table Usr~@~147~@~40~@~D~@~~@~~@~M~@~~@~Change table Usr~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_Usr (UsrId int NOT NULL, LoginName nvarchar(32) NOT NULL, UsrEmail nvarchar(50) NULL, UsrName nvarchar(50) NULL, UsrPassword varbinary(32) NULL, ConfirmPwd varbinary(32) NULL, ExtPassword varbinary(255) NULL, CultureId tinyint NOT NULL, InternalUsr char(1) NOT NULL, TechnicalUsr char(1) NOT NULL, UsrGroupLs varchar(1000) NOT NULL, CompanyLs varchar(1000) NULL, ProjectLs varchar(1000) NULL, InvestorId int NULL, CustomerId int NULL, VendorId int NULL, AgentId int NULL, BrokerId int NULL, MemberId int NULL, DefSystemId tinyint NOT NULL, DefProjectId smallint NULL, DefCompanyId smallint NULL, FailedAttempt tinyint NULL, FailedAttemptFP tinyint NULL, LastFailedDt datetime NULL, LastSuccessDt datetime NULL, HintQuestionId tinyint NULL, HintAnswer nvarchar(50) NULL, Active char(1) NOT NULL, ModifiedOn datetime NOT NULL, UsrImprLink varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_Usr (UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink) SELECT convert(int,UsrId), LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, convert(tinyint,CultureId), InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, convert(int,InvestorId), convert(int,CustomerId), convert(int,VendorId), convert(int,AgentId), convert(int,BrokerId), convert(int,MemberId), convert(tinyint,DefSystemId), convert(smallint,DefProjectId), convert(smallint,DefCompanyId), convert(tinyint,FailedAttempt), convert(tinyint,FailedAttemptFP), LastFailedDt, LastSuccessDt, convert(tinyint,HintQuestionId), HintAnswer, Active, ModifiedOn, UsrImprLink FROM dbo.Usr IF (SELECT COUNT(1) FROM dbo.Tmp_Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Usr) = 0 DROP TABLE dbo.Usr') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Usr'')) CREATE TABLE dbo.Usr (UsrId Int IDENTITY NOT NULL, LoginName NVarChar(32) NOT NULL, UsrEmail NVarChar(50) NULL, UsrName NVarChar(50) NULL, UsrPassword VarBinary(32) NULL, ConfirmPwd VarBinary(32) NULL, ExtPassword VarBinary(255) NULL, CultureId TinyInt NOT NULL, InternalUsr Char(1) NOT NULL, TechnicalUsr Char(1) NOT NULL, UsrGroupLs VarChar(1000) NOT NULL, CompanyLs VarChar(1000) NULL, ProjectLs VarChar(1000) NULL, InvestorId Int NULL, CustomerId Int NULL, VendorId Int NULL, AgentId Int NULL, BrokerId Int NULL, MemberId Int NULL, DefSystemId TinyInt NOT NULL, DefProjectId SmallInt NULL, DefCompanyId SmallInt NULL, FailedAttempt TinyInt NULL, FailedAttemptFP TinyInt NULL, LastFailedDt DateTime NULL, LastSuccessDt DateTime NULL, LastPwdChgDt DateTime NULL, HintQuestionId TinyInt NULL, HintAnswer NVarChar(50) NULL, Active Char(1) NOT NULL, ModifiedOn DateTime NOT NULL, UsrImprLink VarChar(200) NULL, CONSTRAINT PK_Usr PRIMARY KEY CLUSTERED (UsrId))') EXEC (' ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_CultureId DEFAULT (1) FOR CultureId ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_InternalUsr DEFAULT (''N'') FOR InternalUsr ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_TechnicalUsr DEFAULT (''N'') FOR TechnicalUsr SET IDENTITY_INSERT dbo.Usr ON INSERT INTO dbo.Usr (UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink) SELECT UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink FROM dbo.Tmp_Usr SET IDENTITY_INSERT dbo.Usr OFF IF (SELECT COUNT(1) FROM dbo.Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Usr) = 0 DROP TABLE dbo.Tmp_Usr CREATE  NONCLUSTERED INDEX IX_Usr_UsrName ON dbo.Usr (UsrName) CREATE  UNIQUE NONCLUSTERED INDEX IX_Usr_LoginName ON dbo.Usr (LoginName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=431&typ=N&sys=3","","",""); return false;
432~@~   4.   7.90828:D:   10:*:*:M: Change table CtCultureType~@~149~@~10~@~D~@~~@~~@~M~@~~@~Change table CtCultureType~@~N~@~IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtCultureType'))
BEGIN
EXEC ('ALTER TABLE dbo.CtCultureType DROP CONSTRAINT DF_CtCultureType_CultureTypeSrt')
EXEC ('CREATE TABLE dbo.Tmp_CtCulture (CultureTypeId smallint identity NOT NULL, CultureTypeName varchar(6) NOT NULL, CultureTypeDesc nvarchar(50) NOT NULL, CultureDefault char(1) NOT NULL, EnNumberRule char(1) NOT NULL, CultureTypeSrt smallint NOT NULL, ImportFileName nvarchar(30) NULL)')
EXEC ('ALTER TABLE dbo.Tmp_CtCulture ADD CONSTRAINT DF_CtCulture_CultureTypeSrt DEFAULT ((1)) FOR CultureTypeSrt')
EXEC ('SET IDENTITY_INSERT dbo.Tmp_CtCulture ON INSERT INTO dbo.Tmp_CtCulture (CultureTypeId, CultureTypeName, CultureTypeDesc, CultureDefault, EnNumberRule, CultureTypeSrt, ImportFileName) SELECT CONVERT(smallint, CultureId), CultureTypeName, CultureTypeDesc, CultureDefault, EnNumberRule, CultureTypeSrt, ImportFileName FROM dbo.CtCultureType SET IDENTITY_INSERT dbo.Tmp_CtCulture OFF')
EXEC ('DROP TABLE dbo.CtCultureType')
EXEC sp_rename 'dbo.Tmp_CtCulture', 'CtCulture'
EXEC ('ALTER TABLE dbo.CtCulture ADD CONSTRAINT PK_CtCulture PRIMARY KEY CLUSTERED (CultureTypeId)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=432&typ=N&sys=3","","",""); return false;
433~@~   4.   7.90828:D:   30:*:*:M: Add table AtCulture~@~149~@~30~@~D~@~~@~~@~M~@~~@~Add table AtCulture~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.AtCulture'))
BEGIN
EXEC ('CREATE TABLE dbo.AtCulture (CultureTypeId SmallInt IDENTITY (10000,1) NOT NULL, CultureTypeName VarChar(6) NOT NULL, CultureTypeDesc NVarChar(50) NOT NULL, CultureDefault Char(1) NOT NULL, EnNumberRule Char(1) NOT NULL, CultureTypeSrt SmallInt NOT NULL, ImportFileName NVarChar(30) NULL, CONSTRAINT PK_AtCulture PRIMARY KEY CLUSTERED (CultureTypeId))')
EXEC ('ALTER TABLE dbo.AtCulture ADD CONSTRAINT DF_AtCulture_CultureTypeSrt DEFAULT (1) FOR CultureTypeSrt')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=433&typ=N&sys=3","","",""); return false;
434~@~   4.   7.90828:D:   40:*:*:M: Add table AtCultureLbl~@~149~@~40~@~D~@~~@~~@~M~@~~@~Add table AtCultureLbl~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.AtCultureLbl'))
BEGIN
EXEC ('CREATE TABLE dbo.AtCultureLbl (CultureLblId Int IDENTITY NOT NULL, CultureTypeId SmallInt NOT NULL, CultureId SmallInt NOT NULL, CultureTypeLabel NVarChar(50) NOT NULL, CONSTRAINT PK_AtCultureLbl PRIMARY KEY CLUSTERED (CultureLblId))')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=434&typ=N&sys=3","","",""); return false;
435~@~   4.   7.90828:D:   20:*:*:M: Change table CultureType~@~149~@~20~@~D~@~~@~~@~M~@~~@~Change table CultureType~@~N~@~IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CultureType'))
BEGIN
EXEC ('CREATE TABLE dbo.Tmp_CultureType (CultureLblId int NOT NULL IDENTITY, CultureTypeId smallint NOT NULL, CultureId smallint NOT NULL, CultureTypeLabel nvarchar(50) NOT NULL)')
EXEC ('INSERT INTO dbo.Tmp_CultureType (CultureTypeId, CultureId, CultureTypeLabel) SELECT CONVERT(smallint, CultureTypeId), CONVERT(smallint, CultureId), CultureTypeLabel FROM dbo.CultureType')
EXEC ('DROP TABLE dbo.CultureType')
EXEC sp_rename 'dbo.Tmp_CultureType', 'CtCultureLbl'
EXEC ('ALTER TABLE dbo.CtCultureLbl ADD CONSTRAINT PK_CtCultureLbl PRIMARY KEY CLUSTERED (CultureLblId)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=435&typ=N&sys=3","","",""); return false;
436~@~   4.   7.90828:D:   80:*:*:M: Clean up all D's DB~@~149~@~80~@~D~@~~@~~@~M~@~~@~Clean up all D's DB~@~Y~@~EXEC ('DROP INDEX ScreenHlp.IX_ScreenHlp_ScreenId')
EXEC ('ALTER TABLE dbo.ScreenHlp ALTER COLUMN CultureId smallint NOT NULL')
EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_ScreenHlp_ScreenId ON dbo.ScreenHlp (CultureId,ScreenId)')
EXEC ('DROP INDEX ScreenObjHlp.IX_ScreenObjHlp_ObjId')
EXEC ('ALTER TABLE dbo.ScreenObjHlp ALTER COLUMN CultureId smallint NOT NULL')
EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_ScreenObjHlp_ObjId ON dbo.ScreenObjHlp (CultureId,ScreenObjId)')
EXEC ('DROP INDEX ScreenTabHlp.IX_ScreenTabHlp_ScreenTabId')
EXEC ('ALTER TABLE dbo.ScreenTabHlp ALTER COLUMN CultureId smallint NOT NULL')
EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_ScreenTabHlp_ScreenTabId ON dbo.ScreenTabHlp (CultureId,ScreenTabId)')
EXEC ('DROP INDEX ScreenFilterHlp.IX_ScreenFilterHlp_FilterId')
EXEC ('ALTER TABLE dbo.ScreenFilterHlp ALTER COLUMN CultureId smallint NOT NULL')
EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_ScreenFilterHlp_FilterId ON dbo.ScreenFilterHlp (CultureId,ScreenFilterId)')
EXEC ('DROP INDEX ReportHlp.IX_ReportHlp_ReportId')
EXEC ('ALTER TABLE dbo.ReportHlp ALTER COLUMN CultureId smallint NOT NULL')
EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_ReportHlp_ReportId ON dbo.ReportHlp (CultureId,ReportId)')
EXEC ('DROP INDEX ReportCriHlp.IX_ReportCriHlp_ReportCriId')
EXEC ('ALTER TABLE dbo.ReportCriHlp ALTER COLUMN CultureId smallint NOT NULL')
EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_ReportCriHlp_ReportCriId ON dbo.ReportCriHlp (CultureId,ReportCriId)')
EXEC ('DROP INDEX ReportObjHlp.IX_ReportObjHlp_ReportObjId')
EXEC ('ALTER TABLE dbo.ReportObjHlp ALTER COLUMN CultureId smallint NOT NULL')
EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_ReportObjHlp_ReportObjId ON dbo.ReportObjHlp (CultureId,ReportObjId)')
EXEC ('DROP INDEX ScreenCriHlp.IX_ScreenCriHlp_ScreenCriId')
EXEC ('ALTER TABLE dbo.ScreenCriHlp ALTER COLUMN CultureId smallint NOT NULL')
EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_ScreenCriHlp_ScreenCriId ON dbo.ScreenCriHlp (CultureId,ScreenCriId)')
EXEC ('DROP INDEX ButtonHlp.IX_ButtonHlp')
EXEC ('ALTER TABLE dbo.ButtonHlp ALTER COLUMN CultureId smallint NOT NULL')
EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_ButtonHlp ON dbo.ButtonHlp (ScreenId,ReportId,WizardId,CultureId,ButtonTypeId)')
EXEC ('ALTER TABLE dbo.ClientRule ALTER COLUMN CultureId smallint NULL')
EXEC ('DROP INDEX MenuHlp.IX_MenuHlp_MenuId')
EXEC ('ALTER TABLE dbo.MenuHlp ALTER COLUMN CultureId smallint NOT NULL')
EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_MenuHlp_MenuId ON dbo.MenuHlp (CultureId,MenuId)')
EXEC ('DROP INDEX MsgCenter.IX_MsgCenter')
EXEC ('ALTER TABLE dbo.MsgCenter ALTER COLUMN CultureId smallint NOT NULL')
EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_MsgCenter ON dbo.MsgCenter (CultureId,MsgId)')
EXEC ('DROP INDEX Label.IX_Label')
EXEC ('ALTER TABLE dbo.Label ALTER COLUMN CultureId smallint NOT NULL')
EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_Label ON dbo.Label (CultureId,LabelCat,LabelKey)')

IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.GetDdlCultureId2003C10')) EXEC ('DROP PROCEDURE dbo.GetDdlCultureId2003C10')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=436&typ=N&sys=3","","",""); return false;
437~@~   4.   7.90828:D:   50:*:*:M: Add View VwCulture~@~149~@~50~@~D~@~~@~~@~M~@~~@~Add View VwCulture~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.VwCulture'))
BEGIN
EXEC ('CREATE VIEW dbo.VwCulture AS SELECT CultureId = CultureTypeId, CultureTypeName, CultureTypeDesc, CultureDefault, EnNumberRule, CultureTypeSrt, ImportFileName FROM dbo.CtCulture UNION SELECT CultureId = CultureTypeId, CultureTypeName, CultureTypeDesc, CultureDefault, EnNumberRule, CultureTypeSrt, ImportFileName FROM dbo.AtCulture')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=437&typ=N&sys=3","","",""); return false;
438~@~   4.   7.90828:D:   60:*:*:M: Add View VwCultureLbl~@~149~@~60~@~D~@~~@~~@~M~@~~@~Add View VwCultureLbl~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.VwCultureLbl'))
BEGIN
EXEC ('CREATE VIEW dbo.VwCultureLbl AS SELECT CultureLblId, CultureTypeId, CultureId, CultureTypeLabel FROM dbo.CtCultureLbl UNION SELECT CultureLblId, CultureTypeId, CultureId, CultureTypeLabel FROM dbo.AtCultureLbl')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=438&typ=N&sys=3","","",""); return false;
439~@~   4.   7.90828:D:   70:*:*:M: Change table ClientTier~@~149~@~70~@~D~@~~@~~@~M~@~~@~Change table ClientTier~@~N~@~EXEC ('CREATE TABLE dbo.Tmp_ClientTier (ClientTierId tinyint NOT NULL, ClientTierName nvarchar(50) NOT NULL, EntityId int NOT NULL, LanguageCd char(1) NOT NULL, FrameworkCd char(1) NOT NULL, DevProgramPath varchar(100) NOT NULL, WsProgramPath varchar(100) NULL, IsDefault char(1) NOT NULL)')
EXEC ('INSERT INTO dbo.Tmp_ClientTier (ClientTierId, ClientTierName, EntityId, LanguageCd, FrameworkCd, DevProgramPath, WsProgramPath, IsDefault) SELECT convert(tinyint,ClientTierId), ClientTierName, convert(int,EntityId), LanguageCd, FrameworkCd, DevProgramPath, WsProgramPath, IsDefault FROM dbo.ClientTier IF (SELECT COUNT(1) FROM dbo.Tmp_ClientTier) > 0 OR (SELECT COUNT(1) FROM dbo.ClientTier) = 0 DROP TABLE dbo.ClientTier')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ClientTier'')) CREATE TABLE dbo.ClientTier (ClientTierId TinyInt NOT NULL, ClientTierName NVarChar(50) NOT NULL, EntityId Int NOT NULL, LanguageCd Char(1) NOT NULL, FrameworkCd Char(1) NOT NULL, DevProgramPath VarChar(100) NOT NULL, WsProgramPath VarChar(100) NULL, DevCompilePath VarChar(100) NULL, WsCompilePath VarChar(100) NULL, IsDefault Char(1) NOT NULL, CONSTRAINT PK_ClientTier PRIMARY KEY CLUSTERED (ClientTierId))')
EXEC ('INSERT INTO dbo.ClientTier (ClientTierId, ClientTierName, EntityId, LanguageCd, FrameworkCd, DevProgramPath, WsProgramPath, IsDefault) SELECT ClientTierId, ClientTierName, EntityId, LanguageCd, FrameworkCd, DevProgramPath, WsProgramPath, IsDefault FROM dbo.Tmp_ClientTier IF (SELECT COUNT(1) FROM dbo.ClientTier) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ClientTier) = 0 DROP TABLE dbo.Tmp_ClientTier')
EXEC ('UPDATE dbo.ClientTier SET DevCompilePath = DevProgramPath, WsCompilePath = WsProgramPath')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=439&typ=N&sys=3","","",""); return false;
440~@~   4.   7.90828:D:   90:*:*:M: Clean up ??Design DB~@~149~@~90~@~D~@~~@~~@~M~@~~@~Clean up ??Design DB~@~N~@~EXEC ('DROP INDEX CtButtonHlp.IX_CtButtonHlp')
EXEC ('ALTER TABLE dbo.CtButtonHlp ALTER COLUMN CultureId smallint NOT NULL')
EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_CtButtonHlp ON dbo.CtButtonHlp (CultureId,ButtonTypeId)')
EXEC ('ALTER TABLE dbo.CtButtonHlp DROP CONSTRAINT PK_CtButtonHlp')
EXEC ('ALTER TABLE dbo.CtButtonHlp ALTER COLUMN ButtonHlpId int NOT NULL')
EXEC ('ALTER TABLE dbo.CtButtonHlp ADD CONSTRAINT PK_CtButtonHlp PRIMARY KEY CLUSTERED (ButtonHlpId)')
EXEC ('ALTER TABLE dbo.Usr DROP CONSTRAINT DF_Usr_CultureId')
EXEC ('ALTER TABLE dbo.Usr ALTER COLUMN CultureId smallint NOT NULL')
EXEC ('ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_CultureId DEFAULT ((1)) FOR CultureId')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=440&typ=N&sys=3","","",""); return false;
441~@~   4.   9.90911:D:   10:*:*:M: Remove Obsolete S.Proc~@~151~@~10~@~D~@~~@~~@~M~@~~@~Remove Obsolete S.Proc~@~Y~@~IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.WrRptRmSql')) EXEC ('DROP PROCEDURE dbo.WrRptRmSql')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=441&typ=N&sys=3","","",""); return false;
442~@~   4.   9.90911:D:   10:*:*:M: Change table ClientTier~@~151~@~10~@~D~@~~@~~@~M~@~~@~Change table ClientTier~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_ClientTier (ClientTierId tinyint NOT NULL, ClientTierName nvarchar(50) NOT NULL, EntityId int NOT NULL, LanguageCd char(1) NOT NULL, FrameworkCd char(1) NOT NULL, DevProgramPath varchar(100) NOT NULL, WsProgramPath varchar(100) NULL, DevCompilePath varchar(100) NULL, WsCompilePath varchar(100) NULL, IsDefault char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_ClientTier (ClientTierId, ClientTierName, EntityId, LanguageCd, FrameworkCd, DevProgramPath, WsProgramPath, DevCompilePath, WsCompilePath, IsDefault) SELECT convert(tinyint,ClientTierId), ClientTierName, convert(int,EntityId), LanguageCd, FrameworkCd, DevProgramPath, WsProgramPath, DevCompilePath, WsCompilePath, IsDefault FROM dbo.ClientTier IF (SELECT COUNT(1) FROM dbo.Tmp_ClientTier) > 0 OR (SELECT COUNT(1) FROM dbo.ClientTier) = 0 DROP TABLE dbo.ClientTier') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ClientTier'')) CREATE TABLE dbo.ClientTier (ClientTierId TinyInt NOT NULL, ClientTierName NVarChar(50) NOT NULL, EntityId Int NOT NULL, LanguageCd Char(1) NOT NULL, FrameworkCd Char(1) NOT NULL, DevProgramPath VarChar(100) NOT NULL, WsProgramPath VarChar(100) NULL, XlsProgramPath VarChar(100) NULL, DevCompilePath VarChar(100) NULL, WsCompilePath VarChar(100) NULL, XlsCompilePath VarChar(100) NULL, IsDefault Char(1) NOT NULL, CONSTRAINT PK_ClientTier PRIMARY KEY CLUSTERED (ClientTierId))') EXEC (' INSERT INTO dbo.ClientTier (ClientTierId, ClientTierName, EntityId, LanguageCd, FrameworkCd, DevProgramPath, WsProgramPath, DevCompilePath, WsCompilePath, IsDefault) SELECT ClientTierId, ClientTierName, EntityId, LanguageCd, FrameworkCd, DevProgramPath, WsProgramPath, DevCompilePath, WsCompilePath, IsDefault FROM dbo.Tmp_ClientTier IF (SELECT COUNT(1) FROM dbo.ClientTier) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ClientTier) = 0 DROP TABLE dbo.Tmp_ClientTier')
EXEC ('UPDATE dbo.ClientTier SET XlsProgramPath = WsProgramPath, XlsCompilePath = WsCompilePath')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=442&typ=N&sys=3","","",""); return false;
443~@~   4.  10.90916:D:   10:*:*:M: Create missing indexes~@~152~@~10~@~D~@~~@~~@~M~@~~@~Create missing indexes~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = 'IX_CtCultureLbl') EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_CtCultureLbl ON dbo.CtCultureLbl (CultureId,CultureTypeId)')
IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = 'IX_AtCultureLbl') EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_AtCultureLbl ON dbo.AtCultureLbl (CultureId,CultureTypeId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=443&typ=N&sys=3","","",""); return false;
444~@~   4.  12.91014:D:   10:*:*:M: Create view VwMailProfile~@~154~@~10~@~D~@~~@~~@~M~@~~@~Create view VwMailProfile~@~N~@~CREATE VIEW dbo.VwMailProfile
AS
SELECT ProfileNm = [name] FROM msdb.dbo.sysmail_profile~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=444&typ=N&sys=3","","",""); return false;
453~@~   4.  14.91027:D:   50:*:*:M: Change table RptTemplate~@~156~@~50~@~D~@~~@~~@~M~@~~@~Change table RptTemplate~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_RptTemplate (DocId int NOT NULL, MasterId int NOT NULL, DocName nvarchar(50) NOT NULL, MimeType varchar(30) NOT NULL, DocSize bigint NOT NULL, DocImage varbinary(max) NOT NULL, InputBy int NULL, InputOn datetime NULL, Active char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_RptTemplate (DocId, MasterId, DocName, MimeType, DocSize, DocImage, InputBy, InputOn, Active) SELECT convert(int,DocId), convert(int,MasterId), DocName, MimeType, convert(bigint,DocSize), DocImage, convert(int,InputBy), InputOn, Active FROM dbo.RptTemplate IF (SELECT COUNT(1) FROM dbo.Tmp_RptTemplate) > 0 OR (SELECT COUNT(1) FROM dbo.RptTemplate) = 0 DROP TABLE dbo.RptTemplate') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RptTemplate'')) CREATE TABLE dbo.RptTemplate (DocId Int IDENTITY NOT NULL, MasterId Int NOT NULL, DocName NVarChar(100) NOT NULL, MimeType VarChar(100) NOT NULL, DocSize BigInt NOT NULL, DocImage VarBinary(max) NOT NULL, InputBy Int NULL, InputOn DateTime NULL, Active Char(1) NOT NULL, CONSTRAINT PK_RptTemplate PRIMARY KEY CLUSTERED (DocId))') EXEC (' SET IDENTITY_INSERT dbo.RptTemplate ON INSERT INTO dbo.RptTemplate (DocId, MasterId, DocName, MimeType, DocSize, DocImage, InputBy, InputOn, Active) SELECT DocId, MasterId, DocName, MimeType, DocSize, DocImage, InputBy, InputOn, Active FROM dbo.Tmp_RptTemplate SET IDENTITY_INSERT dbo.RptTemplate OFF IF (SELECT COUNT(1) FROM dbo.RptTemplate) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RptTemplate) = 0 DROP TABLE dbo.Tmp_RptTemplate CREATE  NONCLUSTERED INDEX IX_RptTemplate ON dbo.RptTemplate (MasterId,DocName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=453&typ=N&sys=3","","",""); return false;
454~@~   4.  14.91027:D:   60:*:*:M: Change table AppZip~@~156~@~60~@~D~@~~@~~@~M~@~~@~Change table AppZip~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_AppZip (DocId int NOT NULL, MasterId int NOT NULL, DocName nvarchar(100) NOT NULL, MimeType varchar(100) NOT NULL, DocSize bigint NOT NULL, DocImage varbinary(max) NOT NULL, InputBy int NULL, InputOn datetime NULL, Active char(1) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_AppZip (DocId, MasterId, DocName, MimeType, DocSize, DocImage, InputBy, InputOn, Active) SELECT convert(int,DocId), convert(int,MasterId), DocName, MimeType, convert(bigint,DocSize), DocImage, convert(int,InputBy), InputOn, Active FROM dbo.AppZip IF (SELECT COUNT(1) FROM dbo.Tmp_AppZip) > 0 OR (SELECT COUNT(1) FROM dbo.AppZip) = 0 DROP TABLE dbo.AppZip') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AppZip'')) CREATE TABLE dbo.AppZip (DocId Int IDENTITY NOT NULL, MasterId Int NOT NULL, DocName NVarChar(100) NOT NULL, MimeType VarChar(100) NOT NULL, DocSize BigInt NOT NULL, DocImage VarBinary(max) NOT NULL, InputBy Int NULL, InputOn DateTime NULL, Active Char(1) NOT NULL, CONSTRAINT PK_AppZip PRIMARY KEY CLUSTERED (DocId))') EXEC (' SET IDENTITY_INSERT dbo.AppZip ON INSERT INTO dbo.AppZip (DocId, MasterId, DocName, MimeType, DocSize, DocImage, InputBy, InputOn, Active) SELECT DocId, MasterId, DocName, MimeType, DocSize, DocImage, InputBy, InputOn, Active FROM dbo.Tmp_AppZip SET IDENTITY_INSERT dbo.AppZip OFF IF (SELECT COUNT(1) FROM dbo.AppZip) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AppZip) = 0 DROP TABLE dbo.Tmp_AppZip CREATE  NONCLUSTERED INDEX IX_AppZip ON dbo.AppZip (MasterId,DocName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=454&typ=N&sys=3","","",""); return false;
455~@~   4.  15.91030:D:   10:*:*:M: Change table ScreenHlp~@~157~@~10~@~D~@~~@~~@~M~@~~@~Change table ScreenHlp~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenHlp_Screen'') ALTER TABLE dbo.ScreenHlp DROP CONSTRAINT FK_ScreenHlp_Screen CREATE TABLE dbo.Tmp_ScreenHlp (ScreenHlpId int NOT NULL, ScreenId int NOT NULL, CultureId smallint NOT NULL, DefaultHlpMsg ntext NOT NULL, FootNote nvarchar(400) NULL, ScreenTitle nvarchar(50) NOT NULL, AddMsg nvarchar(100) NULL, UpdMsg nvarchar(100) NULL, DelMsg nvarchar(100) NULL)')
EXEC ('INSERT INTO dbo.Tmp_ScreenHlp (ScreenHlpId, ScreenId, CultureId, DefaultHlpMsg, FootNote, ScreenTitle, AddMsg, UpdMsg, DelMsg) SELECT convert(int,ScreenHlpId), convert(int,ScreenId), convert(smallint,CultureId), DefaultHlpMsg, FootNote, ScreenTitle, AddMsg, UpdMsg, DelMsg FROM dbo.ScreenHlp IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenHlp) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenHlp) = 0 DROP TABLE dbo.ScreenHlp')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenHlp'')) CREATE TABLE dbo.ScreenHlp (ScreenHlpId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, CultureId SmallInt NOT NULL, DefaultHlpMsg NVarChar(max) NOT NULL, FootNote NVarChar(400) NULL, ScreenTitle NVarChar(50) NOT NULL, AddMsg NVarChar(100) NULL, UpdMsg NVarChar(100) NULL, DelMsg NVarChar(100) NULL, CONSTRAINT PK_ScreenHlp PRIMARY KEY CLUSTERED (ScreenHlpId))')
EXEC ('SET IDENTITY_INSERT dbo.ScreenHlp ON INSERT INTO dbo.ScreenHlp (ScreenHlpId, ScreenId, CultureId, DefaultHlpMsg, FootNote, ScreenTitle, AddMsg, UpdMsg, DelMsg) SELECT ScreenHlpId, ScreenId, CultureId, DefaultHlpMsg, FootNote, ScreenTitle, AddMsg, UpdMsg, DelMsg FROM dbo.Tmp_ScreenHlp SET IDENTITY_INSERT dbo.ScreenHlp OFF IF (SELECT COUNT(1) FROM dbo.ScreenHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenHlp) = 0 DROP TABLE dbo.Tmp_ScreenHlp CREATE  UNIQUE NONCLUSTERED INDEX IX_ScreenHlp_ScreenId ON dbo.ScreenHlp (CultureId,ScreenId) ALTER TABLE dbo.ScreenHlp WITH NOCHECK ADD CONSTRAINT FK_ScreenHlp_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=455&typ=N&sys=3","","",""); return false;
456~@~   4.  15.91030:D:   20:*:*:M: Change table AdvRule~@~157~@~20~@~D~@~~@~~@~M~@~~@~Change table AdvRule~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_AdvRule (AdvRuleId int NOT NULL, RuleLayerCd char(1) NOT NULL, RuleName nvarchar(100) NOT NULL, RuleDesc nvarchar(150) NULL, RuleDescription nvarchar(500) NULL, ScreenId int NOT NULL, RmFuncProc varchar(100) NULL, AdvRuleProg ntext NOT NULL)')
EXEC ('INSERT INTO dbo.Tmp_AdvRule (AdvRuleId, RuleLayerCd, RuleName, RuleDesc, RuleDescription, ScreenId, RmFuncProc, AdvRuleProg) SELECT convert(int,AdvRuleId), RuleLayerCd, RuleName, RuleDesc, RuleDescription, convert(int,ScreenId), RmFuncProc, AdvRuleProg FROM dbo.AdvRule IF (SELECT COUNT(1) FROM dbo.Tmp_AdvRule) > 0 OR (SELECT COUNT(1) FROM dbo.AdvRule) = 0 DROP TABLE dbo.AdvRule')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AdvRule'')) CREATE TABLE dbo.AdvRule (AdvRuleId Int IDENTITY NOT NULL, RuleLayerCd Char(1) NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, ScreenId Int NOT NULL, RmFuncProc VarChar(100) NULL, AdvRuleProg NVarChar(max) NOT NULL, CONSTRAINT PK_AdvRule PRIMARY KEY CLUSTERED (AdvRuleId))')
EXEC ('SET IDENTITY_INSERT dbo.AdvRule ON INSERT INTO dbo.AdvRule (AdvRuleId, RuleLayerCd, RuleName, RuleDesc, RuleDescription, ScreenId, RmFuncProc, AdvRuleProg) SELECT AdvRuleId, RuleLayerCd, RuleName, RuleDesc, RuleDescription, ScreenId, RmFuncProc, AdvRuleProg FROM dbo.Tmp_AdvRule SET IDENTITY_INSERT dbo.AdvRule OFF IF (SELECT COUNT(1) FROM dbo.AdvRule) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AdvRule) = 0 DROP TABLE dbo.Tmp_AdvRule')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=456&typ=N&sys=3","","",""); return false;
461~@~   4.  15.91030:D:   30:*:*:M: Change table Release~@~157~@~30~@~D~@~~@~~@~M~@~~@~Change table Release~@~N~@~EXEC ('CREATE TABLE dbo.Tmp_Release (ReleaseId smallint NOT NULL, ReleaseName nvarchar(50) NOT NULL, ReleaseDesc nvarchar(80) NULL, ReleaseBuild varchar(20) NULL, ReleaseDate datetime NULL, ReleaseOs char(1) NOT NULL, EntityId smallint NOT NULL, ReleaseTypeId tinyint NOT NULL, TarScriptAft varchar(max) NULL, ReadMe varchar(max) NULL, MkDeploy varchar(100) NULL)')
EXEC ('INSERT INTO dbo.Tmp_Release (ReleaseId, ReleaseName, ReleaseDesc, ReleaseBuild, ReleaseDate, ReleaseOs, EntityId, ReleaseTypeId, TarScriptAft, ReadMe, MkDeploy) SELECT convert(smallint,ReleaseId), ReleaseName, ReleaseDesc, ReleaseBuild, ReleaseDate, ReleaseOs, convert(smallint,EntityId), convert(tinyint,ReleaseTypeId), TarScriptAft, ReadMe, MkDeploy FROM dbo.Release IF (SELECT COUNT(1) FROM dbo.Tmp_Release) > 0 OR (SELECT COUNT(1) FROM dbo.Release) = 0 DROP TABLE dbo.Release')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Release'')) CREATE TABLE dbo.Release (ReleaseId SmallInt IDENTITY NOT NULL, ReleaseName NVarChar(50) NOT NULL, ReleaseDesc NVarChar(80) NULL, ReleaseBuild VarChar(20) NULL, ReleaseDate DateTime NULL, ReleaseOs Char(1) NOT NULL, EntityId SmallInt NOT NULL, ReleaseTypeId TinyInt NOT NULL, TarScriptAft VarChar(max) NULL, ReadMe VarChar(max) NULL, MkDeploy VarChar(100) NULL, CONSTRAINT PK_Release PRIMARY KEY CLUSTERED (ReleaseId))')
EXEC ('SET IDENTITY_INSERT dbo.Release ON INSERT INTO dbo.Release (ReleaseId, ReleaseName, ReleaseDesc, ReleaseBuild, ReleaseDate, ReleaseOs, EntityId, ReleaseTypeId, TarScriptAft, ReadMe, MkDeploy) SELECT ReleaseId, ReleaseName, ReleaseDesc, ReleaseBuild, ReleaseDate, ReleaseOs, EntityId, ReleaseTypeId, TarScriptAft, ReadMe, MkDeploy FROM dbo.Tmp_Release SET IDENTITY_INSERT dbo.Release OFF IF (SELECT COUNT(1) FROM dbo.Release) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Release) = 0 DROP TABLE dbo.Tmp_Release')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=461&typ=N&sys=3","","",""); return false;
462~@~   4.  15.91030:D:   40:*:*:M: Change table ReleaseDtl~@~157~@~40~@~D~@~~@~~@~M~@~~@~Change table ReleaseDtl~@~N~@~EXEC ('CREATE TABLE dbo.Tmp_ReleaseDtl (ReleaseDtlId int NOT NULL, ReleaseId smallint NOT NULL, RunOrder smallint NULL, ObjectName text NOT NULL, SrcObject varchar(50) NULL, ObjectExempt text NULL, ObjectType char(1) NOT NULL, SrcClientTierId tinyint NULL, SrcRuleTierId tinyint NULL, SrcDataTierId tinyint NULL, TarDataTierId tinyint NULL, SProcOnly char(1) NOT NULL, DoSpEncrypt char(1) NOT NULL)')
EXEC ('INSERT INTO dbo.Tmp_ReleaseDtl (ReleaseDtlId, ReleaseId, RunOrder, ObjectName, SrcObject, ObjectExempt, ObjectType, SrcClientTierId, SrcRuleTierId, SrcDataTierId, TarDataTierId, SProcOnly, DoSpEncrypt) SELECT convert(int,ReleaseDtlId), convert(smallint,ReleaseId), convert(smallint,RunOrder), ObjectName, SrcObject, ObjectExempt, ObjectType, convert(tinyint,SrcClientTierId), convert(tinyint,SrcRuleTierId), convert(tinyint,SrcDataTierId), convert(tinyint,TarDataTierId), SProcOnly, DoSpEncrypt FROM dbo.ReleaseDtl IF (SELECT COUNT(1) FROM dbo.Tmp_ReleaseDtl) > 0 OR (SELECT COUNT(1) FROM dbo.ReleaseDtl) = 0 DROP TABLE dbo.ReleaseDtl')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ReleaseDtl'')) CREATE TABLE dbo.ReleaseDtl (ReleaseDtlId Int IDENTITY NOT NULL, ReleaseId SmallInt NOT NULL, RunOrder SmallInt NULL, ObjectName VarChar(max) NOT NULL, SrcObject VarChar(50) NULL, ObjectExempt VarChar(max) NULL, ObjectType Char(1) NOT NULL, SrcClientTierId TinyInt NULL, SrcRuleTierId TinyInt NULL, SrcDataTierId TinyInt NULL, TarDataTierId TinyInt NULL, SProcOnly Char(1) NOT NULL, DoSpEncrypt Char(1) NOT NULL, CONSTRAINT PK_ReleaseDtl PRIMARY KEY CLUSTERED (ReleaseDtlId))')
EXEC ('ALTER TABLE dbo.ReleaseDtl ADD CONSTRAINT DF_ReleaseDtl_SProcOnly DEFAULT (''Y'') FOR SProcOnly ALTER TABLE dbo.ReleaseDtl ADD CONSTRAINT DF_ReleaseDtl_DoSpEncrypt DEFAULT (''Y'') FOR DoSpEncrypt SET IDENTITY_INSERT dbo.ReleaseDtl ON INSERT INTO dbo.ReleaseDtl (ReleaseDtlId, ReleaseId, RunOrder, ObjectName, SrcObject, ObjectExempt, ObjectType, SrcClientTierId, SrcRuleTierId, SrcDataTierId, TarDataTierId, SProcOnly, DoSpEncrypt) SELECT ReleaseDtlId, ReleaseId, RunOrder, ObjectName, SrcObject, ObjectExempt, ObjectType, SrcClientTierId, SrcRuleTierId, SrcDataTierId, TarDataTierId, SProcOnly, DoSpEncrypt FROM dbo.Tmp_ReleaseDtl SET IDENTITY_INSERT dbo.ReleaseDtl OFF IF (SELECT COUNT(1) FROM dbo.ReleaseDtl) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ReleaseDtl) = 0 DROP TABLE dbo.Tmp_ReleaseDtl')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=462&typ=N&sys=3","","",""); return false;
463~@~   4.  15.91030:D:   50:*:*:M: Change table Report~@~157~@~50~@~D~@~~@~~@~M~@~~@~Change table Report~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportCri_Report'') ALTER TABLE dbo.ReportCri DROP CONSTRAINT FK_ReportCri_Report IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportObj_Report'') ALTER TABLE dbo.ReportObj DROP CONSTRAINT FK_ReportObj_Report CREATE TABLE dbo.Tmp_Report (ReportId int NOT NULL, ProgramName varchar(20) NOT NULL, ReportDesc nvarchar(50) NULL, OrientationCd char(1) NOT NULL, ReportTypeCd char(1) NOT NULL, TemplateName varchar(50) NULL, RptTemplateId int NULL, CopyReportId int NULL, TopMargin decimal(8,2) NOT NULL, BottomMargin decimal(8,2) NOT NULL, LeftMargin decimal(8,2) NOT NULL, RightMargin decimal(8,2) NOT NULL, PageHeight decimal(8,2) NOT NULL, PageWidth decimal(8,2) NOT NULL, UnitCd char(2) NOT NULL, WhereClause varchar(1000) NULL, RegClause varchar(400) NULL, RegCode ntext NULL, ValClause varchar(400) NULL, ValCode ntext NULL, UpdClause varchar(200) NULL, UpdCode ntext NULL, XlsClause varchar(200) NULL, XlsCode ntext NULL, GenerateRp char(1) NOT NULL, AllowSelect char(1) NOT NULL, ModifiedBy int NULL, ModifiedOn datetime NULL, LastGenDt datetime NULL)')
EXEC ('INSERT INTO dbo.Tmp_Report (ReportId, ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, RptTemplateId, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, ModifiedBy, ModifiedOn, LastGenDt) SELECT convert(int,ReportId), ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, convert(int,RptTemplateId), convert(int,CopyReportId), convert(decimal(8,2),TopMargin), convert(decimal(8,2),BottomMargin), convert(decimal(8,2),LeftMargin), convert(decimal(8,2),RightMargin), convert(decimal(8,2),PageHeight), convert(decimal(8,2),PageWidth), UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, convert(int,ModifiedBy), ModifiedOn, LastGenDt FROM dbo.Report IF (SELECT COUNT(1) FROM dbo.Tmp_Report) > 0 OR (SELECT COUNT(1) FROM dbo.Report) = 0 DROP TABLE dbo.Report')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Report'')) CREATE TABLE dbo.Report (ReportId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ReportDesc NVarChar(50) NULL, OrientationCd Char(1) NOT NULL, ReportTypeCd Char(1) NOT NULL, TemplateName VarChar(50) NULL, RptTemplateId Int NULL, CopyReportId Int NULL, TopMargin Decimal(8,2) NOT NULL, BottomMargin Decimal(8,2) NOT NULL, LeftMargin Decimal(8,2) NOT NULL, RightMargin Decimal(8,2) NOT NULL, PageHeight Decimal(8,2) NOT NULL, PageWidth Decimal(8,2) NOT NULL, UnitCd Char(2) NOT NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, RegCode NVarChar(max) NULL, ValClause VarChar(400) NULL, ValCode NVarChar(max) NULL, UpdClause VarChar(200) NULL, UpdCode NVarChar(max) NULL, XlsClause VarChar(200) NULL, XlsCode NVarChar(max) NULL, GenerateRp Char(1) NOT NULL, AllowSelect Char(1) NOT NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, CONSTRAINT PK_Report PRIMARY KEY CLUSTERED (ReportId))')
EXEC ('ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_TopMargin DEFAULT (1) FOR TopMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_BottomMargin DEFAULT (1) FOR BottomMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_LeftMargin DEFAULT (1) FOR LeftMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_RightMargin DEFAULT (1) FOR RightMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_PageHeight DEFAULT (11) FOR PageHeight ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_PageWidth DEFAULT (8.5) FOR PageWidth ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_UnitCd DEFAULT (''in'') FOR UnitCd ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_AllowSelect DEFAULT (''N'') FOR AllowSelect SET IDENTITY_INSERT dbo.Report ON INSERT INTO dbo.Report (ReportId, ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, RptTemplateId, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, ModifiedBy, ModifiedOn, LastGenDt) SELECT ReportId, ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, RptTemplateId, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, ModifiedBy, ModifiedOn, LastGenDt FROM dbo.Tmp_Report SET IDENTITY_INSERT dbo.Report OFF IF (SELECT COUNT(1) FROM dbo.Report) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Report) = 0 DROP TABLE dbo.Tmp_Report CREATE  UNIQUE NONCLUSTERED INDEX IX_Report_ProgramName ON dbo.Report (ProgramName) ALTER TABLE dbo.ReportCri WITH NOCHECK ADD CONSTRAINT FK_ReportCri_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId) ALTER TABLE dbo.ReportObj WITH NOCHECK ADD CONSTRAINT FK_ReportObj_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=463&typ=N&sys=3","","",""); return false;
464~@~   4.  15.91030:D:   60:*:*:M: Change table ReportHlp~@~157~@~60~@~D~@~~@~~@~M~@~~@~Change table ReportHlp~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_ReportHlp (ReportHlpId int NOT NULL, ReportId int NOT NULL, CultureId smallint NOT NULL, DefaultHlpMsg ntext NOT NULL, ReportTitle nvarchar(50) NOT NULL)')
EXEC ('INSERT INTO dbo.Tmp_ReportHlp (ReportHlpId, ReportId, CultureId, DefaultHlpMsg, ReportTitle) SELECT convert(int,ReportHlpId), convert(int,ReportId), convert(smallint,CultureId), DefaultHlpMsg, ReportTitle FROM dbo.ReportHlp IF (SELECT COUNT(1) FROM dbo.Tmp_ReportHlp) > 0 OR (SELECT COUNT(1) FROM dbo.ReportHlp) = 0 DROP TABLE dbo.ReportHlp')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ReportHlp'')) CREATE TABLE dbo.ReportHlp (ReportHlpId Int IDENTITY NOT NULL, ReportId Int NOT NULL, CultureId SmallInt NOT NULL, DefaultHlpMsg NVarChar(max) NOT NULL, ReportTitle NVarChar(50) NOT NULL, CONSTRAINT PK_ReportHlp PRIMARY KEY CLUSTERED (ReportHlpId))')
EXEC ('SET IDENTITY_INSERT dbo.ReportHlp ON INSERT INTO dbo.ReportHlp (ReportHlpId, ReportId, CultureId, DefaultHlpMsg, ReportTitle) SELECT ReportHlpId, ReportId, CultureId, DefaultHlpMsg, ReportTitle FROM dbo.Tmp_ReportHlp SET IDENTITY_INSERT dbo.ReportHlp OFF IF (SELECT COUNT(1) FROM dbo.ReportHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ReportHlp) = 0 DROP TABLE dbo.Tmp_ReportHlp CREATE  UNIQUE NONCLUSTERED INDEX IX_ReportHlp_ReportId ON dbo.ReportHlp (CultureId,ReportId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=464&typ=N&sys=3","","",""); return false;
465~@~   4.  15.91030:D:   70:*:*:M: Change table ServerRule~@~157~@~70~@~D~@~~@~~@~M~@~~@~Change table ServerRule~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_ServerRule (ServerRuleId int NOT NULL, ScreenId int NOT NULL, RuleTypeId tinyint NOT NULL, MasterTable char(1) NOT NULL, RuleName nvarchar(100) NOT NULL, RuleDesc nvarchar(150) NULL, RuleDescription nvarchar(500) NULL, RuleOrder smallint NOT NULL, ProcedureName varchar(28) NOT NULL, ParameterNames varchar(200) NULL, ParameterTypes varchar(200) NULL, CallingParams varchar(200) NULL, OnAdd char(1) NOT NULL, OnUpd char(1) NOT NULL, OnDel char(1) NOT NULL, BeforeCRUD char(1) NOT NULL, RuleCode ntext NULL, ModifiedBy int NULL, ModifiedOn datetime NULL, LastGenDt datetime NULL)')
EXEC ('INSERT INTO dbo.Tmp_ServerRule (ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, RuleOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn, LastGenDt) SELECT convert(int,ServerRuleId), convert(int,ScreenId), convert(tinyint,RuleTypeId), MasterTable, RuleName, RuleDesc, RuleDescription, convert(smallint,RuleOrder), ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, convert(int,ModifiedBy), ModifiedOn, LastGenDt FROM dbo.ServerRule IF (SELECT COUNT(1) FROM dbo.Tmp_ServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.ServerRule) = 0 DROP TABLE dbo.ServerRule')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ServerRule'')) CREATE TABLE dbo.ServerRule (ServerRuleId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, RuleTypeId TinyInt NOT NULL, MasterTable Char(1) NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, RuleOrder SmallInt NOT NULL, ProcedureName VarChar(28) NOT NULL, ParameterNames VarChar(200) NULL, ParameterTypes VarChar(200) NULL, CallingParams VarChar(200) NULL, OnAdd Char(1) NOT NULL, OnUpd Char(1) NOT NULL, OnDel Char(1) NOT NULL, BeforeCRUD Char(1) NOT NULL, RuleCode NVarChar(max) NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, CONSTRAINT PK_ServerRule PRIMARY KEY CLUSTERED (ServerRuleId))')
EXEC ('SET IDENTITY_INSERT dbo.ServerRule ON INSERT INTO dbo.ServerRule (ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, RuleOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn, LastGenDt) SELECT ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, RuleOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn, LastGenDt FROM dbo.Tmp_ServerRule SET IDENTITY_INSERT dbo.ServerRule OFF IF (SELECT COUNT(1) FROM dbo.ServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ServerRule) = 0 DROP TABLE dbo.Tmp_ServerRule')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=465&typ=N&sys=3","","",""); return false;
466~@~   4.  15.91030:D:   80:*:*:M: Change table UsrPref~@~157~@~80~@~D~@~~@~~@~M~@~~@~Change table UsrPref~@~N~@~EXEC ('CREATE TABLE dbo.Tmp_UsrPref (UsrPrefId int NOT NULL, UsrId int NULL, UsrGroupId smallint NULL, CompanyId smallint NULL, MemberId int NULL, AgentId int NULL, BrokerId int NULL, CustomerId int NULL, InvestorId int NULL, VendorId int NULL, ProjectId smallint NULL, SystemId tinyint NULL, PrefDefault char(1) NOT NULL, UsrPrefDesc nvarchar(50) NOT NULL, SysListVisible char(1) NOT NULL, ComListVisible char(1) NOT NULL, PrjListVisible char(1) NOT NULL, MenuOption char(1) NOT NULL, PageBannerImg varchar(100) NULL, UsrStyleSheet text NULL, SplashImg varchar(100) NULL)')
EXEC ('INSERT INTO dbo.Tmp_UsrPref (UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOption, PageBannerImg, UsrStyleSheet, SplashImg) SELECT convert(int,UsrPrefId), convert(int,UsrId), convert(smallint,UsrGroupId), convert(smallint,CompanyId), convert(int,MemberId), convert(int,AgentId), convert(int,BrokerId), convert(int,CustomerId), convert(int,InvestorId), convert(int,VendorId), convert(smallint,ProjectId), convert(tinyint,SystemId), PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOption, PageBannerImg, UsrStyleSheet, SplashImg FROM dbo.UsrPref IF (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.UsrPref) = 0 DROP TABLE dbo.UsrPref')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrPref'')) CREATE TABLE dbo.UsrPref (UsrPrefId Int IDENTITY NOT NULL, UsrId Int NULL, UsrGroupId SmallInt NULL, CompanyId SmallInt NULL, MemberId Int NULL, AgentId Int NULL, BrokerId Int NULL, CustomerId Int NULL, InvestorId Int NULL, VendorId Int NULL, ProjectId SmallInt NULL, SystemId TinyInt NULL, PrefDefault Char(1) NOT NULL, UsrPrefDesc NVarChar(50) NOT NULL, SysListVisible Char(1) NOT NULL, ComListVisible Char(1) NOT NULL, PrjListVisible Char(1) NOT NULL, MenuOption Char(1) NOT NULL, PageBannerImg VarChar(100) NULL, UsrStyleSheet VarChar(max) NULL, SplashImg VarChar(100) NULL, CONSTRAINT PK_UsrPref PRIMARY KEY CLUSTERED (UsrPrefId))')
EXEC ('ALTER TABLE dbo.UsrPref ADD CONSTRAINT DF_UsrPref_PrjListVisible DEFAULT (''N'') FOR PrjListVisible SET IDENTITY_INSERT dbo.UsrPref ON INSERT INTO dbo.UsrPref (UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOption, PageBannerImg, UsrStyleSheet, SplashImg) SELECT UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOption, PageBannerImg, UsrStyleSheet, SplashImg FROM dbo.Tmp_UsrPref SET IDENTITY_INSERT dbo.UsrPref OFF IF (SELECT COUNT(1) FROM dbo.UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) = 0 DROP TABLE dbo.Tmp_UsrPref CREATE  UNIQUE NONCLUSTERED INDEX IX_UsrPref_UsrPrefDesc ON dbo.UsrPref (UsrPrefDesc)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=466&typ=N&sys=3","","",""); return false;
467~@~   4.  15.91030:D:   90:*:*:M: Change table WebRule~@~157~@~90~@~D~@~~@~~@~M~@~~@~Change table WebRule~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_WebRule (WebRuleId int NOT NULL, RuleTypeId tinyint NOT NULL, RuleName nvarchar(100) NOT NULL, RuleDesc nvarchar(150) NULL, RuleDescription nvarchar(500) NULL, ScreenId int NOT NULL, ScreenCriId int NULL, ScreenObjId int NULL, ButtonTypeId tinyint NULL, EventId tinyint NOT NULL, WebRuleProg ntext NOT NULL)')
EXEC ('INSERT INTO dbo.Tmp_WebRule (WebRuleId, RuleTypeId, RuleName, RuleDesc, RuleDescription, ScreenId, ScreenCriId, ScreenObjId, ButtonTypeId, EventId, WebRuleProg) SELECT convert(int,WebRuleId), convert(tinyint,RuleTypeId), RuleName, RuleDesc, RuleDescription, convert(int,ScreenId), convert(int,ScreenCriId), convert(int,ScreenObjId), convert(tinyint,ButtonTypeId), convert(tinyint,EventId), WebRuleProg FROM dbo.WebRule IF (SELECT COUNT(1) FROM dbo.Tmp_WebRule) > 0 OR (SELECT COUNT(1) FROM dbo.WebRule) = 0 DROP TABLE dbo.WebRule')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.WebRule'')) CREATE TABLE dbo.WebRule (WebRuleId Int IDENTITY NOT NULL, RuleTypeId TinyInt NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, ScreenId Int NOT NULL, ScreenCriId Int NULL, ScreenObjId Int NULL, ButtonTypeId TinyInt NULL, EventId TinyInt NOT NULL, WebRuleProg NVarChar(max) NOT NULL, CONSTRAINT PK_WebRule PRIMARY KEY CLUSTERED (WebRuleId))')
EXEC ('SET IDENTITY_INSERT dbo.WebRule ON INSERT INTO dbo.WebRule (WebRuleId, RuleTypeId, RuleName, RuleDesc, RuleDescription, ScreenId, ScreenCriId, ScreenObjId, ButtonTypeId, EventId, WebRuleProg) SELECT WebRuleId, RuleTypeId, RuleName, RuleDesc, RuleDescription, ScreenId, ScreenCriId, ScreenObjId, ButtonTypeId, EventId, WebRuleProg FROM dbo.Tmp_WebRule SET IDENTITY_INSERT dbo.WebRule OFF IF (SELECT COUNT(1) FROM dbo.WebRule) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_WebRule) = 0 DROP TABLE dbo.Tmp_WebRule')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=467&typ=N&sys=3","","",""); return false;
470~@~   4.  15.91030:D:  100:*:*:M: Change table CustomDtl~@~157~@~100~@~D~@~~@~~@~M~@~~@~Change table CustomDtl~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_CustomDtl (CustomDtlId int NOT NULL, CustomId int NOT NULL, CustomDtlDesc nvarchar(200) NULL, ObjectTypeCd char(1) NOT NULL, LanguageCd char(1) NULL, FrameworkCd char(1) NULL, DbProviderCd char(1) NULL, MultiDesignDb char(1) NOT NULL, RelativePath varchar(100) NULL, ProgramName varchar(50) NOT NULL, CustomCode ntext NULL, CustomDtlLink varchar(200) NULL, ModifiedBy int NULL, ModifiedOn datetime NULL, LastGenDt datetime NULL)') EXEC (' INSERT INTO dbo.Tmp_CustomDtl (CustomDtlId, CustomId, CustomDtlDesc, ObjectTypeCd, LanguageCd, FrameworkCd, DbProviderCd, MultiDesignDb, RelativePath, ProgramName, CustomCode, CustomDtlLink, ModifiedBy, ModifiedOn, LastGenDt) SELECT convert(int,CustomDtlId), convert(int,CustomId), CustomDtlDesc, ObjectTypeCd, LanguageCd, FrameworkCd, DbProviderCd, MultiDesignDb, RelativePath, ProgramName, CustomCode, CustomDtlLink, convert(int,ModifiedBy), ModifiedOn, LastGenDt FROM dbo.CustomDtl IF (SELECT COUNT(1) FROM dbo.Tmp_CustomDtl) > 0 OR (SELECT COUNT(1) FROM dbo.CustomDtl) = 0 DROP TABLE dbo.CustomDtl') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CustomDtl'')) CREATE TABLE dbo.CustomDtl (CustomDtlId Int IDENTITY NOT NULL, CustomId Int NOT NULL, CustomDtlDesc NVarChar(200) NULL, ObjectTypeCd Char(1) NOT NULL, LanguageCd Char(1) NULL, FrameworkCd Char(1) NULL, DbProviderCd Char(1) NULL, MultiDesignDb Char(1) NOT NULL, RelativePath VarChar(100) NULL, ProgramName VarChar(50) NOT NULL, CustomCode NVarChar(max) NULL, CustomDtlLink VarChar(200) NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, CONSTRAINT PK_CustomDtl PRIMARY KEY CLUSTERED (CustomDtlId))') EXEC (' SET IDENTITY_INSERT dbo.CustomDtl ON INSERT INTO dbo.CustomDtl (CustomDtlId, CustomId, CustomDtlDesc, ObjectTypeCd, LanguageCd, FrameworkCd, DbProviderCd, MultiDesignDb, RelativePath, ProgramName, CustomCode, CustomDtlLink, ModifiedBy, ModifiedOn, LastGenDt) SELECT CustomDtlId, CustomId, CustomDtlDesc, ObjectTypeCd, LanguageCd, FrameworkCd, DbProviderCd, MultiDesignDb, RelativePath, ProgramName, CustomCode, CustomDtlLink, ModifiedBy, ModifiedOn, LastGenDt FROM dbo.Tmp_CustomDtl SET IDENTITY_INSERT dbo.CustomDtl OFF IF (SELECT COUNT(1) FROM dbo.CustomDtl) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CustomDtl) = 0 DROP TABLE dbo.Tmp_CustomDtl CREATE  NONCLUSTERED INDEX IX_CustomDtl ON dbo.CustomDtl (CustomId,CustomDtlDesc)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=470&typ=N&sys=3","","",""); return false;
471~@~   4.  16.91102:D:   10:*:*:M: Substitute apostrophy in D's~@~158~@~10~@~D~@~~@~~@~M~@~~@~Substitute apostrophy in D's~@~Y~@~update ButtonHlp Set
  ButtonName = replace(replace(replace(ButtonName,'\u0026','&'),'&#39;',''''),'quot;','"')
, ButtonToolTip = replace(replace(replace(ButtonToolTip,'\u0026','&'),'&#39;',''''),'quot;','"')
update MenuHlp Set
  MenuText = replace(replace(replace(MenuText,'\u0026','&'),'&#39;',''''),'quot;','"')
update MsgCenter Set
  Msg = replace(replace(replace(Msg,'\u0026','&'),'&#39;',''''),'quot;','"')
update ReportCriHlp Set
  ColumnHeader = replace(replace(replace(ColumnHeader,'\u0026','&'),'&#39;',''''),'quot;','"')
update ReportHlp Set
  DefaultHlpMsg = replace(replace(replace(DefaultHlpMsg,'\u0026','&'),'&#39;',''''),'quot;','"')
update ScreenCriHlp Set
  ColumnHeader = replace(replace(replace(ColumnHeader,'\u0026','&'),'&#39;',''''),'quot;','"')
update ScreenFilterHlp Set
  FilterName = replace(replace(replace(FilterName,'\u0026','&'),'&#39;',''''),'quot;','"')
update ScreenHlp Set
  DefaultHlpMsg = replace(replace(replace(DefaultHlpMsg,'\u0026','&'),'&#39;',''''),'quot;','"')
, FootNote = replace(replace(replace(FootNote,'\u0026','&'),'&#39;',''''),'quot;','"')
, AddMsg = replace(replace(replace(AddMsg,'\u0026','&'),'&#39;',''''),'quot;','"')
, UpdMsg = replace(replace(replace(UpdMsg,'\u0026','&'),'&#39;',''''),'quot;','"')
, DelMsg = replace(replace(replace(DelMsg,'\u0026','&'),'&#39;',''''),'quot;','"')
update ScreenObjHlp Set
  ToolTip = replace(replace(replace(ToolTip,'\u0026','&'),'&#39;',''''),'quot;','"')
, ErrMessage = replace(replace(replace(ErrMessage,'\u0026','&'),'&#39;',''''),'quot;','"')
update ScreenTabHlp Set
  TabFolderName = replace(replace(replace(TabFolderName,'\u0026','&'),'&#39;',''''),'quot;','"')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=471&typ=N&sys=3","","",""); return false;
472~@~   4.  16.91102:D:   20:*:*:M: Substitute apostrophy in Design~@~158~@~20~@~D~@~~@~~@~M~@~~@~Substitute apostrophy in Design~@~N~@~update AtCultureLbl Set
  CultureTypeLabel = replace(replace(replace(CultureTypeLabel,'\u0026','&'),'&#39;',''''),'quot;','"')
update CtCultureLbl Set
  CultureTypeLabel = replace(replace(replace(CultureTypeLabel,'\u0026','&'),'&#39;',''''),'quot;','"')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=472&typ=N&sys=3","","",""); return false;
473~@~   4.  19.91123:D:   10:*:*:M: Add columns to Usr~@~161~@~10~@~D~@~~@~~@~M~@~~@~Add columns to Usr~@~N~@~if not exists (select 1 from dbo.syscolumns where id = object_id('dbo.Usr') and name = 'PwdDuration')
	EXEC ('ALTER TABLE dbo.Usr ADD PwdDuration smallint not null default 9999')
if not exists (select 1 from dbo.syscolumns where id = object_id('dbo.Usr') and name = 'PwdWarn')
	EXEC ('ALTER TABLE dbo.Usr ADD PwdWarn smallint not null default 0')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=473&typ=N&sys=3","","",""); return false;
474~@~   4.  20.91208:D:   10:*:*:M: Duplicate tables for Report Generator~@~162~@~10~@~D~@~~@~~@~M~@~~@~Duplicate tables for Report Generator~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.UtReport'))
EXEC ('CREATE TABLE dbo.UtReport(ReportId int IDENTITY(1,1) NOT NULL, ProgramName varchar(20) NOT NULL, ReportDesc nvarchar(50) NULL, OrientationCd char(1) NOT NULL, ReportTypeCd char(1) NOT NULL, TemplateName varchar(50) NULL, RptTemplateId int NULL, CopyReportId int NULL, TopMargin decimal(8, 2) NOT NULL CONSTRAINT DF_UtReport_TopMargin  DEFAULT ((1)), BottomMargin decimal(8, 2) NOT NULL CONSTRAINT DF_UtReport_BottomMargin  DEFAULT ((1)), LeftMargin decimal(8, 2) NOT NULL CONSTRAINT DF_UtReport_LeftMargin  DEFAULT ((1)), RightMargin decimal(8, 2) NOT NULL CONSTRAINT DF_UtReport_RightMargin  DEFAULT ((1)), PageHeight decimal(8, 2) NOT NULL CONSTRAINT DF_UtReport_PageHeight  DEFAULT ((11)), PageWidth decimal(8, 2) NOT NULL CONSTRAINT DF_UtReport_PageWidth  DEFAULT ((8.5)), UnitCd char(2) NOT NULL CONSTRAINT DF_UtReport_UnitCd  DEFAULT (''in''), WhereClause varchar(1000) NULL, RegClause varchar(400) NULL, RegCode nvarchar(max) NULL, ValClause varchar(400) NULL, ValCode nvarchar(max) NULL, UpdClause varchar(200) NULL, UpdCode nvarchar(max) NULL, XlsClause varchar(200) NULL, XlsCode nvarchar(max) NULL, GenerateRp char(1) NOT NULL, AllowSelect char(1) NOT NULL CONSTRAINT DF_UtReport_AllowSelect  DEFAULT (''N''), ModifiedBy int NULL, ModifiedOn datetime NULL, LastGenDt datetime NULL, CompanyLs varchar(1000) NULL, CONSTRAINT PK_UtReport PRIMARY KEY CLUSTERED (ReportId ASC))')
IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.UtReportDel'))
EXEC ('CREATE TABLE dbo.UtReportDel(ReportId int NOT NULL, ProgramName varchar(50) NOT NULL, CONSTRAINT PK_UtReportDel PRIMARY KEY CLUSTERED (ReportId ASC))')
IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.UtReportHlp'))
EXEC ('CREATE TABLE dbo.UtReportHlp(ReportHlpId int IDENTITY(1,1) NOT NULL, ReportId int NOT NULL, CultureId smallint NOT NULL, DefaultHlpMsg nvarchar(max) NOT NULL, ReportTitle nvarchar(50) NOT NULL, CONSTRAINT PK_UtReportHlp PRIMARY KEY CLUSTERED (ReportHlpId ASC))')
IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.UtReportCriHlp'))
EXEC ('CREATE TABLE dbo.UtReportCriHlp(ReportCriHlpId int IDENTITY(1,1) NOT NULL, ReportCriHlpDesc varchar(200) NULL, ReportCriId int NOT NULL, CultureId smallint NOT NULL, ColumnHeader nvarchar(50) NULL, CONSTRAINT PK_UtReportCriHlp PRIMARY KEY CLUSTERED (ReportCriHlpId ASC))')
IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.UtReportCri'))
BEGIN
EXEC ('CREATE TABLE dbo.UtReportCri(ReportCriId int IDENTITY(1,1) NOT NULL, ReportId int NOT NULL, ReportCriDesc varchar(100) NULL, ReportGrpId int NOT NULL, LabelCss varchar(100) NULL, ContentCss varchar(100) NULL, TableId int NULL, TableAbbr varchar(10) NULL, ColumnName varchar(20) NOT NULL, TabIndex smallint NOT NULL, DataTypeId tinyint NOT NULL, DataTypeSize smallint NULL, DisplayModeId tinyint NOT NULL, ColumnSize smallint NULL, RowSize smallint NULL, DdlKeyColumnName varchar(50) NULL, DdlRefColumnName varchar(50) NULL, DdlSrtColumnName varchar(50) NULL, RequiredValid char(1) NOT NULL, WhereClause varchar(1000) NULL, RegClause varchar(400) NULL, CONSTRAINT PK_UtReportCri PRIMARY KEY CLUSTERED (ReportCriId ASC))')
EXEC ('ALTER TABLE dbo.UtReportCri WITH NOCHECK ADD CONSTRAINT FK_UtReportCri_UtReport FOREIGN KEY(ReportId) REFERENCES dbo.UtReport (ReportId)')
END
IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.UtReportObjHlp'))
EXEC ('CREATE TABLE dbo.UtReportObjHlp(ReportObjHlpId int IDENTITY(1,1) NOT NULL, ReportObjHlpDesc varchar(200) NULL, ReportObjId int NOT NULL, CultureId smallint NOT NULL, ColumnHeader nvarchar(50) NULL, HeaderWidth smallint NULL, CONSTRAINT PK_UtReportObjHlp PRIMARY KEY CLUSTERED (ReportObjHlpId ASC))')
IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.UtReportObj'))
BEGIN
EXEC ('CREATE TABLE dbo.UtReportObj(ReportObjId int IDENTITY(1,1) NOT NULL, ReportId int NOT NULL, RptObjTypeCd char(1) NOT NULL CONSTRAINT DF_UtReportObj_RptObjTypeCd  DEFAULT (''F''), ColumnName varchar(20) NOT NULL, ColumnDesc varchar(100) NULL, TabIndex smallint NOT NULL, ColumnFormat varchar(20) NULL, PaddSize tinyint NULL, PaddChar nchar(1) NULL, DataTypeId tinyint NOT NULL, OperatorId tinyint NULL, ReportCriId int NULL, CONSTRAINT PK_UtReportObj PRIMARY KEY CLUSTERED (ReportObjId ASC))')
EXEC ('ALTER TABLE dbo.UtReportObj  WITH NOCHECK ADD  CONSTRAINT FK_UtReportObj_UtReport FOREIGN KEY(ReportId) REFERENCES dbo.UtReport (ReportId)')
END
IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.UtRptElm'))
EXEC ('CREATE TABLE dbo.UtRptElm( RptElmId int IDENTITY(1,1) NOT NULL, RptElmDesc nvarchar(200) NULL, ReportId int NOT NULL, RptElmTypeCd char(1) NOT NULL, RptStyleId int NULL, ElmHeight decimal(8, 2) NOT NULL, ElmColumns smallint NULL, ElmColSpacing decimal(8, 2) NULL, ElmPrintFirst char(1) NOT NULL, ElmPrintLast char(1) NOT NULL, CONSTRAINT PK_UtRptElm PRIMARY KEY CLUSTERED (RptElmId ASC))')
IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.UtRptCtr'))
EXEC ('CREATE TABLE dbo.UtRptCtr( RptCtrId int IDENTITY(1,1) NOT NULL, RptCtrDesc nvarchar(200) NULL, PRptCtrId int NULL, RptElmId int NULL, RptCelId int NULL, ReportId int NOT NULL, RptCtrTypeCd char(1) NOT NULL, RptCtrName nvarchar(100) NOT NULL, RptStyleId int NULL, CtrTop decimal(8, 2) NULL, CtrLeft decimal(8, 2) NULL, CtrHeight decimal(8, 2) NULL, CtrWidth decimal(8, 2) NULL, CtrZIndex smallint NULL, CtrAction varchar(500) NULL, CtrGrouping int NULL, CtrVisibility char(1) NULL, CtrToggle int NULL, CtrToolTip nvarchar(200) NULL, CtrPgBrStart char(1) NOT NULL, CtrPgBrEnd char(1) NOT NULL, CtrValue nvarchar(1000) NULL, CtrCanGrow char(1) NOT NULL, CtrCanShrink char(1) NOT NULL, CtrTogether char(1) NOT NULL, CONSTRAINT PK_UtRptCtr PRIMARY KEY CLUSTERED (RptCtrId ASC))')
IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.UtRptCel'))
EXEC ('CREATE TABLE dbo.UtRptCel( RptCelId int IDENTITY(1,1) NOT NULL, RptCelDesc nvarchar(200) NULL, RptTblId int NOT NULL, RowNum smallint NOT NULL, RowHeight decimal(8, 2) NOT NULL, RowVisibility varchar(1000) NULL, CelNum smallint NOT NULL, CelColSpan smallint NULL, CONSTRAINT PK_UtRptCel PRIMARY KEY CLUSTERED (RptCelId ASC))')
IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.UtRptTbl'))
EXEC ('CREATE TABLE dbo.UtRptTbl(RptTblId int IDENTITY(1,1) NOT NULL, RptTblDesc nvarchar(200) NULL, ParentId int NULL, RptCtrId int NOT NULL, ReportId int NULL, RptTblTypeCd char(1) NOT NULL, TblRepeatNew char(1) NOT NULL, TblOrder smallint NULL, ColWidth decimal(8, 2) NULL, TblGrouping int NULL, TblVisibility char(1) NULL, TblToggle int NULL, CONSTRAINT PK_UtRptTbl PRIMARY KEY CLUSTERED (RptTblId ASC))')
IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.UtRptCha'))
EXEC ('CREATE TABLE dbo.UtRptCha(RptChaId int IDENTITY(1,1) NOT NULL, RptChaDesc nvarchar(200) NULL, RptCtrId int NOT NULL, ReportId int NULL, RptChaTypeCd char(2) NOT NULL, ThreeD char(1) NOT NULL, CategoryGrp int NOT NULL, ChartData nvarchar(1000) NOT NULL, SeriesGrp int NULL, CONSTRAINT PK_UtRptCha PRIMARY KEY CLUSTERED (RptChaId ASC))')
IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.UtRptMemCriDtl'))
EXEC ('CREATE TABLE dbo.UtRptMemCriDtl(RptMemCriDtlId int IDENTITY(1,1) NOT NULL, RptMemCriId int NOT NULL, ReportCriId int NOT NULL, MemCriteria nvarchar(900) NULL, CONSTRAINT PK_UtRptMemCriDtl PRIMARY KEY CLUSTERED (RptMemCriDtlId ASC))')
IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.UtRptMemCri'))
EXEC ('CREATE TABLE dbo.UtRptMemCri(RptMemCriId int IDENTITY(1,1) NOT NULL, RptMemFldId int NOT NULL, RptMemCriName nvarchar(200) NOT NULL, RptMemCriDesc nvarchar(500) NULL, RptMemCriLink varchar(200) NULL, ReportId int NOT NULL, UsrId int NULL, InputBy int NULL, InputOn datetime NULL, ModifiedOn datetime NULL, ViewedOn datetime NULL, CompanyLs varchar(1000) NULL, CONSTRAINT PK_UtRptMemCri PRIMARY KEY CLUSTERED (RptMemCriId ASC))')
IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.UtRptMemFld'))
EXEC ('CREATE TABLE dbo.UtRptMemFld(RptMemFldId int IDENTITY(1,1) NOT NULL, RptMemFldName nvarchar(200) NOT NULL, UsrId int NULL, InputBy int NULL, CompanyLs varchar(1000) NULL, AccessCd char(1) NOT NULL CONSTRAINT DF_UtRptMemFld_AccessCd DEFAULT (''V''), CONSTRAINT PK_UtRptMemFld PRIMARY KEY CLUSTERED (RptMemFldId ASC))')
IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.UtReportLstCri'))
EXEC ('CREATE TABLE dbo.UtReportLstCri(ReportLstCriId int IDENTITY(1,1) NOT NULL, UsrId int NOT NULL, ReportId int NOT NULL, ReportCriId int NOT NULL, LastCriteria nvarchar(900) NULL, CONSTRAINT PK_UtReportLstCri PRIMARY KEY CLUSTERED (ReportLstCriId ASC))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=474&typ=N&sys=3","","",""); return false;
475~@~   4.  20.91208:D:   20:*:*:M: Remove dangling records~@~162~@~20~@~D~@~~@~~@~M~@~~@~Remove dangling records~@~Y~@~EXEC ('DELETE FROM RptMemCri WHERE NOT EXISTS (SELECT 1 FROM Report WHERE Report.ReportId = RptMemCri.reportId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=475&typ=N&sys=3","","",""); return false;
476~@~   4.  20.91208:D:   30:*:*:M: Add column to Report, etc.~@~162~@~30~@~D~@~~@~~@~M~@~~@~Add column to Report, etc.~@~Y~@~if not exists (select 1 from dbo.syscolumns where id = object_id('dbo.Report') and name = 'CompanyLs')
	EXEC ('ALTER TABLE dbo.Report ADD CompanyLs varchar(1000) null')
if not exists (select 1 from dbo.syscolumns where id = object_id('dbo.RptMemCri') and name = 'CompanyLs')
	EXEC ('ALTER TABLE dbo.RptMemCri ADD CompanyLs varchar(1000) null')
if not exists (select 1 from dbo.syscolumns where id = object_id('dbo.DshFldDtl') and name = 'CompanyLs')
	EXEC ('ALTER TABLE dbo.DshFldDtl ADD CompanyLs varchar(1000) null')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=476&typ=N&sys=3","","",""); return false;
477~@~   4.  20.91208:D:   40:*:*:M: Change table Rptwiz~@~162~@~40~@~D~@~~@~~@~M~@~~@~Change table Rptwiz~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_Rptwiz (RptwizId int NOT NULL, RptwizName nvarchar(50) NOT NULL, RptwizDesc nvarchar(400) NOT NULL, RptwizTypeCd char(1) NOT NULL, RptwizCatId smallint NOT NULL, TemplateName varchar(50) NULL, ReportId int NULL, Changeable char(1) NOT NULL, UsrId int NOT NULL, TopMargin decimal(8,2) NULL, BottomMargin decimal(8,2) NULL, LeftMargin decimal(8,2) NULL, RightMargin decimal(8,2) NULL, OrientationCd char(1) NOT NULL, UnitCd char(2) NOT NULL, RptChaTypeCd char(2) NULL, ThreeD char(1) NOT NULL, GMinValue decimal(19,4) NULL, GLowRange decimal(19,4) NULL, GMidRange decimal(19,4) NULL, GMaxValue decimal(19,4) NULL, GNeedle decimal(19,4) NULL, GMinValueId int NULL, GLowRangeId int NULL, GMidRangeId int NULL, GMaxValueId int NULL, GNeedleId int NULL, GPositive char(1) NULL, GFormat char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Rptwiz (RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, TemplateName, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, OrientationCd, UnitCd, RptChaTypeCd, ThreeD, GMinValue, GLowRange, GMidRange, GMaxValue, GNeedle, GMinValueId, GLowRangeId, GMidRangeId, GMaxValueId, GNeedleId, GPositive, GFormat) SELECT convert(int,RptwizId), RptwizName, RptwizDesc, RptwizTypeCd, convert(smallint,RptwizCatId), TemplateName, convert(int,ReportId), Changeable, convert(int,UsrId), convert(decimal(8,2),TopMargin), convert(decimal(8,2),BottomMargin), convert(decimal(8,2),LeftMargin), convert(decimal(8,2),RightMargin), OrientationCd, UnitCd, RptChaTypeCd, ThreeD, convert(decimal(19,4),GMinValue), convert(decimal(19,4),GLowRange), convert(decimal(19,4),GMidRange), convert(decimal(19,4),GMaxValue), convert(decimal(19,4),GNeedle), convert(int,GMinValueId), convert(int,GLowRangeId), convert(int,GMidRangeId), convert(int,GMaxValueId), convert(int,GNeedleId), GPositive, GFormat FROM dbo.Rptwiz IF (SELECT COUNT(1) FROM dbo.Tmp_Rptwiz) > 0 OR (SELECT COUNT(1) FROM dbo.Rptwiz) = 0 DROP TABLE dbo.Rptwiz') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Rptwiz'')) CREATE TABLE dbo.Rptwiz (RptwizId Int IDENTITY NOT NULL, RptwizName NVarChar(50) NOT NULL, RptwizDesc NVarChar(400) NOT NULL, RptwizTypeCd Char(1) NOT NULL, RptwizCatId SmallInt NOT NULL, TemplateName VarChar(50) NULL, ReportId Int NULL, AccessCd Char(1) NOT NULL, UsrId Int NOT NULL, TopMargin Decimal(8,2) NULL, BottomMargin Decimal(8,2) NULL, LeftMargin Decimal(8,2) NULL, RightMargin Decimal(8,2) NULL, OrientationCd Char(1) NOT NULL, UnitCd Char(2) NOT NULL, RptChaTypeCd Char(2) NULL, ThreeD Char(1) NOT NULL, GMinValue Decimal(19,4) NULL, GLowRange Decimal(19,4) NULL, GMidRange Decimal(19,4) NULL, GMaxValue Decimal(19,4) NULL, GNeedle Decimal(19,4) NULL, GMinValueId Int NULL, GLowRangeId Int NULL, GMidRangeId Int NULL, GMaxValueId Int NULL, GNeedleId Int NULL, GPositive Char(1) NULL, GFormat Char(1) NULL, CONSTRAINT PK_Rptwiz PRIMARY KEY CLUSTERED (RptwizId))') EXEC (' ALTER TABLE dbo.Rptwiz ADD CONSTRAINT DF_Rptwiz_OrientationCd DEFAULT (''Y'') FOR OrientationCd ALTER TABLE dbo.Rptwiz ADD CONSTRAINT DF_Rptwiz_UnitCd DEFAULT (''in'') FOR UnitCd ALTER TABLE dbo.Rptwiz ADD CONSTRAINT DF_Rptwiz_ThreeD DEFAULT (''N'') FOR ThreeD SET IDENTITY_INSERT dbo.Rptwiz ON INSERT INTO dbo.Rptwiz (RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, TemplateName, ReportId, AccessCd, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, OrientationCd, UnitCd, RptChaTypeCd, ThreeD, GMinValue, GLowRange, GMidRange, GMaxValue, GNeedle, GMinValueId, GLowRangeId, GMidRangeId, GMaxValueId, GNeedleId, GPositive, GFormat) SELECT RptwizId, RptwizName, RptwizDesc, RptwizTypeCd, RptwizCatId, TemplateName, ReportId, Changeable, UsrId, TopMargin, BottomMargin, LeftMargin, RightMargin, OrientationCd, UnitCd, RptChaTypeCd, ThreeD, GMinValue, GLowRange, GMidRange, GMaxValue, GNeedle, GMinValueId, GLowRangeId, GMidRangeId, GMaxValueId, GNeedleId, GPositive, GFormat FROM dbo.Tmp_Rptwiz SET IDENTITY_INSERT dbo.Rptwiz OFF IF (SELECT COUNT(1) FROM dbo.Rptwiz) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Rptwiz) = 0 DROP TABLE dbo.Tmp_Rptwiz')
EXEC ('UPDATE dbo.RptWiz SET AccessCd = ''P''')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=477&typ=N&sys=3","","",""); return false;
478~@~   4.  21.91217:D:   10:*:*:M: Change Miscellaneous in Menu~@~163~@~10~@~D~@~~@~~@~M~@~~@~Change Miscellaneous in Menu~@~Y~@~EXEC ('ALTER TABLE Menu ALTER COLUMN Miscellaneous varchar(100) null')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=478&typ=N&sys=3","","",""); return false;
479~@~   5.   4.10221:D:   10:*:*:M: Remove table CtMenuOption~@~171~@~10~@~D~@~~@~~@~M~@~~@~Remove table CtMenuOption~@~N~@~IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtMenuOption')) EXEC ('drop table dbo.CtMenuOption')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=479&typ=N&sys=3","","",""); return false;
480~@~   5.   4.10221:D:   20:*:*:M: Change table UsrPref~@~171~@~20~@~D~@~~@~~@~M~@~~@~Change table UsrPref~@~N~@~IF EXISTS (SELECT 1 FROM dbo.syscolumns WHERE name = 'MenuOption' and id = object_id('UsrPref'))
BEGIN
	IF EXISTS (SELECT 1 from sysobjects where name = 'DF_UsrPref_PrjListVisible') EXEC ('ALTER TABLE dbo.UsrPref DROP CONSTRAINT DF_UsrPref_PrjListVisible')
	EXEC ('CREATE TABLE dbo.Tmp_UsrPref (
		UsrPrefId int NOT NULL IDENTITY (1, 1),
		UsrId int NULL,
		UsrGroupId smallint NULL,
		CompanyId smallint NULL,
		MemberId int NULL,
		AgentId int NULL,
		BrokerId int NULL,
		CustomerId int NULL,
		InvestorId int NULL,
		VendorId int NULL,
		ProjectId smallint NULL,
		SystemId tinyint NULL,
		PrefDefault char(1) NOT NULL,
		UsrPrefDesc nvarchar(50) NOT NULL,
		SysListVisible char(1) NOT NULL,
		ComListVisible char(1) NOT NULL,
		PrjListVisible char(1) NOT NULL,
		MenuOptId int NOT NULL,
		PageBannerImg varchar(100) NULL,
		UsrStyleSheet varchar(MAX) NULL,
		SplashImg varchar(100) NULL)
		SET IDENTITY_INSERT dbo.Tmp_UsrPref ON
		INSERT INTO dbo.Tmp_UsrPref (UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOptId, PageBannerImg, UsrStyleSheet, SplashImg)
		SELECT UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, 2, PageBannerImg, UsrStyleSheet, SplashImg FROM dbo.UsrPref
		SET IDENTITY_INSERT dbo.Tmp_UsrPref OFF
		DROP TABLE dbo.UsrPref
		EXEC sp_rename ''dbo.Tmp_UsrPref'', ''UsrPref'', ''OBJECT''
		ALTER TABLE dbo.UsrPref ADD CONSTRAINT PK_UsrPref PRIMARY KEY CLUSTERED (UsrPrefId)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=480&typ=N&sys=3","","",""); return false;
481~@~   5.   4.10221:D:   30:*:*:M: Change table Menu~@~171~@~30~@~D~@~~@~~@~M~@~~@~Change table Menu~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.syscolumns WHERE name = 'IconUrl' and id = object_id('Menu'))
BEGIN
	EXEC ('CREATE TABLE dbo.Tmp_Menu (
	MenuId int NOT NULL IDENTITY (1, 1),
	MenuIndex smallint NOT NULL,
	MenuName varchar(30) NOT NULL,
	MenuDesc nvarchar(100) NULL,
	Miscellaneous varchar(500) NULL,
	ParentId int NULL,
	ReportId int NULL,
	ScreenId int NULL,
	WizardId int NULL,
	IconUrl nvarchar(500) NULL)
	SET IDENTITY_INSERT dbo.Tmp_Menu ON
	INSERT INTO dbo.Tmp_Menu (MenuId, MenuIndex, MenuName, MenuDesc, Miscellaneous, ParentId, ReportId, ScreenId, WizardId)
		SELECT MenuId, MenuIndex, MenuName, MenuDesc, Miscellaneous, ParentId, ReportId, ScreenId, WizardId FROM dbo.Menu
	SET IDENTITY_INSERT dbo.Tmp_Menu OFF
	ALTER TABLE dbo.MenuHlp DROP CONSTRAINT FK_MenuHlp_Menu
	DROP TABLE dbo.Menu
	EXECUTE sp_rename ''dbo.Tmp_Menu'', ''Menu'', ''OBJECT'' 
	ALTER TABLE dbo.Menu ADD CONSTRAINT PK_Menu PRIMARY KEY CLUSTERED (MenuId)
	CREATE NONCLUSTERED INDEX IX_Menu_ParentId ON dbo.Menu (ParentId,MenuIndex)')
	EXEC ('ALTER TABLE dbo.MenuHlp ADD CONSTRAINT FK_MenuHlp_Menu FOREIGN KEY (MenuId) REFERENCES dbo.Menu (MenuId)')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=481&typ=N&sys=3","","",""); return false;
482~@~   5.  12.10511:D:   10:*:*:M: Change table MenuHlp~@~179~@~10~@~D~@~~@~~@~M~@~~@~Change table MenuHlp~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_MenuHlp_Menu'') ALTER TABLE dbo.MenuHlp DROP CONSTRAINT FK_MenuHlp_Menu CREATE TABLE dbo.Tmp_MenuHlp (MenuHlpId int NOT NULL, MenuId int NOT NULL, CultureId smallint NOT NULL, MenuText nvarchar(30) NOT NULL)') EXEC (' INSERT INTO dbo.Tmp_MenuHlp (MenuHlpId, MenuId, CultureId, MenuText) SELECT convert(int,MenuHlpId), convert(int,MenuId), convert(smallint,CultureId), MenuText FROM dbo.MenuHlp IF (SELECT COUNT(1) FROM dbo.Tmp_MenuHlp) > 0 OR (SELECT COUNT(1) FROM dbo.MenuHlp) = 0 DROP TABLE dbo.MenuHlp') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.MenuHlp'')) CREATE TABLE dbo.MenuHlp (MenuHlpId Int IDENTITY NOT NULL, MenuId Int NOT NULL, CultureId SmallInt NOT NULL, MenuText NVarChar(50) NOT NULL, CONSTRAINT PK_MenuHlp PRIMARY KEY CLUSTERED (MenuHlpId))') EXEC (' SET IDENTITY_INSERT dbo.MenuHlp ON INSERT INTO dbo.MenuHlp (MenuHlpId, MenuId, CultureId, MenuText) SELECT MenuHlpId, MenuId, CultureId, MenuText FROM dbo.Tmp_MenuHlp SET IDENTITY_INSERT dbo.MenuHlp OFF IF (SELECT COUNT(1) FROM dbo.MenuHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_MenuHlp) = 0 DROP TABLE dbo.Tmp_MenuHlp CREATE  UNIQUE NONCLUSTERED INDEX IX_MenuHlp_MenuId ON dbo.MenuHlp (CultureId,MenuId) ALTER TABLE dbo.MenuHlp WITH NOCHECK ADD CONSTRAINT FK_MenuHlp_Menu FOREIGN KEY (MenuId) REFERENCES dbo.Menu (MenuId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=482&typ=N&sys=3","","",""); return false;
483~@~   5.  13.10622:D:   10:*:*:M: Change index on Label~@~180~@~10~@~D~@~~@~~@~M~@~~@~Change index on Label~@~Y~@~EXEC ('DROP INDEX Label.IX_Label')
EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_Label ON dbo.Label 
(
	CultureId,
	LabelCat,
	LabelKey,
	CompanyId
)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=483&typ=N&sys=3","","",""); return false;
486~@~   5.  14.10707:D:   10:*:*:M: Change table Label's LabelCat to not null~@~181~@~10~@~D~@~~@~~@~M~@~~@~Change table Label's LabelCat to not null~@~Y~@~EXEC ('UPDATE dbo.Label set LabelCat = LabelKey WHERE LabelCat is null')
EXEC ('CREATE TABLE dbo.Tmp_Label (LabelId int NOT NULL, CultureId smallint NOT NULL, LabelCat varchar(50) NULL, LabelKey varchar(50) NOT NULL, LabelText nvarchar(1000) NOT NULL, CompanyId smallint NULL, SortOrder smallint NULL)')
EXEC ('INSERT INTO dbo.Tmp_Label (LabelId, CultureId, LabelCat, LabelKey, LabelText, CompanyId, SortOrder) SELECT convert(int,LabelId), convert(smallint,CultureId), LabelCat, LabelKey, LabelText, convert(smallint,CompanyId), convert(smallint,SortOrder) FROM dbo.Label IF (SELECT COUNT(1) FROM dbo.Tmp_Label) > 0 OR (SELECT COUNT(1) FROM dbo.Label) = 0 DROP TABLE dbo.Label')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Label'')) CREATE TABLE dbo.Label (LabelId Int IDENTITY NOT NULL, CultureId SmallInt NOT NULL, LabelCat VarChar(50) NOT NULL, LabelKey VarChar(50) NOT NULL, LabelText NVarChar(1000) NOT NULL, CompanyId SmallInt NULL, SortOrder SmallInt NULL, CONSTRAINT PK_Label PRIMARY KEY CLUSTERED (LabelId))')
EXEC ('SET IDENTITY_INSERT dbo.Label ON INSERT INTO dbo.Label (LabelId, CultureId, LabelCat, LabelKey, LabelText, CompanyId, SortOrder) SELECT LabelId, CultureId, LabelCat, LabelKey, LabelText, CompanyId, SortOrder FROM dbo.Tmp_Label SET IDENTITY_INSERT dbo.Label OFF IF (SELECT COUNT(1) FROM dbo.Label) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Label) = 0 DROP TABLE dbo.Tmp_Label')
EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_Label ON dbo.Label (CultureId,LabelCat,LabelKey,CompanyId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=486&typ=N&sys=3","","",""); return false;
487~@~   5.  21.10914:D:   10:*:*:M: Change table Screen~@~188~@~10~@~D~@~~@~~@~M~@~~@~Change table Screen~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenCri_Screen'') ALTER TABLE dbo.ScreenCri DROP CONSTRAINT FK_ScreenCri_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenHlp_Screen'') ALTER TABLE dbo.ScreenHlp DROP CONSTRAINT FK_ScreenHlp_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_Screen'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_Screen CREATE TABLE dbo.Tmp_Screen (ScreenId int NOT NULL, ProgramName varchar(20) NOT NULL, ScreenDesc nvarchar(50) NULL, ScreenTypeId tinyint NOT NULL, MasterTableId int NULL, DetailTableId int NULL, SearchId smallint NULL, SearchWidth smallint NULL, SearchAscending char(1) NOT NULL, GridRows tinyint NULL, GridClass varchar(30) NULL, GridTitle nvarchar(50) NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL, GenerateSc char(1) NOT NULL, HasDeleteAll char(1) NOT NULL, ValidateReq char(1) NOT NULL, DeferError char(1) NULL)')
 EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq, DeferError) SELECT convert(int,ScreenId), ProgramName, ScreenDesc, convert(tinyint,ScreenTypeId), convert(int,MasterTableId), convert(int,DetailTableId), convert(smallint,SearchId), convert(smallint,SearchWidth), SearchAscending, convert(tinyint,GridRows), GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq, DeferError FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen')
 EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchId SmallInt NULL, SearchWidth SmallInt NULL, SearchAscending Char(1) NOT NULL, SearchMode Char(1) NOT NULL, GridRows TinyInt NULL, GridClass VarChar(30) NULL, GridTitle NVarChar(50) NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))')
 EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_SearchMode DEFAULT (''A'') FOR SearchMode ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq, DeferError) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, ''A'', GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq, DeferError FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen CREATE  UNIQUE NONCLUSTERED INDEX IX_Screen_ProgramName ON dbo.Screen (ProgramName) ALTER TABLE dbo.ScreenCri WITH NOCHECK ADD CONSTRAINT FK_ScreenCri_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenHlp WITH NOCHECK ADD CONSTRAINT FK_ScreenHlp_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenObj WITH NOCHECK ADD CONSTRAINT FK_ScreenObj_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=487&typ=N&sys=3","","",""); return false;
488~@~   5.  21.10914:D:   20:*:*:M: Change table CtSearchMode~@~188~@~20~@~D~@~~@~~@~M~@~~@~Change table CtSearchMode~@~N~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtSearchMode'')) CREATE TABLE dbo.CtSearchMode (SearchCd Char(1) NOT NULL, SearchName NVarChar(20) NOT NULL, CONSTRAINT PK_CtSearchMode PRIMARY KEY CLUSTERED (SearchCd))')
IF NOT EXISTS (SELECT 1 FROM dbo.CtSearchMode WHERE SearchCd = 'A')
BEGIN
	EXEC ('INSERT dbo.CtSearchMode VALUES (''A'',''Auto Complete'')')
	EXEC ('INSERT dbo.CtSearchMode VALUES (''C'',''Combo Box'')')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=488&typ=N&sys=3","","",""); return false;
493~@~   6.   2.11011:D:   10:*:*:M: Change table Label~@~192~@~10~@~D~@~~@~~@~M~@~~@~Change table Label~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Label (LabelId int NULL, CultureId smallint NULL, LabelCat varchar(50) NULL, LabelKey varchar(50) NULL, LabelText nvarchar(1000) NULL, CompanyId smallint NULL, SortOrder smallint NULL)') EXEC (' INSERT INTO dbo.Tmp_Label (LabelId, CultureId, LabelCat, LabelKey, LabelText, CompanyId, SortOrder) SELECT convert(int,LabelId), convert(smallint,CultureId), LabelCat, LabelKey, LabelText, convert(smallint,CompanyId), convert(smallint,SortOrder) FROM dbo.Label IF (SELECT COUNT(1) FROM dbo.Tmp_Label) > 0 OR (SELECT COUNT(1) FROM dbo.Label) = 0 DROP TABLE dbo.Label') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Label'')) CREATE TABLE dbo.Label (LabelId Int IDENTITY NOT NULL, CultureId SmallInt NOT NULL, LabelCat VarChar(50) NOT NULL, LabelKey VarChar(50) NOT NULL, LabelText NVarChar(max) NOT NULL, CompanyId SmallInt NULL, SortOrder SmallInt NULL, CONSTRAINT PK_Label PRIMARY KEY CLUSTERED (LabelId))') EXEC (' ALTER TABLE dbo.Label ADD CONSTRAINT DF_Label_LabelCat DEFAULT (''NA'') FOR LabelCat SET IDENTITY_INSERT dbo.Label ON INSERT INTO dbo.Label (LabelId, CultureId, LabelCat, LabelKey, LabelText, CompanyId, SortOrder) SELECT LabelId, CultureId, LabelCat, LabelKey, LabelText, CompanyId, SortOrder FROM dbo.Tmp_Label SET IDENTITY_INSERT dbo.Label OFF IF (SELECT COUNT(1) FROM dbo.Label) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Label) = 0 DROP TABLE dbo.Tmp_Label CREATE  UNIQUE NONCLUSTERED INDEX IX_Label ON dbo.Label (CultureId,LabelCat,LabelKey,CompanyId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=493&typ=N&sys=3","","",""); return false;
494~@~   6.   4.11017:D:   10:*:*:M: Change table Screen~@~194~@~10~@~D~@~~@~~@~M~@~~@~Change table Screen~@~Y~@~ EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenCri_Screen'') ALTER TABLE dbo.ScreenCri DROP CONSTRAINT FK_ScreenCri_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenHlp_Screen'') ALTER TABLE dbo.ScreenHlp DROP CONSTRAINT FK_ScreenHlp_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_Screen'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_Screen CREATE TABLE dbo.Tmp_Screen (ScreenId int NULL, ProgramName varchar(20) NULL, ScreenDesc nvarchar(50) NULL, ScreenTypeId tinyint NULL, MasterTableId int NULL, DetailTableId int NULL, SearchId smallint NULL, SearchWidth smallint NULL, SearchAscending char(1) NULL, SearchMode char(1) NULL, GridRows tinyint NULL, GridClass varchar(30) NULL, GridTitle nvarchar(50) NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL, GenerateSc char(1) NULL, HasDeleteAll char(1) NULL, ValidateReq char(1) NULL, DeferError char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq, DeferError) SELECT convert(int,ScreenId), ProgramName, ScreenDesc, convert(tinyint,ScreenTypeId), convert(int,MasterTableId), convert(int,DetailTableId), convert(smallint,SearchId), convert(smallint,SearchWidth), SearchAscending, SearchMode, convert(tinyint,GridRows), GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq, DeferError FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchId SmallInt NULL, SearchWidth SmallInt NULL, SearchAscending Char(1) NOT NULL, SearchMode Char(1) NOT NULL, GridRows TinyInt NULL, GridClass VarChar(30) NULL, GridTitle NVarChar(50) NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, MasterPageFile VarChar(100) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_SearchMode DEFAULT (''A'') FOR SearchMode ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_MasterPageFile DEFAULT (''Default.master'') FOR MasterPageFile SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq, DeferError, MasterPageFile) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq, DeferError, ''Default.master'' FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen CREATE  UNIQUE NONCLUSTERED INDEX IX_Screen_ProgramName ON dbo.Screen (ProgramName) ALTER TABLE dbo.ScreenCri WITH NOCHECK ADD CONSTRAINT FK_ScreenCri_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenHlp WITH NOCHECK ADD CONSTRAINT FK_ScreenHlp_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenObj WITH NOCHECK ADD CONSTRAINT FK_ScreenObj_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=494&typ=N&sys=3","","",""); return false;
496~@~   6.   9.20103:D:   10:*:*:M: Change table Screen~@~199~@~10~@~D~@~~@~~@~M~@~~@~Change table Screen~@~Y~@~ EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenCri_Screen'') ALTER TABLE dbo.ScreenCri DROP CONSTRAINT FK_ScreenCri_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenHlp_Screen'') ALTER TABLE dbo.ScreenHlp DROP CONSTRAINT FK_ScreenHlp_Screen IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ScreenObj_Screen'') ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_Screen CREATE TABLE dbo.Tmp_Screen (ScreenId int NULL, ProgramName varchar(20) NULL, ScreenDesc nvarchar(50) NULL, ScreenTypeId tinyint NULL, MasterTableId int NULL, DetailTableId int NULL, SearchId smallint NULL, SearchWidth smallint NULL, SearchAscending char(1) NULL, SearchMode char(1) NULL, GridRows tinyint NULL, GridClass varchar(30) NULL, GridTitle nvarchar(50) NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL, GenerateSc char(1) NULL, HasDeleteAll char(1) NULL, ValidateReq char(1) NULL, DeferError char(1) NULL, MasterPageFile varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq, DeferError, MasterPageFile) SELECT convert(int,ScreenId), ProgramName, ScreenDesc, convert(tinyint,ScreenTypeId), convert(int,MasterTableId), convert(int,DetailTableId), convert(smallint,SearchId), convert(smallint,SearchWidth), SearchAscending, SearchMode, convert(tinyint,GridRows), GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq, DeferError, MasterPageFile FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchId SmallInt NULL, SearchWidth SmallInt NULL, SearchAscending Char(1) NOT NULL, SearchMode Char(1) NOT NULL, GridRows TinyInt NULL, GridClass VarChar(30) NULL, GridTitle NVarChar(50) NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, MasterPageFile VarChar(100) NOT NULL, NeedRegen Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_SearchMode DEFAULT (''A'') FOR SearchMode ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_MasterPageFile DEFAULT (''Default.master'') FOR MasterPageFile ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NeedRegen DEFAULT (''N'') FOR NeedRegen SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq, DeferError, MasterPageFile, NeedRegen) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq, DeferError, MasterPageFile, ''N'' FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen CREATE  UNIQUE NONCLUSTERED INDEX IX_Screen_ProgramName ON dbo.Screen (ProgramName) ALTER TABLE dbo.ScreenCri WITH NOCHECK ADD CONSTRAINT FK_ScreenCri_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenHlp WITH NOCHECK ADD CONSTRAINT FK_ScreenHlp_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId) ALTER TABLE dbo.ScreenObj WITH NOCHECK ADD CONSTRAINT FK_ScreenObj_Screen FOREIGN KEY (ScreenId) REFERENCES dbo.Screen (ScreenId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=496&typ=N&sys=3","","",""); return false;
497~@~   6.   9.20103:D:   20:*:*:M: Change table ScreenDel~@~199~@~20~@~D~@~~@~~@~M~@~~@~Change table ScreenDel~@~Y~@~EXEC ('DROP TABLE dbo.ScreenDel')
EXEC ('CREATE TABLE dbo.ScreenDel(ScreenDelId int IDENTITY(1,1) NOT NULL, ScreenId int NOT NULL, ProgramName varchar(100) NOT NULL, MultiDesignDb char(1) NOT NULL, CONSTRAINT PK_ScreenDel PRIMARY KEY CLUSTERED (ScreenDelId))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=497&typ=N&sys=3","","",""); return false;
498~@~   6.   9.20103:D:   30:*:*:M: Change table ReportDel~@~199~@~30~@~D~@~~@~~@~M~@~~@~Change table ReportDel~@~Y~@~EXEC ('DROP TABLE dbo.ReportDel')
EXEC ('CREATE TABLE dbo.ReportDel(ReportDelId int IDENTITY(1,1) NOT NULL, ReportId int NOT NULL, ProgramName varchar(100) NOT NULL, CONSTRAINT PK_ReportDel PRIMARY KEY CLUSTERED (ReportDelId))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=498&typ=N&sys=3","","",""); return false;
499~@~   6.   9.20103:D:   40:*:*:M: Change table WizardDel~@~199~@~40~@~D~@~~@~~@~M~@~~@~Change table WizardDel~@~Y~@~EXEC ('DROP TABLE dbo.WizardDel')
EXEC ('CREATE TABLE dbo.WizardDel(WizardDelId int IDENTITY(1,1) NOT NULL, WizardId int NOT NULL, ProgramName varchar(100) NOT NULL, CONSTRAINT PK_WizardDel PRIMARY KEY CLUSTERED (WizardDelId))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=499&typ=N&sys=3","","",""); return false;
500~@~   6.  10.20109:D:   10:*:*:M: Change table Report~@~200~@~10~@~D~@~~@~~@~M~@~~@~Change table Report~@~Y~@~ EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportCri_Report'') ALTER TABLE dbo.ReportCri DROP CONSTRAINT FK_ReportCri_Report IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_ReportObj_Report'') ALTER TABLE dbo.ReportObj DROP CONSTRAINT FK_ReportObj_Report CREATE TABLE dbo.Tmp_Report (ReportId int NULL, ProgramName varchar(20) NULL, ReportDesc nvarchar(50) NULL, OrientationCd char(1) NULL, ReportTypeCd char(1) NULL, TemplateName varchar(50) NULL, RptTemplateId int NULL, CopyReportId int NULL, TopMargin decimal(8,2) NULL, BottomMargin decimal(8,2) NULL, LeftMargin decimal(8,2) NULL, RightMargin decimal(8,2) NULL, PageHeight decimal(8,2) NULL, PageWidth decimal(8,2) NULL, UnitCd char(2) NULL, WhereClause varchar(1000) NULL, RegClause varchar(400) NULL, RegCode nvarchar(max) NULL, ValClause varchar(400) NULL, ValCode nvarchar(max) NULL, UpdClause varchar(200) NULL, UpdCode nvarchar(max) NULL, XlsClause varchar(200) NULL, XlsCode nvarchar(max) NULL, GenerateRp char(1) NULL, AllowSelect char(1) NULL, ModifiedBy int NULL, ModifiedOn datetime NULL, LastGenDt datetime NULL, CompanyLs varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_Report (ReportId, ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, RptTemplateId, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, ModifiedBy, ModifiedOn, LastGenDt, CompanyLs) SELECT convert(int,ReportId), ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, convert(int,RptTemplateId), convert(int,CopyReportId), convert(decimal(8,2),TopMargin), convert(decimal(8,2),BottomMargin), convert(decimal(8,2),LeftMargin), convert(decimal(8,2),RightMargin), convert(decimal(8,2),PageHeight), convert(decimal(8,2),PageWidth), UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, convert(int,ModifiedBy), ModifiedOn, LastGenDt, CompanyLs FROM dbo.Report IF (SELECT COUNT(1) FROM dbo.Tmp_Report) > 0 OR (SELECT COUNT(1) FROM dbo.Report) = 0 DROP TABLE dbo.Report') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Report'')) CREATE TABLE dbo.Report (ReportId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ReportDesc NVarChar(50) NULL, OrientationCd Char(1) NOT NULL, ReportTypeCd Char(1) NOT NULL, TemplateName VarChar(50) NULL, RptTemplateId Int NULL, CopyReportId Int NULL, TopMargin Decimal(8,2) NOT NULL, BottomMargin Decimal(8,2) NOT NULL, LeftMargin Decimal(8,2) NOT NULL, RightMargin Decimal(8,2) NOT NULL, PageHeight Decimal(8,2) NOT NULL, PageWidth Decimal(8,2) NOT NULL, UnitCd Char(2) NOT NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, RegCode NVarChar(max) NULL, ValClause VarChar(400) NULL, ValCode NVarChar(max) NULL, UpdClause VarChar(200) NULL, UpdCode NVarChar(max) NULL, XlsClause VarChar(200) NULL, XlsCode NVarChar(max) NULL, GenerateRp Char(1) NOT NULL, AllowSelect Char(1) NOT NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, CompanyLs VarChar(1000) NULL, NeedRegen Char(1) NOT NULL, CONSTRAINT PK_Report PRIMARY KEY CLUSTERED (ReportId))') EXEC (' ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_TopMargin DEFAULT (1) FOR TopMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_BottomMargin DEFAULT (1) FOR BottomMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_LeftMargin DEFAULT (1) FOR LeftMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_RightMargin DEFAULT (1) FOR RightMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_PageHeight DEFAULT (11) FOR PageHeight ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_PageWidth DEFAULT (8.5) FOR PageWidth ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_UnitCd DEFAULT (''in'') FOR UnitCd ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_AllowSelect DEFAULT (''N'') FOR AllowSelect ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_NeedRegen DEFAULT (''N'') FOR NeedRegen SET IDENTITY_INSERT dbo.Report ON INSERT INTO dbo.Report (ReportId, ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, RptTemplateId, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, ModifiedBy, ModifiedOn, LastGenDt, CompanyLs, NeedRegen) SELECT ReportId, ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, RptTemplateId, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, ModifiedBy, ModifiedOn, LastGenDt, CompanyLs, ''N'' FROM dbo.Tmp_Report SET IDENTITY_INSERT dbo.Report OFF IF (SELECT COUNT(1) FROM dbo.Report) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Report) = 0 DROP TABLE dbo.Tmp_Report CREATE  UNIQUE NONCLUSTERED INDEX IX_Report_ProgramName ON dbo.Report (ProgramName) ALTER TABLE dbo.ReportCri WITH NOCHECK ADD CONSTRAINT FK_ReportCri_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId) ALTER TABLE dbo.ReportObj WITH NOCHECK ADD CONSTRAINT FK_ReportObj_Report FOREIGN KEY (ReportId) REFERENCES dbo.Report (ReportId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=500&typ=N&sys=3","","",""); return false;
501~@~   6.  10.20109:D:   20:*:*:M: Change table Wizard~@~200~@~20~@~D~@~~@~~@~M~@~~@~Change table Wizard~@~Y~@~ EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_WizardObj_Wizard'') ALTER TABLE dbo.WizardObj DROP CONSTRAINT FK_WizardObj_Wizard CREATE TABLE dbo.Tmp_Wizard (WizardId int NULL, WizardTypeId tinyint NULL, MasterTableId int NULL, WizardTitle nvarchar(50) NULL, ProgramName varchar(50) NULL, DefWorkSheet nvarchar(50) NULL, DefStartRow smallint NULL, DefOverwrite char(1) NULL, OvwrReadonly char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Wizard (WizardId, WizardTypeId, MasterTableId, WizardTitle, ProgramName, DefWorkSheet, DefStartRow, DefOverwrite, OvwrReadonly) SELECT convert(int,WizardId), convert(tinyint,WizardTypeId), convert(int,MasterTableId), WizardTitle, ProgramName, DefWorkSheet, convert(smallint,DefStartRow), DefOverwrite, OvwrReadonly FROM dbo.Wizard IF (SELECT COUNT(1) FROM dbo.Tmp_Wizard) > 0 OR (SELECT COUNT(1) FROM dbo.Wizard) = 0 DROP TABLE dbo.Wizard') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Wizard'')) CREATE TABLE dbo.Wizard (WizardId Int IDENTITY NOT NULL, WizardTypeId TinyInt NOT NULL, MasterTableId Int NOT NULL, WizardTitle NVarChar(50) NOT NULL, ProgramName VarChar(50) NOT NULL, DefWorkSheet NVarChar(50) NOT NULL, DefStartRow SmallInt NOT NULL, DefOverwrite Char(1) NOT NULL, OvwrReadonly Char(1) NOT NULL, NeedRegen Char(1) NOT NULL, CONSTRAINT PK_Wizard PRIMARY KEY CLUSTERED (WizardId))') EXEC (' ALTER TABLE dbo.Wizard ADD CONSTRAINT DF_Wizard_NeedRegen DEFAULT (''N'') FOR NeedRegen SET IDENTITY_INSERT dbo.Wizard ON INSERT INTO dbo.Wizard (WizardId, WizardTypeId, MasterTableId, WizardTitle, ProgramName, DefWorkSheet, DefStartRow, DefOverwrite, OvwrReadonly, NeedRegen) SELECT WizardId, WizardTypeId, MasterTableId, WizardTitle, ProgramName, DefWorkSheet, DefStartRow, DefOverwrite, OvwrReadonly, ''N'' FROM dbo.Tmp_Wizard SET IDENTITY_INSERT dbo.Wizard OFF IF (SELECT COUNT(1) FROM dbo.Wizard) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Wizard) = 0 DROP TABLE dbo.Tmp_Wizard CREATE  UNIQUE NONCLUSTERED INDEX IX_Wizard_ProgramName ON dbo.Wizard (ProgramName) ALTER TABLE dbo.WizardObj WITH NOCHECK ADD CONSTRAINT FK_WizardObj_Wizard FOREIGN KEY (WizardId) REFERENCES dbo.Wizard (WizardId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=501&typ=N&sys=3","","",""); return false;
502~@~   6.  10.20109:D:   30:*:*:M: Clean up procedures~@~200~@~30~@~D~@~~@~~@~M~@~~@~Clean up procedures~@~Y~@~IF EXISTS (SELECT 1 FROM sys.objects WHERE name = 'IsNeedRegen') EXEC ('DROP PROCEDURE dbo.IsNeedRegen')
IF EXISTS (SELECT 1 FROM sys.objects WHERE name = 'Ir_UpdNeedRegen') EXEC ('DROP PROCEDURE dbo.Ir_UpdNeedRegen')
IF EXISTS (SELECT 1 FROM sys.objects WHERE name = 'SetNeedRegen') EXEC ('DROP PROCEDURE dbo.SetNeedRegen')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=502&typ=N&sys=3","","",""); return false;
503~@~   6.  11.20113:D:   30:*:*:M: Clean up constraints not needed~@~201~@~30~@~D~@~~@~~@~M~@~~@~Clean up constraints not needed~@~Y~@~IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'FK_ScreenObj_ScreenTab')
	EXEC ('ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_ScreenTab')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'FK_ScreenObj_Screen')
	EXEC ('ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_Screen')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'FK_ScreenCri_Screen')
	EXEC ('ALTER TABLE dbo.ScreenCri DROP CONSTRAINT FK_ScreenCri_Screen')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'FK_FilterHlp_ScreenFilter')
	EXEC ('ALTER TABLE dbo.ScreenFilterHlp DROP CONSTRAINT FK_FilterHlp_ScreenFilter')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'FK_ScreenHlp_Screen')
	EXEC ('ALTER TABLE dbo.ScreenHlp DROP CONSTRAINT FK_ScreenHlp_Screen')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'FK_ScreenTabHlp_ScreenTab')
	EXEC ('ALTER TABLE dbo.ScreenTabHlp DROP CONSTRAINT FK_ScreenTabHlp_ScreenTab')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'FK_ReportCri_Report')
	EXEC ('ALTER TABLE dbo.ReportCri DROP CONSTRAINT FK_ReportCri_Report')
IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name = 'FK_ReportObj_Report')
	EXEC ('ALTER TABLE dbo.ReportObj DROP CONSTRAINT FK_ReportObj_Report')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=503&typ=N&sys=3","","",""); return false;
504~@~   6.  11.20113:D:   40:*:*:M: Change table Screen and update GenerateSr~@~201~@~40~@~D~@~~@~~@~M~@~~@~Change table Screen and update GenerateSr~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_Screen (ScreenId int NULL, ProgramName varchar(20) NULL, ScreenDesc nvarchar(50) NULL, ScreenTypeId tinyint NULL, MasterTableId int NULL, DetailTableId int NULL, SearchId smallint NULL, SearchWidth smallint NULL, SearchAscending char(1) NULL, SearchMode char(1) NULL, GridRows tinyint NULL, GridClass varchar(30) NULL, GridTitle nvarchar(50) NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL, GenerateSc char(1) NULL, HasDeleteAll char(1) NULL, ValidateReq char(1) NULL, DeferError char(1) NULL, MasterPageFile varchar(100) NULL, NeedRegen char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq, DeferError, MasterPageFile, NeedRegen) SELECT convert(int,ScreenId), ProgramName, ScreenDesc, convert(tinyint,ScreenTypeId), convert(int,MasterTableId), convert(int,DetailTableId), convert(smallint,SearchId), convert(smallint,SearchWidth), SearchAscending, SearchMode, convert(tinyint,GridRows), GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, HasDeleteAll, ValidateReq, DeferError, MasterPageFile, NeedRegen FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchId SmallInt NULL, SearchWidth SmallInt NULL, SearchAscending Char(1) NOT NULL, SearchMode Char(1) NOT NULL, GridRows TinyInt NULL, GridClass VarChar(30) NULL, GridTitle NVarChar(50) NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, GenerateSr Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, MasterPageFile VarChar(100) NOT NULL, NeedRegen Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_SearchMode DEFAULT (''A'') FOR SearchMode ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSc DEFAULT (''Y'') FOR GenerateSc ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSr DEFAULT (''Y'') FOR GenerateSr ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_MasterPageFile DEFAULT (''Default.master'') FOR MasterPageFile ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NeedRegen DEFAULT (''N'') FOR NeedRegen SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, MasterPageFile, NeedRegen) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, ''Y'', HasDeleteAll, ValidateReq, DeferError, MasterPageFile, NeedRegen FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen CREATE  UNIQUE NONCLUSTERED INDEX IX_Screen_ProgramName ON dbo.Screen (ProgramName)')
EXEC ('UPDATE dbo.screen SET GenerateSr = ''N'' WHERE GenerateSc = ''N''')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=504&typ=N&sys=3","","",""); return false;
505~@~   6.  11.20113:D:   20:*:*:M: Change table Entity~@~201~@~20~@~D~@~~@~~@~M~@~~@~Change table Entity~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_Entity (EntityId smallint NULL, EntityName nvarchar(100) NULL, EntityCode varchar(4) NULL, DeployPath varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_Entity (EntityId, EntityName, EntityCode, DeployPath) SELECT convert(smallint,EntityId), EntityName, EntityCode, DeployPath FROM dbo.Entity IF (SELECT COUNT(1) FROM dbo.Tmp_Entity) > 0 OR (SELECT COUNT(1) FROM dbo.Entity) = 0 DROP TABLE dbo.Entity') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Entity'')) CREATE TABLE dbo.Entity (EntityId SmallInt NOT NULL, EntityName NVarChar(100) NOT NULL, EntityCode VarChar(10) NOT NULL, DeployPath VarChar(100) NOT NULL, CONSTRAINT PK_Entity PRIMARY KEY CLUSTERED (EntityId))') EXEC (' INSERT INTO dbo.Entity (EntityId, EntityName, EntityCode, DeployPath) SELECT EntityId, EntityName, EntityCode, DeployPath FROM dbo.Tmp_Entity IF (SELECT COUNT(1) FROM dbo.Entity) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Entity) = 0 DROP TABLE dbo.Tmp_Entity')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=505&typ=N&sys=3","","",""); return false;
508~@~   6.  12.20117:D:   10:*:*:M: Change table Label~@~202~@~10~@~D~@~~@~~@~M~@~~@~Change table Label~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_Label (LabelId int NULL, CultureId smallint NULL, LabelCat varchar(50) NULL, LabelKey varchar(50) NULL, LabelText nvarchar(max) NULL, CompanyId smallint NULL, SortOrder smallint NULL)') EXEC (' INSERT INTO dbo.Tmp_Label (LabelId, CultureId, LabelCat, LabelKey, LabelText, CompanyId, SortOrder) SELECT convert(int,LabelId), convert(smallint,CultureId), LabelCat, LabelKey, LabelText, convert(smallint,CompanyId), convert(smallint,SortOrder) FROM dbo.Label IF (SELECT COUNT(1) FROM dbo.Tmp_Label) > 0 OR (SELECT COUNT(1) FROM dbo.Label) = 0 DROP TABLE dbo.Label') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Label'')) CREATE TABLE dbo.Label (LabelId Int IDENTITY NOT NULL, LabelDesc VarChar(200) NULL, CultureId SmallInt NOT NULL, LabelCat VarChar(50) NOT NULL, LabelKey VarChar(50) NOT NULL, LabelText NVarChar(max) NOT NULL, CompanyId SmallInt NULL, SortOrder SmallInt NULL, CONSTRAINT PK_Label PRIMARY KEY CLUSTERED (LabelId))') EXEC (' ALTER TABLE dbo.Label ADD CONSTRAINT DF_Label_LabelCat DEFAULT (''NA'') FOR LabelCat SET IDENTITY_INSERT dbo.Label ON INSERT INTO dbo.Label (LabelId, CultureId, LabelCat, LabelKey, LabelText, CompanyId, SortOrder) SELECT LabelId, CultureId, LabelCat, LabelKey, LabelText, CompanyId, SortOrder FROM dbo.Tmp_Label SET IDENTITY_INSERT dbo.Label OFF IF (SELECT COUNT(1) FROM dbo.Label) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Label) = 0 DROP TABLE dbo.Tmp_Label CREATE  UNIQUE NONCLUSTERED INDEX IX_Label ON dbo.Label (CultureId,LabelCat,LabelKey,CompanyId) IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IX_Label'') CREATE NONCLUSTERED INDEX IX_Label ON dbo.Label(CultureId,LabelCat,LabelKey,CompanyId)')
EXEC ('UPDATE dbo.Label SET LabelDesc = LabelCat + '': '' + LabelKey + '' ('' + b.CultureTypeName + '')'' FROM dbo.Label a INNER JOIN [[?]]Design.dbo.VwCulture b ON a.CultureId = b.CultureId')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=508&typ=N&sys=3","","",""); return false;
510~@~   6.  13.20118:D:   20:*:*:M: Add table AppZipId~@~203~@~20~@~D~@~~@~~@~M~@~~@~Add table AppZipId~@~N~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AppZipId'')) CREATE TABLE dbo.AppZipId (DocId Int IDENTITY NOT NULL, MasterId Int NOT NULL, DocName NVarChar(100) NOT NULL, MimeType VarChar(100) NOT NULL, DocSize BigInt NOT NULL, DocImage VarBinary(max) NOT NULL, InputBy Int NULL, InputOn DateTime NULL, Active Char(1) NOT NULL, CONSTRAINT PK_AppZipId PRIMARY KEY CLUSTERED (DocId))') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=510&typ=N&sys=3","","",""); return false;
511~@~   6.  14.20120:D:   10:*:*:M: Change table Screen~@~204~@~10~@~D~@~~@~~@~M~@~~@~Change table Screen~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Screen (ScreenId int NULL, ProgramName varchar(20) NULL, ScreenDesc nvarchar(50) NULL, ScreenTypeId tinyint NULL, MasterTableId int NULL, DetailTableId int NULL, SearchId smallint NULL, SearchWidth smallint NULL, SearchAscending char(1) NULL, SearchMode char(1) NULL, GridRows tinyint NULL, GridClass varchar(30) NULL, GridTitle nvarchar(50) NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL, GenerateSc char(1) NULL, GenerateSr char(1) NULL, HasDeleteAll char(1) NULL, ValidateReq char(1) NULL, DeferError char(1) NULL, MasterPageFile varchar(100) NULL, NeedRegen char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, MasterPageFile, NeedRegen) SELECT convert(int,ScreenId), ProgramName, ScreenDesc, convert(tinyint,ScreenTypeId), convert(int,MasterTableId), convert(int,DetailTableId), convert(smallint,SearchId), convert(smallint,SearchWidth), SearchAscending, SearchMode, convert(tinyint,GridRows), GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, MasterPageFile, NeedRegen FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchId SmallInt NULL, SearchWidth SmallInt NULL, SearchAscending Char(1) NOT NULL, SearchMode Char(1) NULL, GridRows TinyInt NULL, GridClass VarChar(30) NULL, GridTitle NVarChar(50) NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, GenerateSr Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, MasterPageFile VarChar(100) NOT NULL, NeedRegen Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSc DEFAULT (''Y'') FOR GenerateSc ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSr DEFAULT (''Y'') FOR GenerateSr ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_MasterPageFile DEFAULT (''Default.master'') FOR MasterPageFile ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NeedRegen DEFAULT (''N'') FOR NeedRegen SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, MasterPageFile, NeedRegen) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, MasterPageFile, NeedRegen FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen CREATE  UNIQUE NONCLUSTERED INDEX IX_Screen_ProgramName ON dbo.Screen (ProgramName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=511&typ=N&sys=3","","",""); return false;
512~@~   6.  16.20201:D:   10:*:*:M: Change table UtReportDel~@~206~@~10~@~D~@~~@~~@~M~@~~@~Change table UtReportDel~@~Y~@~EXEC ('DROP TABLE dbo.UtReportDel')
EXEC ('CREATE TABLE dbo.UtReportDel(UtReportDelId int IDENTITY(1,1) NOT NULL, ReportId int NOT NULL, ProgramName varchar(100) NOT NULL, CONSTRAINT PK_UtReportDel PRIMARY KEY CLUSTERED (UtReportDelId))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=512&typ=N&sys=3","","",""); return false;
513~@~   6.  17.20208:D:   10:*:*:M: Change all combobox to autocomplete~@~207~@~10~@~D~@~~@~~@~M~@~~@~Change all combobox to autocomplete~@~Y~@~EXEC ('UPDATE dbo.ScreenCri SET DisplayModeId = 38 WHERE DisplayModeId in (18,22)')
EXEC ('UPDATE dbo.ScreenObj SET DisplayModeId = 38 WHERE DisplayModeId in (18,22)')
EXEC ('UPDATE dbo.ReportCri SET DisplayModeId = 38 FROM dbo.ReportCri a INNER JOIN dbo.Report b ON a.ReportId = b.ReportId  WHERE a.DisplayModeId in (18,22) AND b.ReportTypeCd <> ''C''')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=513&typ=N&sys=3","","",""); return false;
514~@~   6.  18.20214:D:   10:*:*:M: Change table Report~@~208~@~10~@~D~@~~@~~@~M~@~~@~Change table Report~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Report (ReportId int NULL, ProgramName varchar(20) NULL, ReportDesc nvarchar(50) NULL, OrientationCd char(1) NULL, ReportTypeCd char(1) NULL, TemplateName varchar(50) NULL, RptTemplateId int NULL, CopyReportId int NULL, TopMargin decimal(8,2) NULL, BottomMargin decimal(8,2) NULL, LeftMargin decimal(8,2) NULL, RightMargin decimal(8,2) NULL, PageHeight decimal(8,2) NULL, PageWidth decimal(8,2) NULL, UnitCd char(2) NULL, WhereClause varchar(1000) NULL, RegClause varchar(400) NULL, RegCode nvarchar(max) NULL, ValClause varchar(400) NULL, ValCode nvarchar(max) NULL, UpdClause varchar(200) NULL, UpdCode nvarchar(max) NULL, XlsClause varchar(200) NULL, XlsCode nvarchar(max) NULL, GenerateRp char(1) NULL, AllowSelect char(1) NULL, ModifiedBy int NULL, ModifiedOn datetime NULL, LastGenDt datetime NULL, CompanyLs varchar(1000) NULL, NeedRegen char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Report (ReportId, ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, RptTemplateId, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, ModifiedBy, ModifiedOn, LastGenDt, CompanyLs, NeedRegen) SELECT convert(int,ReportId), ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, convert(int,RptTemplateId), convert(int,CopyReportId), convert(decimal(8,2),TopMargin), convert(decimal(8,2),BottomMargin), convert(decimal(8,2),LeftMargin), convert(decimal(8,2),RightMargin), convert(decimal(8,2),PageHeight), convert(decimal(8,2),PageWidth), UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, convert(int,ModifiedBy), ModifiedOn, LastGenDt, CompanyLs, NeedRegen FROM dbo.Report IF (SELECT COUNT(1) FROM dbo.Tmp_Report) > 0 OR (SELECT COUNT(1) FROM dbo.Report) = 0 DROP TABLE dbo.Report') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Report'')) CREATE TABLE dbo.Report (ReportId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ReportDesc NVarChar(50) NULL, OrientationCd Char(1) NOT NULL, ReportTypeCd Char(1) NOT NULL, TemplateName VarChar(50) NULL, RptTemplate Int NULL, CopyReportId Int NULL, TopMargin Decimal(8,2) NOT NULL, BottomMargin Decimal(8,2) NOT NULL, LeftMargin Decimal(8,2) NOT NULL, RightMargin Decimal(8,2) NOT NULL, PageHeight Decimal(8,2) NOT NULL, PageWidth Decimal(8,2) NOT NULL, UnitCd Char(2) NOT NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, RegCode NVarChar(max) NULL, ValClause VarChar(400) NULL, ValCode NVarChar(max) NULL, UpdClause VarChar(200) NULL, UpdCode NVarChar(max) NULL, XlsClause VarChar(200) NULL, XlsCode NVarChar(max) NULL, GenerateRp Char(1) NOT NULL, AllowSelect Char(1) NOT NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, CompanyLs VarChar(1000) NULL, NeedRegen Char(1) NOT NULL, CONSTRAINT PK_Report PRIMARY KEY CLUSTERED (ReportId))') EXEC (' ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_TopMargin DEFAULT (1) FOR TopMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_BottomMargin DEFAULT (1) FOR BottomMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_LeftMargin DEFAULT (1) FOR LeftMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_RightMargin DEFAULT (1) FOR RightMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_PageHeight DEFAULT (11) FOR PageHeight ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_PageWidth DEFAULT (8.5) FOR PageWidth ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_UnitCd DEFAULT (''in'') FOR UnitCd ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_AllowSelect DEFAULT (''N'') FOR AllowSelect ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_NeedRegen DEFAULT (''N'') FOR NeedRegen SET IDENTITY_INSERT dbo.Report ON INSERT INTO dbo.Report (ReportId, ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, RptTemplate, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, ModifiedBy, ModifiedOn, LastGenDt, CompanyLs, NeedRegen) SELECT ReportId, ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, RptTemplateId, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, ModifiedBy, ModifiedOn, LastGenDt, CompanyLs, NeedRegen FROM dbo.Tmp_Report SET IDENTITY_INSERT dbo.Report OFF IF (SELECT COUNT(1) FROM dbo.Report) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Report) = 0 DROP TABLE dbo.Tmp_Report CREATE  UNIQUE NONCLUSTERED INDEX IX_Report_ProgramName ON dbo.Report (ProgramName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=514&typ=N&sys=3","","",""); return false;
515~@~   6.  18.20214:D:   20:*:*:M: Remove Search Link if Document then upload column~@~208~@~20~@~D~@~~@~~@~M~@~~@~Remove Search Link if Document then upload column~@~Y~@~EXEC ('UPDATE ScreenObj SET ColumnLink = null WHERE ColumnLink is not null and DisplayModeId = 32')
EXEC ('update ScreenObj set ColumnLink = null, DisplayModeId = 39 where DisplayModeId <> 32 AND ColumnLink like ''Upload.aspx?%''')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=515&typ=N&sys=3","","",""); return false;
516~@~   6.  18.20214:D:   30:*:*:M: Change table UtReport~@~208~@~30~@~D~@~~@~~@~M~@~~@~Change table UtReport~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM sysobjects where name = ''FK_UtReportCri_UtReport'') ALTER TABLE UtReportCri DROP CONSTRAINT FK_UtReportCri_UtReport')
EXEC ('IF EXISTS (SELECT 1 FROM sysobjects where name = ''FK_UtReportObj_UtReport'') ALTER TABLE UtReportObj DROP CONSTRAINT FK_UtReportObj_UtReport')

EXEC (' CREATE TABLE dbo.Tmp_UtReport (ReportId int NULL, ProgramName varchar(20) NULL, ReportDesc nvarchar(50) NULL, OrientationCd char(1) NULL, ReportTypeCd char(1) NULL, TemplateName varchar(50) NULL, RptTemplateId int NULL, CopyReportId int NULL, TopMargin decimal(8,2) NULL, BottomMargin decimal(8,2) NULL, LeftMargin decimal(8,2) NULL, RightMargin decimal(8,2) NULL, PageHeight decimal(8,2) NULL, PageWidth decimal(8,2) NULL, UnitCd char(2) NULL, WhereClause varchar(1000) NULL, RegClause varchar(400) NULL, RegCode nvarchar(max) NULL, ValClause varchar(400) NULL, ValCode nvarchar(max) NULL, UpdClause varchar(200) NULL, UpdCode nvarchar(max) NULL, XlsClause varchar(200) NULL, XlsCode nvarchar(max) NULL, GenerateRp char(1) NULL, AllowSelect char(1) NULL, ModifiedBy int NULL, ModifiedOn datetime NULL, LastGenDt datetime NULL, CompanyLs varchar(1000) NULL)')
EXEC (' INSERT INTO dbo.Tmp_UtReport (ReportId, ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, RptTemplateId, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, ModifiedBy, ModifiedOn, LastGenDt, CompanyLs) SELECT convert(int,ReportId), ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, convert(int,RptTemplateId), convert(int,CopyReportId), convert(decimal(8,2),TopMargin), convert(decimal(8,2),BottomMargin), convert(decimal(8,2),LeftMargin), convert(decimal(8,2),RightMargin), convert(decimal(8,2),PageHeight), convert(decimal(8,2),PageWidth), UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, convert(int,ModifiedBy), ModifiedOn, LastGenDt, CompanyLs FROM dbo.UtReport IF (SELECT COUNT(1) FROM dbo.Tmp_UtReport) > 0 OR (SELECT COUNT(1) FROM dbo.UtReport) = 0 DROP TABLE dbo.UtReport')
EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UtReport'')) CREATE TABLE dbo.UtReport (ReportId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ReportDesc NVarChar(50) NULL, OrientationCd Char(1) NOT NULL, ReportTypeCd Char(1) NOT NULL, TemplateName VarChar(50) NULL, RptTemplate Int NULL, CopyReportId Int NULL, TopMargin Decimal(8,2) NOT NULL, BottomMargin Decimal(8,2) NOT NULL, LeftMargin Decimal(8,2) NOT NULL, RightMargin Decimal(8,2) NOT NULL, PageHeight Decimal(8,2) NOT NULL, PageWidth Decimal(8,2) NOT NULL, UnitCd Char(2) NOT NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, RegCode NVarChar(max) NULL, ValClause VarChar(400) NULL, ValCode NVarChar(max) NULL, UpdClause VarChar(200) NULL, UpdCode NVarChar(max) NULL, XlsClause VarChar(200) NULL, XlsCode NVarChar(max) NULL, GenerateRp Char(1) NOT NULL, AllowSelect Char(1) NOT NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, CompanyLs VarChar(1000) NULL, NeedRegen Char(1) NOT NULL, CONSTRAINT PK_UtReport PRIMARY KEY CLUSTERED (ReportId))')
EXEC (' ALTER TABLE dbo.UtReport ADD CONSTRAINT DF_UtReport_TopMargin DEFAULT (1) FOR TopMargin ALTER TABLE dbo.UtReport ADD CONSTRAINT DF_UtReport_BottomMargin DEFAULT (1) FOR BottomMargin ALTER TABLE dbo.UtReport ADD CONSTRAINT DF_UtReport_LeftMargin DEFAULT (1) FOR LeftMargin ALTER TABLE dbo.UtReport ADD CONSTRAINT DF_UtReport_RightMargin DEFAULT (1) FOR RightMargin ALTER TABLE dbo.UtReport ADD CONSTRAINT DF_UtReport_PageHeight DEFAULT (11) FOR PageHeight ALTER TABLE dbo.UtReport ADD CONSTRAINT DF_UtReport_PageWidth DEFAULT (8.5) FOR PageWidth ALTER TABLE dbo.UtReport ADD CONSTRAINT DF_UtReport_UnitCd DEFAULT (''in'') FOR UnitCd ALTER TABLE dbo.UtReport ADD CONSTRAINT DF_UtReport_AllowSelect DEFAULT (''N'') FOR AllowSelect ALTER TABLE dbo.UtReport ADD CONSTRAINT DF_UtReport_NeedRegen DEFAULT (''N'') FOR NeedRegen SET IDENTITY_INSERT dbo.UtReport ON INSERT INTO dbo.UtReport (ReportId, ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, RptTemplate, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, ModifiedBy, ModifiedOn, LastGenDt, CompanyLs, NeedRegen) SELECT ReportId, ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, RptTemplateId, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, ModifiedBy, ModifiedOn, LastGenDt, CompanyLs, ''N'' FROM dbo.Tmp_UtReport SET IDENTITY_INSERT dbo.UtReport OFF IF (SELECT COUNT(1) FROM dbo.UtReport) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UtReport) = 0 DROP TABLE dbo.Tmp_UtReport CREATE  UNIQUE NONCLUSTERED INDEX IX_UtReport_ProgramName ON dbo.UtReport (ProgramName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=516&typ=N&sys=3","","",""); return false;
520~@~   6.  22.20229:D:   10:*:*:M: Remove index on DbColumn table~@~212~@~10~@~D~@~~@~~@~M~@~~@~Remove index on DbColumn table~@~Y~@~IF EXISTS (SELECT 1 FROM sysobjects WHERE name = 'IX_DbColumn') EXEC ('DROP INDEX DbColumn.IX_DbColumn')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=520&typ=N&sys=3","","",""); return false;
521~@~   6.  24.20306:D:   10:*:*:M: Change table Screen~@~214~@~10~@~D~@~~@~~@~M~@~~@~Change table Screen~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Screen (ScreenId int NULL, ProgramName varchar(20) NULL, ScreenDesc nvarchar(50) NULL, ScreenTypeId tinyint NULL, MasterTableId int NULL, DetailTableId int NULL, SearchId smallint NULL, SearchWidth smallint NULL, SearchAscending char(1) NULL, SearchMode char(1) NULL, GridRows tinyint NULL, GridClass varchar(30) NULL, GridTitle nvarchar(50) NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL, GenerateSc char(1) NULL, GenerateSr char(1) NULL, HasDeleteAll char(1) NULL, ValidateReq char(1) NULL, DeferError char(1) NULL, MasterPageFile varchar(100) NULL, NeedRegen char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, MasterPageFile, NeedRegen) SELECT convert(int,ScreenId), ProgramName, ScreenDesc, convert(tinyint,ScreenTypeId), convert(int,MasterTableId), convert(int,DetailTableId), convert(smallint,SearchId), convert(smallint,SearchWidth), SearchAscending, SearchMode, convert(tinyint,GridRows), GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, MasterPageFile, NeedRegen FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchId SmallInt NULL, SearchWidth SmallInt NULL, SearchAscending Char(1) NOT NULL, SearchMode Char(1) NULL, NumCols TinyInt NOT NULL, GridRows TinyInt NULL, GridClass VarChar(30) NULL, GridTitle NVarChar(50) NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, GenerateSr Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, MasterPageFile VarChar(100) NOT NULL, NeedRegen Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NumCols DEFAULT (1) FOR NumCols ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSc DEFAULT (''Y'') FOR GenerateSc ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSr DEFAULT (''Y'') FOR GenerateSr ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_MasterPageFile DEFAULT (''Default.master'') FOR MasterPageFile ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NeedRegen DEFAULT (''N'') FOR NeedRegen SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, NumCols, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, MasterPageFile, NeedRegen) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, 1, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, MasterPageFile, NeedRegen FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen CREATE  UNIQUE NONCLUSTERED INDEX IX_Screen_ProgramName ON dbo.Screen (ProgramName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=521&typ=N&sys=3","","",""); return false;
522~@~   6.  24.20306:D:   20:*:*:M: Add table CtNumCols~@~214~@~20~@~D~@~~@~~@~M~@~~@~Add table CtNumCols~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtNumCols'))
BEGIN
EXEC ('CREATE TABLE dbo.CtNumCols (NumCols TinyInt NOT NULL, CONSTRAINT PK_CtNumCols PRIMARY KEY CLUSTERED (NumCols))')
EXEC ('INSERT dbo.CtNumCols SELECT 1')
EXEC ('INSERT dbo.CtNumCols SELECT 2')
EXEC ('INSERT dbo.CtNumCols SELECT 3')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=522&typ=N&sys=3","","",""); return false;
524~@~   6.  38.20409:D:   10:*:*:M: Change table RowOvrdPrm~@~228~@~10~@~D~@~~@~~@~M~@~~@~Change table RowOvrdPrm~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_RowOvrdPrm (RowOvrdPrmId smallint NULL, RowOvrdId smallint NULL, PermKeyId smallint NULL, SelLevel char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_RowOvrdPrm (RowOvrdPrmId, RowOvrdId, PermKeyId, SelLevel) SELECT convert(smallint,RowOvrdPrmId), convert(smallint,RowOvrdId), convert(smallint,PermKeyId), SelLevel FROM dbo.RowOvrdPrm IF (SELECT COUNT(1) FROM dbo.Tmp_RowOvrdPrm) > 0 OR (SELECT COUNT(1) FROM dbo.RowOvrdPrm) = 0 DROP TABLE dbo.RowOvrdPrm') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RowOvrdPrm'')) CREATE TABLE dbo.RowOvrdPrm (RowOvrdPrmId SmallInt IDENTITY NOT NULL, RowOvrdId SmallInt NOT NULL, PermKeyId SmallInt NOT NULL, SelLevel Char(1) NOT NULL, AndCondition Char(1) NOT NULL, CONSTRAINT PK_RowOvrdPrm PRIMARY KEY CLUSTERED (RowOvrdPrmId))') EXEC (' ALTER TABLE dbo.RowOvrdPrm ADD CONSTRAINT DF_RowOvrdPrm_AndCondition DEFAULT (''Y'') FOR AndCondition SET IDENTITY_INSERT dbo.RowOvrdPrm ON INSERT INTO dbo.RowOvrdPrm (RowOvrdPrmId, RowOvrdId, PermKeyId, SelLevel, AndCondition) SELECT RowOvrdPrmId, RowOvrdId, PermKeyId, SelLevel, ''Y'' FROM dbo.Tmp_RowOvrdPrm SET IDENTITY_INSERT dbo.RowOvrdPrm OFF IF (SELECT COUNT(1) FROM dbo.RowOvrdPrm) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RowOvrdPrm) = 0 DROP TABLE dbo.Tmp_RowOvrdPrm')

EXEC ('UPDATE RowOvrdPrm SET AndCondition = b.AndCondition FROM dbo.RowOvrdPrm a INNER JOIN [[?]]Design.dbo.CtPermKey b ON a.PermKeyId = b.CtPermKeyId')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=524&typ=N&sys=3","","",""); return false;
525~@~   6.  38.20409:D:   20:*:*:M: Add table CtAndOr~@~228~@~20~@~D~@~~@~~@~M~@~~@~Add table CtAndOr~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtAndOr'')) CREATE TABLE dbo.CtAndOr (AndOrCd Char(1) NOT NULL, AndOrName NVarChar(10) NOT NULL, CONSTRAINT PK_CtAndOr PRIMARY KEY CLUSTERED (AndOrCd))')
EXEC ('IF (SELECT COUNT(1) FROM dbo.CtAndOr) <= 0 BEGIN INSERT INTO dbo.CtAndOr VALUES (''Y'',''AND'') INSERT INTO dbo.CtAndOr VALUES (''N'',''OR'') END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=525&typ=N&sys=3","","",""); return false;
526~@~   6.  40.20416:D:   10:*:*:M: Reinitialize ScreenGrp~@~230~@~10~@~D~@~~@~~@~M~@~~@~Reinitialize ScreenGrp~@~Y~@~EXEC('
DECLARE @id5 int
DECLARE @id6 int
DECLARE @id7 int
DECLARE @id8 int
DECLARE @id9 int
SELECT @id5 = 0, @id6 = 0, @id7 = 0, @id8 = 0, @id9 = 0
SET IDENTITY_INSERT dbo.ScreenGrp ON
IF EXISTS (SELECT 1 FROM dbo.ScreenGrp WHERE ScreenGrpId = 5 AND ScreenGrpName <> ''Tab1'')
BEGIN
	SELECT @id5 = max(ScreenGrpId) FROM dbo.ScreenGrp
	IF @id5 < 9 SELECT @id5 = 10 ELSE SELECT @id5 = @id5 + 1
	INSERT dbo.ScreenGrp (ScreenGrpId,ScreenId,ScreenGrpTypeCd,ParentGrpId,ScreenGrpName,TabIndex,ScreenGrpIndex,ContentVertical,LabelVertical,BorderWidth,GrpStyle) 
		SELECT @id5,ScreenId,ScreenGrpTypeCd,ParentGrpId,ScreenGrpName,TabIndex,ScreenGrpIndex,ContentVertical,LabelVertical,BorderWidth,GrpStyle FROM dbo.ScreenGrp WHERE ScreenGrpId = 5
	UPDATE dbo.ScreenCri SET ScreenGrpId = @id5 WHERE ScreenGrpId = 5
	UPDATE dbo.ScreenObj SET ScreenGrpId = @id5 WHERE ScreenGrpId = 5
	DELETE FROM dbo.ScreenGrp WHERE ScreenGrpId = 5
END
IF EXISTS (SELECT 1 FROM dbo.ScreenGrp WHERE ScreenGrpId = 6 AND ScreenGrpName <> ''Tab1Col1'')
BEGIN
	SELECT @id6 = max(ScreenGrpId) FROM dbo.ScreenGrp
	IF @id6 < 9 SELECT @id6 = 10 ELSE SELECT @id6 = @id6 + 1
	INSERT dbo.ScreenGrp (ScreenGrpId,ScreenId,ScreenGrpTypeCd,ParentGrpId,ScreenGrpName,TabIndex,ScreenGrpIndex,ContentVertical,LabelVertical,BorderWidth,GrpStyle)
		SELECT @id6,ScreenId,ScreenGrpTypeCd,ParentGrpId,ScreenGrpName,TabIndex,ScreenGrpIndex,ContentVertical,LabelVertical,BorderWidth,GrpStyle FROM dbo.ScreenGrp WHERE ScreenGrpId = 6
	UPDATE dbo.ScreenCri SET ScreenGrpId = @id6 WHERE ScreenGrpId = 6
	UPDATE dbo.ScreenObj SET ScreenGrpId = @id6 WHERE ScreenGrpId = 6
	DELETE FROM dbo.ScreenGrp WHERE ScreenGrpId = 6
END
IF EXISTS (SELECT 1 FROM dbo.ScreenGrp WHERE ScreenGrpId = 7 AND ScreenGrpName <> ''Tab1Col2'')
BEGIN
	SELECT @id7 = max(ScreenGrpId) FROM dbo.ScreenGrp
	IF @id7 < 9 SELECT @id7 = 10 ELSE SELECT @id7 = @id7 + 1
	INSERT dbo.ScreenGrp (ScreenGrpId,ScreenId,ScreenGrpTypeCd,ParentGrpId,ScreenGrpName,TabIndex,ScreenGrpIndex,ContentVertical,LabelVertical,BorderWidth,GrpStyle)
		SELECT @id7,ScreenId,ScreenGrpTypeCd,ParentGrpId,ScreenGrpName,TabIndex,ScreenGrpIndex,ContentVertical,LabelVertical,BorderWidth,GrpStyle FROM dbo.ScreenGrp WHERE ScreenGrpId = 7
	UPDATE dbo.ScreenCri SET ScreenGrpId = @id7 WHERE ScreenGrpId = 7
	UPDATE dbo.ScreenObj SET ScreenGrpId = @id7 WHERE ScreenGrpId = 7
	DELETE FROM dbo.ScreenGrp WHERE ScreenGrpId = 7
END
IF EXISTS (SELECT 1 FROM dbo.ScreenGrp WHERE ScreenGrpId = 8 AND ScreenGrpName <> ''Tab1Col3'')
BEGIN
	SELECT @id8 = max(ScreenGrpId) FROM dbo.ScreenGrp
	IF @id8 < 9 SELECT @id8 = 10 ELSE SELECT @id8 = @id8 + 1
	INSERT dbo.ScreenGrp (ScreenGrpId,ScreenId,ScreenGrpTypeCd,ParentGrpId,ScreenGrpName,TabIndex,ScreenGrpIndex,ContentVertical,LabelVertical,BorderWidth,GrpStyle)
		SELECT @id8,ScreenId,ScreenGrpTypeCd,ParentGrpId,ScreenGrpName,TabIndex,ScreenGrpIndex,ContentVertical,LabelVertical,BorderWidth,GrpStyle FROM dbo.ScreenGrp WHERE ScreenGrpId = 8
	UPDATE dbo.ScreenCri SET ScreenGrpId = @id8 WHERE ScreenGrpId = 8
	UPDATE dbo.ScreenObj SET ScreenGrpId = @id8 WHERE ScreenGrpId = 8
	DELETE FROM dbo.ScreenGrp WHERE ScreenGrpId = 8
END
IF EXISTS (SELECT 1 FROM dbo.ScreenGrp WHERE ScreenGrpId = 9 AND ScreenGrpName <> ''Tab1Col4'')
BEGIN
	SELECT @id9 = max(ScreenGrpId) FROM dbo.ScreenGrp
	IF @id9 < 9 SELECT @id9 = 10 ELSE SELECT @id9 = @id9 + 1
	INSERT dbo.ScreenGrp (ScreenGrpId,ScreenId,ScreenGrpTypeCd,ParentGrpId,ScreenGrpName,TabIndex,ScreenGrpIndex,ContentVertical,LabelVertical,BorderWidth,GrpStyle)
	SELECT @id9,ScreenId,ScreenGrpTypeCd,ParentGrpId,ScreenGrpName,TabIndex,ScreenGrpIndex,ContentVertical,LabelVertical,BorderWidth,GrpStyle FROM dbo.ScreenGrp WHERE ScreenGrpId = 9
	UPDATE dbo.ScreenCri SET ScreenGrpId = @id9 WHERE ScreenGrpId = 9
	UPDATE dbo.ScreenObj SET ScreenGrpId = @id9 WHERE ScreenGrpId = 9
	DELETE FROM dbo.ScreenGrp WHERE ScreenGrpId = 9
END
IF @id5 <> 0 UPDATE dbo.ScreenGrp SET ParentGrpId = @id5 WHERE ParentGrpId = 5
IF @id6 <> 0 UPDATE dbo.ScreenGrp SET ParentGrpId = @id6 WHERE ParentGrpId = 6
IF @id7 <> 0 UPDATE dbo.ScreenGrp SET ParentGrpId = @id7 WHERE ParentGrpId = 7
IF @id8 <> 0 UPDATE dbo.ScreenGrp SET ParentGrpId = @id8 WHERE ParentGrpId = 8
IF @id9 <> 0 UPDATE dbo.ScreenGrp SET ParentGrpId = @id9 WHERE ParentGrpId = 9
IF NOT EXISTS (SELECT 1 FROM dbo.ScreenGrp WHERE ScreenGrpId = 5 AND ScreenGrpName = ''Tab1'')
BEGIN
	INSERT dbo.ScreenGrp (ScreenGrpId,ParentGrpId,ScreenGrpName,ScreenGrpIndex,ContentVertical,LabelVertical,BorderWidth)
	VALUES (5,3,''Tab1'',0,''N'',''N'',0)
END
IF NOT EXISTS (SELECT 1 FROM dbo.ScreenGrp WHERE ScreenGrpId = 6 AND ScreenGrpName = ''Tab1Col1'')
BEGIN
	INSERT dbo.ScreenGrp (ScreenGrpId,ParentGrpId,ScreenGrpName,ScreenGrpIndex,ContentVertical,LabelVertical,BorderWidth)
	VALUES (6,5,''Tab1Col1'',0,''Y'',''N'',0)
END
IF NOT EXISTS (SELECT 1 FROM dbo.ScreenGrp WHERE ScreenGrpId = 7 AND ScreenGrpName = ''Tab1Col2'')
BEGIN
	INSERT dbo.ScreenGrp (ScreenGrpId,ParentGrpId,ScreenGrpName,ScreenGrpIndex,ContentVertical,LabelVertical,BorderWidth)
	VALUES (7,5,''Tab1Col2'',0,''Y'',''N'',0)
END
IF NOT EXISTS (SELECT 1 FROM dbo.ScreenGrp WHERE ScreenGrpId = 8 AND ScreenGrpName = ''Tab1Col3'')
BEGIN
	INSERT dbo.ScreenGrp (ScreenGrpId,ParentGrpId,ScreenGrpName,ScreenGrpIndex,ContentVertical,LabelVertical,BorderWidth)
	VALUES (8,5,''Tab1Col3'',0,''Y'',''N'',0)
END
IF NOT EXISTS (SELECT 1 FROM dbo.ScreenGrp WHERE ScreenGrpId = 9 AND ScreenGrpName = ''Tab1Col4'')
BEGIN
	INSERT dbo.ScreenGrp (ScreenGrpId,ParentGrpId,ScreenGrpName,ScreenGrpIndex,ContentVertical,LabelVertical,BorderWidth)
	VALUES (9,5,''Tab1Col4'',0,''Y'',''N'',0)
END
SET IDENTITY_INSERT dbo.ScreenGrp OFF
')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=526&typ=N&sys=3","","",""); return false;
528~@~   6.  40.20416:D:   20:*:*:M: Add function fMenu~@~230~@~20~@~D~@~~@~~@~M~@~~@~Add function fMenu~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.fMenu'))
EXEC ('CREATE FUNCTION dbo.fMenu() RETURNS TABLE 
AS
RETURN 
(
	SELECT MenuId, MenuName FROM dbo.Menu
)')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.VwMenu'')) DROP VIEW dbo.VwMenu')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=528&typ=N&sys=3","","",""); return false;
529~@~   6.  43.20420:D:   10:*:*:M: Change table ScreenObj~@~233~@~10~@~D~@~~@~~@~M~@~~@~Change table ScreenObj~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenObj (ScreenObjId int NULL, ScreenId int NULL, MasterTable char(1) NULL, ScreenGrpId int NULL, LabelCss varchar(100) NULL, ContentCss varchar(100) NULL, ColumnId int NULL, ColumnName varchar(20) NULL, ColumnDesc varchar(100) NULL, DefaultValue nvarchar(100) NULL, SystemValue nvarchar(100) NULL, ColumnWrap char(1) NULL, ColumnJustify char(1) NULL, ColumnSize smallint NULL, ColumnHeight smallint NULL, DisplayModeId tinyint NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DdlAdnColumnId int NULL, DdlFtrColumnId int NULL, AggregateCd char(1) NULL, GenerateSp char(1) NULL, TabFolderId int NULL, TabIndex smallint NULL, SortOrder smallint NULL, RequiredValid char(1) NULL, MaskValid varchar(50) NULL, RangeValidType varchar(50) NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, ColumnLink varchar(1000) NULL, RefreshOnCUD char(1) NULL, TrimOnEntry char(1) NULL, MatchCd char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd) SELECT convert(int,ScreenObjId), convert(int,ScreenId), MasterTable, convert(int,ScreenGrpId), LabelCss, ContentCss, convert(int,ColumnId), ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, convert(smallint,ColumnSize), convert(smallint,ColumnHeight), convert(tinyint,DisplayModeId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), convert(int,DdlAdnColumnId), convert(int,DdlFtrColumnId), AggregateCd, GenerateSp, convert(int,TabFolderId), convert(smallint,TabIndex), convert(smallint,SortOrder), RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObj'')) CREATE TABLE dbo.ScreenObj (ScreenObjId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, ScreenGrpId Int NOT NULL, LabelCss VarChar(100) NULL, ContentCss VarChar(100) NULL, ColumnId Int NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(100) NULL, DefaultValue NVarChar(100) NULL, SystemValue NVarChar(100) NULL, ColumnWrap Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, ColumnHeight SmallInt NULL, DisplayModeId TinyInt NOT NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlAdnColumnId Int NULL, DdlFtrColumnId Int NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId Int NULL, TabIndex SmallInt NOT NULL, SortOrder SmallInt NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(50) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(1000) NULL, RefreshOnCUD Char(1) NOT NULL, TrimOnEntry Char(1) NOT NULL, MatchCd Char(1) NULL, IgnoreConfirm Char(1) NOT NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))') EXEC (' ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_TrimOnEntry DEFAULT (''Y'') FOR TrimOnEntry ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_IgnoreConfirm DEFAULT (''Y'') FOR IgnoreConfirm SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm) SELECT ScreenObjId, ScreenId, MasterTable, ScreenGrpId, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, ''Y'' FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj CREATE  NONCLUSTERED INDEX IX_ScreenObj_ScreenId ON dbo.ScreenObj (ScreenId,TabIndex)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=529&typ=N&sys=3","","",""); return false;
530~@~   6.  45.20518:D:   10:*:*:M: Change Custom Label Description~@~235~@~10~@~D~@~~@~~@~M~@~~@~Change Custom Label Description~@~Y~@~UPDATE dbo.Label SET
LabelDesc = LabelCat + ': ' + ISNULL(RIGHT('000'+CONVERT(varchar,SortOrder),4)+' ','') + LabelKey + ' (' + b.CultureTypeName + ')'
FROM dbo.Label a INNER JOIN [[?]]Design.dbo.VwCulture b ON a.CultureId = b.CultureId~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=530&typ=N&sys=3","","",""); return false;
531~@~   6.  46.20522:D:   10:*:*:M: Add criteria display view~@~236~@~10~@~D~@~~@~~@~M~@~~@~Add criteria display view~@~N~@~IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.VwDisplayType'))
EXEC ('DROP VIEW dbo.VwDisplayType')
EXEC ('CREATE VIEW dbo.VwDisplayType AS SELECT TypeId, TypeName, TypeDesc, DisplayDefault FROM dbo.CtDisplayType
WHERE TypeId IN (1,3,4,5,17,18,20,33,35,38,40)')

EXEC ('UPDATE dbo.ReportCri SET DisplayModeId = 33 where DisplayModeId in (8,19,30,31,34)')
EXEC ('UPDATE dbo.ScreenCri SET DisplayModeId = 33 where DisplayModeId in (8,19,30,31,34)')
EXEC ('UPDATE dbo.ReportCri SET DisplayModeId = 1 where DisplayModeId in (9,16)')
EXEC ('UPDATE dbo.ScreenCri SET DisplayModeId = 1 where DisplayModeId in (9,16)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=531&typ=N&sys=3","","",""); return false;
532~@~   6.  46.20522:D:   20:*:*:M: Drop redundant table CtRptDisplay~@~236~@~20~@~D~@~~@~~@~M~@~~@~Drop redundant table CtRptDisplay~@~N~@~IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtRptDisplay'))
EXEC ('DROP TABLE dbo.CtRptDisplay')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=532&typ=N&sys=3","","",""); return false;
533~@~   6.  51.20610:D:   10:*:*:M: Change table DbColumn~@~241~@~10~@~D~@~~@~~@~M~@~~@~Change table DbColumn~@~Y~@~ EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_DbColumn_DbTable'') ALTER TABLE dbo.DbColumn DROP CONSTRAINT FK_DbColumn_DbTable CREATE TABLE dbo.Tmp_DbColumn (ColumnId int NULL, TableId int NULL, ExternalTable varchar(50) NULL, ColumnName varchar(20) NULL, ColumnDesc varchar(100) NULL, DataType tinyint NULL, ColumnLength smallint NULL, ColumnScale tinyint NULL, AllowNulls char(1) NULL, ColumnIdentity char(1) NULL, PrimaryKey char(1) NULL, IsIndex char(1) NULL, ColObjective nvarchar(200) NULL, PrevColName varchar(20) NULL, ColumnIndex smallint NULL, DefaultValue nvarchar(50) NULL)') EXEC (' INSERT INTO dbo.Tmp_DbColumn (ColumnId, TableId, ExternalTable, ColumnName, ColumnDesc, DataType, ColumnLength, ColumnScale, AllowNulls, ColumnIdentity, PrimaryKey, IsIndex, ColObjective, PrevColName, ColumnIndex, DefaultValue) SELECT convert(int,ColumnId), convert(int,TableId), ExternalTable, ColumnName, ColumnDesc, convert(tinyint,DataType), convert(smallint,ColumnLength), convert(tinyint,ColumnScale), AllowNulls, ColumnIdentity, PrimaryKey, IsIndex, ColObjective, PrevColName, convert(smallint,ColumnIndex), DefaultValue FROM dbo.DbColumn IF (SELECT COUNT(1) FROM dbo.Tmp_DbColumn) > 0 OR (SELECT COUNT(1) FROM dbo.DbColumn) = 0 DROP TABLE dbo.DbColumn') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.DbColumn'')) CREATE TABLE dbo.DbColumn (ColumnId Int IDENTITY NOT NULL, TableId Int NOT NULL, ColumnIndex SmallInt NULL, ExternalTable VarChar(50) NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(100) NULL, DataType TinyInt NOT NULL, ColumnLength SmallInt NOT NULL, ColumnScale TinyInt NULL, DefaultValue NVarChar(50) NULL, AllowNulls Char(1) NOT NULL, ColumnIdentity Char(1) NOT NULL, PrimaryKey Char(1) NOT NULL, IsIndexU Char(1) NOT NULL, IsIndex Char(1) NOT NULL, ColObjective NVarChar(200) NULL, PrevColName VarChar(20) NULL, CONSTRAINT PK_DbColumn PRIMARY KEY CLUSTERED (ColumnId))') EXEC (' ALTER TABLE dbo.DbColumn ADD CONSTRAINT DF_DbColumn_IsIndexU DEFAULT (''N'') FOR IsIndexU ALTER TABLE dbo.DbColumn ADD CONSTRAINT DF_DbColumn_IsIndex DEFAULT (''N'') FOR IsIndex SET IDENTITY_INSERT dbo.DbColumn ON INSERT INTO dbo.DbColumn (ColumnId, TableId, ColumnIndex, ExternalTable, ColumnName, ColumnDesc, DataType, ColumnLength, ColumnScale, DefaultValue, AllowNulls, ColumnIdentity, PrimaryKey, IsIndexU, IsIndex, ColObjective, PrevColName) SELECT ColumnId, TableId, ColumnIndex, ExternalTable, ColumnName, ColumnDesc, DataType, ColumnLength, ColumnScale, DefaultValue, AllowNulls, ColumnIdentity, PrimaryKey, ''N'', IsIndex, ColObjective, PrevColName FROM dbo.Tmp_DbColumn SET IDENTITY_INSERT dbo.DbColumn OFF IF (SELECT COUNT(1) FROM dbo.DbColumn) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_DbColumn) = 0 DROP TABLE dbo.Tmp_DbColumn ALTER TABLE dbo.DbColumn WITH NOCHECK ADD CONSTRAINT FK_DbColumn_DbTable FOREIGN KEY (TableId) REFERENCES dbo.DbTable (TableId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=533&typ=N&sys=3","","",""); return false;
534~@~   6.  51.20610:D:   20:*:*:M: Change table Wizard~@~241~@~20~@~D~@~~@~~@~M~@~~@~Change table Wizard~@~Y~@~ EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_WizardObj_Wizard'') ALTER TABLE dbo.WizardObj DROP CONSTRAINT FK_WizardObj_Wizard CREATE TABLE dbo.Tmp_Wizard (WizardId int NULL, WizardTypeId tinyint NULL, MasterTableId int NULL, WizardTitle nvarchar(50) NULL, ProgramName varchar(50) NULL, DefWorkSheet nvarchar(50) NULL, DefStartRow smallint NULL, DefOverwrite char(1) NULL, OvwrReadonly char(1) NULL, NeedRegen char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Wizard (WizardId, WizardTypeId, MasterTableId, WizardTitle, ProgramName, DefWorkSheet, DefStartRow, DefOverwrite, OvwrReadonly, NeedRegen) SELECT convert(int,WizardId), convert(tinyint,WizardTypeId), convert(int,MasterTableId), WizardTitle, ProgramName, DefWorkSheet, convert(smallint,DefStartRow), DefOverwrite, OvwrReadonly, NeedRegen FROM dbo.Wizard IF (SELECT COUNT(1) FROM dbo.Tmp_Wizard) > 0 OR (SELECT COUNT(1) FROM dbo.Wizard) = 0 DROP TABLE dbo.Wizard') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Wizard'')) CREATE TABLE dbo.Wizard (WizardId Int IDENTITY NOT NULL, WizardTypeId TinyInt NOT NULL, MasterTableId Int NOT NULL, WizardTitle NVarChar(50) NOT NULL, ProgramName VarChar(50) NOT NULL, DefWorkSheet NVarChar(50) NOT NULL, DefStartRow SmallInt NOT NULL, DefOverwrite Char(1) NOT NULL, OvwrReadonly Char(1) NOT NULL, NeedRegen Char(1) NOT NULL, CONSTRAINT PK_Wizard PRIMARY KEY CLUSTERED (WizardId))') EXEC (' ALTER TABLE dbo.Wizard ADD CONSTRAINT DF_Wizard_NeedRegen DEFAULT (''N'') FOR NeedRegen SET IDENTITY_INSERT dbo.Wizard ON INSERT INTO dbo.Wizard (WizardId, WizardTypeId, MasterTableId, WizardTitle, ProgramName, DefWorkSheet, DefStartRow, DefOverwrite, OvwrReadonly, NeedRegen) SELECT WizardId, WizardTypeId, MasterTableId, WizardTitle, ProgramName, DefWorkSheet, DefStartRow, DefOverwrite, OvwrReadonly, NeedRegen FROM dbo.Tmp_Wizard SET IDENTITY_INSERT dbo.Wizard OFF IF (SELECT COUNT(1) FROM dbo.Wizard) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Wizard) = 0 DROP TABLE dbo.Tmp_Wizard ALTER TABLE dbo.WizardObj WITH NOCHECK ADD CONSTRAINT FK_WizardObj_Wizard FOREIGN KEY (WizardId) REFERENCES dbo.Wizard (WizardId) IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IU_Wizard'') CREATE UNIQUE NONCLUSTERED INDEX IU_Wizard ON dbo.Wizard(ProgramName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=534&typ=N&sys=3","","",""); return false;
535~@~   6.  51.20610:D:   30:*:*:M: Change table ServerRule~@~241~@~30~@~D~@~~@~~@~M~@~~@~Change table ServerRule~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ServerRule (ServerRuleId int NULL, ScreenId int NULL, RuleTypeId tinyint NULL, MasterTable char(1) NULL, RuleName nvarchar(100) NULL, RuleDesc nvarchar(150) NULL, RuleDescription nvarchar(500) NULL, RuleOrder smallint NULL, ProcedureName varchar(28) NULL, ParameterNames varchar(200) NULL, ParameterTypes varchar(200) NULL, CallingParams varchar(200) NULL, OnAdd char(1) NULL, OnUpd char(1) NULL, OnDel char(1) NULL, BeforeCRUD char(1) NULL, RuleCode nvarchar(max) NULL, ModifiedBy int NULL, ModifiedOn datetime NULL, LastGenDt datetime NULL)') EXEC (' INSERT INTO dbo.Tmp_ServerRule (ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, RuleOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn, LastGenDt) SELECT convert(int,ServerRuleId), convert(int,ScreenId), convert(tinyint,RuleTypeId), MasterTable, RuleName, RuleDesc, RuleDescription, convert(smallint,RuleOrder), ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, convert(int,ModifiedBy), ModifiedOn, LastGenDt FROM dbo.ServerRule IF (SELECT COUNT(1) FROM dbo.Tmp_ServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.ServerRule) = 0 DROP TABLE dbo.ServerRule') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ServerRule'')) CREATE TABLE dbo.ServerRule (ServerRuleId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, RuleTypeId TinyInt NOT NULL, MasterTable Char(1) NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, RuleOrder SmallInt NOT NULL, ProcedureName VarChar(28) NOT NULL, ParameterNames VarChar(200) NULL, ParameterTypes VarChar(200) NULL, CallingParams VarChar(200) NULL, OnAdd Char(1) NOT NULL, OnUpd Char(1) NOT NULL, OnDel Char(1) NOT NULL, BeforeCRUD Char(1) NOT NULL, RuleCode NVarChar(max) NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, CONSTRAINT PK_ServerRule PRIMARY KEY CLUSTERED (ServerRuleId))') EXEC (' SET IDENTITY_INSERT dbo.ServerRule ON INSERT INTO dbo.ServerRule (ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, RuleOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn, LastGenDt) SELECT ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, RuleOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn, LastGenDt FROM dbo.Tmp_ServerRule SET IDENTITY_INSERT dbo.ServerRule OFF IF (SELECT COUNT(1) FROM dbo.ServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ServerRule) = 0 DROP TABLE dbo.Tmp_ServerRule IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IX_ServerRule'') CREATE NONCLUSTERED INDEX IX_ServerRule ON dbo.ServerRule(ScreenId,RuleOrder)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=535&typ=N&sys=3","","",""); return false;
537~@~   6.  57.20727:D:   10:*:*:M: Update image references~@~247~@~10~@~D~@~~@~~@~M~@~~@~Update image references~@~Y~@~UPDATE Menu SET IconUrl = REPLACE(IconUrl,'image','~/image') where CHARINDEX('~',IconUrl) <> 1

UPDATE ScreenObj SET DefaultValue = replace(replace(b.ColumnHeader,'\','/'),'../','~/')
FROM ScreenObj a INNER JOIN ScreenObjHlp b ON a.ScreenObjId = b.ScreenObjId AND CultureId = 1
WHERE a.DisplayModeId = 28 AND a.ColumnId is null AND a.DefaultValue is null AND b.ColumnHeader is not null

UPDATE ScreenObjHlp SET ColumnHeader = null
FROM ScreenObj a INNER JOIN ScreenObjHlp b ON a.ScreenObjId = b.ScreenObjId
WHERE a.DisplayModeId = 28 AND a.ColumnId is null AND b.ColumnHeader is not null~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=537&typ=N&sys=3","","",""); return false;
538~@~   6.  57.20727:D:   20:*:*:M: Add column to Rptwizcat~@~247~@~20~@~D~@~~@~~@~M~@~~@~Add column to Rptwizcat~@~Y~@~IF NOT EXISTS (SELECT 1 FROM dbo.syscolumns WHERE name='SampleImage')
BEGIN
	ALTER TABLE dbo.RptWizCat DROP COLUMN RptWizCatImg
	ALTER TABLE dbo.RptWizCat ADD SampleImage varbinary(max) null
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=538&typ=N&sys=3","","",""); return false;
539~@~   6.  57.20727:D:   30:*:*:M: Change all ComboBox to AutoComplete in ReportCri~@~247~@~30~@~D~@~~@~~@~M~@~~@~Change all ComboBox to AutoComplete in ReportCri~@~Y~@~update ReportCri set DisplayModeId = 38 where DisplayModeId in (18,22)~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=539&typ=N&sys=3","","",""); return false;
540~@~   6.  57.20727:D:   40:*:*:M: Change table Usr~@~247~@~40~@~D~@~~@~~@~M~@~~@~Change table Usr~@~N~@~EXEC ('CREATE TABLE dbo.Tmp_Usr (UsrId int NULL, LoginName nvarchar(32) NULL, UsrEmail nvarchar(50) NULL, UsrName nvarchar(50) NULL, UsrPassword varbinary(32) NULL, ConfirmPwd varbinary(32) NULL, ExtPassword varbinary(255) NULL, CultureId smallint NULL, InternalUsr char(1) NULL, TechnicalUsr char(1) NULL, UsrGroupLs varchar(1000) NULL, CompanyLs varchar(1000) NULL, ProjectLs varchar(1000) NULL, InvestorId int NULL, CustomerId int NULL, VendorId int NULL, AgentId int NULL, BrokerId int NULL, MemberId int NULL, DefSystemId tinyint NULL, DefProjectId smallint NULL, DefCompanyId int NULL, FailedAttempt tinyint NULL, FailedAttemptFP tinyint NULL, LastFailedDt datetime NULL, LastSuccessDt datetime NULL, LastPwdChgDt datetime NULL, HintQuestionId tinyint NULL, HintAnswer nvarchar(50) NULL, Active char(1) NULL, ModifiedOn datetime NULL, UsrImprLink varchar(200) NULL, PwdDuration smallint NULL, PwdWarn smallint NULL)')
 EXEC ('INSERT INTO dbo.Tmp_Usr (UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, LastPwdChgDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink, PwdDuration, PwdWarn) SELECT convert(int,UsrId), LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, convert(smallint,CultureId), InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, convert(int,InvestorId), convert(int,CustomerId), convert(int,VendorId), convert(int,AgentId), convert(int,BrokerId), convert(int,MemberId), convert(tinyint,DefSystemId), convert(smallint,DefProjectId), convert(int,DefCompanyId), convert(tinyint,FailedAttempt), convert(tinyint,FailedAttemptFP), LastFailedDt, LastSuccessDt, LastPwdChgDt, convert(tinyint,HintQuestionId), HintAnswer, Active, ModifiedOn, UsrImprLink, convert(smallint,PwdDuration), convert(smallint,PwdWarn) FROM dbo.Usr IF (SELECT COUNT(1) FROM dbo.Tmp_Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Usr) = 0 DROP TABLE dbo.Usr')
 EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Usr'')) CREATE TABLE dbo.Usr (UsrId Int IDENTITY NOT NULL, LoginName NVarChar(32) NOT NULL, UsrEmail NVarChar(50) NULL, UsrName NVarChar(50) NULL, UsrPassword VarBinary(32) NULL, ConfirmPwd VarBinary(32) NULL, ExtPassword VarBinary(255) NULL, CultureId SmallInt NOT NULL, InternalUsr Char(1) NOT NULL, TechnicalUsr Char(1) NOT NULL, UsrGroupLs VarChar(1000) NOT NULL, CompanyLs VarChar(1000) NULL, ProjectLs VarChar(1000) NULL, InvestorId Int NULL, CustomerId Int NULL, VendorId Int NULL, AgentId Int NULL, BrokerId Int NULL, MemberId Int NULL, DefSystemId TinyInt NOT NULL, DefProjectId SmallInt NULL, DefCompanyId Int NULL, FailedAttempt TinyInt NULL, FailedAttemptFP TinyInt NULL, LastFailedDt DateTime NULL, LastSuccessDt DateTime NULL, LastPwdChgDt DateTime NULL, HintQuestionId TinyInt NULL, HintAnswer NVarChar(50) NULL, Active Char(1) NOT NULL, ModifiedOn DateTime NOT NULL, UsrImprLink VarChar(200) NULL, PwdDuration SmallInt NOT NULL, PwdWarn SmallInt NOT NULL, PicMed VarBinary(max) NULL, CONSTRAINT PK_Usr PRIMARY KEY CLUSTERED (UsrId))')
 EXEC ('ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_CultureId DEFAULT (1) FOR CultureId ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_InternalUsr DEFAULT (''N'') FOR InternalUsr ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_TechnicalUsr DEFAULT (''N'') FOR TechnicalUsr ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdDuration DEFAULT (9999) FOR PwdDuration ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdWarn DEFAULT (0) FOR PwdWarn SET IDENTITY_INSERT dbo.Usr ON INSERT INTO dbo.Usr (UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, LastPwdChgDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink, PwdDuration, PwdWarn) SELECT UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, LastPwdChgDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink, PwdDuration, PwdWarn FROM dbo.Tmp_Usr SET IDENTITY_INSERT dbo.Usr OFF IF (SELECT COUNT(1) FROM dbo.Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Usr) = 0 DROP TABLE dbo.Tmp_Usr CREATE  NONCLUSTERED INDEX IX_Usr_UsrName ON dbo.Usr (UsrName) CREATE  UNIQUE NONCLUSTERED INDEX IX_Usr_LoginName ON dbo.Usr (LoginName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=540&typ=N&sys=3","","",""); return false;
541~@~   6.  58.20810:D:   10:*:*:M: Change table Entity~@~248~@~10~@~D~@~~@~~@~M~@~~@~Change table Entity~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_Entity (EntityId smallint NULL, EntityName nvarchar(100) NULL, EntityCode varchar(10) NULL, DeployPath varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_Entity (EntityId, EntityName, EntityCode, DeployPath) SELECT convert(smallint,EntityId), EntityName, EntityCode, DeployPath FROM dbo.Entity IF (SELECT COUNT(1) FROM dbo.Tmp_Entity) > 0 OR (SELECT COUNT(1) FROM dbo.Entity) = 0 DROP TABLE dbo.Entity') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Entity'')) CREATE TABLE dbo.Entity (EntityId SmallInt NOT NULL, EntityImg VarBinary(max) NULL, EntityName NVarChar(100) NOT NULL, EntityCode VarChar(10) NOT NULL, DeployPath VarChar(100) NOT NULL, CONSTRAINT PK_Entity PRIMARY KEY CLUSTERED (EntityId))') EXEC (' INSERT INTO dbo.Entity (EntityId, EntityName, EntityCode, DeployPath) SELECT EntityId, EntityName, EntityCode, DeployPath FROM dbo.Tmp_Entity IF (SELECT COUNT(1) FROM dbo.Entity) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Entity) = 0 DROP TABLE dbo.Tmp_Entity')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=541&typ=N&sys=3","","",""); return false;
542~@~   6.  60.20824:D:   10:*:*:M: Change table CtButtonType~@~250~@~10~@~D~@~~@~~@~M~@~~@~Change table CtButtonType~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_CtButtonType (ButtonTypeId tinyint NULL, ObjectType char(1) NULL, ButtonTypeName varchar(20) NULL, ButtonTypeDesc nvarchar(50) NULL, ButtonVisible char(1) NULL, ButtonIsImage char(1) NULL, ButtonImage varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_CtButtonType (ButtonTypeId, ObjectType, ButtonTypeName, ButtonTypeDesc, ButtonVisible, ButtonIsImage, ButtonImage) SELECT convert(tinyint,ButtonTypeId), ObjectType, ButtonTypeName, ButtonTypeDesc, ButtonVisible, ButtonIsImage, ButtonImage FROM dbo.CtButtonType IF (SELECT COUNT(1) FROM dbo.Tmp_CtButtonType) > 0 OR (SELECT COUNT(1) FROM dbo.CtButtonType) = 0 DROP TABLE dbo.CtButtonType') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtButtonType'')) CREATE TABLE dbo.CtButtonType (ButtonTypeId TinyInt NOT NULL, ObjectType Char(1) NOT NULL, ButtonTypeName VarChar(20) NOT NULL, ButtonTypeDesc NVarChar(50) NOT NULL, ButtonVisible Char(1) NOT NULL, ButtonIsImage Char(1) NOT NULL, CONSTRAINT PK_CtButtonType PRIMARY KEY CLUSTERED (ButtonTypeId))') EXEC (' INSERT INTO dbo.CtButtonType (ButtonTypeId, ObjectType, ButtonTypeName, ButtonTypeDesc, ButtonVisible, ButtonIsImage) SELECT ButtonTypeId, ObjectType, ButtonTypeName, ButtonTypeDesc, ButtonVisible, ButtonIsImage FROM dbo.Tmp_CtButtonType IF (SELECT COUNT(1) FROM dbo.CtButtonType) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtButtonType) = 0 DROP TABLE dbo.Tmp_CtButtonType CREATE  UNIQUE NONCLUSTERED INDEX IX_CtButtonType ON dbo.CtButtonType (ObjectType,ButtonTypeName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=542&typ=N&sys=3","","",""); return false;
543~@~   6.  60.20824:D:   20:*:*:M: Change table ButtonHlp~@~250~@~20~@~D~@~~@~~@~M~@~~@~Change table ButtonHlp~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ButtonHlp (ButtonHlpId int NULL, ScreenId int NULL, ReportId int NULL, WizardId int NULL, CultureId smallint NULL, ButtonTypeId tinyint NULL, ButtonName nvarchar(20) NULL, ButtonToolTip nvarchar(100) NULL, ButtonVisible char(1) NULL, ButtonIsImage char(1) NULL, ButtonImage varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_ButtonHlp (ButtonHlpId, ScreenId, ReportId, WizardId, CultureId, ButtonTypeId, ButtonName, ButtonToolTip, ButtonVisible, ButtonIsImage, ButtonImage) SELECT convert(int,ButtonHlpId), convert(int,ScreenId), convert(int,ReportId), convert(int,WizardId), convert(smallint,CultureId), convert(tinyint,ButtonTypeId), ButtonName, ButtonToolTip, ButtonVisible, ButtonIsImage, ButtonImage FROM dbo.ButtonHlp IF (SELECT COUNT(1) FROM dbo.Tmp_ButtonHlp) > 0 OR (SELECT COUNT(1) FROM dbo.ButtonHlp) = 0 DROP TABLE dbo.ButtonHlp') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ButtonHlp'')) CREATE TABLE dbo.ButtonHlp (ButtonHlpId Int IDENTITY NOT NULL, ScreenId Int NULL, ReportId Int NULL, WizardId Int NULL, CultureId SmallInt NOT NULL, ButtonTypeId TinyInt NOT NULL, ButtonName NVarChar(20) NULL, ButtonToolTip NVarChar(100) NULL, ButtonVisible Char(1) NOT NULL, ButtonIsImage Char(1) NOT NULL, CONSTRAINT PK_ButtonHlp PRIMARY KEY CLUSTERED (ButtonHlpId))') EXEC (' SET IDENTITY_INSERT dbo.ButtonHlp ON INSERT INTO dbo.ButtonHlp (ButtonHlpId, ScreenId, ReportId, WizardId, CultureId, ButtonTypeId, ButtonName, ButtonToolTip, ButtonVisible, ButtonIsImage) SELECT ButtonHlpId, ScreenId, ReportId, WizardId, CultureId, ButtonTypeId, ButtonName, ButtonToolTip, ButtonVisible, ButtonIsImage FROM dbo.Tmp_ButtonHlp SET IDENTITY_INSERT dbo.ButtonHlp OFF IF (SELECT COUNT(1) FROM dbo.ButtonHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ButtonHlp) = 0 DROP TABLE dbo.Tmp_ButtonHlp CREATE  UNIQUE NONCLUSTERED INDEX IX_ButtonHlp ON dbo.ButtonHlp (ScreenId,ReportId,WizardId,CultureId,ButtonTypeId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=543&typ=N&sys=3","","",""); return false;
544~@~   6.  61.20828:D:   10:*:*:M: Change table ReportCri~@~251~@~10~@~D~@~~@~~@~M~@~~@~Change table ReportCri~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ReportCri (ReportCriId int NULL, ReportId int NULL, ReportCriDesc varchar(100) NULL, ReportGrpId int NULL, LabelCss varchar(100) NULL, ContentCss varchar(100) NULL, TableId int NULL, TableAbbr varchar(10) NULL, ColumnName varchar(20) NULL, TabIndex smallint NULL, DataTypeId tinyint NULL, DataTypeSize smallint NULL, DisplayModeId tinyint NULL, ColumnSize smallint NULL, RowSize smallint NULL, DdlKeyColumnName varchar(50) NULL, DdlRefColumnName varchar(50) NULL, DdlSrtColumnName varchar(50) NULL, RequiredValid char(1) NULL, WhereClause varchar(1000) NULL, RegClause varchar(400) NULL)') EXEC (' INSERT INTO dbo.Tmp_ReportCri (ReportCriId, ReportId, ReportCriDesc, ReportGrpId, LabelCss, ContentCss, TableId, TableAbbr, ColumnName, TabIndex, DataTypeId, DataTypeSize, DisplayModeId, ColumnSize, RowSize, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, RequiredValid, WhereClause, RegClause) SELECT convert(int,ReportCriId), convert(int,ReportId), ReportCriDesc, convert(int,ReportGrpId), LabelCss, ContentCss, convert(int,TableId), TableAbbr, ColumnName, convert(smallint,TabIndex), convert(tinyint,DataTypeId), convert(smallint,DataTypeSize), convert(tinyint,DisplayModeId), convert(smallint,ColumnSize), convert(smallint,RowSize), DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, RequiredValid, WhereClause, RegClause FROM dbo.ReportCri IF (SELECT COUNT(1) FROM dbo.Tmp_ReportCri) > 0 OR (SELECT COUNT(1) FROM dbo.ReportCri) = 0 DROP TABLE dbo.ReportCri') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ReportCri'')) CREATE TABLE dbo.ReportCri (ReportCriId Int IDENTITY NOT NULL, ReportId Int NOT NULL, ReportCriDesc VarChar(100) NULL, ReportGrpId Int NOT NULL, LabelCss VarChar(100) NULL, ContentCss VarChar(100) NULL, TableId Int NULL, TableAbbr VarChar(10) NULL, ColumnName VarChar(20) NOT NULL, TabIndex SmallInt NOT NULL, DataTypeId TinyInt NOT NULL, DataTypeSize SmallInt NULL, DisplayModeId TinyInt NOT NULL, ColumnSize SmallInt NULL, RowSize SmallInt NULL, DdlKeyColumnName VarChar(50) NULL, DdlRefColumnName VarChar(50) NULL, DdlSrtColumnName VarChar(50) NULL, RequiredValid Char(1) NOT NULL, DefaultValue NVarChar(100) NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, CONSTRAINT PK_ReportCri PRIMARY KEY CLUSTERED (ReportCriId))') EXEC (' SET IDENTITY_INSERT dbo.ReportCri ON INSERT INTO dbo.ReportCri (ReportCriId, ReportId, ReportCriDesc, ReportGrpId, LabelCss, ContentCss, TableId, TableAbbr, ColumnName, TabIndex, DataTypeId, DataTypeSize, DisplayModeId, ColumnSize, RowSize, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, RequiredValid, WhereClause, RegClause) SELECT ReportCriId, ReportId, ReportCriDesc, ReportGrpId, LabelCss, ContentCss, TableId, TableAbbr, ColumnName, TabIndex, DataTypeId, DataTypeSize, DisplayModeId, ColumnSize, RowSize, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, RequiredValid, WhereClause, RegClause FROM dbo.Tmp_ReportCri SET IDENTITY_INSERT dbo.ReportCri OFF IF (SELECT COUNT(1) FROM dbo.ReportCri) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ReportCri) = 0 DROP TABLE dbo.Tmp_ReportCri CREATE  UNIQUE NONCLUSTERED INDEX IX_ReportCri_ReportId ON dbo.ReportCri (ReportId,TabIndex,ColumnName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=544&typ=N&sys=3","","",""); return false;
545~@~   6.  61.20828:D:   20:*:*:M: Change table Report~@~251~@~20~@~D~@~~@~~@~M~@~~@~Change table Report~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Report (ReportId int NULL, ProgramName varchar(20) NULL, ReportDesc nvarchar(50) NULL, OrientationCd char(1) NULL, ReportTypeCd char(1) NULL, TemplateName varchar(50) NULL, RptTemplate int NULL, CopyReportId int NULL, TopMargin decimal(8,2) NULL, BottomMargin decimal(8,2) NULL, LeftMargin decimal(8,2) NULL, RightMargin decimal(8,2) NULL, PageHeight decimal(8,2) NULL, PageWidth decimal(8,2) NULL, UnitCd char(2) NULL, WhereClause varchar(1000) NULL, RegClause varchar(400) NULL, RegCode nvarchar(max) NULL, ValClause varchar(400) NULL, ValCode nvarchar(max) NULL, UpdClause varchar(200) NULL, UpdCode nvarchar(max) NULL, XlsClause varchar(200) NULL, XlsCode nvarchar(max) NULL, GenerateRp char(1) NULL, AllowSelect char(1) NULL, ModifiedBy int NULL, ModifiedOn datetime NULL, LastGenDt datetime NULL, CompanyLs varchar(1000) NULL, NeedRegen char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Report (ReportId, ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, RptTemplate, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, ModifiedBy, ModifiedOn, LastGenDt, CompanyLs, NeedRegen) SELECT convert(int,ReportId), ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, convert(int,RptTemplate), convert(int,CopyReportId), convert(decimal(8,2),TopMargin), convert(decimal(8,2),BottomMargin), convert(decimal(8,2),LeftMargin), convert(decimal(8,2),RightMargin), convert(decimal(8,2),PageHeight), convert(decimal(8,2),PageWidth), UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, convert(int,ModifiedBy), ModifiedOn, LastGenDt, CompanyLs, NeedRegen FROM dbo.Report IF (SELECT COUNT(1) FROM dbo.Tmp_Report) > 0 OR (SELECT COUNT(1) FROM dbo.Report) = 0 DROP TABLE dbo.Report') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Report'')) CREATE TABLE dbo.Report (ReportId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ReportDesc NVarChar(50) NULL, OrientationCd Char(1) NOT NULL, ReportTypeCd Char(1) NOT NULL, TemplateName VarChar(50) NULL, RptTemplate Int NULL, CopyReportId Int NULL, TopMargin Decimal(8,2) NOT NULL, BottomMargin Decimal(8,2) NOT NULL, LeftMargin Decimal(8,2) NOT NULL, RightMargin Decimal(8,2) NOT NULL, PageHeight Decimal(8,2) NOT NULL, PageWidth Decimal(8,2) NOT NULL, UnitCd Char(2) NOT NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, RegCode NVarChar(max) NULL, ValClause VarChar(400) NULL, ValCode NVarChar(max) NULL, UpdClause VarChar(200) NULL, UpdCode NVarChar(max) NULL, XlsClause VarChar(200) NULL, XlsCode NVarChar(max) NULL, GenerateRp Char(1) NOT NULL, AllowSelect Char(1) NOT NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, CompanyLs VarChar(1000) NULL, NeedRegen Char(1) NOT NULL, AuthRequired Char(1) NOT NULL, CONSTRAINT PK_Report PRIMARY KEY CLUSTERED (ReportId))') EXEC (' ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_TopMargin DEFAULT (1) FOR TopMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_BottomMargin DEFAULT (1) FOR BottomMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_LeftMargin DEFAULT (1) FOR LeftMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_RightMargin DEFAULT (1) FOR RightMargin ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_PageHeight DEFAULT (11) FOR PageHeight ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_PageWidth DEFAULT (8.5) FOR PageWidth ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_UnitCd DEFAULT (''in'') FOR UnitCd ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_AllowSelect DEFAULT (''N'') FOR AllowSelect ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_NeedRegen DEFAULT (''N'') FOR NeedRegen ALTER TABLE dbo.Report ADD CONSTRAINT DF_Report_AuthRequired DEFAULT (''Y'') FOR AuthRequired SET IDENTITY_INSERT dbo.Report ON INSERT INTO dbo.Report (ReportId, ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, RptTemplate, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, ModifiedBy, ModifiedOn, LastGenDt, CompanyLs, NeedRegen, AuthRequired) SELECT ReportId, ProgramName, ReportDesc, OrientationCd, ReportTypeCd, TemplateName, RptTemplate, CopyReportId, TopMargin, BottomMargin, LeftMargin, RightMargin, PageHeight, PageWidth, UnitCd, WhereClause, RegClause, RegCode, ValClause, ValCode, UpdClause, UpdCode, XlsClause, XlsCode, GenerateRp, AllowSelect, ModifiedBy, ModifiedOn, LastGenDt, CompanyLs, NeedRegen, ''Y'' FROM dbo.Tmp_Report SET IDENTITY_INSERT dbo.Report OFF IF (SELECT COUNT(1) FROM dbo.Report) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Report) = 0 DROP TABLE dbo.Tmp_Report CREATE  UNIQUE NONCLUSTERED INDEX IX_Report_ProgramName ON dbo.Report (ProgramName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=545&typ=N&sys=3","","",""); return false;
546~@~   6.  61.20828:D:   30:*:*:M: Change table Screen~@~251~@~30~@~D~@~~@~~@~M~@~~@~Change table Screen~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Screen (ScreenId int NULL, ProgramName varchar(20) NULL, ScreenDesc nvarchar(50) NULL, ScreenTypeId tinyint NULL, MasterTableId int NULL, DetailTableId int NULL, SearchId smallint NULL, SearchWidth smallint NULL, SearchAscending char(1) NULL, SearchMode char(1) NULL, NumCols tinyint NULL, GridRows tinyint NULL, GridClass varchar(30) NULL, GridTitle nvarchar(50) NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL, GenerateSc char(1) NULL, GenerateSr char(1) NULL, HasDeleteAll char(1) NULL, ValidateReq char(1) NULL, DeferError char(1) NULL, MasterPageFile varchar(100) NULL, NeedRegen char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, NumCols, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, MasterPageFile, NeedRegen) SELECT convert(int,ScreenId), ProgramName, ScreenDesc, convert(tinyint,ScreenTypeId), convert(int,MasterTableId), convert(int,DetailTableId), convert(smallint,SearchId), convert(smallint,SearchWidth), SearchAscending, SearchMode, convert(tinyint,NumCols), convert(tinyint,GridRows), GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, MasterPageFile, NeedRegen FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchId SmallInt NULL, SearchWidth SmallInt NULL, SearchAscending Char(1) NOT NULL, SearchMode Char(1) NULL, NumCols TinyInt NOT NULL, GridRows TinyInt NULL, GridClass VarChar(30) NULL, GridTitle NVarChar(50) NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, GenerateSr Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, MasterPageFile VarChar(100) NOT NULL, NeedRegen Char(1) NOT NULL, AuthRequired Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NumCols DEFAULT (1) FOR NumCols ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSc DEFAULT (''Y'') FOR GenerateSc ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSr DEFAULT (''Y'') FOR GenerateSr ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_MasterPageFile DEFAULT (''Default.master'') FOR MasterPageFile ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NeedRegen DEFAULT (''N'') FOR NeedRegen ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_AuthRequired DEFAULT (''Y'') FOR AuthRequired SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, NumCols, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, MasterPageFile, NeedRegen, AuthRequired) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, NumCols, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, MasterPageFile, NeedRegen, ''Y'' FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen CREATE  UNIQUE NONCLUSTERED INDEX IX_Screen_ProgramName ON dbo.Screen (ProgramName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=546&typ=N&sys=3","","",""); return false;
547~@~   6.  61.20828:D:   40:*:*:M: Change table Wizard~@~251~@~40~@~D~@~~@~~@~M~@~~@~Change table Wizard~@~Y~@~ EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_WizardObj_Wizard'') ALTER TABLE dbo.WizardObj DROP CONSTRAINT FK_WizardObj_Wizard CREATE TABLE dbo.Tmp_Wizard (WizardId int NULL, WizardTypeId tinyint NULL, MasterTableId int NULL, WizardTitle nvarchar(50) NULL, ProgramName varchar(50) NULL, DefWorkSheet nvarchar(50) NULL, DefStartRow smallint NULL, DefOverwrite char(1) NULL, OvwrReadonly char(1) NULL, NeedRegen char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Wizard (WizardId, WizardTypeId, MasterTableId, WizardTitle, ProgramName, DefWorkSheet, DefStartRow, DefOverwrite, OvwrReadonly, NeedRegen) SELECT convert(int,WizardId), convert(tinyint,WizardTypeId), convert(int,MasterTableId), WizardTitle, ProgramName, DefWorkSheet, convert(smallint,DefStartRow), DefOverwrite, OvwrReadonly, NeedRegen FROM dbo.Wizard IF (SELECT COUNT(1) FROM dbo.Tmp_Wizard) > 0 OR (SELECT COUNT(1) FROM dbo.Wizard) = 0 DROP TABLE dbo.Wizard') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Wizard'')) CREATE TABLE dbo.Wizard (WizardId Int IDENTITY NOT NULL, WizardTypeId TinyInt NOT NULL, MasterTableId Int NOT NULL, WizardTitle NVarChar(50) NOT NULL, ProgramName VarChar(50) NOT NULL, DefWorkSheet NVarChar(50) NOT NULL, DefStartRow SmallInt NOT NULL, DefOverwrite Char(1) NOT NULL, OvwrReadonly Char(1) NOT NULL, NeedRegen Char(1) NOT NULL, AuthRequired Char(1) NOT NULL, CONSTRAINT PK_Wizard PRIMARY KEY CLUSTERED (WizardId))') EXEC (' ALTER TABLE dbo.Wizard ADD CONSTRAINT DF_Wizard_NeedRegen DEFAULT (''N'') FOR NeedRegen ALTER TABLE dbo.Wizard ADD CONSTRAINT DF_Wizard_AuthRequired DEFAULT (''Y'') FOR AuthRequired SET IDENTITY_INSERT dbo.Wizard ON INSERT INTO dbo.Wizard (WizardId, WizardTypeId, MasterTableId, WizardTitle, ProgramName, DefWorkSheet, DefStartRow, DefOverwrite, OvwrReadonly, NeedRegen, AuthRequired) SELECT WizardId, WizardTypeId, MasterTableId, WizardTitle, ProgramName, DefWorkSheet, DefStartRow, DefOverwrite, OvwrReadonly, NeedRegen, ''Y'' FROM dbo.Tmp_Wizard SET IDENTITY_INSERT dbo.Wizard OFF IF (SELECT COUNT(1) FROM dbo.Wizard) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Wizard) = 0 DROP TABLE dbo.Tmp_Wizard ALTER TABLE dbo.WizardObj WITH NOCHECK ADD CONSTRAINT FK_WizardObj_Wizard FOREIGN KEY (WizardId) REFERENCES dbo.Wizard (WizardId) IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IU_Wizard'') CREATE UNIQUE NONCLUSTERED INDEX IU_Wizard ON dbo.Wizard(ProgramName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=547&typ=N&sys=3","","",""); return false;
548~@~   6.  61.20828:D:   50:*:*:M: Change table UsrPref~@~251~@~50~@~D~@~~@~~@~M~@~~@~Change table UsrPref~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_UsrPref (UsrPrefId int NULL, UsrId int NULL, UsrGroupId smallint NULL, CompanyId int NULL, MemberId int NULL, AgentId int NULL, BrokerId int NULL, CustomerId int NULL, InvestorId int NULL, VendorId int NULL, ProjectId smallint NULL, SystemId tinyint NULL, PrefDefault char(1) NULL, UsrPrefDesc nvarchar(50) NULL, SysListVisible char(1) NULL, ComListVisible char(1) NULL, PrjListVisible char(1) NULL, MenuOptId int NULL, PageBannerImg varchar(100) NULL, UsrStyleSheet varchar(max) NULL, SplashImg varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_UsrPref (UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOptId, PageBannerImg, UsrStyleSheet, SplashImg) SELECT convert(int,UsrPrefId), convert(int,UsrId), convert(smallint,UsrGroupId), convert(int,CompanyId), convert(int,MemberId), convert(int,AgentId), convert(int,BrokerId), convert(int,CustomerId), convert(int,InvestorId), convert(int,VendorId), convert(smallint,ProjectId), convert(tinyint,SystemId), PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, convert(int,MenuOptId), PageBannerImg, UsrStyleSheet, SplashImg FROM dbo.UsrPref IF (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.UsrPref) = 0 DROP TABLE dbo.UsrPref') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrPref'')) CREATE TABLE dbo.UsrPref (UsrPrefId Int IDENTITY NOT NULL, UsrId Int NULL, UsrGroupId SmallInt NULL, CompanyId Int NULL, MemberId Int NULL, AgentId Int NULL, BrokerId Int NULL, CustomerId Int NULL, InvestorId Int NULL, VendorId Int NULL, ProjectId SmallInt NULL, SystemId TinyInt NULL, PrefDefault Char(1) NOT NULL, UsrPrefDesc NVarChar(50) NOT NULL, SysListVisible Char(1) NOT NULL, ComListVisible Char(1) NOT NULL, PrjListVisible Char(1) NOT NULL, MenuOptId Int NOT NULL, PageBannerImg VarChar(100) NULL, UsrStyleSheet VarChar(max) NULL, SplashImg VarChar(100) NULL, MasterPgFile VarChar(100) NULL, CONSTRAINT PK_UsrPref PRIMARY KEY CLUSTERED (UsrPrefId))') EXEC (' ALTER TABLE dbo.UsrPref ADD CONSTRAINT DF_UsrPref_PrjListVisible DEFAULT (''N'') FOR PrjListVisible SET IDENTITY_INSERT dbo.UsrPref ON INSERT INTO dbo.UsrPref (UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOptId, PageBannerImg, UsrStyleSheet, SplashImg) SELECT UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOptId, PageBannerImg, UsrStyleSheet, SplashImg FROM dbo.Tmp_UsrPref SET IDENTITY_INSERT dbo.UsrPref OFF IF (SELECT COUNT(1) FROM dbo.UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) = 0 DROP TABLE dbo.Tmp_UsrPref')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=548&typ=N&sys=3","","",""); return false;
549~@~   6.  61.20828:D:   60:*:*:M: Change table Screen~@~251~@~60~@~D~@~~@~~@~M~@~~@~Change table Screen~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Screen (ScreenId int NULL, ProgramName varchar(20) NULL, ScreenDesc nvarchar(50) NULL, ScreenTypeId tinyint NULL, MasterTableId int NULL, DetailTableId int NULL, SearchId smallint NULL, SearchWidth smallint NULL, SearchAscending char(1) NULL, SearchMode char(1) NULL, NumCols tinyint NULL, GridRows tinyint NULL, GridClass varchar(30) NULL, GridTitle nvarchar(50) NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL, GenerateSc char(1) NULL, GenerateSr char(1) NULL, HasDeleteAll char(1) NULL, ValidateReq char(1) NULL, DeferError char(1) NULL, MasterPageFile varchar(100) NULL, NeedRegen char(1) NULL, AuthRequired char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, NumCols, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, MasterPageFile, NeedRegen, AuthRequired) SELECT convert(int,ScreenId), ProgramName, ScreenDesc, convert(tinyint,ScreenTypeId), convert(int,MasterTableId), convert(int,DetailTableId), convert(smallint,SearchId), convert(smallint,SearchWidth), SearchAscending, SearchMode, convert(tinyint,NumCols), convert(tinyint,GridRows), GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, MasterPageFile, NeedRegen, AuthRequired FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchId SmallInt NULL, SearchWidth SmallInt NULL, SearchAscending Char(1) NOT NULL, SearchMode Char(1) NULL, NumCols TinyInt NOT NULL, GridRows TinyInt NULL, GridClass VarChar(30) NULL, GridTitle NVarChar(50) NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, GenerateSr Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, NeedRegen Char(1) NOT NULL, AuthRequired Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NumCols DEFAULT (1) FOR NumCols ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSc DEFAULT (''Y'') FOR GenerateSc ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSr DEFAULT (''Y'') FOR GenerateSr ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NeedRegen DEFAULT (''N'') FOR NeedRegen ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_AuthRequired DEFAULT (''Y'') FOR AuthRequired SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, NumCols, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, NeedRegen, AuthRequired) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, NumCols, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, NeedRegen, AuthRequired FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen CREATE  UNIQUE NONCLUSTERED INDEX IX_Screen_ProgramName ON dbo.Screen (ProgramName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=549&typ=N&sys=3","","",""); return false;
550~@~   6.  62.20829:D:   10:*:*:M: Change table UsrPref~@~252~@~10~@~D~@~~@~~@~M~@~~@~Change table UsrPref~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_UsrPref (UsrPrefId int NULL, UsrId int NULL, UsrGroupId smallint NULL, CompanyId int NULL, MemberId int NULL, AgentId int NULL, BrokerId int NULL, CustomerId int NULL, InvestorId int NULL, VendorId int NULL, ProjectId smallint NULL, SystemId tinyint NULL, PrefDefault char(1) NULL, UsrPrefDesc nvarchar(50) NULL, SysListVisible char(1) NULL, ComListVisible char(1) NULL, PrjListVisible char(1) NULL, MenuOptId int NULL, PageBannerImg varchar(100) NULL, UsrStyleSheet varchar(max) NULL, SplashImg varchar(100) NULL, MasterPgFile varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_UsrPref (UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOptId, PageBannerImg, UsrStyleSheet, SplashImg, MasterPgFile) SELECT convert(int,UsrPrefId), convert(int,UsrId), convert(smallint,UsrGroupId), convert(int,CompanyId), convert(int,MemberId), convert(int,AgentId), convert(int,BrokerId), convert(int,CustomerId), convert(int,InvestorId), convert(int,VendorId), convert(smallint,ProjectId), convert(tinyint,SystemId), PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, convert(int,MenuOptId), PageBannerImg, UsrStyleSheet, SplashImg, MasterPgFile FROM dbo.UsrPref IF (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.UsrPref) = 0 DROP TABLE dbo.UsrPref') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrPref'')) CREATE TABLE dbo.UsrPref (UsrPrefId Int IDENTITY NOT NULL, UsrId Int NULL, UsrGroupId SmallInt NULL, CompanyId Int NULL, MemberId Int NULL, AgentId Int NULL, BrokerId Int NULL, CustomerId Int NULL, InvestorId Int NULL, VendorId Int NULL, ProjectId SmallInt NULL, SystemId TinyInt NULL, PrefDefault Char(1) NOT NULL, UsrPrefDesc NVarChar(50) NOT NULL, SysListVisible Char(1) NOT NULL, ComListVisible Char(1) NOT NULL, PrjListVisible Char(1) NOT NULL, MenuOptId Int NOT NULL, PageBannerImg VarChar(100) NULL, UsrStyleSheet VarChar(max) NULL, SplashImg VarChar(100) NULL, MasterPgFile VarChar(100) NULL, SampleImage VarBinary(max) NULL, CONSTRAINT PK_UsrPref PRIMARY KEY CLUSTERED (UsrPrefId))') EXEC (' ALTER TABLE dbo.UsrPref ADD CONSTRAINT DF_UsrPref_PrjListVisible DEFAULT (''N'') FOR PrjListVisible SET IDENTITY_INSERT dbo.UsrPref ON INSERT INTO dbo.UsrPref (UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOptId, PageBannerImg, UsrStyleSheet, SplashImg, MasterPgFile) SELECT UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOptId, PageBannerImg, UsrStyleSheet, SplashImg, MasterPgFile FROM dbo.Tmp_UsrPref SET IDENTITY_INSERT dbo.UsrPref OFF IF (SELECT COUNT(1) FROM dbo.UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) = 0 DROP TABLE dbo.Tmp_UsrPref')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=550&typ=N&sys=3","","",""); return false;
551~@~   6.  64.20912:D:   10:*:*:M: Change table StaticPg~@~254~@~10~@~D~@~~@~~@~M~@~~@~Change table StaticPg~@~Y~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.StaticPg'')) CREATE TABLE dbo.StaticPg (StaticPgId Int IDENTITY NOT NULL, StaticPgTitle NVarChar(50) NOT NULL, StaticPgCss NVarChar(max) NULL, StaticPgHtm NVarChar(max) NOT NULL, MasterPgFile VarChar(100) NULL, CONSTRAINT PK_StaticPg PRIMARY KEY CLUSTERED (StaticPgId))') EXEC ('') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=551&typ=N&sys=3","","",""); return false;
552~@~   6.  65.20913:D:   10:*:*:M: Change table Menu~@~255~@~10~@~D~@~~@~~@~M~@~~@~Change table Menu~@~Y~@~ EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_MenuHlp_Menu'') ALTER TABLE dbo.MenuHlp DROP CONSTRAINT FK_MenuHlp_Menu CREATE TABLE dbo.Tmp_Menu (MenuId int NULL, MenuIndex smallint NULL, MenuName varchar(30) NULL, MenuDesc nvarchar(100) NULL, Miscellaneous varchar(500) NULL, ParentId int NULL, ReportId int NULL, ScreenId int NULL, WizardId int NULL, IconUrl nvarchar(500) NULL)') EXEC (' INSERT INTO dbo.Tmp_Menu (MenuId, MenuIndex, MenuName, MenuDesc, Miscellaneous, ParentId, ReportId, ScreenId, WizardId, IconUrl) SELECT convert(int,MenuId), convert(smallint,MenuIndex), MenuName, MenuDesc, Miscellaneous, convert(int,ParentId), convert(int,ReportId), convert(int,ScreenId), convert(int,WizardId), IconUrl FROM dbo.Menu IF (SELECT COUNT(1) FROM dbo.Tmp_Menu) > 0 OR (SELECT COUNT(1) FROM dbo.Menu) = 0 DROP TABLE dbo.Menu') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Menu'')) CREATE TABLE dbo.Menu (MenuId Int IDENTITY NOT NULL, MenuIndex SmallInt NOT NULL, MenuName VarChar(30) NOT NULL, MenuDesc NVarChar(100) NULL, Miscellaneous VarChar(100) NULL, ParentId Int NULL, ReportId Int NULL, ScreenId Int NULL, WizardId Int NULL, StaticPgId Int NULL, IconUrl NVarChar(300) NULL, CONSTRAINT PK_Menu PRIMARY KEY CLUSTERED (MenuId))') EXEC (' SET IDENTITY_INSERT dbo.Menu ON INSERT INTO dbo.Menu (MenuId, MenuIndex, MenuName, MenuDesc, Miscellaneous, ParentId, ReportId, ScreenId, WizardId, IconUrl) SELECT MenuId, MenuIndex, MenuName, MenuDesc, Miscellaneous, ParentId, ReportId, ScreenId, WizardId, IconUrl FROM dbo.Tmp_Menu SET IDENTITY_INSERT dbo.Menu OFF IF (SELECT COUNT(1) FROM dbo.Menu) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Menu) = 0 DROP TABLE dbo.Tmp_Menu CREATE  NONCLUSTERED INDEX IX_Menu_ParentId ON dbo.Menu (ParentId,MenuIndex) ALTER TABLE dbo.MenuHlp WITH NOCHECK ADD CONSTRAINT FK_MenuHlp_Menu FOREIGN KEY (MenuId) REFERENCES dbo.Menu (MenuId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=552&typ=N&sys=3","","",""); return false;
553~@~   6.  67.20921:D:   10:*:*:M: Change table Screen~@~257~@~10~@~D~@~~@~~@~M~@~~@~Change table Screen~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Screen (ScreenId int NULL, ProgramName varchar(20) NULL, ScreenDesc nvarchar(50) NULL, ScreenTypeId tinyint NULL, MasterTableId int NULL, DetailTableId int NULL, SearchId smallint NULL, SearchWidth smallint NULL, SearchAscending char(1) NULL, SearchMode char(1) NULL, NumCols tinyint NULL, GridRows tinyint NULL, GridClass varchar(30) NULL, GridTitle nvarchar(50) NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL, GenerateSc char(1) NULL, GenerateSr char(1) NULL, HasDeleteAll char(1) NULL, ValidateReq char(1) NULL, DeferError char(1) NULL, NeedRegen char(1) NULL, AuthRequired char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, NumCols, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, NeedRegen, AuthRequired) SELECT convert(int,ScreenId), ProgramName, ScreenDesc, convert(tinyint,ScreenTypeId), convert(int,MasterTableId), convert(int,DetailTableId), convert(smallint,SearchId), convert(smallint,SearchWidth), SearchAscending, SearchMode, convert(tinyint,NumCols), convert(tinyint,GridRows), GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, NeedRegen, AuthRequired FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchId Int NULL, SearchWidth SmallInt NULL, SearchAscending Char(1) NOT NULL, SearchMode Char(1) NULL, NumCols TinyInt NOT NULL, GridRows TinyInt NULL, GridClass VarChar(30) NULL, GridTitle NVarChar(50) NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, GenerateSr Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, NeedRegen Char(1) NOT NULL, AuthRequired Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NumCols DEFAULT (1) FOR NumCols ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSc DEFAULT (''Y'') FOR GenerateSc ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSr DEFAULT (''Y'') FOR GenerateSr ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NeedRegen DEFAULT (''N'') FOR NeedRegen ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_AuthRequired DEFAULT (''Y'') FOR AuthRequired SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, NumCols, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, NeedRegen, AuthRequired) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, CONVERT(Int,SearchId), SearchWidth, SearchAscending, SearchMode, NumCols, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, NeedRegen, AuthRequired FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen CREATE  UNIQUE NONCLUSTERED INDEX IX_Screen_ProgramName ON dbo.Screen (ProgramName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=553&typ=N&sys=3","","",""); return false;
554~@~   6.  67.20921:D:   20:*:*:M: Change table CtDisplayType~@~257~@~20~@~D~@~~@~~@~M~@~~@~Change table CtDisplayType~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_CtDisplayType (TypeId tinyint NULL, TypeName varchar(20) NULL, TypeDesc varchar(20) NULL, DisplayDefault char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_CtDisplayType (TypeId, TypeName, TypeDesc, DisplayDefault) SELECT convert(tinyint,TypeId), TypeName, TypeDesc, DisplayDefault FROM dbo.CtDisplayType IF (SELECT COUNT(1) FROM dbo.Tmp_CtDisplayType) > 0 OR (SELECT COUNT(1) FROM dbo.CtDisplayType) = 0 DROP TABLE dbo.CtDisplayType') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtDisplayType'')) CREATE TABLE dbo.CtDisplayType (TypeId TinyInt NOT NULL, TypeName VarChar(20) NOT NULL, TypeDesc VarChar(20) NOT NULL, DisplayDesc NVarChar(1000) NULL, DisplayDefault Char(1) NOT NULL, CONSTRAINT PK_CtDisplayType PRIMARY KEY CLUSTERED (TypeId))') EXEC (' INSERT INTO dbo.CtDisplayType (TypeId, TypeName, TypeDesc, DisplayDefault) SELECT TypeId, TypeName, TypeDesc, DisplayDefault FROM dbo.Tmp_CtDisplayType IF (SELECT COUNT(1) FROM dbo.CtDisplayType) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtDisplayType) = 0 DROP TABLE dbo.Tmp_CtDisplayType')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=554&typ=N&sys=3","","",""); return false;
555~@~   6.  67.20921:D:   30:*:*:M: Change table ClientTier~@~257~@~30~@~D~@~~@~~@~M~@~~@~Change table ClientTier~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_ClientTier (ClientTierId tinyint NULL, ClientTierName nvarchar(50) NULL, EntityId int NULL, LanguageCd char(1) NULL, FrameworkCd char(1) NULL, DevProgramPath varchar(100) NULL, WsProgramPath varchar(100) NULL, XlsProgramPath varchar(100) NULL, DevCompilePath varchar(100) NULL, WsCompilePath varchar(100) NULL, XlsCompilePath varchar(100) NULL, IsDefault char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_ClientTier (ClientTierId, ClientTierName, EntityId, LanguageCd, FrameworkCd, DevProgramPath, WsProgramPath, XlsProgramPath, DevCompilePath, WsCompilePath, XlsCompilePath, IsDefault) SELECT convert(tinyint,ClientTierId), ClientTierName, convert(int,EntityId), LanguageCd, FrameworkCd, DevProgramPath, WsProgramPath, XlsProgramPath, DevCompilePath, WsCompilePath, XlsCompilePath, IsDefault FROM dbo.ClientTier IF (SELECT COUNT(1) FROM dbo.Tmp_ClientTier) > 0 OR (SELECT COUNT(1) FROM dbo.ClientTier) = 0 DROP TABLE dbo.ClientTier') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ClientTier'')) CREATE TABLE dbo.ClientTier (ClientTierId TinyInt NOT NULL, ClientTierName NVarChar(50) NOT NULL, EntityId Int NOT NULL, LanguageCd Char(1) NOT NULL, FrameworkCd Char(1) NOT NULL, DevProgramPath VarChar(100) NOT NULL, WsProgramPath VarChar(100) NULL, XlsProgramPath VarChar(100) NULL, DevCompilePath VarChar(100) NULL, WsCompilePath VarChar(100) NULL, XlsCompilePath VarChar(100) NULL, CombineAsm Char(1) NOT NULL, IsDefault Char(1) NOT NULL, CONSTRAINT PK_ClientTier PRIMARY KEY CLUSTERED (ClientTierId))') EXEC (' ALTER TABLE dbo.ClientTier ADD CONSTRAINT DF_ClientTier_CombineAsm DEFAULT (''N'') FOR CombineAsm INSERT INTO dbo.ClientTier (ClientTierId, ClientTierName, EntityId, LanguageCd, FrameworkCd, DevProgramPath, WsProgramPath, XlsProgramPath, DevCompilePath, WsCompilePath, XlsCompilePath, CombineAsm, IsDefault) SELECT ClientTierId, ClientTierName, EntityId, LanguageCd, FrameworkCd, DevProgramPath, WsProgramPath, XlsProgramPath, DevCompilePath, WsCompilePath, XlsCompilePath, ''N'', IsDefault FROM dbo.Tmp_ClientTier IF (SELECT COUNT(1) FROM dbo.ClientTier) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ClientTier) = 0 DROP TABLE dbo.Tmp_ClientTier')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=555&typ=N&sys=3","","",""); return false;
556~@~   6.  69.20926:D:   10:*:*:M: Change table StaticJs~@~259~@~10~@~D~@~~@~~@~M~@~~@~Change table StaticJs~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.StaticJs'')) CREATE TABLE dbo.StaticJs (StaticJsId SmallInt IDENTITY NOT NULL, StaticJsNm NVarChar(200) NOT NULL, ScriptDef NVarChar(max) NULL, CONSTRAINT PK_StaticJs PRIMARY KEY CLUSTERED (StaticJsId))') EXEC ('') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=556&typ=N&sys=3","","",""); return false;
557~@~   6.  69.20926:D:   20:*:*:M: Change table StaticCs~@~259~@~20~@~D~@~~@~~@~M~@~~@~Change table StaticCs~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.StaticCs'')) CREATE TABLE dbo.StaticCs (StaticCsId SmallInt IDENTITY NOT NULL, StaticCsNm NVarChar(200) NOT NULL, StyleDef NVarChar(max) NULL, CONSTRAINT PK_StaticCs PRIMARY KEY CLUSTERED (StaticCsId))') EXEC ('') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=557&typ=N&sys=3","","",""); return false;
558~@~   6.  69.20926:D:   30:*:*:M: Change table StaticFi~@~259~@~30~@~D~@~~@~~@~M~@~~@~Change table StaticFi~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.StaticFi'')) CREATE TABLE dbo.StaticFi (StaticFiId Int IDENTITY NOT NULL, StaticFiUrl NVarChar(200) NOT NULL, CONSTRAINT PK_StaticFi PRIMARY KEY CLUSTERED (StaticFiId))') EXEC ('') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=558&typ=N&sys=3","","",""); return false;
559~@~   6.  69.20926:D:   40:*:*:M: Change table StaticPg~@~259~@~40~@~D~@~~@~~@~M~@~~@~Change table StaticPg~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_StaticPg (StaticPgId int NULL, StaticPgTitle nvarchar(50) NULL, StaticPgCss nvarchar(max) NULL, StaticPgHtm nvarchar(max) NULL, MasterPgFile varchar(100) NULL)')
EXEC ('INSERT INTO dbo.Tmp_StaticPg (StaticPgId, StaticPgTitle, StaticPgCss, StaticPgHtm, MasterPgFile) SELECT convert(int,StaticPgId), StaticPgTitle, StaticPgCss, StaticPgHtm, MasterPgFile FROM dbo.StaticPg IF (SELECT COUNT(1) FROM dbo.Tmp_StaticPg) > 0 OR (SELECT COUNT(1) FROM dbo.StaticPg) = 0 DROP TABLE dbo.StaticPg')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.StaticPg'')) CREATE TABLE dbo.StaticPg (StaticPgId Int IDENTITY NOT NULL, StaticPgTitle NVarChar(50) NOT NULL, StaticPgCss NVarChar(max) NULL, StaticPgJs NVarChar(max) NULL, StaticPgHtm NVarChar(max) NOT NULL, MasterPgFile VarChar(100) NULL, StaticCsId SmallInt NULL, StaticJsId SmallInt NULL, CONSTRAINT PK_StaticPg PRIMARY KEY CLUSTERED (StaticPgId))')
EXEC ('SET IDENTITY_INSERT dbo.StaticPg ON INSERT INTO dbo.StaticPg (StaticPgId, StaticPgTitle, StaticPgCss, StaticPgHtm, MasterPgFile) SELECT StaticPgId, StaticPgTitle, StaticPgCss, StaticPgHtm, MasterPgFile FROM dbo.Tmp_StaticPg SET IDENTITY_INSERT dbo.StaticPg OFF IF (SELECT COUNT(1) FROM dbo.StaticPg) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_StaticPg) = 0 DROP TABLE dbo.Tmp_StaticPg')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=559&typ=N&sys=3","","",""); return false;
560~@~   6.  70.20927:D:   10:*:*:M: Change table StaticPg~@~260~@~10~@~D~@~~@~~@~M~@~~@~Change table StaticPg~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_StaticPg (StaticPgId int NULL, StaticPgTitle nvarchar(50) NULL, StaticPgCss nvarchar(max) NULL, StaticPgJs nvarchar(max) NULL, StaticPgHtm nvarchar(max) NULL, MasterPgFile varchar(100) NULL, StaticCsId smallint NULL, StaticJsId smallint NULL)') EXEC (' INSERT INTO dbo.Tmp_StaticPg (StaticPgId, StaticPgTitle, StaticPgCss, StaticPgJs, StaticPgHtm, MasterPgFile, StaticCsId, StaticJsId) SELECT convert(int,StaticPgId), StaticPgTitle, StaticPgCss, StaticPgJs, StaticPgHtm, MasterPgFile, convert(smallint,StaticCsId), convert(smallint,StaticJsId) FROM dbo.StaticPg IF (SELECT COUNT(1) FROM dbo.Tmp_StaticPg) > 0 OR (SELECT COUNT(1) FROM dbo.StaticPg) = 0 DROP TABLE dbo.StaticPg') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.StaticPg'')) CREATE TABLE dbo.StaticPg (StaticPgId Int IDENTITY NOT NULL, StaticPgNm VarChar(50) NULL, StaticPgTitle NVarChar(100) NOT NULL, StaticPgCss NVarChar(max) NULL, StaticPgJs NVarChar(max) NULL, StaticPgHtm NVarChar(max) NOT NULL, MasterPgFile VarChar(100) NULL, StaticCsId SmallInt NULL, StaticJsId SmallInt NULL, CONSTRAINT PK_StaticPg PRIMARY KEY CLUSTERED (StaticPgId))') EXEC (' SET IDENTITY_INSERT dbo.StaticPg ON INSERT INTO dbo.StaticPg (StaticPgId, StaticPgTitle, StaticPgCss, StaticPgJs, StaticPgHtm, MasterPgFile, StaticCsId, StaticJsId) SELECT StaticPgId, StaticPgTitle, StaticPgCss, StaticPgJs, StaticPgHtm, MasterPgFile, StaticCsId, StaticJsId FROM dbo.Tmp_StaticPg SET IDENTITY_INSERT dbo.StaticPg OFF IF (SELECT COUNT(1) FROM dbo.StaticPg) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_StaticPg) = 0 DROP TABLE dbo.Tmp_StaticPg')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=560&typ=N&sys=3","","",""); return false;
561~@~   6.  70.20927:D:   20:*:*:M: Change table StaticPg~@~260~@~20~@~D~@~~@~~@~M~@~~@~Change table StaticPg~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_StaticPg (StaticPgId int NULL, StaticPgNm varchar(50) NULL, StaticPgTitle nvarchar(100) NULL, StaticPgCss nvarchar(max) NULL, StaticPgJs nvarchar(max) NULL, StaticPgHtm nvarchar(max) NULL, MasterPgFile varchar(100) NULL, StaticCsId smallint NULL, StaticJsId smallint NULL)') EXEC (' INSERT INTO dbo.Tmp_StaticPg (StaticPgId, StaticPgNm, StaticPgTitle, StaticPgCss, StaticPgJs, StaticPgHtm, MasterPgFile, StaticCsId, StaticJsId) SELECT convert(int,StaticPgId), StaticPgNm, StaticPgTitle, StaticPgCss, StaticPgJs, StaticPgHtm, MasterPgFile, convert(smallint,StaticCsId), convert(smallint,StaticJsId) FROM dbo.StaticPg IF (SELECT COUNT(1) FROM dbo.Tmp_StaticPg) > 0 OR (SELECT COUNT(1) FROM dbo.StaticPg) = 0 DROP TABLE dbo.StaticPg') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.StaticPg'')) CREATE TABLE dbo.StaticPg (StaticPgId Int IDENTITY NOT NULL, StaticPgNm VarChar(50) NULL, StaticPgTitle NVarChar(100) NOT NULL, StaticPgCss NVarChar(max) NULL, StaticPgJs NVarChar(max) NULL, StaticPgHtm NVarChar(max) NOT NULL, MasterPgFile VarChar(100) NULL, StaticCsId SmallInt NULL, StaticJsId SmallInt NULL, StaticPgUrl VarChar(200) NULL, CONSTRAINT PK_StaticPg PRIMARY KEY CLUSTERED (StaticPgId))') EXEC (' SET IDENTITY_INSERT dbo.StaticPg ON INSERT INTO dbo.StaticPg (StaticPgId, StaticPgNm, StaticPgTitle, StaticPgCss, StaticPgJs, StaticPgHtm, MasterPgFile, StaticCsId, StaticJsId) SELECT StaticPgId, StaticPgNm, StaticPgTitle, StaticPgCss, StaticPgJs, StaticPgHtm, MasterPgFile, StaticCsId, StaticJsId FROM dbo.Tmp_StaticPg SET IDENTITY_INSERT dbo.StaticPg OFF IF (SELECT COUNT(1) FROM dbo.StaticPg) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_StaticPg) = 0 DROP TABLE dbo.Tmp_StaticPg')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=561&typ=N&sys=3","","",""); return false;
562~@~   7.   4.21011:D:   10:*:*:M: Change table ScreenObj~@~265~@~10~@~D~@~~@~~@~M~@~~@~Change table ScreenObj~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenObj (ScreenObjId int NULL, ScreenId int NULL, MasterTable char(1) NULL, ScreenGrpId int NULL, LabelCss varchar(100) NULL, ContentCss varchar(100) NULL, ColumnId int NULL, ColumnName varchar(20) NULL, ColumnDesc varchar(100) NULL, DefaultValue nvarchar(100) NULL, SystemValue nvarchar(100) NULL, ColumnWrap char(1) NULL, ColumnJustify char(1) NULL, ColumnSize smallint NULL, ColumnHeight smallint NULL, DisplayModeId tinyint NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DdlAdnColumnId int NULL, DdlFtrColumnId int NULL, AggregateCd char(1) NULL, GenerateSp char(1) NULL, TabFolderId int NULL, TabIndex smallint NULL, SortOrder smallint NULL, RequiredValid char(1) NULL, MaskValid varchar(50) NULL, RangeValidType varchar(50) NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, ColumnLink varchar(1000) NULL, RefreshOnCUD char(1) NULL, TrimOnEntry char(1) NULL, MatchCd char(1) NULL, IgnoreConfirm char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm) SELECT convert(int,ScreenObjId), convert(int,ScreenId), MasterTable, convert(int,ScreenGrpId), LabelCss, ContentCss, convert(int,ColumnId), ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ColumnJustify, convert(smallint,ColumnSize), convert(smallint,ColumnHeight), convert(tinyint,DisplayModeId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), convert(int,DdlAdnColumnId), convert(int,DdlFtrColumnId), AggregateCd, GenerateSp, convert(int,TabFolderId), convert(smallint,TabIndex), convert(smallint,SortOrder), RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObj'')) CREATE TABLE dbo.ScreenObj (ScreenObjId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, ScreenGrpId Int NOT NULL, LabelCss VarChar(100) NULL, ContentCss VarChar(100) NULL, ColumnId Int NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(100) NULL, DefaultValue NVarChar(100) NULL, SystemValue NVarChar(100) NULL, ColumnWrap Char(1) NOT NULL, UnderPrevCol Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, ColumnHeight SmallInt NULL, DisplayModeId TinyInt NOT NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlAdnColumnId Int NULL, DdlFtrColumnId Int NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId Int NULL, TabIndex SmallInt NOT NULL, SortOrder SmallInt NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(50) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(1000) NULL, RefreshOnCUD Char(1) NOT NULL, TrimOnEntry Char(1) NOT NULL, MatchCd Char(1) NULL, IgnoreConfirm Char(1) NOT NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))') EXEC (' ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_UnderPrevCol DEFAULT (''N'') FOR UnderPrevCol ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_TrimOnEntry DEFAULT (''Y'') FOR TrimOnEntry ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_IgnoreConfirm DEFAULT (''Y'') FOR IgnoreConfirm SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, UnderPrevCol, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm) SELECT ScreenObjId, ScreenId, MasterTable, ScreenGrpId, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, ''N'', ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=562&typ=N&sys=3","","",""); return false;
563~@~   7.   5.21018:D:   10:*:*:M: Change table CtGridGrp~@~266~@~10~@~D~@~~@~~@~M~@~~@~Change table CtGridGrp~@~N~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtGridGrp'')) CREATE TABLE dbo.CtGridGrp (GridGrpCd Char(1) NOT NULL, GridGrpName NVarChar(50) NOT NULL, CONSTRAINT PK_CtGridGrp PRIMARY KEY CLUSTERED (GridGrpCd))') EXEC ('') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=563&typ=N&sys=3","","",""); return false;
564~@~   7.   5.21018:D:   20:*:*:M: Change table ScreenObj~@~266~@~20~@~D~@~~@~~@~M~@~~@~Change table ScreenObj~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenObj (ScreenObjId int NULL, ScreenId int NULL, MasterTable char(1) NULL, ScreenGrpId int NULL, LabelCss varchar(100) NULL, ContentCss varchar(100) NULL, ColumnId int NULL, ColumnName varchar(20) NULL, ColumnDesc varchar(100) NULL, DefaultValue nvarchar(100) NULL, SystemValue nvarchar(100) NULL, ColumnWrap char(1) NULL, UnderPrevCol char(1) NULL, ColumnJustify char(1) NULL, ColumnSize smallint NULL, ColumnHeight smallint NULL, DisplayModeId tinyint NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DdlAdnColumnId int NULL, DdlFtrColumnId int NULL, AggregateCd char(1) NULL, GenerateSp char(1) NULL, TabFolderId int NULL, TabIndex smallint NULL, SortOrder smallint NULL, RequiredValid char(1) NULL, MaskValid varchar(50) NULL, RangeValidType varchar(50) NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, ColumnLink varchar(1000) NULL, RefreshOnCUD char(1) NULL, TrimOnEntry char(1) NULL, MatchCd char(1) NULL, IgnoreConfirm char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, UnderPrevCol, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm) SELECT convert(int,ScreenObjId), convert(int,ScreenId), MasterTable, convert(int,ScreenGrpId), LabelCss, ContentCss, convert(int,ColumnId), ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, UnderPrevCol, ColumnJustify, convert(smallint,ColumnSize), convert(smallint,ColumnHeight), convert(tinyint,DisplayModeId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), convert(int,DdlAdnColumnId), convert(int,DdlFtrColumnId), AggregateCd, GenerateSp, convert(int,TabFolderId), convert(smallint,TabIndex), convert(smallint,SortOrder), RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObj'')) CREATE TABLE dbo.ScreenObj (ScreenObjId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, ScreenGrpId Int NOT NULL, LabelCss VarChar(100) NULL, ContentCss VarChar(100) NULL, ColumnId Int NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(100) NULL, DefaultValue NVarChar(100) NULL, SystemValue NVarChar(100) NULL, ColumnWrap Char(1) NOT NULL, GridGrpCd Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, ColumnHeight SmallInt NULL, DisplayModeId TinyInt NOT NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlAdnColumnId Int NULL, DdlFtrColumnId Int NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId Int NULL, TabIndex SmallInt NOT NULL, SortOrder SmallInt NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(50) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(1000) NULL, RefreshOnCUD Char(1) NOT NULL, TrimOnEntry Char(1) NOT NULL, MatchCd Char(1) NULL, IgnoreConfirm Char(1) NOT NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))') EXEC (' ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_GridGrpCd DEFAULT (''N'') FOR GridGrpCd ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_TrimOnEntry DEFAULT (''Y'') FOR TrimOnEntry ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_IgnoreConfirm DEFAULT (''Y'') FOR IgnoreConfirm SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, GridGrpCd, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm) SELECT ScreenObjId, ScreenId, MasterTable, ScreenGrpId, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, SystemValue, ColumnWrap, UnderPrevCol, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=564&typ=N&sys=3","","",""); return false;
568~@~   7.   8.21115:D:   10:*:*:M: Add table CronJob~@~269~@~10~@~D~@~~@~~@~M~@~~@~Add table CronJob~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CronJob'')) DROP TABLE dbo.CronJob')
EXEC ('CREATE TABLE dbo.CronJob (CronJobId Int IDENTITY NOT NULL, CronJobName NVarChar(200) NOT NULL, Year SmallInt NULL, Month TinyInt NULL, Day TinyInt NULL, Hour TinyInt NULL, Minute TinyInt NULL, DayOfWeek TinyInt NULL, LastRun DateTime NULL, NextRun DateTime NULL, JobLink VarChar(200) NOT NULL, LastStatus NVarChar(500) NULL, CONSTRAINT PK_CronJob PRIMARY KEY CLUSTERED (CronJobId))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=568&typ=N&sys=3","","",""); return false;
569~@~   7.  11.21126:D:   10:*:*:M: Just in case removed datatype is used~@~272~@~10~@~D~@~~@~~@~M~@~~@~Just in case removed datatype is used~@~Y~@~EXEC ('UPDATE DbColumn SET DataType = 3 WHERE DataType in (5,13,16)')
EXEC ('UPDATE DbColumn SET DataType = 11, ColumnLength = 0 WHERE DataType in (19,20)')
EXEC ('UPDATE ReportObj SET DataTypeId = 3 WHERE DataTypeId in (5,13,16)')
EXEC ('UPDATE ReportObj SET DataTypeId = 11 WHERE DataTypeId in (19,20)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=569&typ=N&sys=3","","",""); return false;
570~@~   7.  12.21210:D:   10:*:*:M: Change table ScreenObjHlp~@~273~@~10~@~D~@~~@~~@~M~@~~@~Change table ScreenObjHlp~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenObjHlp (CultureId smallint NULL, ScreenObjHlpId int NULL, ScreenObjId int NULL, ColumnHeader nvarchar(50) NULL, ToolTip nvarchar(200) NULL, ErrMessage nvarchar(300) NULL, ScreenObjHlpDesc varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObjHlp (CultureId, ScreenObjHlpId, ScreenObjId, ColumnHeader, ToolTip, ErrMessage, ScreenObjHlpDesc) SELECT convert(smallint,CultureId), convert(int,ScreenObjHlpId), convert(int,ScreenObjId), ColumnHeader, ToolTip, ErrMessage, ScreenObjHlpDesc FROM dbo.ScreenObjHlp IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObjHlp) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObjHlp) = 0 DROP TABLE dbo.ScreenObjHlp') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObjHlp'')) CREATE TABLE dbo.ScreenObjHlp (ScreenObjHlpId Int IDENTITY NOT NULL, ScreenObjHlpDesc VarChar(200) NULL, ScreenObjId Int NOT NULL, CultureId SmallInt NOT NULL, ColumnHeader NVarChar(50) NULL, ToolTip NVarChar(200) NULL, ErrMessage NVarChar(300) NULL, TbHint NVarChar(200) NULL, CONSTRAINT PK_ScreenObjHlp PRIMARY KEY CLUSTERED (ScreenObjHlpId))') EXEC (' SET IDENTITY_INSERT dbo.ScreenObjHlp ON INSERT INTO dbo.ScreenObjHlp (ScreenObjHlpId, ScreenObjHlpDesc, ScreenObjId, CultureId, ColumnHeader, ToolTip, ErrMessage) SELECT ScreenObjHlpId, ScreenObjHlpDesc, ScreenObjId, CultureId, ColumnHeader, ToolTip, ErrMessage FROM dbo.Tmp_ScreenObjHlp SET IDENTITY_INSERT dbo.ScreenObjHlp OFF IF (SELECT COUNT(1) FROM dbo.ScreenObjHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObjHlp) = 0 DROP TABLE dbo.Tmp_ScreenObjHlp')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=570&typ=N&sys=3","","",""); return false;
571~@~   7.  12.21210:D:   20:*:*:M: Change table StaticPg~@~273~@~20~@~D~@~~@~~@~M~@~~@~Change table StaticPg~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_StaticPg (StaticCsId smallint NULL, StaticJsId smallint NULL, StaticPgId int NULL, StaticPgTitle nvarchar(100) NULL, StaticPgCss nvarchar(max) NULL, StaticPgJs nvarchar(max) NULL, StaticPgHtm nvarchar(max) NULL, StaticPgNm varchar(50) NULL, MasterPgFile varchar(100) NULL, StaticPgUrl varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_StaticPg (StaticCsId, StaticJsId, StaticPgId, StaticPgTitle, StaticPgCss, StaticPgJs, StaticPgHtm, StaticPgNm, MasterPgFile, StaticPgUrl) SELECT convert(smallint,StaticCsId), convert(smallint,StaticJsId), convert(int,StaticPgId), StaticPgTitle, StaticPgCss, StaticPgJs, StaticPgHtm, StaticPgNm, MasterPgFile, StaticPgUrl FROM dbo.StaticPg IF (SELECT COUNT(1) FROM dbo.Tmp_StaticPg) > 0 OR (SELECT COUNT(1) FROM dbo.StaticPg) = 0 DROP TABLE dbo.StaticPg') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.StaticPg'')) CREATE TABLE dbo.StaticPg (StaticPgId Int IDENTITY NOT NULL, StaticPgNm VarChar(50) NULL, StaticPgTitle NVarChar(100) NOT NULL, StaticMeta NVarChar(1000) NULL, StaticPgCss NVarChar(max) NULL, StaticPgJs NVarChar(max) NULL, StaticPgHtm NVarChar(max) NOT NULL, MasterPgFile VarChar(100) NULL, StaticCsId SmallInt NULL, StaticJsId SmallInt NULL, StaticPgUrl VarChar(200) NULL, CONSTRAINT PK_StaticPg PRIMARY KEY CLUSTERED (StaticPgId))') EXEC (' SET IDENTITY_INSERT dbo.StaticPg ON INSERT INTO dbo.StaticPg (StaticPgId, StaticPgNm, StaticPgTitle, StaticPgCss, StaticPgJs, StaticPgHtm, MasterPgFile, StaticCsId, StaticJsId, StaticPgUrl) SELECT StaticPgId, StaticPgNm, StaticPgTitle, StaticPgCss, StaticPgJs, StaticPgHtm, MasterPgFile, StaticCsId, StaticJsId, StaticPgUrl FROM dbo.Tmp_StaticPg SET IDENTITY_INSERT dbo.StaticPg OFF IF (SELECT COUNT(1) FROM dbo.StaticPg) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_StaticPg) = 0 DROP TABLE dbo.Tmp_StaticPg')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=571&typ=N&sys=3","","",""); return false;
572~@~   7.  12.21210:D:   30:*:*:M: Change table ScreenObj~@~273~@~30~@~D~@~~@~~@~M~@~~@~Change table ScreenObj~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenObj (DisplayModeId tinyint NULL, ColumnSize smallint NULL, ColumnHeight smallint NULL, TabIndex smallint NULL, SortOrder smallint NULL, ScreenObjId int NULL, ScreenId int NULL, ScreenGrpId int NULL, ColumnId int NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DdlAdnColumnId int NULL, DdlFtrColumnId int NULL, TabFolderId int NULL, DefaultValue nvarchar(100) NULL, SystemValue nvarchar(100) NULL, MasterTable char(1) NULL, ColumnWrap char(1) NULL, GridGrpCd char(1) NULL, ColumnJustify char(1) NULL, AggregateCd char(1) NULL, GenerateSp char(1) NULL, RequiredValid char(1) NULL, RefreshOnCUD char(1) NULL, TrimOnEntry char(1) NULL, MatchCd char(1) NULL, IgnoreConfirm char(1) NULL, LabelCss varchar(100) NULL, ContentCss varchar(100) NULL, ColumnName varchar(20) NULL, ColumnDesc varchar(100) NULL, MaskValid varchar(50) NULL, RangeValidType varchar(50) NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, ColumnLink varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObj (DisplayModeId, ColumnSize, ColumnHeight, TabIndex, SortOrder, ScreenObjId, ScreenId, ScreenGrpId, ColumnId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, TabFolderId, DefaultValue, SystemValue, MasterTable, ColumnWrap, GridGrpCd, ColumnJustify, AggregateCd, GenerateSp, RequiredValid, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm, LabelCss, ContentCss, ColumnName, ColumnDesc, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink) SELECT convert(tinyint,DisplayModeId), convert(smallint,ColumnSize), convert(smallint,ColumnHeight), convert(smallint,TabIndex), convert(smallint,SortOrder), convert(int,ScreenObjId), convert(int,ScreenId), convert(int,ScreenGrpId), convert(int,ColumnId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), convert(int,DdlAdnColumnId), convert(int,DdlFtrColumnId), convert(int,TabFolderId), DefaultValue, SystemValue, MasterTable, ColumnWrap, GridGrpCd, ColumnJustify, AggregateCd, GenerateSp, RequiredValid, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm, LabelCss, ContentCss, ColumnName, ColumnDesc, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObj'')) CREATE TABLE dbo.ScreenObj (ScreenObjId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, ScreenGrpId Int NOT NULL, LabelCss VarChar(100) NULL, ContentCss VarChar(100) NULL, ColumnId Int NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(100) NULL, DefaultValue NVarChar(100) NULL, DefAfter Char(1) NOT NULL, SystemValue NVarChar(100) NULL, DefAlways Char(1) NOT NULL, ColumnWrap Char(1) NOT NULL, GridGrpCd Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, ColumnHeight SmallInt NULL, DisplayModeId TinyInt NOT NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlAdnColumnId Int NULL, DdlFtrColumnId Int NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId Int NULL, TabIndex SmallInt NOT NULL, SortOrder SmallInt NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(50) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(1000) NULL, RefreshOnCUD Char(1) NOT NULL, TrimOnEntry Char(1) NOT NULL, MatchCd Char(1) NULL, IgnoreConfirm Char(1) NOT NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))') EXEC (' ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAfter DEFAULT (''N'') FOR DefAfter ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAlways DEFAULT (''N'') FOR DefAlways ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_GridGrpCd DEFAULT (''N'') FOR GridGrpCd ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_TrimOnEntry DEFAULT (''Y'') FOR TrimOnEntry ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_IgnoreConfirm DEFAULT (''Y'') FOR IgnoreConfirm SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm) SELECT ScreenObjId, ScreenId, MasterTable, ScreenGrpId, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, ''N'', SystemValue, ''N'', ColumnWrap, GridGrpCd, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=572&typ=N&sys=3","","",""); return false;
573~@~   7.  13.21213:D:   10:*:*:M: Map Input?? and Modified?? to new settings~@~275~@~10~@~D~@~~@~~@~M~@~~@~Map Input?? and Modified?? to new settings~@~Y~@~EXEC ('UPDATE ScreenObj SET SystemValue = ''getutcdate()'', DisplayModeId = case when DisplayModeId = 30 then 41 else 42 end where ColumnName in (''InputOn'',''CreatedOn'',''EnteredOn'')')
EXEC ('UPDATE ScreenObj SET SystemValue = ''getutcdate()'', DefAlways = ''Y'', DisplayModeId = case when DisplayModeId = 30 then 41 else 42 end where ColumnName in (''ModifiedOn'',''ChangedOn'')')
EXEC ('UPDATE ScreenObj SET DefaultValue = ''LUser.UsrId.ToString()'', DefAfter = ''Y'' where ColumnName in (''InputBy'',''CreatedBy'',''EnteredBy'')')
EXEC ('UPDATE ScreenObj SET DefaultValue = ''LUser.UsrId.ToString()'', DefAfter = ''Y'', DefAlways = ''Y'' where ColumnName in (''ModifiedBy'',''ChangedBy'')')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=573&typ=N&sys=3","","",""); return false;
576~@~   7.  17.21220:D:   10:*:*:M: Change table StaticPg~@~279~@~10~@~D~@~~@~~@~M~@~~@~Change table StaticPg~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_StaticPg (StaticCsId smallint NULL, StaticJsId smallint NULL, StaticPgId int NULL, StaticPgTitle nvarchar(100) NULL, StaticMeta nvarchar(1000) NULL, StaticPgCss nvarchar(max) NULL, StaticPgJs nvarchar(max) NULL, StaticPgHtm nvarchar(max) NULL, StaticPgNm varchar(50) NULL, MasterPgFile varchar(100) NULL, StaticPgUrl varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_StaticPg (StaticCsId, StaticJsId, StaticPgId, StaticPgTitle, StaticMeta, StaticPgCss, StaticPgJs, StaticPgHtm, StaticPgNm, MasterPgFile, StaticPgUrl) SELECT convert(smallint,StaticCsId), convert(smallint,StaticJsId), convert(int,StaticPgId), StaticPgTitle, StaticMeta, StaticPgCss, StaticPgJs, StaticPgHtm, StaticPgNm, MasterPgFile, StaticPgUrl FROM dbo.StaticPg IF (SELECT COUNT(1) FROM dbo.Tmp_StaticPg) > 0 OR (SELECT COUNT(1) FROM dbo.StaticPg) = 0 DROP TABLE dbo.StaticPg') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.StaticPg'')) CREATE TABLE dbo.StaticPg (StaticPgId Int IDENTITY NOT NULL, StaticPgNm VarChar(50) NOT NULL, StaticPgTitle NVarChar(100) NOT NULL, StaticMeta NVarChar(1000) NULL, StaticPgCss NVarChar(max) NULL, StaticPgJs NVarChar(max) NULL, StaticPgHtm NVarChar(max) NOT NULL, MasterPgFile VarChar(100) NULL, StaticCsId SmallInt NULL, StaticJsId SmallInt NULL, StaticPgUrl VarChar(200) NULL, CONSTRAINT PK_StaticPg PRIMARY KEY CLUSTERED (StaticPgId))') EXEC (' ALTER TABLE dbo.StaticPg ADD CONSTRAINT DF_StaticPg_StaticPgNm DEFAULT (''PgNm'') FOR StaticPgNm SET IDENTITY_INSERT dbo.StaticPg ON INSERT INTO dbo.StaticPg (StaticPgId, StaticPgNm, StaticPgTitle, StaticMeta, StaticPgCss, StaticPgJs, StaticPgHtm, MasterPgFile, StaticCsId, StaticJsId, StaticPgUrl) SELECT StaticPgId, CASE WHEN StaticPgNm is null THEN ''PgNm'' ELSE StaticPgNm END, StaticPgTitle, StaticMeta, StaticPgCss, StaticPgJs, StaticPgHtm, MasterPgFile, StaticCsId, StaticJsId, StaticPgUrl FROM dbo.Tmp_StaticPg SET IDENTITY_INSERT dbo.StaticPg OFF IF (SELECT COUNT(1) FROM dbo.StaticPg) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_StaticPg) = 0 DROP TABLE dbo.Tmp_StaticPg')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=576&typ=N&sys=3","","",""); return false;
577~@~   7.  21.30122:D:   10:*:*:M: UPDATE RequiredValid~@~2281~@~10~@~D~@~~@~~@~M~@~~@~UPDATE RequiredValid~@~Y~@~UPDATE ScreenObj SET RequiredValid = 'N' from ScreenObj a INNER JOIN ColOvrd b ON a.ScreenObjId = b.ScreenObjId WHERE a.RequiredValid = 'Y' and (b.ColVisible = 'N' OR b.ColReadOnly = 'Y')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=577&typ=N&sys=3","","",""); return false;
578~@~   7.  24.30213:D:   10:*:*:M: Change table ClientRule~@~2284~@~10~@~D~@~~@~~@~M~@~~@~Change table ClientRule~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ClientRule (RuleTypeId tinyint NULL, CultureId smallint NULL, ClientScript smallint NULL, ClientRuleId int NULL, ScreenId int NULL, ReportId int NULL, ScreenObjHlpId int NULL, ScreenCriHlpId int NULL, ReportCriHlpId int NULL, RuleName nvarchar(100) NULL, RuleDesc nvarchar(150) NULL, RuleDescription nvarchar(500) NULL, UserScriptEvent varchar(50) NULL, UserScriptName varchar(50) NULL, ScriptParam varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_ClientRule (RuleTypeId, CultureId, ClientScript, ClientRuleId, ScreenId, ReportId, ScreenObjHlpId, ScreenCriHlpId, ReportCriHlpId, RuleName, RuleDesc, RuleDescription, UserScriptEvent, UserScriptName, ScriptParam) SELECT convert(tinyint,RuleTypeId), convert(smallint,CultureId), convert(smallint,ClientScript), convert(int,ClientRuleId), convert(int,ScreenId), convert(int,ReportId), convert(int,ScreenObjHlpId), convert(int,ScreenCriHlpId), convert(int,ReportCriHlpId), RuleName, RuleDesc, RuleDescription, UserScriptEvent, UserScriptName, ScriptParam FROM dbo.ClientRule IF (SELECT COUNT(1) FROM dbo.Tmp_ClientRule) > 0 OR (SELECT COUNT(1) FROM dbo.ClientRule) = 0 DROP TABLE dbo.ClientRule') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ClientRule'')) CREATE TABLE dbo.ClientRule (ClientRuleId Int IDENTITY NOT NULL, RuleTypeId TinyInt NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, ScreenId Int NULL, ReportId Int NULL, CultureId SmallInt NULL, ScreenObjHlpId Int NULL, ScreenCriHlpId Int NULL, ReportCriHlpId Int NULL, ClientScript SmallInt NULL, UserScriptEvent VarChar(50) NULL, UserScriptName VarChar(500) NULL, ScriptParam VarChar(300) NULL, CONSTRAINT PK_ClientRule PRIMARY KEY CLUSTERED (ClientRuleId))') EXEC (' SET IDENTITY_INSERT dbo.ClientRule ON INSERT INTO dbo.ClientRule (ClientRuleId, RuleTypeId, RuleName, RuleDesc, RuleDescription, ScreenId, ReportId, CultureId, ScreenObjHlpId, ScreenCriHlpId, ReportCriHlpId, ClientScript, UserScriptEvent, UserScriptName, ScriptParam) SELECT ClientRuleId, RuleTypeId, RuleName, RuleDesc, RuleDescription, ScreenId, ReportId, CultureId, ScreenObjHlpId, ScreenCriHlpId, ReportCriHlpId, ClientScript, UserScriptEvent, UserScriptName, ScriptParam FROM dbo.Tmp_ClientRule SET IDENTITY_INSERT dbo.ClientRule OFF IF (SELECT COUNT(1) FROM dbo.ClientRule) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ClientRule) = 0 DROP TABLE dbo.Tmp_ClientRule')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=578&typ=N&sys=3","","",""); return false;
579~@~   7.  31.30313:D:   10:*:*:M: Change table ScreenObj~@~3290~@~10~@~D~@~~@~~@~M~@~~@~Change table ScreenObj~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenObj (DisplayModeId tinyint NULL, ColumnSize smallint NULL, ColumnHeight smallint NULL, TabIndex smallint NULL, SortOrder smallint NULL, ScreenObjId int NULL, ScreenId int NULL, ScreenGrpId int NULL, ColumnId int NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DdlAdnColumnId int NULL, DdlFtrColumnId int NULL, TabFolderId int NULL, DefaultValue nvarchar(100) NULL, SystemValue nvarchar(100) NULL, MasterTable char(1) NULL, DefAfter char(1) NULL, DefAlways char(1) NULL, ColumnWrap char(1) NULL, GridGrpCd char(1) NULL, ColumnJustify char(1) NULL, AggregateCd char(1) NULL, GenerateSp char(1) NULL, RequiredValid char(1) NULL, RefreshOnCUD char(1) NULL, TrimOnEntry char(1) NULL, MatchCd char(1) NULL, IgnoreConfirm char(1) NULL, LabelCss varchar(100) NULL, ContentCss varchar(100) NULL, ColumnName varchar(20) NULL, ColumnDesc varchar(100) NULL, MaskValid varchar(50) NULL, RangeValidType varchar(50) NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, ColumnLink varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObj (DisplayModeId, ColumnSize, ColumnHeight, TabIndex, SortOrder, ScreenObjId, ScreenId, ScreenGrpId, ColumnId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, TabFolderId, DefaultValue, SystemValue, MasterTable, DefAfter, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, AggregateCd, GenerateSp, RequiredValid, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm, LabelCss, ContentCss, ColumnName, ColumnDesc, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink) SELECT convert(tinyint,DisplayModeId), convert(smallint,ColumnSize), convert(smallint,ColumnHeight), convert(smallint,TabIndex), convert(smallint,SortOrder), convert(int,ScreenObjId), convert(int,ScreenId), convert(int,ScreenGrpId), convert(int,ColumnId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), convert(int,DdlAdnColumnId), convert(int,DdlFtrColumnId), convert(int,TabFolderId), DefaultValue, SystemValue, MasterTable, DefAfter, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, AggregateCd, GenerateSp, RequiredValid, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm, LabelCss, ContentCss, ColumnName, ColumnDesc, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObj'')) CREATE TABLE dbo.ScreenObj (ScreenObjId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, ScreenGrpId Int NOT NULL, LabelCss VarChar(1000) NULL, ContentCss VarChar(1000) NULL, ColumnId Int NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(200) NULL, DefaultValue NVarChar(200) NULL, DefAfter Char(1) NOT NULL, SystemValue NVarChar(200) NULL, DefAlways Char(1) NOT NULL, ColumnWrap Char(1) NOT NULL, GridGrpCd Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, ColumnHeight SmallInt NULL, DisplayModeId TinyInt NOT NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlAdnColumnId Int NULL, DdlFtrColumnId Int NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId Int NULL, TabIndex SmallInt NOT NULL, SortOrder SmallInt NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(50) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(1000) NULL, RefreshOnCUD Char(1) NOT NULL, TrimOnEntry Char(1) NOT NULL, MatchCd Char(1) NULL, IgnoreConfirm Char(1) NOT NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))') EXEC (' ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAfter DEFAULT (''N'') FOR DefAfter ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAlways DEFAULT (''N'') FOR DefAlways ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_GridGrpCd DEFAULT (''N'') FOR GridGrpCd ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_TrimOnEntry DEFAULT (''Y'') FOR TrimOnEntry ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_IgnoreConfirm DEFAULT (''Y'') FOR IgnoreConfirm SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm) SELECT ScreenObjId, ScreenId, MasterTable, ScreenGrpId, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=579&typ=N&sys=3","","",""); return false;
580~@~   7.  32.30315:D:   10:*:*:M: Change table ButtonHlp~@~3291~@~10~@~D~@~~@~~@~M~@~~@~Change table ButtonHlp~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ButtonHlp (ButtonTypeId tinyint NULL, CultureId smallint NULL, ButtonHlpId int NULL, ScreenId int NULL, ReportId int NULL, WizardId int NULL, ButtonName nvarchar(20) NULL, ButtonToolTip nvarchar(100) NULL, ButtonVisible char(1) NULL, ButtonIsImage char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_ButtonHlp (ButtonTypeId, CultureId, ButtonHlpId, ScreenId, ReportId, WizardId, ButtonName, ButtonToolTip, ButtonVisible, ButtonIsImage) SELECT convert(tinyint,ButtonTypeId), convert(smallint,CultureId), convert(int,ButtonHlpId), convert(int,ScreenId), convert(int,ReportId), convert(int,WizardId), ButtonName, ButtonToolTip, ButtonVisible, ButtonIsImage FROM dbo.ButtonHlp IF (SELECT COUNT(1) FROM dbo.Tmp_ButtonHlp) > 0 OR (SELECT COUNT(1) FROM dbo.ButtonHlp) = 0 DROP TABLE dbo.ButtonHlp') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ButtonHlp'')) CREATE TABLE dbo.ButtonHlp (ButtonHlpId Int IDENTITY NOT NULL, ScreenId Int NULL, ReportId Int NULL, WizardId Int NULL, CultureId SmallInt NOT NULL, ButtonTypeId TinyInt NOT NULL, ButtonName NVarChar(200) NULL, ButtonToolTip NVarChar(400) NULL, ButtonVisible Char(1) NOT NULL, ButtonIsImage Char(1) NOT NULL, CONSTRAINT PK_ButtonHlp PRIMARY KEY CLUSTERED (ButtonHlpId))') EXEC (' SET IDENTITY_INSERT dbo.ButtonHlp ON INSERT INTO dbo.ButtonHlp (ButtonHlpId, ScreenId, ReportId, WizardId, CultureId, ButtonTypeId, ButtonName, ButtonToolTip, ButtonVisible, ButtonIsImage) SELECT ButtonHlpId, ScreenId, ReportId, WizardId, CultureId, ButtonTypeId, ButtonName, ButtonToolTip, ButtonVisible, ButtonIsImage FROM dbo.Tmp_ButtonHlp SET IDENTITY_INSERT dbo.ButtonHlp OFF IF (SELECT COUNT(1) FROM dbo.ButtonHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ButtonHlp) = 0 DROP TABLE dbo.Tmp_ButtonHlp')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=580&typ=N&sys=3","","",""); return false;
581~@~   7.  33.30326:D:   10:*:*:M: Remove AtCulture tables~@~3292~@~10~@~D~@~~@~~@~M~@~~@~Remove AtCulture tables~@~N~@~EXEC ('DROP TABLE dbo.AtCulture')
EXEC ('DROP TABLE dbo.AtCultureLbl')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=581&typ=N&sys=3","","",""); return false;
582~@~   7.  33.30326:D:   20:*:*:M: Change table CtCulture~@~3292~@~20~@~D~@~~@~~@~M~@~~@~Change table CtCulture~@~N~@~EXEC ('CREATE TABLE dbo.Tmp_CtCulture (CultureTypeId smallint NULL, CultureTypeSrt smallint NULL, CultureTypeDesc nvarchar(50) NULL, ImportFileName nvarchar(30) NULL, CultureDefault char(1) NULL, EnNumberRule char(1) NULL, CultureTypeName varchar(6) NULL)')
EXEC ('INSERT INTO dbo.Tmp_CtCulture (CultureTypeId, CultureTypeSrt, CultureTypeDesc, ImportFileName, CultureDefault, EnNumberRule, CultureTypeName) SELECT convert(smallint,CultureTypeId), convert(smallint,CultureTypeSrt), CultureTypeDesc, ImportFileName, CultureDefault, EnNumberRule, CultureTypeName FROM dbo.CtCulture IF (SELECT COUNT(1) FROM dbo.Tmp_CtCulture) > 0 OR (SELECT COUNT(1) FROM dbo.CtCulture) = 0 DROP TABLE dbo.CtCulture')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtCulture'')) CREATE TABLE dbo.CtCulture (CultureTypeId SmallInt IDENTITY NOT NULL, CultureTypeName VarChar(10) NOT NULL, CultureTypeDesc NVarChar(50) NOT NULL, CultureDefault Char(1) NOT NULL, EnNumberRule Char(1) NOT NULL, CountryCd Char(3) NULL, CurrencyCd Char(3) NULL, ToTranslate Char(1) NOT NULL, ImportFileName NVarChar(30) NULL, CONSTRAINT PK_CtCulture PRIMARY KEY CLUSTERED (CultureTypeId))')
EXEC ('ALTER TABLE dbo.CtCulture ADD CONSTRAINT DF_CtCulture_ToTranslate DEFAULT (''N'') FOR ToTranslate SET IDENTITY_INSERT dbo.CtCulture ON INSERT INTO dbo.CtCulture (CultureTypeId, CultureTypeName, CultureTypeDesc, CultureDefault, EnNumberRule, ToTranslate, ImportFileName) SELECT CultureTypeId, CultureTypeName, CultureTypeDesc, CultureDefault, EnNumberRule, ''N'', ImportFileName FROM dbo.Tmp_CtCulture SET IDENTITY_INSERT dbo.CtCulture OFF IF (SELECT COUNT(1) FROM dbo.CtCulture) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtCulture) = 0 DROP TABLE dbo.Tmp_CtCulture')
EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_CtCulture ON dbo.CtCulture(CultureTypeName)')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=582&typ=N&sys=3","","",""); return false;
583~@~   7.  33.30326:D:   30:*:*:M: Change table FxRate~@~3292~@~30~@~D~@~~@~~@~M~@~~@~Change table FxRate~@~N~@~EXEC ('USE [[?]]Cmon')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.FxRate'')) CREATE TABLE dbo.FxRate (FxRateId Int IDENTITY NOT NULL, FrCurrency Char(3) NOT NULL, ToCurrency Char(3) NOT NULL, ToFxRate Decimal(12,4) NOT NULL, ValidFr DateTime NOT NULL, ValidTo DateTime NOT NULL, CONSTRAINT PK_FxRate PRIMARY KEY CLUSTERED (FxRateId))')
EXEC ('CREATE UNIQUE NONCLUSTERED INDEX IX_FxRate ON dbo.FxRate (FrCurrency,ToCurrency,ValidFr)')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=583&typ=N&sys=3","","",""); return false;
1584~@~   7.  33.30326:D:   50:*:*:M: Change table AppInfo~@~3292~@~50~@~D~@~~@~~@~M~@~~@~Change table AppInfo~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_AppInfo (VersionMa smallint NULL, VersionMi smallint NULL, AppInfoId int NULL, AppZipId int NULL, Prerequisite nvarchar(max) NULL, Readme nvarchar(max) NULL, VersionDt datetime NULL, AppInfoDesc varchar(50) NULL, AppItemLink varchar(200) NULL)')
EXEC ('INSERT INTO dbo.Tmp_AppInfo (VersionMa, VersionMi, AppInfoId, AppZipId, Prerequisite, Readme, VersionDt, AppInfoDesc, AppItemLink) SELECT convert(smallint,VersionMa), convert(smallint,VersionMi), convert(int,AppInfoId), convert(int,AppZipId), Prerequisite, Readme, VersionDt, AppInfoDesc, AppItemLink FROM dbo.AppInfo IF (SELECT COUNT(1) FROM dbo.Tmp_AppInfo) > 0 OR (SELECT COUNT(1) FROM dbo.AppInfo) = 0 DROP TABLE dbo.AppInfo')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AppInfo'')) CREATE TABLE dbo.AppInfo (AppInfoId Int IDENTITY NOT NULL, AppInfoDesc VarChar(50) NULL, VersionMa SmallInt NOT NULL, VersionMi SmallInt NOT NULL, VersionDt DateTime NULL, AppZipId Int NULL, Prerequisite NVarChar(max) NULL, Readme NVarChar(max) NULL, AppItemLink VarChar(200) NULL, CultureTypeName varchar(10) NULL, VersionValue Money NULL, CONSTRAINT PK_AppInfo PRIMARY KEY CLUSTERED (AppInfoId))')
EXEC ('SET IDENTITY_INSERT dbo.AppInfo ON INSERT INTO dbo.AppInfo (AppInfoId, AppInfoDesc, VersionMa, VersionMi, VersionDt, AppZipId, Prerequisite, Readme, AppItemLink) SELECT AppInfoId, AppInfoDesc, VersionMa, VersionMi, VersionDt, AppZipId, Prerequisite, Readme, AppItemLink FROM dbo.Tmp_AppInfo SET IDENTITY_INSERT dbo.AppInfo OFF IF (SELECT COUNT(1) FROM dbo.AppInfo) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AppInfo) = 0 DROP TABLE dbo.Tmp_AppInfo')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=1584&typ=N&sys=3","","",""); return false;
1585~@~   7.  34.30327:D:   10:*:*:M: Change table UsrImpr~@~3293~@~10~@~D~@~~@~~@~M~@~~@~Change table UsrImpr~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_UsrImpr (UsrImprId int NULL, UsrId int NULL, ImprUsrId int NULL, UsrImprDesc nvarchar(200) NULL, UsrImprLink varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_UsrImpr (UsrImprId, UsrId, ImprUsrId, UsrImprDesc, UsrImprLink) SELECT convert(int,UsrImprId), convert(int,UsrId), convert(int,ImprUsrId), UsrImprDesc, UsrImprLink FROM dbo.UsrImpr IF (SELECT COUNT(1) FROM dbo.Tmp_UsrImpr) > 0 OR (SELECT COUNT(1) FROM dbo.UsrImpr) = 0 DROP TABLE dbo.UsrImpr') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrImpr'')) CREATE TABLE dbo.UsrImpr (UsrImprId Int IDENTITY NOT NULL, UsrId Int NOT NULL, ImprUsrId Int NOT NULL, UsrImprDesc NVarChar(200) NULL, UsrImprLink VarChar(200) NULL, TestCulture VarChar(10) NULL, TestCurrency Money NULL, CONSTRAINT PK_UsrImpr PRIMARY KEY CLUSTERED (UsrImprId))') EXEC (' SET IDENTITY_INSERT dbo.UsrImpr ON INSERT INTO dbo.UsrImpr (UsrImprId, UsrId, ImprUsrId, UsrImprDesc, UsrImprLink) SELECT UsrImprId, UsrId, ImprUsrId, UsrImprDesc, UsrImprLink FROM dbo.Tmp_UsrImpr SET IDENTITY_INSERT dbo.UsrImpr OFF IF (SELECT COUNT(1) FROM dbo.UsrImpr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrImpr) = 0 DROP TABLE dbo.Tmp_UsrImpr')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=1585&typ=N&sys=3","","",""); return false;
1586~@~   7.  42.30612:D:   10:*:*:M: Change table Menu~@~3301~@~10~@~D~@~~@~~@~M~@~~@~Change table Menu~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_MenuHlp_Menu'') ALTER TABLE dbo.MenuHlp DROP CONSTRAINT FK_MenuHlp_Menu CREATE TABLE dbo.Tmp_Menu (MenuIndex smallint NULL, MenuId int NULL, ParentId int NULL, ReportId int NULL, ScreenId int NULL, WizardId int NULL, StaticPgId int NULL, MenuDesc nvarchar(100) NULL, IconUrl nvarchar(300) NULL, MenuName varchar(30) NULL, Miscellaneous varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_Menu (MenuIndex, MenuId, ParentId, ReportId, ScreenId, WizardId, StaticPgId, MenuDesc, IconUrl, MenuName, Miscellaneous) SELECT convert(smallint,MenuIndex), convert(int,MenuId), convert(int,ParentId), convert(int,ReportId), convert(int,ScreenId), convert(int,WizardId), convert(int,StaticPgId), MenuDesc, IconUrl, MenuName, Miscellaneous FROM dbo.Menu IF (SELECT COUNT(1) FROM dbo.Tmp_Menu) > 0 OR (SELECT COUNT(1) FROM dbo.Menu) = 0 DROP TABLE dbo.Menu') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Menu'')) CREATE TABLE dbo.Menu (MenuId Int IDENTITY NOT NULL, MenuIndex SmallInt NOT NULL, MenuName VarChar(30) NOT NULL, MenuDesc NVarChar(300) NULL, Miscellaneous VarChar(100) NULL, ParentId Int NULL, ReportId Int NULL, ScreenId Int NULL, WizardId Int NULL, StaticPgId Int NULL, IconUrl NVarChar(300) NULL, CONSTRAINT PK_Menu PRIMARY KEY CLUSTERED (MenuId))') EXEC (' SET IDENTITY_INSERT dbo.Menu ON INSERT INTO dbo.Menu (MenuId, MenuIndex, MenuName, MenuDesc, Miscellaneous, ParentId, ReportId, ScreenId, WizardId, StaticPgId, IconUrl) SELECT MenuId, MenuIndex, MenuName, MenuDesc, Miscellaneous, ParentId, ReportId, ScreenId, WizardId, StaticPgId, IconUrl FROM dbo.Tmp_Menu SET IDENTITY_INSERT dbo.Menu OFF IF (SELECT COUNT(1) FROM dbo.Menu) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Menu) = 0 DROP TABLE dbo.Tmp_Menu ALTER TABLE dbo.MenuHlp WITH NOCHECK ADD CONSTRAINT FK_MenuHlp_Menu FOREIGN KEY (MenuId) REFERENCES dbo.Menu (MenuId)')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=1586&typ=N&sys=3","","",""); return false;
1587~@~   7.  42.30612:D:   20:*:*:M: Update MenuDesc~@~3301~@~20~@~D~@~~@~~@~M~@~~@~Update MenuDesc~@~Y~@~EXEC ('DECLARE @ii int, @mm int SELECT @ii = 1, @mm = max(MenuId) from Menu WHILE @ii <= @mm BEGIN IF EXISTS (SELECT 1 FROM Menu WHERE MenuId = @ii) EXEC Ir_InitMenuHlp @ii SELECT @ii = @ii + 1 END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=1587&typ=N&sys=3","","",""); return false;
1588~@~   7.  43.30624:D:   10:*:*:M: Change table CtClientScript~@~3302~@~10~@~D~@~~@~~@~M~@~~@~Change table CtClientScript~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_CtClientScript (ClientScriptId smallint NULL, ClientScriptDesc nvarchar(100) NULL, ClientScriptEvent varchar(50) NULL, ClientScriptName varchar(50) NULL)') EXEC (' INSERT INTO dbo.Tmp_CtClientScript (ClientScriptId, ClientScriptDesc, ClientScriptEvent, ClientScriptName) SELECT convert(smallint,ClientScriptId), ClientScriptDesc, ClientScriptEvent, ClientScriptName FROM dbo.CtClientScript IF (SELECT COUNT(1) FROM dbo.Tmp_CtClientScript) > 0 OR (SELECT COUNT(1) FROM dbo.CtClientScript) = 0 DROP TABLE dbo.CtClientScript') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtClientScript'')) CREATE TABLE dbo.CtClientScript (ClientScriptId SmallInt NOT NULL, ClientScriptEvent VarChar(50) NOT NULL, ClientScriptName VarChar(50) NOT NULL, ClientScriptDesc NVarChar(100) NOT NULL, ClientScriptHelp NVarChar(1000) NULL, CONSTRAINT PK_CtClientScript PRIMARY KEY CLUSTERED (ClientScriptId))') EXEC (' INSERT INTO dbo.CtClientScript (ClientScriptId, ClientScriptEvent, ClientScriptName, ClientScriptDesc) SELECT ClientScriptId, ClientScriptEvent, ClientScriptName, ClientScriptDesc FROM dbo.Tmp_CtClientScript IF (SELECT COUNT(1) FROM dbo.CtClientScript) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtClientScript) = 0 DROP TABLE dbo.Tmp_CtClientScript')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=1588&typ=N&sys=3","","",""); return false;
1589~@~   7.  43.30624:D:   20:*:*:M: Change table Screen~@~3302~@~20~@~D~@~~@~~@~M~@~~@~Change table Screen~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Screen (ScreenTypeId tinyint NULL, NumCols tinyint NULL, GridRows tinyint NULL, SearchWidth smallint NULL, ScreenId int NULL, MasterTableId int NULL, DetailTableId int NULL, SearchId int NULL, ScreenDesc nvarchar(50) NULL, GridTitle nvarchar(50) NULL, SearchAscending char(1) NULL, SearchMode char(1) NULL, GenerateSc char(1) NULL, GenerateSr char(1) NULL, HasDeleteAll char(1) NULL, ValidateReq char(1) NULL, DeferError char(1) NULL, NeedRegen char(1) NULL, AuthRequired char(1) NULL, ProgramName varchar(20) NULL, GridClass varchar(30) NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenTypeId, NumCols, GridRows, SearchWidth, ScreenId, MasterTableId, DetailTableId, SearchId, ScreenDesc, GridTitle, SearchAscending, SearchMode, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, NeedRegen, AuthRequired, ProgramName, GridClass, ScreenObj, ScreenFilter) SELECT convert(tinyint,ScreenTypeId), convert(tinyint,NumCols), convert(tinyint,GridRows), convert(smallint,SearchWidth), convert(int,ScreenId), convert(int,MasterTableId), convert(int,DetailTableId), convert(int,SearchId), ScreenDesc, GridTitle, SearchAscending, SearchMode, GenerateSc, GenerateSr, HasDeleteAll, ValidateReq, DeferError, NeedRegen, AuthRequired, ProgramName, GridClass, ScreenObj, ScreenFilter FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchId Int NULL, SearchWidth SmallInt NULL, SearchAscending Char(1) NOT NULL, SearchMode Char(1) NULL, NumCols TinyInt NOT NULL, GridRows TinyInt NULL, GridClass VarChar(30) NULL, GridTitle NVarChar(50) NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, GenerateSr Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ShowGridHead Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, NeedRegen Char(1) NOT NULL, AuthRequired Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NumCols DEFAULT (1) FOR NumCols ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSc DEFAULT (''Y'') FOR GenerateSc ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSr DEFAULT (''Y'') FOR GenerateSr ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ShowGridHead DEFAULT (''Y'') FOR ShowGridHead ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NeedRegen DEFAULT (''N'') FOR NeedRegen ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_AuthRequired DEFAULT (''Y'') FOR AuthRequired SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, NumCols, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, NeedRegen, AuthRequired) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, NumCols, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ''Y'', ValidateReq, DeferError, NeedRegen, AuthRequired FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=1589&typ=N&sys=3","","",""); return false;
1592~@~   7.  43.30624:D:   40:*:*:M: Add table SredTime~@~3302~@~40~@~D~@~~@~~@~M~@~~@~Add table SredTime~@~N~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.SredTime'')) CREATE TABLE dbo.SredTime (SredTimeId Int IDENTITY NOT NULL, MemberId Int NOT NULL, SredTimeDt DateTime NOT NULL, Accomplished NVarChar(1000) NOT NULL, HourSpent Decimal(9,2) NOT NULL, EnteredBy Int NULL, EnteredOn DateTime NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, CONSTRAINT PK_SredTime PRIMARY KEY CLUSTERED (SredTimeId))') EXEC ('') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=1592&typ=N&sys=3","","",""); return false;
1594~@~   7.  43.30624:D:   30:*:*:M: Add table SredMebr~@~3302~@~30~@~D~@~~@~~@~M~@~~@~Add table SredMebr~@~N~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.SredMebr'')) CREATE TABLE dbo.SredMebr (SredMebrId Int IDENTITY NOT NULL, MemberId Int NOT NULL, UserId Int NOT NULL, MemberTitle NVarChar(50) NULL, LT10PercShare Char(1) NOT NULL, MnSalary Money NOT NULL, MnNtxBenefit Money NOT NULL, MnTaxBenefit Money NOT NULL, MnWorkHours Decimal(9,2) NOT NULL, CONSTRAINT PK_SredMebr PRIMARY KEY CLUSTERED (SredMebrId))') EXEC ('') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IU_SredMebr'') CREATE UNIQUE NONCLUSTERED INDEX IU_SredMebr ON dbo.SredMebr(MemberId,UserId)') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=1594&typ=N&sys=3","","",""); return false;
1595~@~   7.  44.30626:D:   10:*:*:M: Change table Screen~@~3303~@~10~@~D~@~~@~~@~M~@~~@~Change table Screen~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Screen (ScreenTypeId tinyint NULL, NumCols tinyint NULL, GridRows tinyint NULL, SearchWidth smallint NULL, ScreenId int NULL, MasterTableId int NULL, DetailTableId int NULL, SearchId int NULL, ScreenDesc nvarchar(50) NULL, GridTitle nvarchar(50) NULL, SearchAscending char(1) NULL, SearchMode char(1) NULL, GenerateSc char(1) NULL, GenerateSr char(1) NULL, HasDeleteAll char(1) NULL, ShowGridHead char(1) NULL, ValidateReq char(1) NULL, DeferError char(1) NULL, NeedRegen char(1) NULL, AuthRequired char(1) NULL, ProgramName varchar(20) NULL, GridClass varchar(30) NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenTypeId, NumCols, GridRows, SearchWidth, ScreenId, MasterTableId, DetailTableId, SearchId, ScreenDesc, GridTitle, SearchAscending, SearchMode, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, NeedRegen, AuthRequired, ProgramName, GridClass, ScreenObj, ScreenFilter) SELECT convert(tinyint,ScreenTypeId), convert(tinyint,NumCols), convert(tinyint,GridRows), convert(smallint,SearchWidth), convert(int,ScreenId), convert(int,MasterTableId), convert(int,DetailTableId), convert(int,SearchId), ScreenDesc, GridTitle, SearchAscending, SearchMode, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, NeedRegen, AuthRequired, ProgramName, GridClass, ScreenObj, ScreenFilter FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchId Int NULL, SearchWidth SmallInt NULL, SearchAscending Char(1) NOT NULL, SearchMode Char(1) NULL, NumCols TinyInt NOT NULL, GridRows TinyInt NULL, GridClass VarChar(30) NULL, GridTitle NVarChar(50) NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, GenerateSr Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ShowGridHead Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, NeedRegen Char(1) NOT NULL, AuthRequired Char(1) NOT NULL, ViewOnly Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NumCols DEFAULT (1) FOR NumCols ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSc DEFAULT (''Y'') FOR GenerateSc ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSr DEFAULT (''Y'') FOR GenerateSr ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ShowGridHead DEFAULT (''Y'') FOR ShowGridHead ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NeedRegen DEFAULT (''N'') FOR NeedRegen ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_AuthRequired DEFAULT (''Y'') FOR AuthRequired ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ViewOnly DEFAULT (''N'') FOR ViewOnly SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, NumCols, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, NeedRegen, AuthRequired, ViewOnly) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, NumCols, GridRows, GridClass, GridTitle, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, NeedRegen, AuthRequired, ''N'' FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=1595&typ=N&sys=3","","",""); return false;
1596~@~   7.  44.30626:D:   20:*:*:M: Change table CtButtonType~@~3303~@~20~@~D~@~~@~~@~M~@~~@~Change table CtButtonType~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_CtButtonType (ButtonTypeId tinyint NULL, ButtonTypeDesc nvarchar(50) NULL, ObjectType char(1) NULL, ButtonVisible char(1) NULL, ButtonIsImage char(1) NULL, ButtonTypeName varchar(20) NULL)') EXEC (' INSERT INTO dbo.Tmp_CtButtonType (ButtonTypeId, ButtonTypeDesc, ObjectType, ButtonVisible, ButtonIsImage, ButtonTypeName) SELECT convert(tinyint,ButtonTypeId), ButtonTypeDesc, ObjectType, ButtonVisible, ButtonIsImage, ButtonTypeName FROM dbo.CtButtonType IF (SELECT COUNT(1) FROM dbo.Tmp_CtButtonType) > 0 OR (SELECT COUNT(1) FROM dbo.CtButtonType) = 0 DROP TABLE dbo.CtButtonType') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtButtonType'')) CREATE TABLE dbo.CtButtonType (ButtonTypeId TinyInt NOT NULL, ObjectType Char(1) NOT NULL, ButtonTypeName VarChar(20) NOT NULL, ButtonTypeDesc NVarChar(50) NOT NULL, ButtonVisible Char(1) NOT NULL, ButtonIsImage Char(1) NOT NULL, ViewOnlyVisible Char(1) NOT NULL, CONSTRAINT PK_CtButtonType PRIMARY KEY CLUSTERED (ButtonTypeId))') EXEC (' ALTER TABLE dbo.CtButtonType ADD CONSTRAINT DF_CtButtonType_ViewOnlyVisible DEFAULT (''Y'') FOR ViewOnlyVisible INSERT INTO dbo.CtButtonType (ButtonTypeId, ObjectType, ButtonTypeName, ButtonTypeDesc, ButtonVisible, ButtonIsImage, ViewOnlyVisible) SELECT ButtonTypeId, ObjectType, ButtonTypeName, ButtonTypeDesc, ButtonVisible, ButtonIsImage, ''Y'' FROM dbo.Tmp_CtButtonType IF (SELECT COUNT(1) FROM dbo.CtButtonType) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtButtonType) = 0 DROP TABLE dbo.Tmp_CtButtonType')
EXEC ('UPDATE dbo.CtButtonType SET ViewOnlyVisible = ''N'' WHERE ButtonTypeId in (6,7,8,11,51,54,56,57)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=1596&typ=N&sys=3","","",""); return false;
2595~@~   7.  45.30702:D:   10:*:*:M: Update table CtButtonType~@~3304~@~10~@~D~@~~@~~@~M~@~~@~Update table CtButtonType~@~N~@~EXEC ('UPDATE dbo.CtButtonType SET ViewOnlyVisible = ''N'' WHERE ButtonTypeId in (47,48)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2595&typ=N&sys=3","","",""); return false;
2596~@~   8.   2.30729:D:   10:*:*:M: Change table StaticPg~@~4307~@~10~@~D~@~~@~~@~M~@~~@~Change table StaticPg~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_StaticPg (StaticCsId smallint NULL, StaticJsId smallint NULL, StaticPgId int NULL, StaticPgTitle nvarchar(100) NULL, StaticMeta nvarchar(1000) NULL, StaticPgCss nvarchar(max) NULL, StaticPgJs nvarchar(max) NULL, StaticPgHtm nvarchar(max) NULL, StaticPgNm varchar(50) NULL, MasterPgFile varchar(100) NULL, StaticPgUrl varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_StaticPg (StaticCsId, StaticJsId, StaticPgId, StaticPgTitle, StaticMeta, StaticPgCss, StaticPgJs, StaticPgHtm, StaticPgNm, MasterPgFile, StaticPgUrl) SELECT convert(smallint,StaticCsId), convert(smallint,StaticJsId), convert(int,StaticPgId), StaticPgTitle, StaticMeta, StaticPgCss, StaticPgJs, StaticPgHtm, StaticPgNm, MasterPgFile, StaticPgUrl FROM dbo.StaticPg IF (SELECT COUNT(1) FROM dbo.Tmp_StaticPg) > 0 OR (SELECT COUNT(1) FROM dbo.StaticPg) = 0 DROP TABLE dbo.StaticPg') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.StaticPg'')) CREATE TABLE dbo.StaticPg (StaticPgId Int IDENTITY NOT NULL, StaticPgDesc NVarChar(300) NULL, StaticPgNm VarChar(50) NOT NULL, StaticPgTitle NVarChar(100) NOT NULL, StaticMeta NVarChar(1000) NULL, StaticPgCss NVarChar(max) NULL, StaticPgJs NVarChar(max) NULL, StaticPgHtm NVarChar(max) NOT NULL, MasterPgFile VarChar(100) NULL, StaticCsId SmallInt NULL, StaticJsId SmallInt NULL, StaticPgUrl VarChar(200) NULL, CONSTRAINT PK_StaticPg PRIMARY KEY CLUSTERED (StaticPgId))') EXEC (' ALTER TABLE dbo.StaticPg ADD CONSTRAINT DF_StaticPg_StaticPgNm DEFAULT (''PgNm'') FOR StaticPgNm SET IDENTITY_INSERT dbo.StaticPg ON INSERT INTO dbo.StaticPg (StaticPgId, StaticPgNm, StaticPgTitle, StaticMeta, StaticPgCss, StaticPgJs, StaticPgHtm, MasterPgFile, StaticCsId, StaticJsId, StaticPgUrl) SELECT StaticPgId, StaticPgNm, StaticPgTitle, StaticMeta, StaticPgCss, StaticPgJs, StaticPgHtm, MasterPgFile, StaticCsId, StaticJsId, StaticPgUrl FROM dbo.Tmp_StaticPg SET IDENTITY_INSERT dbo.StaticPg OFF IF (SELECT COUNT(1) FROM dbo.StaticPg) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_StaticPg) = 0 DROP TABLE dbo.Tmp_StaticPg')
EXEC ('UPDATE dbo.StaticPg SET StaticPgDesc = StaticPgTitle + '' ('' + StaticPgNm + '')''')
EXEC ('TRUNCATE TABLE dbo.ScreenLstCri')
EXEC ('TRUNCATE TABLE dbo.ScreenLstInf')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2596&typ=N&sys=3","","",""); return false;
2597~@~   8.   3.30813:D:   10:*:*:M: Update screen filter description~@~4308~@~10~@~D~@~~@~~@~M~@~~@~Update screen filter description~@~Y~@~UPDATE dbo.ScreenFilter
	SET ScreenFilterDesc = b.ProgramName + ' ' + RIGHT('00'+convert(varchar,FilterOrder),3) + ' ' + a.ScreenFilterName
	FROM dbo.ScreenFilter a INNER JOIN dbo.Screen b ON a.ScreenId = b.ScreenId
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2597&typ=N&sys=3","","",""); return false;
2598~@~   8.   5.30916:D:   10:*:*:M: Change table ScreenObj~@~4310~@~10~@~D~@~~@~~@~M~@~~@~Change table ScreenObj~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenObj (DisplayModeId tinyint NULL, ColumnSize smallint NULL, ColumnHeight smallint NULL, TabIndex smallint NULL, SortOrder smallint NULL, ScreenObjId int NULL, ScreenId int NULL, ScreenGrpId int NULL, ColumnId int NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DdlAdnColumnId int NULL, DdlFtrColumnId int NULL, TabFolderId int NULL, DefaultValue nvarchar(200) NULL, SystemValue nvarchar(200) NULL, MasterTable char(1) NULL, DefAfter char(1) NULL, DefAlways char(1) NULL, ColumnWrap char(1) NULL, GridGrpCd char(1) NULL, ColumnJustify char(1) NULL, AggregateCd char(1) NULL, GenerateSp char(1) NULL, RequiredValid char(1) NULL, RefreshOnCUD char(1) NULL, TrimOnEntry char(1) NULL, MatchCd char(1) NULL, IgnoreConfirm char(1) NULL, LabelCss varchar(1000) NULL, ContentCss varchar(1000) NULL, ColumnName varchar(20) NULL, ColumnDesc varchar(200) NULL, MaskValid varchar(50) NULL, RangeValidType varchar(50) NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, ColumnLink varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObj (DisplayModeId, ColumnSize, ColumnHeight, TabIndex, SortOrder, ScreenObjId, ScreenId, ScreenGrpId, ColumnId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, TabFolderId, DefaultValue, SystemValue, MasterTable, DefAfter, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, AggregateCd, GenerateSp, RequiredValid, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm, LabelCss, ContentCss, ColumnName, ColumnDesc, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink) SELECT convert(tinyint,DisplayModeId), convert(smallint,ColumnSize), convert(smallint,ColumnHeight), convert(smallint,TabIndex), convert(smallint,SortOrder), convert(int,ScreenObjId), convert(int,ScreenId), convert(int,ScreenGrpId), convert(int,ColumnId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), convert(int,DdlAdnColumnId), convert(int,DdlFtrColumnId), convert(int,TabFolderId), DefaultValue, SystemValue, MasterTable, DefAfter, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, AggregateCd, GenerateSp, RequiredValid, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm, LabelCss, ContentCss, ColumnName, ColumnDesc, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObj'')) CREATE TABLE dbo.ScreenObj (ScreenObjId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, ScreenGrpId Int NOT NULL, LabelCss VarChar(1000) NULL, ContentCss VarChar(1000) NULL, ColumnId Int NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(200) NULL, DefaultValue NVarChar(200) NULL, DefAfter Char(1) NOT NULL, SystemValue NVarChar(200) NULL, DefAlways Char(1) NOT NULL, ColumnWrap Char(1) NOT NULL, GridGrpCd Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, ColumnHeight SmallInt NULL, DisplayModeId TinyInt NOT NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlAdnColumnId Int NULL, DdlFtrColumnId Int NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId Int NULL, TabIndex SmallInt NOT NULL, SortOrder SmallInt NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(100) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(1000) NULL, RefreshOnCUD Char(1) NOT NULL, TrimOnEntry Char(1) NOT NULL, MatchCd Char(1) NULL, IgnoreConfirm Char(1) NOT NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))') EXEC (' ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAfter DEFAULT (''N'') FOR DefAfter ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAlways DEFAULT (''N'') FOR DefAlways ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_GridGrpCd DEFAULT (''N'') FOR GridGrpCd ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_TrimOnEntry DEFAULT (''Y'') FOR TrimOnEntry ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_IgnoreConfirm DEFAULT (''Y'') FOR IgnoreConfirm SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm) SELECT ScreenObjId, ScreenId, MasterTable, ScreenGrpId, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2598&typ=N&sys=3","","",""); return false;
2599~@~   8.  10.31022:D:   10:*:*:M: Add table Deleted~@~5314~@~10~@~D~@~~@~~@~M~@~~@~Add table Deleted~@~Y~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Deleted'')) CREATE TABLE dbo.Deleted(DbName varchar(50) NOT NULL, TableName varchar(50) NOT NULL, PKeyId varchar(100) NOT NULL, DContent nvarchar(max) NULL, DeletedBy int NOT NULL, DeletedOn datetime NOT NULL)')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2599&typ=N&sys=3","","",""); return false;
2600~@~   8.  15.31114:D:   10:*:*:M: Change table SredMebr~@~5319~@~10~@~D~@~~@~~@~M~@~~@~Change table SredMebr~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_SredMebr (SredMebrId int NULL, MemberId int NULL, UserId int NULL, MnSalary money NULL, MnNtxBenefit money NULL, MnTaxBenefit money NULL, MemberTitle nvarchar(50) NULL, LT10PercShare char(1) NULL, MnWorkHours decimal(9,2) NULL)') EXEC (' INSERT INTO dbo.Tmp_SredMebr (SredMebrId, MemberId, UserId, MnSalary, MnNtxBenefit, MnTaxBenefit, MemberTitle, LT10PercShare, MnWorkHours) SELECT convert(int,SredMebrId), convert(int,MemberId), convert(int,UserId), convert(money,MnSalary), convert(money,MnNtxBenefit), convert(money,MnTaxBenefit), MemberTitle, LT10PercShare, convert(decimal(9,2),MnWorkHours) FROM dbo.SredMebr IF (SELECT COUNT(1) FROM dbo.Tmp_SredMebr) > 0 OR (SELECT COUNT(1) FROM dbo.SredMebr) = 0 DROP TABLE dbo.SredMebr') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.SredMebr'')) CREATE TABLE dbo.SredMebr (SredMebrId Int IDENTITY NOT NULL, MemberId Int NOT NULL, MemberName NVarChar(50) NULL, UserId Int NOT NULL, MemberTitle NVarChar(50) NULL, LT10PercShare Char(1) NOT NULL, MnSalary Money NOT NULL, MnNtxBenefit Money NOT NULL, MnTaxBenefit Money NOT NULL, MnWorkHours Decimal(9,2) NOT NULL, CONSTRAINT PK_SredMebr PRIMARY KEY CLUSTERED (SredMebrId))') EXEC (' SET IDENTITY_INSERT dbo.SredMebr ON INSERT INTO dbo.SredMebr (SredMebrId, MemberId, UserId, MemberTitle, LT10PercShare, MnSalary, MnNtxBenefit, MnTaxBenefit, MnWorkHours) SELECT SredMebrId, MemberId, UserId, MemberTitle, LT10PercShare, MnSalary, MnNtxBenefit, MnTaxBenefit, MnWorkHours FROM dbo.Tmp_SredMebr SET IDENTITY_INSERT dbo.SredMebr OFF IF (SELECT COUNT(1) FROM dbo.SredMebr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_SredMebr) = 0 DROP TABLE dbo.Tmp_SredMebr IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IU_SredMebr'') CREATE UNIQUE NONCLUSTERED INDEX IU_SredMebr ON dbo.SredMebr(MemberId,UserId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2600&typ=N&sys=3","","",""); return false;
2601~@~   8.  15.31114:D:   20:*:*:M: Add table UsrProvider~@~5319~@~20~@~D~@~~@~~@~M~@~~@~Add table UsrProvider~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrProvider'')) CREATE TABLE dbo.UsrProvider(UsrId int NOT NULL, ProviderCd char(1) NOT NULL, LoginName nvarchar(200) NOT NULL, CONSTRAINT PK_UsrProvider PRIMARY KEY CLUSTERED (UsrId,ProviderCd))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2601&typ=N&sys=3","","",""); return false;
2602~@~   8.  28.40423:D:   10:*:*:M: Standardize screen criteria group~@~5332~@~10~@~D~@~~@~~@~M~@~~@~Standardize screen criteria group~@~Y~@~EXEC ('UPDATE dbo.ScreenCri Set ScreenGrpId = 1')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2602&typ=N&sys=3","","",""); return false;
2603~@~   8.  29.40425:D:   10:*:*:M: Change table ScreenGrp~@~5333~@~10~@~D~@~~@~~@~M~@~~@~Change table ScreenGrp~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_ScreenGrp (BorderWidth tinyint NULL, TabIndex smallint NULL, ScreenGrpId int NULL, ScreenId int NULL, ParentGrpId int NULL, ScreenGrpName nvarchar(50) NULL, ScreenGrpTypeCd char(1) NULL, ContentVertical char(1) NULL, LabelVertical char(1) NULL, ScreenGrpIndex varchar(20) NULL, GrpStyle varchar(200) NULL)')
EXEC ('INSERT INTO dbo.Tmp_ScreenGrp (BorderWidth, TabIndex, ScreenGrpId, ScreenId, ParentGrpId, ScreenGrpName, ScreenGrpTypeCd, ContentVertical, LabelVertical, ScreenGrpIndex, GrpStyle) SELECT convert(tinyint,BorderWidth), convert(smallint,TabIndex), convert(int,ScreenGrpId), convert(int,ScreenId), convert(int,ParentGrpId), ScreenGrpName, ScreenGrpTypeCd, ContentVertical, LabelVertical, ScreenGrpIndex, GrpStyle FROM dbo.ScreenGrp IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenGrp) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenGrp) = 0 DROP TABLE dbo.ScreenGrp')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenGrp'')) CREATE TABLE dbo.ScreenGrp (ScreenGrpId Int IDENTITY NOT NULL, ScreenId Int NULL, ScreenGrpTypeCd Char(1) NULL, ParentGrpId Int NULL, ScreenGrpCss VarChar(20) NULL, ScreenGrpName NVarChar(50) NOT NULL, TabIndex SmallInt NULL, ScreenGrpIndex VarChar(20) NULL, ContentVertical Char(1) NULL, LabelVertical Char(1) NULL, BorderWidth TinyInt NULL, GrpStyle VarChar(200) NULL, CONSTRAINT PK_ScreenGrp PRIMARY KEY CLUSTERED (ScreenGrpId))')
EXEC ('SET IDENTITY_INSERT dbo.ScreenGrp ON INSERT INTO dbo.ScreenGrp (ScreenGrpId, ScreenId, ScreenGrpTypeCd, ParentGrpId, ScreenGrpName, TabIndex, ScreenGrpIndex, ContentVertical, LabelVertical, BorderWidth, GrpStyle) SELECT ScreenGrpId, ScreenId, ScreenGrpTypeCd, ParentGrpId, ScreenGrpName, TabIndex, ScreenGrpIndex, ContentVertical, LabelVertical, BorderWidth, GrpStyle FROM dbo.Tmp_ScreenGrp SET IDENTITY_INSERT dbo.ScreenGrp OFF IF (SELECT COUNT(1) FROM dbo.ScreenGrp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenGrp) = 0 DROP TABLE dbo.Tmp_ScreenGrp')

EXEC ('SET IDENTITY_INSERT dbo.ScreenGrp ON
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (801, ''c-1-1'', ''Column  1 to  1 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (802, ''c-2-2'', ''Column  2 to  2 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (803, ''c-3-3'', ''Column  3 to  3 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (804, ''c-4-4'', ''Column  4 to  4 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (805, ''c-5-5'', ''Column  5 to  5 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (806, ''c-6-6'', ''Column  6 to  6 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (807, ''c-7-7'', ''Column  7 to  7 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (808, ''c-8-8'', ''Column  8 to  8 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (809, ''c-9-9'', ''Column  9 to  9 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (810, ''c-10-10'', ''Column 10 to 10 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (811, ''c-11-11'', ''Column 11 to 11 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (812, ''c-12-12'', ''Column 12 to 12 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (813, ''c-1-2'', ''Column  1 to  2 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (814, ''c-2-3'', ''Column  2 to  3 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (815, ''c-3-4'', ''Column  3 to  4 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (816, ''c-4-5'', ''Column  4 to  5 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (817, ''c-5-6'', ''Column  5 to  6 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (818, ''c-6-7'', ''Column  6 to  7 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (819, ''c-7-8'', ''Column  7 to  8 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (820, ''c-8-9'', ''Column  8 to  9 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (821, ''c-9-10'', ''Column  9 to 10 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (822, ''c-10-11'', ''Column 10 to 11 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (823, ''c-11-12'', ''Column 11 to 12 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (824, ''c-1-3'', ''Column  1 to  3 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (825, ''c-2-4'', ''Column  2 to  4 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (826, ''c-3-5'', ''Column  3 to  5 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (827, ''c-4-6'', ''Column  4 to  6 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (828, ''c-5-7'', ''Column  5 to  7 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (829, ''c-6-8'', ''Column  6 to  8 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (830, ''c-7-9'', ''Column  7 to  9 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (831, ''c-8-10'', ''Column  8 to 10 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (832, ''c-9-11'', ''Column  9 to 11 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (833, ''c-10-12'', ''Column 10 to 12 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (834, ''c-1-4'', ''Column  1 to  4 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (835, ''c-2-5'', ''Column  2 to  5 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (836, ''c-3-6'', ''Column  3 to  6 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (837, ''c-4-7'', ''Column  4 to  7 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (838, ''c-5-8'', ''Column  5 to  8 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (839, ''c-6-9'', ''Column  6 to  9 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (840, ''c-7-10'', ''Column  7 to 10 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (841, ''c-8-11'', ''Column  8 to 11 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (842, ''c-9-12'', ''Column  9 to 12 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (843, ''c-1-5'', ''Column  1 to  5 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (844, ''c-2-6'', ''Column  2 to  6 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (845, ''c-3-7'', ''Column  3 to  7 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (846, ''c-4-8'', ''Column  4 to  8 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (847, ''c-5-9'', ''Column  5 to  9 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (848, ''c-6-10'', ''Column  6 to 10 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (849, ''c-7-11'', ''Column  7 to 11 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (850, ''c-8-12'', ''Column  8 to 12 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (851, ''c-1-6'', ''Column  1 to  6 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (852, ''c-2-7'', ''Column  2 to  7 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (853, ''c-3-8'', ''Column  3 to  8 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (854, ''c-4-9'', ''Column  4 to  9 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (855, ''c-5-10'', ''Column  5 to 10 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (856, ''c-6-11'', ''Column  6 to 11 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (857, ''c-7-12'', ''Column  7 to 12 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (858, ''c-1-7'', ''Column  1 to  7 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (859, ''c-2-8'', ''Column  2 to  8 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (860, ''c-3-9'', ''Column  3 to  9 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (861, ''c-4-10'', ''Column  4 to 10 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (862, ''c-5-11'', ''Column  5 to 11 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (863, ''c-6-12'', ''Column  6 to 12 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (864, ''c-1-8'', ''Column  1 to  8 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (865, ''c-2-9'', ''Column  2 to  9 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (866, ''c-3-10'', ''Column  3 to 10 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (867, ''c-4-11'', ''Column  4 to 11 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (868, ''c-5-12'', ''Column  5 to 12 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (869, ''c-1-9'', ''Column  1 to  9 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (870, ''c-2-10'', ''Column  2 to 10 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (871, ''c-3-11'', ''Column  3 to 11 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (872, ''c-4-12'', ''Column  4 to 12 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (873, ''c-1-10'', ''Column  1 to 10 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (874, ''c-2-11'', ''Column  2 to 11 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (875, ''c-3-12'', ''Column  3 to 12 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (876, ''c-1-11'', ''Column  1 to 11 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (877, ''c-2-12'', ''Column  2 to 12 of 12'')
INSERT dbo.ScreenGrp (ScreenGrpId,ScreenGrpCss,ScreenGrpName) VALUES (878, ''c-1-12'', ''Column  1 to 12 of 12'')
SET IDENTITY_INSERT dbo.ScreenGrp OFF')

EXEC ('UPDATE ScreenObj SET ScreenGrpId = 851 WHERE ScreenGrpId in (1,2,3,4)')
EXEC ('DECLARE @ScreenId int
DECLARE cur1 CURSOR FAST_FORWARD FOR SELECT ScreenId FROM dbo.Screen ORDER BY ScreenId FOR READ ONLY
OPEN cur1
FETCH NEXT FROM cur1 INTO @ScreenId
WHILE @@FETCH_STATUS = 0
BEGIN
	IF EXISTS (SELECT 1 FROM dbo.ScreenObj WHERE ScreenId = @ScreenId AND ScreenGrpId = 9)
	BEGIN
		UPDATE ScreenObj SET ScreenGrpId = 824 WHERE ScreenId = @ScreenId AND ScreenGrpId = 6
		UPDATE ScreenObj SET ScreenGrpId = 827 WHERE ScreenId = @ScreenId AND ScreenGrpId = 7
		UPDATE ScreenObj SET ScreenGrpId = 830 WHERE ScreenId = @ScreenId AND ScreenGrpId = 8
		UPDATE ScreenObj SET ScreenGrpId = 833 WHERE ScreenId = @ScreenId AND ScreenGrpId = 9
	END
	ELSE IF EXISTS (SELECT 1 FROM dbo.ScreenObj WHERE ScreenId = @ScreenId AND ScreenGrpId = 8)
	BEGIN
		UPDATE ScreenObj SET ScreenGrpId = 834 WHERE ScreenId = @ScreenId AND ScreenGrpId = 6
		UPDATE ScreenObj SET ScreenGrpId = 838 WHERE ScreenId = @ScreenId AND ScreenGrpId = 7
		UPDATE ScreenObj SET ScreenGrpId = 842 WHERE ScreenId = @ScreenId AND ScreenGrpId = 8
	END
	ELSE
	BEGIN
		UPDATE ScreenObj SET ScreenGrpId = 851 WHERE ScreenId = @ScreenId AND ScreenGrpId = 6
		UPDATE ScreenObj SET ScreenGrpId = 857 WHERE ScreenId = @ScreenId AND ScreenGrpId = 7
	END
	FETCH NEXT FROM cur1 INTO @ScreenId
END
CLOSE cur1
DEALLOCATE cur1')
EXEC ('UPDATE ScreenObj SET ScreenGrpId = 851 WHERE ScreenGrpId <= 800')
EXEC ('DELETE from ScreenGrp WHERE ScreenGrpId <= 800')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2603&typ=N&sys=3","","",""); return false;
2604~@~   8.  30.40429:D:   10:*:*:M: Remove tables Custom & CustomDtl~@~5334~@~10~@~D~@~~@~~@~M~@~~@~Remove tables Custom & CustomDtl~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Custom'')) DROP TABLE dbo.Custom')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CustomDtl'')) DROP TABLE dbo.CustomDtl')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2604&typ=N&sys=3","","",""); return false;
2605~@~   8.  30.40429:D:   20:*:*:M: Remove table CtNumCols,CtSearchMode,CtScreenGrpTyp~@~5334~@~20~@~D~@~~@~~@~M~@~~@~Remove table CtNumCols,CtSearchMode,CtScreenGrpTyp~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtNumCols'')) DROP TABLE dbo.CtNumCols')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtSearchMode'')) DROP TABLE dbo.CtSearchMode')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtScreenGrpType'')) DROP TABLE dbo.CtScreenGrpType')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2605&typ=N&sys=3","","",""); return false;
2606~@~   8.  30.40429:D:   30:*:*:M: Change table ScreenGrp~@~5334~@~30~@~D~@~~@~~@~M~@~~@~Change table ScreenGrp~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenGrp (BorderWidth tinyint NULL, TabIndex smallint NULL, ScreenGrpId int NULL, ScreenId int NULL, ParentGrpId int NULL, ScreenGrpName nvarchar(50) NULL, ScreenGrpTypeCd char(1) NULL, ContentVertical char(1) NULL, LabelVertical char(1) NULL, ScreenGrpCss varchar(20) NULL, ScreenGrpIndex varchar(20) NULL, GrpStyle varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenGrp (BorderWidth, TabIndex, ScreenGrpId, ScreenId, ParentGrpId, ScreenGrpName, ScreenGrpTypeCd, ContentVertical, LabelVertical, ScreenGrpCss, ScreenGrpIndex, GrpStyle) SELECT convert(tinyint,BorderWidth), convert(smallint,TabIndex), convert(int,ScreenGrpId), convert(int,ScreenId), convert(int,ParentGrpId), ScreenGrpName, ScreenGrpTypeCd, ContentVertical, LabelVertical, ScreenGrpCss, ScreenGrpIndex, GrpStyle FROM dbo.ScreenGrp IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenGrp) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenGrp) = 0 DROP TABLE dbo.ScreenGrp') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenGrp'')) CREATE TABLE dbo.ScreenGrp (ScreenGrpId Int IDENTITY NOT NULL, ScreenGrpCss VarChar(20) NULL, ScreenGrpName NVarChar(50) NOT NULL, CONSTRAINT PK_ScreenGrp PRIMARY KEY CLUSTERED (ScreenGrpId))') EXEC (' SET IDENTITY_INSERT dbo.ScreenGrp ON INSERT INTO dbo.ScreenGrp (ScreenGrpId, ScreenGrpCss, ScreenGrpName) SELECT ScreenGrpId, ScreenGrpCss, ScreenGrpName FROM dbo.Tmp_ScreenGrp SET IDENTITY_INSERT dbo.ScreenGrp OFF IF (SELECT COUNT(1) FROM dbo.ScreenGrp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenGrp) = 0 DROP TABLE dbo.Tmp_ScreenGrp')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2606&typ=N&sys=3","","",""); return false;
2607~@~   8.  30.40429:D:   40:*:*:M: Change table ScreenCri~@~5334~@~40~@~D~@~~@~~@~M~@~~@~Change table ScreenCri~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenCri (DisplayModeId tinyint NULL, TabIndex smallint NULL, ColumnSize smallint NULL, RowSize smallint NULL, ScreenCriId int NULL, ScreenId int NULL, ScreenGrpId int NULL, ColumnId int NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, ColumnJustify char(1) NULL, RequiredValid char(1) NULL, ScreenCriDesc varchar(100) NULL, LabelCss varchar(100) NULL, ContentCss varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenCri (DisplayModeId, TabIndex, ColumnSize, RowSize, ScreenCriId, ScreenId, ScreenGrpId, ColumnId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, ColumnJustify, RequiredValid, ScreenCriDesc, LabelCss, ContentCss) SELECT convert(tinyint,DisplayModeId), convert(smallint,TabIndex), convert(smallint,ColumnSize), convert(smallint,RowSize), convert(int,ScreenCriId), convert(int,ScreenId), convert(int,ScreenGrpId), convert(int,ColumnId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), ColumnJustify, RequiredValid, ScreenCriDesc, LabelCss, ContentCss FROM dbo.ScreenCri IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenCri) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenCri) = 0 DROP TABLE dbo.ScreenCri') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenCri'')) CREATE TABLE dbo.ScreenCri (ScreenCriId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, ScreenCriDesc VarChar(100) NULL, LabelCss VarChar(100) NULL, ContentCss VarChar(100) NULL, ColumnId Int NOT NULL, TabIndex SmallInt NOT NULL, DisplayModeId TinyInt NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, RowSize SmallInt NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, RequiredValid Char(1) NOT NULL, CONSTRAINT PK_ScreenCri PRIMARY KEY CLUSTERED (ScreenCriId))') EXEC (' SET IDENTITY_INSERT dbo.ScreenCri ON INSERT INTO dbo.ScreenCri (ScreenCriId, ScreenId, ScreenCriDesc, LabelCss, ContentCss, ColumnId, TabIndex, DisplayModeId, ColumnJustify, ColumnSize, RowSize, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, RequiredValid) SELECT ScreenCriId, ScreenId, ScreenCriDesc, LabelCss, ContentCss, ColumnId, TabIndex, DisplayModeId, ColumnJustify, ColumnSize, RowSize, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, RequiredValid FROM dbo.Tmp_ScreenCri SET IDENTITY_INSERT dbo.ScreenCri OFF IF (SELECT COUNT(1) FROM dbo.ScreenCri) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenCri) = 0 DROP TABLE dbo.Tmp_ScreenCri')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2607&typ=N&sys=3","","",""); return false;
2608~@~   8.  30.40429:D:   50:*:*:M: Change table ScreenObj~@~5334~@~50~@~D~@~~@~~@~M~@~~@~Change table ScreenObj~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenObj (DisplayModeId tinyint NULL, ColumnSize smallint NULL, ColumnHeight smallint NULL, TabIndex smallint NULL, SortOrder smallint NULL, ScreenObjId int NULL, ScreenId int NULL, ScreenGrpId int NULL, ColumnId int NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DdlAdnColumnId int NULL, DdlFtrColumnId int NULL, TabFolderId int NULL, DefaultValue nvarchar(200) NULL, SystemValue nvarchar(200) NULL, MasterTable char(1) NULL, DefAfter char(1) NULL, DefAlways char(1) NULL, ColumnWrap char(1) NULL, GridGrpCd char(1) NULL, ColumnJustify char(1) NULL, AggregateCd char(1) NULL, GenerateSp char(1) NULL, RequiredValid char(1) NULL, RefreshOnCUD char(1) NULL, TrimOnEntry char(1) NULL, MatchCd char(1) NULL, IgnoreConfirm char(1) NULL, LabelCss varchar(1000) NULL, ContentCss varchar(1000) NULL, ColumnName varchar(20) NULL, ColumnDesc varchar(200) NULL, MaskValid varchar(100) NULL, RangeValidType varchar(50) NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, ColumnLink varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObj (DisplayModeId, ColumnSize, ColumnHeight, TabIndex, SortOrder, ScreenObjId, ScreenId, ScreenGrpId, ColumnId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, TabFolderId, DefaultValue, SystemValue, MasterTable, DefAfter, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, AggregateCd, GenerateSp, RequiredValid, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm, LabelCss, ContentCss, ColumnName, ColumnDesc, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink) SELECT convert(tinyint,DisplayModeId), convert(smallint,ColumnSize), convert(smallint,ColumnHeight), convert(smallint,TabIndex), convert(smallint,SortOrder), convert(int,ScreenObjId), convert(int,ScreenId), convert(int,ScreenGrpId), convert(int,ColumnId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), convert(int,DdlAdnColumnId), convert(int,DdlFtrColumnId), convert(int,TabFolderId), DefaultValue, SystemValue, MasterTable, DefAfter, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, AggregateCd, GenerateSp, RequiredValid, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm, LabelCss, ContentCss, ColumnName, ColumnDesc, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObj'')) CREATE TABLE dbo.ScreenObj (ScreenObjId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, ScreenGrpId Int NOT NULL, LabelVertical Char(1) NOT NULL, LabelCss VarChar(1000) NULL, ContentCss VarChar(1000) NULL, ColumnId Int NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(200) NULL, DefaultValue NVarChar(200) NULL, DefAfter Char(1) NOT NULL, SystemValue NVarChar(200) NULL, DefAlways Char(1) NOT NULL, ColumnWrap Char(1) NOT NULL, GridGrpCd Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, ColumnHeight SmallInt NULL, DisplayModeId TinyInt NOT NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlAdnColumnId Int NULL, DdlFtrColumnId Int NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId Int NULL, TabIndex SmallInt NOT NULL, SortOrder SmallInt NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(100) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(1000) NULL, RefreshOnCUD Char(1) NOT NULL, TrimOnEntry Char(1) NOT NULL, MatchCd Char(1) NULL, IgnoreConfirm Char(1) NOT NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))') EXEC (' ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_LabelVertical DEFAULT (''N'') FOR LabelVertical ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAfter DEFAULT (''N'') FOR DefAfter ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAlways DEFAULT (''N'') FOR DefAlways ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_GridGrpCd DEFAULT (''N'') FOR GridGrpCd ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_TrimOnEntry DEFAULT (''Y'') FOR TrimOnEntry ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_IgnoreConfirm DEFAULT (''Y'') FOR IgnoreConfirm SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, LabelVertical, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm) SELECT ScreenObjId, ScreenId, MasterTable, ScreenGrpId, ''N'', LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2608&typ=N&sys=3","","",""); return false;
2609~@~   8.  32.40506:D:   10:*:*:M: Change table ScreenObjHlp~@~5336~@~10~@~D~@~~@~~@~M~@~~@~Change table ScreenObjHlp~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenObjHlp (CultureId smallint NULL, ScreenObjHlpId int NULL, ScreenObjId int NULL, ColumnHeader nvarchar(50) NULL, ToolTip nvarchar(200) NULL, ErrMessage nvarchar(300) NULL, TbHint nvarchar(200) NULL, ScreenObjHlpDesc varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObjHlp (CultureId, ScreenObjHlpId, ScreenObjId, ColumnHeader, ToolTip, ErrMessage, TbHint, ScreenObjHlpDesc) SELECT convert(smallint,CultureId), convert(int,ScreenObjHlpId), convert(int,ScreenObjId), ColumnHeader, ToolTip, ErrMessage, TbHint, ScreenObjHlpDesc FROM dbo.ScreenObjHlp IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObjHlp) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObjHlp) = 0 DROP TABLE dbo.ScreenObjHlp') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObjHlp'')) CREATE TABLE dbo.ScreenObjHlp (ScreenObjHlpId Int IDENTITY NOT NULL, ScreenObjHlpDesc VarChar(200) NULL, ScreenObjId Int NOT NULL, CultureId SmallInt NOT NULL, ColumnHeader NVarChar(max) NULL, ToolTip NVarChar(200) NULL, ErrMessage NVarChar(300) NULL, TbHint NVarChar(200) NULL, CONSTRAINT PK_ScreenObjHlp PRIMARY KEY CLUSTERED (ScreenObjHlpId))') EXEC (' SET IDENTITY_INSERT dbo.ScreenObjHlp ON INSERT INTO dbo.ScreenObjHlp (ScreenObjHlpId, ScreenObjHlpDesc, ScreenObjId, CultureId, ColumnHeader, ToolTip, ErrMessage, TbHint) SELECT ScreenObjHlpId, ScreenObjHlpDesc, ScreenObjId, CultureId, ColumnHeader, ToolTip, ErrMessage, TbHint FROM dbo.Tmp_ScreenObjHlp SET IDENTITY_INSERT dbo.ScreenObjHlp OFF IF (SELECT COUNT(1) FROM dbo.ScreenObjHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObjHlp) = 0 DROP TABLE dbo.Tmp_ScreenObjHlp')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2609&typ=N&sys=3","","",""); return false;
2610~@~   8.  35.40512:D:   10:*:*:M: Remove sp. Cr_ChkScreenGrp, etc.~@~5339~@~10~@~D~@~~@~~@~M~@~~@~Remove sp. Cr_ChkScreenGrp, etc.~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Cr_ChkScreenGrp'')) DROP PROCEDURE Cr_ChkScreenGrp')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Cr_ChkScreenGrpLoop'')) DROP PROCEDURE Cr_ChkScreenGrpLoop')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Cr_ChkScreenParentGrp'')) DROP PROCEDURE Cr_ChkScreenParentGrp')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Cr_NoScreenDelWhenRef'')) DROP PROCEDURE Cr_NoScreenDelWhenRef')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Ir_ChgScreenCriGrp'')) DROP PROCEDURE Ir_ChgScreenCriGrp')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Ir_UpdScreenGrpIndex'')) DROP PROCEDURE Ir_UpdScreenGrpIndex')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Ir_UpdScreenGrpIndex1'')) DROP PROCEDURE Ir_UpdScreenGrpIndex1')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Ir_UpdScreenGrpIndex2'')) DROP PROCEDURE Ir_UpdScreenGrpIndex2')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2610&typ=N&sys=3","","",""); return false;
2611~@~   8.  37.40521:D:   10:*:*:M: Change table Release~@~5341~@~10~@~D~@~~@~~@~M~@~~@~Change table Release~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_Release (ReleaseTypeId tinyint NULL, ReleaseId smallint NULL, EntityId smallint NULL, ReleaseName nvarchar(50) NULL, ReleaseDesc nvarchar(80) NULL, ReleaseDate datetime NULL, ReleaseOs char(1) NULL, ReleaseBuild varchar(20) NULL, TarScriptAft varchar(max) NULL, ReadMe varchar(max) NULL, MkDeploy varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_Release (ReleaseTypeId, ReleaseId, EntityId, ReleaseName, ReleaseDesc, ReleaseDate, ReleaseOs, ReleaseBuild, TarScriptAft, ReadMe, MkDeploy) SELECT convert(tinyint,ReleaseTypeId), convert(smallint,ReleaseId), convert(smallint,EntityId), ReleaseName, ReleaseDesc, ReleaseDate, ReleaseOs, ReleaseBuild, TarScriptAft, ReadMe, MkDeploy FROM dbo.Release IF (SELECT COUNT(1) FROM dbo.Tmp_Release) > 0 OR (SELECT COUNT(1) FROM dbo.Release) = 0 DROP TABLE dbo.Release') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Release'')) CREATE TABLE dbo.Release (ReleaseId SmallInt IDENTITY NOT NULL, ReleaseName NVarChar(50) NOT NULL, ReleaseDesc NVarChar(80) NULL, ReleaseBuild VarChar(20) NULL, ReleaseDate DateTime NULL, ReleaseOs Char(1) NOT NULL, EntityId SmallInt NOT NULL, ReleaseTypeId TinyInt NOT NULL, TarScriptAft VarChar(max) NULL, ReadMe VarChar(max) NULL, CONSTRAINT PK_Release PRIMARY KEY CLUSTERED (ReleaseId))') EXEC (' SET IDENTITY_INSERT dbo.Release ON INSERT INTO dbo.Release (ReleaseId, ReleaseName, ReleaseDesc, ReleaseBuild, ReleaseDate, ReleaseOs, EntityId, ReleaseTypeId, TarScriptAft, ReadMe) SELECT ReleaseId, ReleaseName, ReleaseDesc, ReleaseBuild, ReleaseDate, ReleaseOs, EntityId, ReleaseTypeId, TarScriptAft, ReadMe FROM dbo.Tmp_Release SET IDENTITY_INSERT dbo.Release OFF IF (SELECT COUNT(1) FROM dbo.Release) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Release) = 0 DROP TABLE dbo.Tmp_Release')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2611&typ=N&sys=3","","",""); return false;
2612~@~   8.  37.40521:D:   20:*:*:M: Change table ScreenObj~@~5341~@~20~@~D~@~~@~~@~M~@~~@~Change table ScreenObj~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenObj (DisplayModeId tinyint NULL, ColumnSize smallint NULL, ColumnHeight smallint NULL, TabIndex smallint NULL, SortOrder smallint NULL, ScreenObjId int NULL, ScreenId int NULL, ScreenGrpId int NULL, ColumnId int NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DdlAdnColumnId int NULL, DdlFtrColumnId int NULL, TabFolderId int NULL, DefaultValue nvarchar(200) NULL, SystemValue nvarchar(200) NULL, MasterTable char(1) NULL, LabelVertical char(1) NULL, DefAfter char(1) NULL, DefAlways char(1) NULL, ColumnWrap char(1) NULL, GridGrpCd char(1) NULL, ColumnJustify char(1) NULL, AggregateCd char(1) NULL, GenerateSp char(1) NULL, RequiredValid char(1) NULL, RefreshOnCUD char(1) NULL, TrimOnEntry char(1) NULL, MatchCd char(1) NULL, IgnoreConfirm char(1) NULL, LabelCss varchar(1000) NULL, ContentCss varchar(1000) NULL, ColumnName varchar(20) NULL, ColumnDesc varchar(200) NULL, MaskValid varchar(100) NULL, RangeValidType varchar(50) NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, ColumnLink varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObj (DisplayModeId, ColumnSize, ColumnHeight, TabIndex, SortOrder, ScreenObjId, ScreenId, ScreenGrpId, ColumnId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, TabFolderId, DefaultValue, SystemValue, MasterTable, LabelVertical, DefAfter, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, AggregateCd, GenerateSp, RequiredValid, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm, LabelCss, ContentCss, ColumnName, ColumnDesc, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink) SELECT convert(tinyint,DisplayModeId), convert(smallint,ColumnSize), convert(smallint,ColumnHeight), convert(smallint,TabIndex), convert(smallint,SortOrder), convert(int,ScreenObjId), convert(int,ScreenId), convert(int,ScreenGrpId), convert(int,ColumnId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), convert(int,DdlAdnColumnId), convert(int,DdlFtrColumnId), convert(int,TabFolderId), DefaultValue, SystemValue, MasterTable, LabelVertical, DefAfter, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, AggregateCd, GenerateSp, RequiredValid, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm, LabelCss, ContentCss, ColumnName, ColumnDesc, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObj'')) CREATE TABLE dbo.ScreenObj (ScreenObjId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, ScreenGrpId Int NOT NULL, LabelVertical Char(1) NOT NULL, LabelCss VarChar(1000) NULL, ContentCss VarChar(1000) NULL, ColumnId Int NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(200) NULL, DefaultValue NVarChar(200) NULL, HyperLinkUrl NVarChar(200) NULL, DefAfter Char(1) NOT NULL, SystemValue NVarChar(200) NULL, DefAlways Char(1) NOT NULL, ColumnWrap Char(1) NOT NULL, GridGrpCd Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, ColumnHeight SmallInt NULL, DisplayModeId TinyInt NOT NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlAdnColumnId Int NULL, DdlFtrColumnId Int NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId Int NULL, TabIndex SmallInt NOT NULL, SortOrder SmallInt NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(100) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(1000) NULL, RefreshOnCUD Char(1) NOT NULL, TrimOnEntry Char(1) NOT NULL, MatchCd Char(1) NULL, IgnoreConfirm Char(1) NOT NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))') EXEC (' ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_LabelVertical DEFAULT (''N'') FOR LabelVertical ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAfter DEFAULT (''N'') FOR DefAfter ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAlways DEFAULT (''N'') FOR DefAlways ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_GridGrpCd DEFAULT (''N'') FOR GridGrpCd ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_TrimOnEntry DEFAULT (''Y'') FOR TrimOnEntry ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_IgnoreConfirm DEFAULT (''Y'') FOR IgnoreConfirm SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, ScreenGrpId, LabelVertical, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm) SELECT ScreenObjId, ScreenId, MasterTable, ScreenGrpId, LabelVertical, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2612&typ=N&sys=3","","",""); return false;
2613~@~   8.  39.40528:D:   10:*:*:M: Change table ButtonHlp~@~5343~@~10~@~D~@~~@~~@~M~@~~@~Change table ButtonHlp~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ButtonHlp (ButtonTypeId tinyint NULL, CultureId smallint NULL, ButtonHlpId int NULL, ScreenId int NULL, ReportId int NULL, WizardId int NULL, ButtonName nvarchar(200) NULL, ButtonToolTip nvarchar(400) NULL, ButtonVisible char(1) NULL, ButtonIsImage char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_ButtonHlp (ButtonTypeId, CultureId, ButtonHlpId, ScreenId, ReportId, WizardId, ButtonName, ButtonToolTip, ButtonVisible, ButtonIsImage) SELECT convert(tinyint,ButtonTypeId), convert(smallint,CultureId), convert(int,ButtonHlpId), convert(int,ScreenId), convert(int,ReportId), convert(int,WizardId), ButtonName, ButtonToolTip, ButtonVisible, ButtonIsImage FROM dbo.ButtonHlp IF (SELECT COUNT(1) FROM dbo.Tmp_ButtonHlp) > 0 OR (SELECT COUNT(1) FROM dbo.ButtonHlp) = 0 DROP TABLE dbo.ButtonHlp') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ButtonHlp'')) CREATE TABLE dbo.ButtonHlp (ButtonHlpId Int IDENTITY NOT NULL, ScreenId Int NULL, ReportId Int NULL, WizardId Int NULL, CultureId SmallInt NOT NULL, ButtonTypeId TinyInt NOT NULL, ButtonName NVarChar(200) NULL, ButtonToolTip NVarChar(400) NULL, ButtonVisible Char(1) NOT NULL, CONSTRAINT PK_ButtonHlp PRIMARY KEY CLUSTERED (ButtonHlpId))') EXEC (' SET IDENTITY_INSERT dbo.ButtonHlp ON INSERT INTO dbo.ButtonHlp (ButtonHlpId, ScreenId, ReportId, WizardId, CultureId, ButtonTypeId, ButtonName, ButtonToolTip, ButtonVisible) SELECT ButtonHlpId, ScreenId, ReportId, WizardId, CultureId, ButtonTypeId, ButtonName, ButtonToolTip, ButtonVisible FROM dbo.Tmp_ButtonHlp SET IDENTITY_INSERT dbo.ButtonHlp OFF IF (SELECT COUNT(1) FROM dbo.ButtonHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ButtonHlp) = 0 DROP TABLE dbo.Tmp_ButtonHlp')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2613&typ=N&sys=3","","",""); return false;
2614~@~   8.  39.40528:D:   20:*:*:M: Change table CtButtonType~@~5343~@~20~@~D~@~~@~~@~M~@~~@~Change table CtButtonType~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_CtButtonType (ButtonTypeId tinyint NULL, ButtonTypeDesc nvarchar(50) NULL, ObjectType char(1) NULL, ButtonVisible char(1) NULL, ButtonIsImage char(1) NULL, ViewOnlyVisible char(1) NULL, ButtonTypeName varchar(20) NULL)') EXEC (' INSERT INTO dbo.Tmp_CtButtonType (ButtonTypeId, ButtonTypeDesc, ObjectType, ButtonVisible, ButtonIsImage, ViewOnlyVisible, ButtonTypeName) SELECT convert(tinyint,ButtonTypeId), ButtonTypeDesc, ObjectType, ButtonVisible, ButtonIsImage, ViewOnlyVisible, ButtonTypeName FROM dbo.CtButtonType IF (SELECT COUNT(1) FROM dbo.Tmp_CtButtonType) > 0 OR (SELECT COUNT(1) FROM dbo.CtButtonType) = 0 DROP TABLE dbo.CtButtonType') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtButtonType'')) CREATE TABLE dbo.CtButtonType (ButtonTypeId TinyInt NOT NULL, ObjectType Char(1) NOT NULL, ButtonTypeName VarChar(20) NOT NULL, ButtonTypeDesc NVarChar(50) NOT NULL, ButtonVisible Char(1) NOT NULL, ViewOnlyVisible Char(1) NOT NULL, CONSTRAINT PK_CtButtonType PRIMARY KEY CLUSTERED (ButtonTypeId))') EXEC (' ALTER TABLE dbo.CtButtonType ADD CONSTRAINT DF_CtButtonType_ViewOnlyVisible DEFAULT (''Y'') FOR ViewOnlyVisible INSERT INTO dbo.CtButtonType (ButtonTypeId, ObjectType, ButtonTypeName, ButtonTypeDesc, ButtonVisible, ViewOnlyVisible) SELECT ButtonTypeId, ObjectType, ButtonTypeName, ButtonTypeDesc, ButtonVisible, ViewOnlyVisible FROM dbo.Tmp_CtButtonType IF (SELECT COUNT(1) FROM dbo.CtButtonType) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtButtonType) = 0 DROP TABLE dbo.Tmp_CtButtonType')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2614&typ=N&sys=3","","",""); return false;
2615~@~   8.  40.40529:D:   10:*:*:M: Change table WebRule~@~5344~@~10~@~D~@~~@~~@~M~@~~@~Change table WebRule~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_WebRule (RuleTypeId tinyint NULL, ButtonTypeId tinyint NULL, EventId tinyint NULL, WebRuleId int NULL, ScreenId int NULL, ScreenCriId int NULL, ScreenObjId int NULL, RuleName nvarchar(100) NULL, RuleDesc nvarchar(150) NULL, RuleDescription nvarchar(500) NULL, WebRuleProg nvarchar(max) NULL)') EXEC (' INSERT INTO dbo.Tmp_WebRule (RuleTypeId, ButtonTypeId, EventId, WebRuleId, ScreenId, ScreenCriId, ScreenObjId, RuleName, RuleDesc, RuleDescription, WebRuleProg) SELECT convert(tinyint,RuleTypeId), convert(tinyint,ButtonTypeId), convert(tinyint,EventId), convert(int,WebRuleId), convert(int,ScreenId), convert(int,ScreenCriId), convert(int,ScreenObjId), RuleName, RuleDesc, RuleDescription, WebRuleProg FROM dbo.WebRule IF (SELECT COUNT(1) FROM dbo.Tmp_WebRule) > 0 OR (SELECT COUNT(1) FROM dbo.WebRule) = 0 DROP TABLE dbo.WebRule') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.WebRule'')) CREATE TABLE dbo.WebRule (WebRuleId Int IDENTITY NOT NULL, RuleTypeId TinyInt NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, ScreenId Int NOT NULL, ScreenObjId Int NULL, ButtonTypeId TinyInt NULL, EventId TinyInt NOT NULL, WebRuleProg NVarChar(max) NOT NULL, CONSTRAINT PK_WebRule PRIMARY KEY CLUSTERED (WebRuleId))') EXEC (' SET IDENTITY_INSERT dbo.WebRule ON INSERT INTO dbo.WebRule (WebRuleId, RuleTypeId, RuleName, RuleDesc, RuleDescription, ScreenId, ScreenObjId, ButtonTypeId, EventId, WebRuleProg) SELECT WebRuleId, RuleTypeId, RuleName, RuleDesc, RuleDescription, ScreenId, ScreenObjId, ButtonTypeId, EventId, WebRuleProg FROM dbo.Tmp_WebRule SET IDENTITY_INSERT dbo.WebRule OFF IF (SELECT COUNT(1) FROM dbo.WebRule) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_WebRule) = 0 DROP TABLE dbo.Tmp_WebRule')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2615&typ=N&sys=3","","",""); return false;
2616~@~   8.  41.40529:D:   10:*:*:M: Remove obsolete server rule~@~5345~@~10~@~D~@~~@~~@~M~@~~@~Remove obsolete server rule~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Cr_RmScrCriWRule'')) DROP PROCEDURE dbo.Cr_RmScrCriWRule')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2616&typ=N&sys=3","","",""); return false;
2617~@~   8.  43.40601:D:   10:*:*:M: Remove obsolete s.proc~@~5347~@~10~@~D~@~~@~~@~M~@~~@~Remove obsolete s.proc~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.GetScreenCriDdlById'')) DROP PROCEDURE dbo.GetScreenCriDdlById')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2617&typ=N&sys=3","","",""); return false;
2618~@~   8.  48.40613:D:   10:*:*:M: Remove obsolete Link Type~@~5352~@~10~@~D~@~~@~~@~M~@~~@~Remove obsolete Link Type~@~N~@~EXEC ('DELETE FROM dbo.CtLinkType WHERE LinkTypeCd = ''P''')
EXEC ('DELETE FROM dbo.UsrLink WHERE LinkTypeCd = ''P''')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=2618&typ=N&sys=3","","",""); return false;
3618~@~   8.  48.40613:D:   20:*:*:M: Change table CtLinkType~@~5352~@~20~@~D~@~~@~~@~M~@~~@~Change table CtLinkType~@~N~@~EXEC ('CREATE TABLE dbo.Tmp_CtLinkType (LinkTypeName nvarchar(50) NULL, LinkTypeCd char(1) NULL)')
EXEC ('INSERT INTO dbo.Tmp_CtLinkType (LinkTypeName, LinkTypeCd) SELECT LinkTypeName, LinkTypeCd FROM dbo.CtLinkType IF (SELECT COUNT(1) FROM dbo.Tmp_CtLinkType) > 0 OR (SELECT COUNT(1) FROM dbo.CtLinkType) = 0 DROP TABLE dbo.CtLinkType')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtLinkType'')) CREATE TABLE dbo.CtLinkType (LinkTypeCd Char(3) NOT NULL, LinkTypeName NVarChar(50) NOT NULL, LinkTypeDesc NVarChar(500) NULL, UsrDefined Char(1) NOT NULL, MobileCd Char(1) NOT NULL, CONSTRAINT PK_CtLinkType PRIMARY KEY CLUSTERED (LinkTypeCd))')
EXEC ('ALTER TABLE dbo.CtLinkType ADD CONSTRAINT DF_CtLinkType_UsrDefined DEFAULT (''N'') FOR UsrDefined ALTER TABLE dbo.CtLinkType ADD CONSTRAINT DF_CtLinkType_MobileCd DEFAULT (''S'') FOR MobileCd INSERT INTO dbo.CtLinkType (LinkTypeCd, LinkTypeName, UsrDefined, MobileCd) SELECT LinkTypeCd, LinkTypeName, ''N'', ''S'' FROM dbo.Tmp_CtLinkType IF (SELECT COUNT(1) FROM dbo.CtLinkType) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtLinkType) = 0 DROP TABLE dbo.Tmp_CtLinkType')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=3618&typ=N&sys=3","","",""); return false;
3619~@~   8.  48.40613:D:   30:*:*:M: Change table UsrLink~@~5352~@~30~@~D~@~~@~~@~M~@~~@~Change table UsrLink~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_UsrLink (HomeTabId smallint NULL, UsrLinkOrd smallint NULL, UsrLinkId int NULL, UsrPrefId int NULL, UsrLinkTxt nvarchar(1000) NULL, LinkTypeCd char(3) NULL, Popup char(1) NULL, UsrLinkRef varchar(200) NULL, UsrLinkImg varchar(200) NULL, UsrLinkAlt varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_UsrLink (HomeTabId, UsrLinkOrd, UsrLinkId, UsrPrefId, UsrLinkTxt, LinkTypeCd, Popup, UsrLinkRef, UsrLinkImg, UsrLinkAlt) SELECT convert(smallint,HomeTabId), convert(smallint,UsrLinkOrd), convert(int,UsrLinkId), convert(int,UsrPrefId), UsrLinkTxt, LinkTypeCd, Popup, UsrLinkRef, UsrLinkImg, UsrLinkAlt FROM dbo.UsrLink IF (SELECT COUNT(1) FROM dbo.Tmp_UsrLink) > 0 OR (SELECT COUNT(1) FROM dbo.UsrLink) = 0 DROP TABLE dbo.UsrLink') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrLink'')) CREATE TABLE dbo.UsrLink (UsrLinkId Int IDENTITY NOT NULL, UsrPrefId Int NOT NULL, LinkTypeCd Char(3) NOT NULL, UsrLinkCss VarChar(1000) NULL, Popup Char(1) NOT NULL, UsrLinkRef VarChar(200) NOT NULL, UsrLinkTxt NVarChar(1000) NULL, UsrLinkImg VarChar(200) NULL, UsrLinkAlt VarChar(200) NULL, UsrLinkOrd SmallInt NULL, CONSTRAINT PK_UsrLink PRIMARY KEY CLUSTERED (UsrLinkId))') EXEC (' ALTER TABLE dbo.UsrLink ADD CONSTRAINT DF_UsrLink_Popup DEFAULT (''Y'') FOR Popup SET IDENTITY_INSERT dbo.UsrLink ON INSERT INTO dbo.UsrLink (UsrLinkId, UsrPrefId, LinkTypeCd, Popup, UsrLinkRef, UsrLinkTxt, UsrLinkImg, UsrLinkAlt, UsrLinkOrd) SELECT UsrLinkId, UsrPrefId, LinkTypeCd, Popup, UsrLinkRef, UsrLinkTxt, UsrLinkImg, UsrLinkAlt, UsrLinkOrd FROM dbo.Tmp_UsrLink SET IDENTITY_INSERT dbo.UsrLink OFF IF (SELECT COUNT(1) FROM dbo.UsrLink) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrLink) = 0 DROP TABLE dbo.Tmp_UsrLink')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=3619&typ=N&sys=3","","",""); return false;
3620~@~   8.  48.40613:D:   30:*:*:M: Remove obsolete table~@~5352~@~30~@~D~@~~@~~@~M~@~~@~Remove obsolete table~@~N~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.HomeTab'')) DROP TABLE dbo.HomeTab')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=3620&typ=N&sys=3","","",""); return false;
4618~@~   8.  48.40613:D:   40:*:*:M: Change table UsrPref~@~5352~@~40~@~D~@~~@~~@~M~@~~@~Change table UsrPref~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_UsrPref (SystemId tinyint NULL, UsrGroupId smallint NULL, ProjectId smallint NULL, UsrPrefId int NULL, UsrId int NULL, CompanyId int NULL, MemberId int NULL, AgentId int NULL, BrokerId int NULL, CustomerId int NULL, InvestorId int NULL, VendorId int NULL, MenuOptId int NULL, SampleImage varbinary(max) NULL, UsrPrefDesc nvarchar(50) NULL, PrefDefault char(1) NULL, SysListVisible char(1) NULL, ComListVisible char(1) NULL, PrjListVisible char(1) NULL, PageBannerImg varchar(100) NULL, UsrStyleSheet varchar(max) NULL, SplashImg varchar(100) NULL, MasterPgFile varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_UsrPref (SystemId, UsrGroupId, ProjectId, UsrPrefId, UsrId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, MenuOptId, SampleImage, UsrPrefDesc, PrefDefault, SysListVisible, ComListVisible, PrjListVisible, PageBannerImg, UsrStyleSheet, SplashImg, MasterPgFile) SELECT convert(tinyint,SystemId), convert(smallint,UsrGroupId), convert(smallint,ProjectId), convert(int,UsrPrefId), convert(int,UsrId), convert(int,CompanyId), convert(int,MemberId), convert(int,AgentId), convert(int,BrokerId), convert(int,CustomerId), convert(int,InvestorId), convert(int,VendorId), convert(int,MenuOptId), SampleImage, UsrPrefDesc, PrefDefault, SysListVisible, ComListVisible, PrjListVisible, PageBannerImg, UsrStyleSheet, SplashImg, MasterPgFile FROM dbo.UsrPref IF (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.UsrPref) = 0 DROP TABLE dbo.UsrPref') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrPref'')) CREATE TABLE dbo.UsrPref (UsrPrefId Int IDENTITY NOT NULL, UsrId Int NULL, UsrGroupId SmallInt NULL, CompanyId Int NULL, MemberId Int NULL, AgentId Int NULL, BrokerId Int NULL, CustomerId Int NULL, InvestorId Int NULL, VendorId Int NULL, ProjectId Int NULL, SystemId TinyInt NULL, PrefDefault Char(1) NOT NULL, UsrPrefDesc NVarChar(50) NOT NULL, SysListVisible Char(1) NOT NULL, ComListVisible Char(1) NOT NULL, PrjListVisible Char(1) NOT NULL, MenuOptId Int NOT NULL, UsrStyleSheet VarChar(max) NULL, SplashImg VarChar(100) NULL, MasterPgFile VarChar(100) NULL, SampleImage VarBinary(max) NULL, CONSTRAINT PK_UsrPref PRIMARY KEY CLUSTERED (UsrPrefId))') EXEC (' ALTER TABLE dbo.UsrPref ADD CONSTRAINT DF_UsrPref_PrjListVisible DEFAULT (''N'') FOR PrjListVisible SET IDENTITY_INSERT dbo.UsrPref ON INSERT INTO dbo.UsrPref (UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOptId, UsrStyleSheet, SplashImg, MasterPgFile, SampleImage) SELECT UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, CONVERT(Int,ProjectId), SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOptId, UsrStyleSheet, SplashImg, MasterPgFile, SampleImage FROM dbo.Tmp_UsrPref SET IDENTITY_INSERT dbo.UsrPref OFF IF (SELECT COUNT(1) FROM dbo.UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) = 0 DROP TABLE dbo.Tmp_UsrPref')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4618&typ=N&sys=3","","",""); return false;
4619~@~   8.  48.40613:D:   50:*:*:M: Add table GroupCol and remove ScreenGrp~@~5352~@~50~@~D~@~~@~~@~M~@~~@~Add table GroupCol and remove ScreenGrp~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.GroupCol'')) BEGIN CREATE TABLE dbo.GroupCol (GroupColId SmallInt IDENTITY NOT NULL, ColCssClass VarChar(20) NULL, GroupColName NVarChar(50) NOT NULL, CONSTRAINT PK_GroupCol PRIMARY KEY CLUSTERED (GroupColId)) SET IDENTITY_INSERT dbo.GroupCol ON INSERT dbo.GroupCol (GroupColId,ColCssClass,GroupColName) SELECT ScreenGrpId,ScreenGrpCss,ScreenGrpName FROM dbo.ScreenGrp SET IDENTITY_INSERT dbo.GroupCol OFF END')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenGrp'')) DROP TABLE dbo.ScreenGrp')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4619&typ=N&sys=3","","",""); return false;
4620~@~   8.  48.40613:D:   60:*:*:M: Change table ScreenObj~@~5352~@~60~@~D~@~~@~~@~M~@~~@~Change table ScreenObj~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenObj (DisplayModeId tinyint NULL, ColumnSize smallint NULL, ColumnHeight smallint NULL, TabIndex smallint NULL, SortOrder smallint NULL, ScreenObjId int NULL, ScreenId int NULL, ScreenGrpId int NULL, ColumnId int NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DdlAdnColumnId int NULL, DdlFtrColumnId int NULL, TabFolderId int NULL, DefaultValue nvarchar(200) NULL, HyperLinkUrl nvarchar(200) NULL, SystemValue nvarchar(200) NULL, MasterTable char(1) NULL, LabelVertical char(1) NULL, DefAfter char(1) NULL, DefAlways char(1) NULL, ColumnWrap char(1) NULL, GridGrpCd char(1) NULL, ColumnJustify char(1) NULL, AggregateCd char(1) NULL, GenerateSp char(1) NULL, RequiredValid char(1) NULL, RefreshOnCUD char(1) NULL, TrimOnEntry char(1) NULL, MatchCd char(1) NULL, IgnoreConfirm char(1) NULL, LabelCss varchar(1000) NULL, ContentCss varchar(1000) NULL, ColumnName varchar(20) NULL, ColumnDesc varchar(200) NULL, MaskValid varchar(100) NULL, RangeValidType varchar(50) NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, ColumnLink varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObj (DisplayModeId, ColumnSize, ColumnHeight, TabIndex, SortOrder, ScreenObjId, ScreenId, ScreenGrpId, ColumnId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, TabFolderId, DefaultValue, HyperLinkUrl, SystemValue, MasterTable, LabelVertical, DefAfter, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, AggregateCd, GenerateSp, RequiredValid, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm, LabelCss, ContentCss, ColumnName, ColumnDesc, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink) SELECT convert(tinyint,DisplayModeId), convert(smallint,ColumnSize), convert(smallint,ColumnHeight), convert(smallint,TabIndex), convert(smallint,SortOrder), convert(int,ScreenObjId), convert(int,ScreenId), convert(int,ScreenGrpId), convert(int,ColumnId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), convert(int,DdlAdnColumnId), convert(int,DdlFtrColumnId), convert(int,TabFolderId), DefaultValue, HyperLinkUrl, SystemValue, MasterTable, LabelVertical, DefAfter, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, AggregateCd, GenerateSp, RequiredValid, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm, LabelCss, ContentCss, ColumnName, ColumnDesc, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObj'')) CREATE TABLE dbo.ScreenObj (ScreenObjId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, GroupColId SmallInt NOT NULL, LabelVertical Char(1) NOT NULL, LabelCss VarChar(1000) NULL, ContentCss VarChar(1000) NULL, ColumnId Int NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(200) NULL, DefaultValue NVarChar(200) NULL, HyperLinkUrl NVarChar(200) NULL, DefAfter Char(1) NOT NULL, SystemValue NVarChar(200) NULL, DefAlways Char(1) NOT NULL, ColumnWrap Char(1) NOT NULL, GridGrpCd Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, ColumnHeight SmallInt NULL, DisplayModeId TinyInt NOT NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlAdnColumnId Int NULL, DdlFtrColumnId Int NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId Int NULL, TabIndex SmallInt NOT NULL, SortOrder SmallInt NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(100) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(1000) NULL, RefreshOnCUD Char(1) NOT NULL, TrimOnEntry Char(1) NOT NULL, MatchCd Char(1) NULL, IgnoreConfirm Char(1) NOT NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))') EXEC (' ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_LabelVertical DEFAULT (''N'') FOR LabelVertical ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAfter DEFAULT (''N'') FOR DefAfter ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAlways DEFAULT (''N'') FOR DefAlways ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_GridGrpCd DEFAULT (''N'') FOR GridGrpCd ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_TrimOnEntry DEFAULT (''Y'') FOR TrimOnEntry ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_IgnoreConfirm DEFAULT (''Y'') FOR IgnoreConfirm SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, GroupColId, LabelVertical, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, HyperLinkUrl, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm) SELECT ScreenObjId, ScreenId, MasterTable, ScreenGrpId, LabelVertical, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, HyperLinkUrl, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4620&typ=N&sys=3","","",""); return false;
4621~@~   8.  48.40613:D:   70:*:*:M: Remove obsolete procedures~@~5352~@~70~@~D~@~~@~~@~M~@~~@~Remove obsolete procedures~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.GetDdlScreenGrpId303C46'')) DROP PROCEDURE dbo.GetDdlScreenGrpId303C46')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.GetDdlScreenGrpId3S1204'')) DROP PROCEDURE dbo.GetDdlScreenGrpId3S1204')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.GetDdlScreenGrpTypeCd3S1205'')) DROP PROCEDURE dbo.GetDdlScreenGrpTypeCd3S1205')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.GetObjScreenGrp'')) DROP PROCEDURE dbo.GetObjScreenGrp')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4621&typ=N&sys=3","","",""); return false;
4622~@~   8.  48.40613:D:   80:*:*:M: Change table UsrPref~@~5352~@~80~@~D~@~~@~~@~M~@~~@~Change table UsrPref~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_UsrPref (SystemId tinyint NULL, UsrGroupId smallint NULL, UsrPrefId int NULL, UsrId int NULL, CompanyId int NULL, MemberId int NULL, AgentId int NULL, BrokerId int NULL, CustomerId int NULL, InvestorId int NULL, VendorId int NULL, ProjectId int NULL, MenuOptId int NULL, SampleImage varbinary(max) NULL, UsrPrefDesc nvarchar(50) NULL, PrefDefault char(1) NULL, SysListVisible char(1) NULL, ComListVisible char(1) NULL, PrjListVisible char(1) NULL, UsrStyleSheet varchar(max) NULL, SplashImg varchar(100) NULL, MasterPgFile varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_UsrPref (SystemId, UsrGroupId, UsrPrefId, UsrId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, MenuOptId, SampleImage, UsrPrefDesc, PrefDefault, SysListVisible, ComListVisible, PrjListVisible, UsrStyleSheet, SplashImg, MasterPgFile) SELECT convert(tinyint,SystemId), convert(smallint,UsrGroupId), convert(int,UsrPrefId), convert(int,UsrId), convert(int,CompanyId), convert(int,MemberId), convert(int,AgentId), convert(int,BrokerId), convert(int,CustomerId), convert(int,InvestorId), convert(int,VendorId), convert(int,ProjectId), convert(int,MenuOptId), SampleImage, UsrPrefDesc, PrefDefault, SysListVisible, ComListVisible, PrjListVisible, UsrStyleSheet, SplashImg, MasterPgFile FROM dbo.UsrPref IF (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.UsrPref) = 0 DROP TABLE dbo.UsrPref') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrPref'')) CREATE TABLE dbo.UsrPref (UsrPrefId Int IDENTITY NOT NULL, UsrId Int NULL, UsrGroupId SmallInt NULL, CompanyId Int NULL, MemberId Int NULL, AgentId Int NULL, BrokerId Int NULL, CustomerId Int NULL, InvestorId Int NULL, VendorId Int NULL, ProjectId Int NULL, SystemId TinyInt NULL, PrefDefault Char(1) NOT NULL, UsrPrefDesc NVarChar(50) NOT NULL, SysListVisible Char(1) NOT NULL, ComListVisible Char(1) NOT NULL, PrjListVisible Char(1) NOT NULL, MenuOptId Int NOT NULL, UsrStyleSheet VarChar(max) NULL, MasterPgFile VarChar(100) NULL, SampleImage VarBinary(max) NULL, CONSTRAINT PK_UsrPref PRIMARY KEY CLUSTERED (UsrPrefId))') EXEC (' ALTER TABLE dbo.UsrPref ADD CONSTRAINT DF_UsrPref_PrjListVisible DEFAULT (''N'') FOR PrjListVisible SET IDENTITY_INSERT dbo.UsrPref ON INSERT INTO dbo.UsrPref (UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOptId, UsrStyleSheet, MasterPgFile, SampleImage) SELECT UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOptId, UsrStyleSheet, MasterPgFile, SampleImage FROM dbo.Tmp_UsrPref SET IDENTITY_INSERT dbo.UsrPref OFF IF (SELECT COUNT(1) FROM dbo.UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) = 0 DROP TABLE dbo.Tmp_UsrPref')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4622&typ=N&sys=3","","",""); return false;
4623~@~   8.  49.40618:D:   10:*:*:M: Remove obsolete functions, tables, procedures~@~5353~@~10~@~D~@~~@~~@~M~@~~@~Remove obsolete functions, tables, procedures~@~N~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.fEvalExpr'')) DROP FUNCTION dbo.fEvalExpr')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.GetUsrLink'')) DROP PROCEDURE dbo.GetUsrLink')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrLink'')) DROP TABLE dbo.UsrLink')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4623&typ=N&sys=3","","",""); return false;
4624~@~   8.  49.40618:D:   40:*:*:M: Change table PageLnk~@~5353~@~40~@~D~@~~@~~@~M~@~~@~Change table PageLnk~@~N~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.PageLnk'')) CREATE TABLE dbo.PageLnk (PageLnkId Int IDENTITY NOT NULL, PageObjId SmallInt NOT NULL, PageLnkCss VarChar(1000) NULL, Popup Char(1) NULL, PageLnkRef VarChar(200) NULL, PageLnkTxt NVarChar(4000) NULL, PageLnkImg VarChar(200) NULL, PageLnkAlt VarChar(200) NULL, PageLnkOrd SmallInt NOT NULL, CONSTRAINT PK_PageLnk PRIMARY KEY CLUSTERED (PageLnkId))') EXEC ('') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4624&typ=N&sys=3","","",""); return false;
4625~@~   8.  49.40618:D:   20:*:*:M: Change table PageObj~@~5353~@~20~@~D~@~~@~~@~M~@~~@~Change table PageObj~@~N~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.PageObj'')) CREATE TABLE dbo.PageObj (PageObjId Int IDENTITY NOT NULL, PageObjDesc NVarChar(200) NULL, SectionCd Char(1) NOT NULL, GroupRowId SmallInt NULL, GroupColId SmallInt NULL, PageObjCss VarChar(500) NULL, PageObjOrd SmallInt NOT NULL, LinkTypeCd Char(3) NOT NULL, LinkJustify Char(1) NOT NULL, LinkVertical Char(1) NULL, CONSTRAINT PK_PageObj PRIMARY KEY CLUSTERED (PageObjId))') EXEC ('') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4625&typ=N&sys=3","","",""); return false;
4626~@~   8.  49.40618:D:   30:*:*:M: Change table PageObjPref~@~5353~@~30~@~D~@~~@~~@~M~@~~@~Change table PageObjPref~@~N~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.PageObjPref'')) CREATE TABLE dbo.PageObjPref (PageObjPrefId Int IDENTITY NOT NULL, PageObjId Int NOT NULL, GrantDeny Char(1) NOT NULL, UsrPrefId Int NOT NULL, CONSTRAINT PK_PageObjPref PRIMARY KEY CLUSTERED (PageObjPrefId))') EXEC ('') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4626&typ=N&sys=3","","",""); return false;
4627~@~   8.  51.40627:D:   10:*:*:M: Change table GroupRow~@~5355~@~10~@~D~@~~@~~@~M~@~~@~Change table GroupRow~@~N~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.GroupRow'')) DROP TABLE dbo.GroupRow')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.GroupRow'')) BEGIN CREATE TABLE dbo.GroupRow (GroupRowId SmallInt IDENTITY NOT NULL, RowCssClass VarChar(20) NOT NULL, GroupRowName NVarChar(50) NOT NULL, CONSTRAINT PK_GroupRow PRIMARY KEY CLUSTERED (GroupRowId)) INSERT dbo.GroupRow (RowCssClass,GroupRowName) SELECT ColCssClass,GroupColName FROM dbo.GroupCol UPDATE dbo.GroupRow SET RowCssClass = REPLACE(RowCssClass,''c-'',''g-'') END')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4627&typ=N&sys=3","","",""); return false;
4628~@~   8.  51.40627:D:   20:*:*:M: Change table ScreenObj~@~5355~@~20~@~D~@~~@~~@~M~@~~@~Change table ScreenObj~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenObj (DisplayModeId tinyint NULL, GroupColId smallint NULL, ColumnSize smallint NULL, ColumnHeight smallint NULL, TabIndex smallint NULL, SortOrder smallint NULL, ScreenObjId int NULL, ScreenId int NULL, ColumnId int NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DdlAdnColumnId int NULL, DdlFtrColumnId int NULL, TabFolderId int NULL, DefaultValue nvarchar(200) NULL, HyperLinkUrl nvarchar(200) NULL, SystemValue nvarchar(200) NULL, MasterTable char(1) NULL, LabelVertical char(1) NULL, DefAfter char(1) NULL, DefAlways char(1) NULL, ColumnWrap char(1) NULL, GridGrpCd char(1) NULL, ColumnJustify char(1) NULL, AggregateCd char(1) NULL, GenerateSp char(1) NULL, RequiredValid char(1) NULL, RefreshOnCUD char(1) NULL, TrimOnEntry char(1) NULL, MatchCd char(1) NULL, IgnoreConfirm char(1) NULL, LabelCss varchar(1000) NULL, ContentCss varchar(1000) NULL, ColumnName varchar(20) NULL, ColumnDesc varchar(200) NULL, MaskValid varchar(100) NULL, RangeValidType varchar(50) NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, ColumnLink varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObj (DisplayModeId, GroupColId, ColumnSize, ColumnHeight, TabIndex, SortOrder, ScreenObjId, ScreenId, ColumnId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, TabFolderId, DefaultValue, HyperLinkUrl, SystemValue, MasterTable, LabelVertical, DefAfter, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, AggregateCd, GenerateSp, RequiredValid, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm, LabelCss, ContentCss, ColumnName, ColumnDesc, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink) SELECT convert(tinyint,DisplayModeId), convert(smallint,GroupColId), convert(smallint,ColumnSize), convert(smallint,ColumnHeight), convert(smallint,TabIndex), convert(smallint,SortOrder), convert(int,ScreenObjId), convert(int,ScreenId), convert(int,ColumnId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), convert(int,DdlAdnColumnId), convert(int,DdlFtrColumnId), convert(int,TabFolderId), DefaultValue, HyperLinkUrl, SystemValue, MasterTable, LabelVertical, DefAfter, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, AggregateCd, GenerateSp, RequiredValid, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm, LabelCss, ContentCss, ColumnName, ColumnDesc, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObj'')) CREATE TABLE dbo.ScreenObj (ScreenObjId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, GroupRowId SmallInt NOT NULL, GroupColId SmallInt NOT NULL, LabelVertical Char(1) NOT NULL, LabelCss VarChar(1000) NULL, ContentCss VarChar(1000) NULL, ColumnId Int NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(200) NULL, DefaultValue NVarChar(200) NULL, HyperLinkUrl NVarChar(200) NULL, DefAfter Char(1) NOT NULL, SystemValue NVarChar(200) NULL, DefAlways Char(1) NOT NULL, ColumnWrap Char(1) NOT NULL, GridGrpCd Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, ColumnHeight SmallInt NULL, DisplayModeId TinyInt NOT NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlAdnColumnId Int NULL, DdlFtrColumnId Int NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId Int NULL, TabIndex SmallInt NOT NULL, SortOrder SmallInt NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(100) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(1000) NULL, RefreshOnCUD Char(1) NOT NULL, TrimOnEntry Char(1) NOT NULL, MatchCd Char(1) NULL, IgnoreConfirm Char(1) NOT NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))') EXEC (' ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_GroupRowId DEFAULT (78) FOR GroupRowId ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_LabelVertical DEFAULT (''N'') FOR LabelVertical ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAfter DEFAULT (''N'') FOR DefAfter ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAlways DEFAULT (''N'') FOR DefAlways ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_GridGrpCd DEFAULT (''N'') FOR GridGrpCd ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_TrimOnEntry DEFAULT (''Y'') FOR TrimOnEntry ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_IgnoreConfirm DEFAULT (''Y'') FOR IgnoreConfirm SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, GroupRowId, GroupColId, LabelVertical, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, HyperLinkUrl, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm) SELECT ScreenObjId, ScreenId, MasterTable, 78, GroupColId, LabelVertical, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, HyperLinkUrl, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4628&typ=N&sys=3","","",""); return false;
4629~@~   8.  51.40627:D:   30:*:*:M: Change table PageObj~@~5355~@~30~@~D~@~~@~~@~M~@~~@~Change table PageObj~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_PageObj (GroupRowId smallint NULL, GroupColId smallint NULL, PageObjOrd smallint NULL, PageObjId int NULL, PageObjDesc nvarchar(200) NULL, SectionCd char(1) NULL, LinkTypeCd char(3) NULL, LinkJustify char(1) NULL, LinkVertical char(1) NULL, PageObjCss varchar(500) NULL)') EXEC (' INSERT INTO dbo.Tmp_PageObj (GroupRowId, GroupColId, PageObjOrd, PageObjId, PageObjDesc, SectionCd, LinkTypeCd, LinkJustify, LinkVertical, PageObjCss) SELECT convert(smallint,GroupRowId), convert(smallint,GroupColId), convert(smallint,PageObjOrd), convert(int,PageObjId), PageObjDesc, SectionCd, LinkTypeCd, LinkJustify, LinkVertical, PageObjCss FROM dbo.PageObj IF (SELECT COUNT(1) FROM dbo.Tmp_PageObj) > 0 OR (SELECT COUNT(1) FROM dbo.PageObj) = 0 DROP TABLE dbo.PageObj') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.PageObj'')) CREATE TABLE dbo.PageObj (PageObjId Int IDENTITY NOT NULL, PageObjDesc NVarChar(200) NULL, SectionCd Char(1) NOT NULL, GroupRowId SmallInt NULL, GroupColId SmallInt NULL, GroupRowCss VarChar(500) NULL, GroupColCss VarChar(500) NULL, PageObjOrd SmallInt NOT NULL, LinkTypeCd Char(3) NOT NULL, CONSTRAINT PK_PageObj PRIMARY KEY CLUSTERED (PageObjId))') EXEC (' SET IDENTITY_INSERT dbo.PageObj ON INSERT INTO dbo.PageObj (PageObjId, PageObjDesc, SectionCd, GroupRowId, GroupColId, GroupColCss, PageObjOrd, LinkTypeCd) SELECT PageObjId, PageObjDesc, SectionCd, GroupRowId, GroupColId, PageObjCss, PageObjOrd, LinkTypeCd FROM dbo.Tmp_PageObj SET IDENTITY_INSERT dbo.PageObj OFF IF (SELECT COUNT(1) FROM dbo.PageObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_PageObj) = 0 DROP TABLE dbo.Tmp_PageObj')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4629&typ=N&sys=3","","",""); return false;
4630~@~   8.  54.40725:D:   10:*:*:M: Change table MemTrans~@~5358~@~10~@~D~@~~@~~@~M~@~~@~Change table MemTrans~@~Y~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.MemTrans'')) CREATE TABLE dbo.MemTrans (MemTransId Int IDENTITY NOT NULL, InStr NVarChar(2000) NOT NULL, CultureTypeId SmallInt NOT NULL, OutStr NVarChar(2000) NOT NULL, CONSTRAINT PK_MemTrans PRIMARY KEY CLUSTERED (MemTransId))') EXEC ('') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4630&typ=N&sys=3","","",""); return false;
4631~@~   8.  54.40725:D:   20:*:*:M: Change table MemTrans~@~5358~@~20~@~D~@~~@~~@~M~@~~@~Change table MemTrans~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_MemTrans (CultureTypeId smallint NULL, MemTransId int NULL, InStr nvarchar(2000) NULL, OutStr nvarchar(2000) NULL)') EXEC (' INSERT INTO dbo.Tmp_MemTrans (CultureTypeId, MemTransId, InStr, OutStr) SELECT convert(smallint,CultureTypeId), convert(int,MemTransId), InStr, OutStr FROM dbo.MemTrans IF (SELECT COUNT(1) FROM dbo.Tmp_MemTrans) > 0 OR (SELECT COUNT(1) FROM dbo.MemTrans) = 0 DROP TABLE dbo.MemTrans') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.MemTrans'')) CREATE TABLE dbo.MemTrans (MemTransId Int IDENTITY NOT NULL, InStr NVarChar(2000) NOT NULL, CultureTypeId SmallInt NOT NULL, OutStr NVarChar(2000) NOT NULL, CONSTRAINT PK_MemTrans PRIMARY KEY CLUSTERED (MemTransId))') EXEC (' SET IDENTITY_INSERT dbo.MemTrans ON INSERT INTO dbo.MemTrans (MemTransId, InStr, CultureTypeId, OutStr) SELECT MemTransId, InStr, CultureTypeId, OutStr FROM dbo.Tmp_MemTrans SET IDENTITY_INSERT dbo.MemTrans OFF IF (SELECT COUNT(1) FROM dbo.MemTrans) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_MemTrans) = 0 DROP TABLE dbo.Tmp_MemTrans IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IU_MemTrans'') CREATE UNIQUE NONCLUSTERED INDEX IU_MemTrans ON dbo.MemTrans(InStr,CultureTypeId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4631&typ=N&sys=3","","",""); return false;
4632~@~   8.  54.40725:D:   30:*:*:M: Change table DbColumn~@~5358~@~30~@~D~@~~@~~@~M~@~~@~Change table DbColumn~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_DbColumn_DbTable'') ALTER TABLE dbo.DbColumn DROP CONSTRAINT FK_DbColumn_DbTable CREATE TABLE dbo.Tmp_DbColumn (DataType tinyint NULL, ColumnScale tinyint NULL, ColumnIndex smallint NULL, ColumnLength smallint NULL, ColumnId int NULL, TableId int NULL, DefaultValue nvarchar(50) NULL, ColObjective nvarchar(200) NULL, AllowNulls char(1) NULL, ColumnIdentity char(1) NULL, PrimaryKey char(1) NULL, IsIndexU char(1) NULL, IsIndex char(1) NULL, ExternalTable varchar(50) NULL, ColumnName varchar(50) NULL, ColumnDesc varchar(100) NULL, PrevColName varchar(20) NULL)') EXEC (' INSERT INTO dbo.Tmp_DbColumn (DataType, ColumnScale, ColumnIndex, ColumnLength, ColumnId, TableId, DefaultValue, ColObjective, AllowNulls, ColumnIdentity, PrimaryKey, IsIndexU, IsIndex, ExternalTable, ColumnName, ColumnDesc, PrevColName) SELECT convert(tinyint,DataType), convert(tinyint,ColumnScale), convert(smallint,ColumnIndex), convert(smallint,ColumnLength), convert(int,ColumnId), convert(int,TableId), DefaultValue, ColObjective, AllowNulls, ColumnIdentity, PrimaryKey, IsIndexU, IsIndex, ExternalTable, ColumnName, ColumnDesc, PrevColName FROM dbo.DbColumn IF (SELECT COUNT(1) FROM dbo.Tmp_DbColumn) > 0 OR (SELECT COUNT(1) FROM dbo.DbColumn) = 0 DROP TABLE dbo.DbColumn') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.DbColumn'')) CREATE TABLE dbo.DbColumn (ColumnId Int IDENTITY NOT NULL, TableId Int NOT NULL, ColumnIndex SmallInt NULL, ExternalTable VarChar(50) NULL, ColumnName VarChar(50) NOT NULL, ColumnDesc VarChar(100) NULL, DataType TinyInt NOT NULL, ColumnLength SmallInt NOT NULL, ColumnScale TinyInt NULL, DefaultValue NVarChar(50) NULL, AllowNulls Char(1) NOT NULL, ColumnIdentity Char(1) NOT NULL, PrimaryKey Char(1) NOT NULL, IsIndexU Char(1) NOT NULL, IsIndex Char(1) NOT NULL, ColObjective NVarChar(200) NULL, PrevColName VarChar(20) NULL, CONSTRAINT PK_DbColumn PRIMARY KEY CLUSTERED (ColumnId))') EXEC (' ALTER TABLE dbo.DbColumn ADD CONSTRAINT DF_DbColumn_IsIndexU DEFAULT (''N'') FOR IsIndexU ALTER TABLE dbo.DbColumn ADD CONSTRAINT DF_DbColumn_IsIndex DEFAULT (''N'') FOR IsIndex SET IDENTITY_INSERT dbo.DbColumn ON INSERT INTO dbo.DbColumn (ColumnId, TableId, ColumnIndex, ExternalTable, ColumnName, ColumnDesc, DataType, ColumnLength, ColumnScale, DefaultValue, AllowNulls, ColumnIdentity, PrimaryKey, IsIndexU, IsIndex, ColObjective, PrevColName) SELECT ColumnId, TableId, ColumnIndex, ExternalTable, ColumnName, ColumnDesc, DataType, ColumnLength, ColumnScale, DefaultValue, AllowNulls, ColumnIdentity, PrimaryKey, IsIndexU, IsIndex, ColObjective, PrevColName FROM dbo.Tmp_DbColumn SET IDENTITY_INSERT dbo.DbColumn OFF IF (SELECT COUNT(1) FROM dbo.DbColumn) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_DbColumn) = 0 DROP TABLE dbo.Tmp_DbColumn ALTER TABLE dbo.DbColumn WITH NOCHECK ADD CONSTRAINT FK_DbColumn_DbTable FOREIGN KEY (TableId) REFERENCES dbo.DbTable (TableId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4632&typ=N&sys=3","","",""); return false;
4633~@~   8.  54.40725:D:   40:*:*:M: Change table ReportObj~@~5358~@~40~@~D~@~~@~~@~M~@~~@~Change table ReportObj~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_ReportObj (PaddSize tinyint NULL, DataTypeId tinyint NULL, OperatorId tinyint NULL, TabIndex smallint NULL, ReportObjId int NULL, ReportId int NULL, ReportCriId int NULL, PaddChar nchar(1) NULL, RptObjTypeCd char(1) NULL, ColumnName varchar(50) NULL, ColumnDesc varchar(100) NULL, ColumnFormat varchar(20) NULL)') EXEC (' INSERT INTO dbo.Tmp_ReportObj (PaddSize, DataTypeId, OperatorId, TabIndex, ReportObjId, ReportId, ReportCriId, PaddChar, RptObjTypeCd, ColumnName, ColumnDesc, ColumnFormat) SELECT convert(tinyint,PaddSize), convert(tinyint,DataTypeId), convert(tinyint,OperatorId), convert(smallint,TabIndex), convert(int,ReportObjId), convert(int,ReportId), convert(int,ReportCriId), PaddChar, RptObjTypeCd, ColumnName, ColumnDesc, ColumnFormat FROM dbo.ReportObj IF (SELECT COUNT(1) FROM dbo.Tmp_ReportObj) > 0 OR (SELECT COUNT(1) FROM dbo.ReportObj) = 0 DROP TABLE dbo.ReportObj') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ReportObj'')) CREATE TABLE dbo.ReportObj (ReportObjId Int IDENTITY NOT NULL, ReportId Int NOT NULL, RptObjTypeCd Char(1) NOT NULL, ColumnName VarChar(50) NOT NULL, ColumnDesc VarChar(100) NULL, TabIndex SmallInt NOT NULL, ColumnFormat VarChar(20) NULL, PaddSize TinyInt NULL, PaddChar NChar(1) NULL, DataTypeId TinyInt NOT NULL, OperatorId TinyInt NULL, ReportCriId Int NULL, CONSTRAINT PK_ReportObj PRIMARY KEY CLUSTERED (ReportObjId))') EXEC (' ALTER TABLE dbo.ReportObj ADD CONSTRAINT DF_ReportObj_RptObjTypeCd DEFAULT (''F'') FOR RptObjTypeCd SET IDENTITY_INSERT dbo.ReportObj ON INSERT INTO dbo.ReportObj (ReportObjId, ReportId, RptObjTypeCd, ColumnName, ColumnDesc, TabIndex, ColumnFormat, PaddSize, PaddChar, DataTypeId, OperatorId, ReportCriId) SELECT ReportObjId, ReportId, RptObjTypeCd, ColumnName, ColumnDesc, TabIndex, ColumnFormat, PaddSize, PaddChar, DataTypeId, OperatorId, ReportCriId FROM dbo.Tmp_ReportObj SET IDENTITY_INSERT dbo.ReportObj OFF IF (SELECT COUNT(1) FROM dbo.ReportObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ReportObj) = 0 DROP TABLE dbo.Tmp_ReportObj')

EXEC ('IF  EXISTS (SELECT 1 FROM sys.foreign_keys WHERE object_id = OBJECT_ID(''[dbo].[FK_DbColumn_DbTable]'') AND parent_object_id = OBJECT_ID(''[dbo].[DbColumn]'')) ALTER TABLE [dbo].[DbColumn] DROP CONSTRAINT [FK_DbColumn_DbTable]')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4633&typ=N&sys=3","","",""); return false;
4637~@~   8.  54.40725:D:   80:*:*:M: Change table SctGrpRow~@~5358~@~80~@~D~@~~@~~@~M~@~~@~Change table SctGrpRow~@~N~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.SctGrpRow'')) CREATE TABLE dbo.SctGrpRow (SctGrpRowId SmallInt IDENTITY NOT NULL, SectionCd Char(1) NOT NULL, GroupRowId SmallInt NOT NULL, SctGrpRowCss VarChar(1000) NULL, CONSTRAINT PK_SctGrpRow PRIMARY KEY CLUSTERED (SctGrpRowId))') EXEC ('') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IU_SctGrpRow'') CREATE UNIQUE NONCLUSTERED INDEX IU_SctGrpRow ON dbo.SctGrpRow(SectionCd,GroupRowId)') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4637&typ=N&sys=3","","",""); return false;
4638~@~   8.  54.40725:D:   90:*:*:M: Change table SctGrpCol~@~5358~@~90~@~D~@~~@~~@~M~@~~@~Change table SctGrpCol~@~N~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.SctGrpCol'')) CREATE TABLE dbo.SctGrpCol (SctGrpColId SmallInt IDENTITY NOT NULL, SectionCd Char(1) NOT NULL, GroupColId SmallInt NOT NULL, SctGrpColCss VarChar(1000) NULL, SctGrpColDiv VarChar(1000) NULL, CONSTRAINT PK_SctGrpCol PRIMARY KEY CLUSTERED (SctGrpColId))') EXEC ('') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IU_SctGrpCol'') CREATE UNIQUE NONCLUSTERED INDEX IU_SctGrpCol ON dbo.SctGrpCol(SectionCd,GroupColId)') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4638&typ=N&sys=3","","",""); return false;
4639~@~   8.  54.40725:D:  100:*:*:M: Change table PageObj~@~5358~@~100~@~D~@~~@~~@~M~@~~@~Change table PageObj~@~N~@~EXEC ('CREATE TABLE dbo.Tmp_PageObj (GroupRowId smallint NULL, GroupColId smallint NULL, PageObjOrd smallint NULL, PageObjId int NULL, PageObjDesc nvarchar(200) NULL, SectionCd char(1) NULL, LinkTypeCd char(3) NULL)')
EXEC ('INSERT INTO dbo.Tmp_PageObj (GroupRowId, GroupColId, PageObjOrd, PageObjId, PageObjDesc, SectionCd, LinkTypeCd) SELECT convert(smallint,GroupRowId), convert(smallint,GroupColId), convert(smallint,PageObjOrd), convert(int,PageObjId), PageObjDesc, SectionCd, LinkTypeCd FROM dbo.PageObj IF (SELECT COUNT(1) FROM dbo.Tmp_PageObj) > 0 OR (SELECT COUNT(1) FROM dbo.PageObj) = 0 DROP TABLE dbo.PageObj')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.PageObj'')) CREATE TABLE dbo.PageObj (PageObjId Int IDENTITY NOT NULL, PageObjDesc NVarChar(200) NULL, SectionCd Char(1) NOT NULL, GroupRowId SmallInt NULL, GroupColId SmallInt NULL, PageObjCss VarChar(1000) NULL, PageObjSrp VarChar(1000) NULL, PageObjOrd SmallInt NOT NULL, LinkTypeCd Char(3) NOT NULL, SctGrpRow varchar(200) NULL, SctGrpCol varchar(200) NULL, CONSTRAINT PK_PageObj PRIMARY KEY CLUSTERED (PageObjId))')
EXEC ('SET IDENTITY_INSERT dbo.PageObj ON INSERT INTO dbo.PageObj (PageObjId, PageObjDesc, SectionCd, GroupRowId, GroupColId, PageObjOrd, LinkTypeCd) SELECT PageObjId, PageObjDesc, SectionCd, GroupRowId, GroupColId, PageObjOrd, LinkTypeCd FROM dbo.Tmp_PageObj SET IDENTITY_INSERT dbo.PageObj OFF IF (SELECT COUNT(1) FROM dbo.PageObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_PageObj) = 0 DROP TABLE dbo.Tmp_PageObj')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4639&typ=N&sys=3","","",""); return false;
4640~@~   8.  54.40725:D:   70:*:*:M: Modify tables GroupCol and GroupRow~@~5358~@~70~@~D~@~~@~~@~M~@~~@~Modify tables GroupCol and GroupRow~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.GroupCol WHERE CHARINDEX('r',ColCssClass) > 0) EXEC ('UPDATE dbo.GroupCol SET ColCssClass = REPLACE(ColCssClass,''c-'',''rc-'')')
IF NOT EXISTS (SELECT 1 FROM dbo.GroupRow WHERE CHARINDEX('r',RowCssClass) > 0) EXEC ('UPDATE dbo.GroupRow SET RowCssClass = REPLACE(RowCssClass,''g-'',''rg-'')')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4640&typ=N&sys=3","","",""); return false;
4641~@~   8.  54.40725:D:  110:*:*:M: Change table SctGrpCol~@~5358~@~110~@~D~@~~@~~@~M~@~~@~Change table SctGrpCol~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_SctGrpCol (SctGrpColId smallint NULL, GroupColId smallint NULL, SectionCd char(1) NULL, SctGrpColCss varchar(1000) NULL, SctGrpColDiv varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_SctGrpCol (SctGrpColId, GroupColId, SectionCd, SctGrpColCss, SctGrpColDiv) SELECT convert(smallint,SctGrpColId), convert(smallint,GroupColId), SectionCd, SctGrpColCss, SctGrpColDiv FROM dbo.SctGrpCol IF (SELECT COUNT(1) FROM dbo.Tmp_SctGrpCol) > 0 OR (SELECT COUNT(1) FROM dbo.SctGrpCol) = 0 DROP TABLE dbo.SctGrpCol') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.SctGrpCol'')) CREATE TABLE dbo.SctGrpCol (SctGrpColId SmallInt IDENTITY NOT NULL, SctGrpColDesc NVarChar(200) NULL, SectionCd Char(1) NOT NULL, GroupColId SmallInt NOT NULL, SctGrpColCss VarChar(1000) NULL, SctGrpColDiv VarChar(1000) NULL, CONSTRAINT PK_SctGrpCol PRIMARY KEY CLUSTERED (SctGrpColId))') EXEC (' SET IDENTITY_INSERT dbo.SctGrpCol ON INSERT INTO dbo.SctGrpCol (SctGrpColId, SectionCd, GroupColId, SctGrpColCss, SctGrpColDiv) SELECT SctGrpColId, SectionCd, GroupColId, SctGrpColCss, SctGrpColDiv FROM dbo.Tmp_SctGrpCol SET IDENTITY_INSERT dbo.SctGrpCol OFF IF (SELECT COUNT(1) FROM dbo.SctGrpCol) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_SctGrpCol) = 0 DROP TABLE dbo.Tmp_SctGrpCol IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IU_SctGrpCol'') CREATE UNIQUE NONCLUSTERED INDEX IU_SctGrpCol ON dbo.SctGrpCol(SectionCd,GroupColId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4641&typ=N&sys=3","","",""); return false;
4642~@~   8.  54.40725:D:  120:*:*:M: Change table SctGrpRow~@~5358~@~120~@~D~@~~@~~@~M~@~~@~Change table SctGrpRow~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_SctGrpRow (SctGrpRowId smallint NULL, GroupRowId smallint NULL, SectionCd char(1) NULL, SctGrpRowCss varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_SctGrpRow (SctGrpRowId, GroupRowId, SectionCd, SctGrpRowCss) SELECT convert(smallint,SctGrpRowId), convert(smallint,GroupRowId), SectionCd, SctGrpRowCss FROM dbo.SctGrpRow IF (SELECT COUNT(1) FROM dbo.Tmp_SctGrpRow) > 0 OR (SELECT COUNT(1) FROM dbo.SctGrpRow) = 0 DROP TABLE dbo.SctGrpRow') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.SctGrpRow'')) CREATE TABLE dbo.SctGrpRow (SctGrpRowId SmallInt IDENTITY NOT NULL, SctGrpRowDesc NVarChar(200) NULL, SectionCd Char(1) NOT NULL, GroupRowId SmallInt NOT NULL, SctGrpRowCss VarChar(1000) NULL, CONSTRAINT PK_SctGrpRow PRIMARY KEY CLUSTERED (SctGrpRowId))') EXEC (' SET IDENTITY_INSERT dbo.SctGrpRow ON INSERT INTO dbo.SctGrpRow (SctGrpRowId, SectionCd, GroupRowId, SctGrpRowCss) SELECT SctGrpRowId, SectionCd, GroupRowId, SctGrpRowCss FROM dbo.Tmp_SctGrpRow SET IDENTITY_INSERT dbo.SctGrpRow OFF IF (SELECT COUNT(1) FROM dbo.SctGrpRow) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_SctGrpRow) = 0 DROP TABLE dbo.Tmp_SctGrpRow IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IU_SctGrpRow'') CREATE UNIQUE NONCLUSTERED INDEX IU_SctGrpRow ON dbo.SctGrpRow(SectionCd,GroupRowId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4642&typ=N&sys=3","","",""); return false;
4645~@~   8.  55.40810:D:   10:*:*:M: Change table UsrPref~@~5359~@~10~@~D~@~~@~~@~M~@~~@~Change table UsrPref~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_UsrPref (SystemId tinyint NULL, UsrGroupId smallint NULL, UsrPrefId int NULL, UsrId int NULL, CompanyId int NULL, MemberId int NULL, AgentId int NULL, BrokerId int NULL, CustomerId int NULL, InvestorId int NULL, VendorId int NULL, ProjectId int NULL, MenuOptId int NULL, SampleImage varbinary(max) NULL, UsrPrefDesc nvarchar(50) NULL, PrefDefault char(1) NULL, SysListVisible char(1) NULL, ComListVisible char(1) NULL, PrjListVisible char(1) NULL, UsrStyleSheet varchar(max) NULL, MasterPgFile varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_UsrPref (SystemId, UsrGroupId, UsrPrefId, UsrId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, MenuOptId, SampleImage, UsrPrefDesc, PrefDefault, SysListVisible, ComListVisible, PrjListVisible, UsrStyleSheet, MasterPgFile) SELECT convert(tinyint,SystemId), convert(smallint,UsrGroupId), convert(int,UsrPrefId), convert(int,UsrId), convert(int,CompanyId), convert(int,MemberId), convert(int,AgentId), convert(int,BrokerId), convert(int,CustomerId), convert(int,InvestorId), convert(int,VendorId), convert(int,ProjectId), convert(int,MenuOptId), SampleImage, UsrPrefDesc, PrefDefault, SysListVisible, ComListVisible, PrjListVisible, UsrStyleSheet, MasterPgFile FROM dbo.UsrPref IF (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.UsrPref) = 0 DROP TABLE dbo.UsrPref') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrPref'')) CREATE TABLE dbo.UsrPref (UsrPrefId Int IDENTITY NOT NULL, UsrId Int NULL, UsrGroupId SmallInt NULL, CompanyId Int NULL, MemberId Int NULL, AgentId Int NULL, BrokerId Int NULL, CustomerId Int NULL, InvestorId Int NULL, VendorId Int NULL, ProjectId Int NULL, SystemId TinyInt NULL, PrefDefault Char(1) NOT NULL, UsrPrefDesc NVarChar(50) NOT NULL, SysListVisible Char(1) NOT NULL, ComListVisible Char(1) NOT NULL, PrjListVisible Char(1) NOT NULL, MenuOptId Int NOT NULL, UsrStyleSheet VarChar(max) NULL, MasterPgFile VarChar(100) NULL, LoginImage VarChar(200) NULL, MobileImage VarChar(200) NULL, SampleImage VarBinary(max) NULL, CONSTRAINT PK_UsrPref PRIMARY KEY CLUSTERED (UsrPrefId))') EXEC (' ALTER TABLE dbo.UsrPref ADD CONSTRAINT DF_UsrPref_PrjListVisible DEFAULT (''N'') FOR PrjListVisible SET IDENTITY_INSERT dbo.UsrPref ON INSERT INTO dbo.UsrPref (UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOptId, UsrStyleSheet, MasterPgFile, SampleImage) SELECT UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOptId, UsrStyleSheet, MasterPgFile, SampleImage FROM dbo.Tmp_UsrPref SET IDENTITY_INSERT dbo.UsrPref OFF IF (SELECT COUNT(1) FROM dbo.UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) = 0 DROP TABLE dbo.Tmp_UsrPref')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4645&typ=N&sys=3","","",""); return false;
4646~@~   8.  55.40810:D:   20:*:*:M: Change table CtSection~@~5359~@~20~@~D~@~~@~~@~M~@~~@~Change table CtSection~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_CtSection (SectionName nvarchar(200) NULL, SectionCd char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_CtSection (SectionName, SectionCd) SELECT SectionName, SectionCd FROM dbo.CtSection IF (SELECT COUNT(1) FROM dbo.Tmp_CtSection) > 0 OR (SELECT COUNT(1) FROM dbo.CtSection) = 0 DROP TABLE dbo.CtSection') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtSection'')) CREATE TABLE dbo.CtSection (SectionCd Char(1) NOT NULL, SectionName NVarChar(200) NOT NULL, NeedRegen Char(1) NOT NULL, CONSTRAINT PK_CtSection PRIMARY KEY CLUSTERED (SectionCd))') EXEC (' ALTER TABLE dbo.CtSection ADD CONSTRAINT DF_CtSection_NeedRegen DEFAULT (''N'') FOR NeedRegen INSERT INTO dbo.CtSection (SectionCd, SectionName, NeedRegen) SELECT SectionCd, SectionName, ''N'' FROM dbo.Tmp_CtSection IF (SELECT COUNT(1) FROM dbo.CtSection) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtSection) = 0 DROP TABLE dbo.Tmp_CtSection')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4646&typ=N&sys=3","","",""); return false;
4647~@~   8.  58.40910:D:   10:*:*:M: Modify content of PageObj, etc.~@~5362~@~10~@~D~@~~@~~@~M~@~~@~Modify content of PageObj, etc.~@~N~@~EXEC ('DELETE FROM dbo.PageObj WHERE SectionCd = ''M''')
EXEC ('UPDATE dbo.PageObj SET SectionCd = ''D'' WHERE SectionCd = ''P''')
EXEC ('UPDATE dbo.SctGrpRow SET SectionCd = ''D'' WHERE SectionCd = ''P''')
EXEC ('UPDATE dbo.SctGrpCol SET SectionCd = ''D'' WHERE SectionCd = ''P''')
EXEC ('UPDATE dbo.ScreenObj SET DefaultValue = SUBSTRING(DefaultValue,2,len(DefaultValue) - 2) WHERE LEFT(DefaultValue,1) = '''''''' and RIGHT(DefaultValue,1) = ''''''''')
EXEC ('UPDATE dbo.ScreenObj SET DefaultValue = SUBSTRING(DefaultValue,2,len(DefaultValue) - 2) WHERE LEFT(DefaultValue,1) = ''"'' and RIGHT(DefaultValue,1) = ''"''')
EXEC ('DECLARE @PageObjId int DECLARE cur CURSOR FAST_FORWARD FOR SELECT PageObjId FROM dbo.PageObj FOR READ ONLY OPEN cur FETCH NEXT FROM cur INTO @PageObjId WHILE @@FETCH_STATUS = 0 BEGIN EXEC Ir_UpdPageObj @PageObjId FETCH NEXT FROM cur INTO @PageObjId END CLOSE cur DEALLOCATE cur')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4647&typ=N&sys=3","","",""); return false;
4648~@~   8.  58.40910:C:   20:*:3:*: MenuModule.*~@~5362~@~20~@~C~@~~@~3~@~~@~~\modules\~@~MenuModule.*~@~N~@~EXEC ('DELETE FROM dbo.PageObj WHERE SectionCd = ''M''')
EXEC ('UPDATE dbo.PageObj SET SectionCd = ''D'' WHERE SectionCd = ''P''')
~@~Y~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4648&typ=N&sys=3","","",""); return false;
4649~@~   8.  67.41204:D:   10:*:*:M: Adjust WebRule for new ListView grid~@~5371~@~10~@~D~@~~@~~@~M~@~~@~Adjust WebRule for new ListView grid~@~Y~@~EXEC ('UPDATE dbo.WebRule SET WebRuleProg = REPLACE(WebRuleProg,''.EditItemIndex'',''.EditIndex'')')
EXEC ('UPDATE dbo.WebRule SET WebRuleProg = CASE WHEN CHARINDEX(''Grid.EditIndex > -1 && c'',WebRuleProg) > 0 AND CHARINDEX(''Grid.EditIndex == e.Item.ItemIndex'',WebRuleProg) > 0 THEN REPLACE(REPLACE(WebRuleProg,''Grid.EditIndex > -1 && c'',''Grid.EditIndex > -1 && GetDataItemIndex(c''),''Grid.EditIndex == e.Item.ItemIndex'',''Grid.EditIndex) == e.Item.DataItemIndex'') ELSE WebRuleProg END')
EXEC ('UPDATE dbo.WebRule SET WebRuleProg = REPLACE(WebRuleProg,''e.Item.DataSetIndex'',''.GetDataItemIndex(e.ItemIndex)'')')
EXEC ('UPDATE dbo.WebRule SET WebRuleProg = REPLACE(WebRuleProg,''DataGridCommandEventArgs'',''ListViewCommandEventArgs'')')
EXEC ('UPDATE dbo.WebRule SET WebRuleProg = REPLACE(WebRuleProg,''DataGridSortCommandEventArgs'',''ListViewSortEventArgs'')')
EXEC ('UPDATE dbo.WebRule SET WebRuleProg = REPLACE(WebRuleProg,''DataGridPageChangedEventArgs'',''PagePropertiesChangingEventArgs'')')
EXEC ('UPDATE dbo.WebRule SET WebRuleProg = REPLACE(WebRuleProg,''Grid.PageSize'',''GridDataPager.PageSize'')')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4649&typ=N&sys=3","","",""); return false;
4650~@~   8.  68.41210:D:   10:*:*:M: Change table ScreenObj~@~5372~@~10~@~D~@~~@~~@~M~@~~@~Change table ScreenObj~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenObj (DisplayModeId tinyint NULL, GroupRowId smallint NULL, GroupColId smallint NULL, ColumnSize smallint NULL, ColumnHeight smallint NULL, TabIndex smallint NULL, SortOrder smallint NULL, ScreenObjId int NULL, ScreenId int NULL, ColumnId int NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DdlAdnColumnId int NULL, DdlFtrColumnId int NULL, TabFolderId int NULL, DefaultValue nvarchar(200) NULL, HyperLinkUrl nvarchar(200) NULL, SystemValue nvarchar(200) NULL, MasterTable char(1) NULL, LabelVertical char(1) NULL, DefAfter char(1) NULL, DefAlways char(1) NULL, ColumnWrap char(1) NULL, GridGrpCd char(1) NULL, ColumnJustify char(1) NULL, AggregateCd char(1) NULL, GenerateSp char(1) NULL, RequiredValid char(1) NULL, RefreshOnCUD char(1) NULL, TrimOnEntry char(1) NULL, MatchCd char(1) NULL, IgnoreConfirm char(1) NULL, LabelCss varchar(1000) NULL, ContentCss varchar(1000) NULL, ColumnName varchar(20) NULL, ColumnDesc varchar(200) NULL, MaskValid varchar(100) NULL, RangeValidType varchar(50) NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, ColumnLink varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObj (DisplayModeId, GroupRowId, GroupColId, ColumnSize, ColumnHeight, TabIndex, SortOrder, ScreenObjId, ScreenId, ColumnId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, TabFolderId, DefaultValue, HyperLinkUrl, SystemValue, MasterTable, LabelVertical, DefAfter, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, AggregateCd, GenerateSp, RequiredValid, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm, LabelCss, ContentCss, ColumnName, ColumnDesc, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink) SELECT convert(tinyint,DisplayModeId), convert(smallint,GroupRowId), convert(smallint,GroupColId), convert(smallint,ColumnSize), convert(smallint,ColumnHeight), convert(smallint,TabIndex), convert(smallint,SortOrder), convert(int,ScreenObjId), convert(int,ScreenId), convert(int,ColumnId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), convert(int,DdlAdnColumnId), convert(int,DdlFtrColumnId), convert(int,TabFolderId), DefaultValue, HyperLinkUrl, SystemValue, MasterTable, LabelVertical, DefAfter, DefAlways, ColumnWrap, GridGrpCd, ColumnJustify, AggregateCd, GenerateSp, RequiredValid, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm, LabelCss, ContentCss, ColumnName, ColumnDesc, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObj'')) CREATE TABLE dbo.ScreenObj (ScreenObjId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, GroupRowId SmallInt NOT NULL, GroupColId SmallInt NOT NULL, LabelVertical Char(1) NOT NULL, LabelCss VarChar(1000) NULL, ContentCss VarChar(1000) NULL, ColumnId Int NULL, ColumnName VarChar(20) NOT NULL, ColumnDesc VarChar(200) NULL, DefaultValue NVarChar(200) NULL, HyperLinkUrl NVarChar(200) NULL, DefAfter Char(1) NOT NULL, SystemValue NVarChar(200) NULL, DefAlways Char(1) NOT NULL, ColumnWrap Char(1) NOT NULL, GridGrpCd Char(1) NOT NULL, HideOnTablet Char(1) NOT NULL, HideOnMobile Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, ColumnHeight SmallInt NULL, DisplayModeId TinyInt NOT NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlAdnColumnId Int NULL, DdlFtrColumnId Int NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId Int NULL, TabIndex SmallInt NOT NULL, SortOrder SmallInt NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(100) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(1000) NULL, RefreshOnCUD Char(1) NOT NULL, TrimOnEntry Char(1) NOT NULL, MatchCd Char(1) NULL, IgnoreConfirm Char(1) NOT NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))') EXEC (' ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_GroupRowId DEFAULT (78) FOR GroupRowId ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_LabelVertical DEFAULT (''N'') FOR LabelVertical ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAfter DEFAULT (''N'') FOR DefAfter ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAlways DEFAULT (''N'') FOR DefAlways ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_GridGrpCd DEFAULT (''N'') FOR GridGrpCd ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_HideOnTablet DEFAULT (''N'') FOR HideOnTablet ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_HideOnMobile DEFAULT (''N'') FOR HideOnMobile ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_TrimOnEntry DEFAULT (''Y'') FOR TrimOnEntry ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_IgnoreConfirm DEFAULT (''Y'') FOR IgnoreConfirm SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, GroupRowId, GroupColId, LabelVertical, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, HyperLinkUrl, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, HideOnTablet, HideOnMobile, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm) SELECT ScreenObjId, ScreenId, MasterTable, GroupRowId, GroupColId, LabelVertical, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, HyperLinkUrl, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, ''N'', ''N'', ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4650&typ=N&sys=3","","",""); return false;
4651~@~   9.   1.50105:D:   10:*:*:M: Adjust WebRule for InsertRow~@~6374~@~10~@~D~@~~@~~@~M~@~~@~Adjust WebRule for InsertRow~@~Y~@~EXEC ('UPDATE dbo.WebRule SET WebRuleProg = REPLACE(WebRuleProg,''Grid.EditIndex < 0'',''GridNotInEdit()'')')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4651&typ=N&sys=3","","",""); return false;
4654~@~   9.   2.50109:D:   10:*:*:M: Change table PageLnk~@~6375~@~10~@~D~@~~@~~@~M~@~~@~Change table PageLnk~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_PageLnk (PageObjId smallint NULL, PageLnkOrd smallint NULL, PageLnkId int NULL, PageLnkTxt nvarchar(4000) NULL, Popup char(1) NULL, PageLnkCss varchar(1000) NULL, PageLnkRef varchar(200) NULL, PageLnkImg varchar(200) NULL, PageLnkAlt varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_PageLnk (PageObjId, PageLnkOrd, PageLnkId, PageLnkTxt, Popup, PageLnkCss, PageLnkRef, PageLnkImg, PageLnkAlt) SELECT convert(smallint,PageObjId), convert(smallint,PageLnkOrd), convert(int,PageLnkId), PageLnkTxt, Popup, PageLnkCss, PageLnkRef, PageLnkImg, PageLnkAlt FROM dbo.PageLnk IF (SELECT COUNT(1) FROM dbo.Tmp_PageLnk) > 0 OR (SELECT COUNT(1) FROM dbo.PageLnk) = 0 DROP TABLE dbo.PageLnk') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.PageLnk'')) CREATE TABLE dbo.PageLnk (PageLnkId Int IDENTITY NOT NULL, PageObjId SmallInt NOT NULL, PageLnkCss VarChar(1000) NULL, Popup Char(1) NULL, PageLnkRef VarChar(1000) NULL, PageLnkTxt NVarChar(4000) NULL, PageLnkImg VarChar(1000) NULL, PageLnkAlt VarChar(1000) NULL, PageLnkOrd SmallInt NOT NULL, CONSTRAINT PK_PageLnk PRIMARY KEY CLUSTERED (PageLnkId))') EXEC (' SET IDENTITY_INSERT dbo.PageLnk ON INSERT INTO dbo.PageLnk (PageLnkId, PageObjId, PageLnkCss, Popup, PageLnkRef, PageLnkTxt, PageLnkImg, PageLnkAlt, PageLnkOrd) SELECT PageLnkId, PageObjId, PageLnkCss, Popup, PageLnkRef, PageLnkTxt, PageLnkImg, PageLnkAlt, PageLnkOrd FROM dbo.Tmp_PageLnk SET IDENTITY_INSERT dbo.PageLnk OFF IF (SELECT COUNT(1) FROM dbo.PageLnk) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_PageLnk) = 0 DROP TABLE dbo.Tmp_PageLnk')

IF (SELECT COUNT(1) FROM dbo.PageObj) <= 0
EXEC ('
SET IDENTITY_INSERT [dbo].[PageLnk] ON 
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (3, 20, N''color:#3d72c1; font-family:sans-serif; font-size:2em; line-height:1;'', N''N'', NULL, N''Screen: Create a simple Screen'', NULL, NULL, 10)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (4, 16, N''display:block; font-size: 16px; color: #333; font-family: century gothic;'', N''Y'', N''AdmScreen.aspx?id=25&typ=N'', N''Define the Screen'', NULL, NULL, 10)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (5, 16, N''display:block; font-size: 16px; color: #333; font-family: century gothic;'', N''Y'', N''AdmScreenObj.aspx?id=26&typ=N'', N''Specify the Screen Objects'', NULL, NULL, 20)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (6, 16, N''display:block; font-size: 16px; color: #333; font-family: century gothic;'', N''Y'', N''AdmAuthCol.aspx?id=20&typ=N'', N''Assign Object Authority'', NULL, NULL, 30)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (7, 21, N''color:#3d72c1; font-family:sans-serif; font-size:2em; line-height:1;'', N''N'', NULL, N''Advanced Screen: Enhance Current Screen'', NULL, NULL, 10)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (8, 17, N''display:block; font-size: 16px; color: #333; font-family: century gothic;'', N''Y'', N''AdmScreenCri.aspx?id=196&typ=N'', N''Add Screen Criteria'', NULL, NULL, 10)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (9, 17, N''display:block; font-size: 16px; color: #333; font-family: century gothic;'', N''Y'', N''AdmScreenCriMap.aspx?id=197&typ=N'', N''Map Screen Criteria to Columns'', NULL, NULL, 20)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (10, 17, N''display:block; font-size: 16px; color: #333; font-family: century gothic;'', N''Y'', N''AdmServerRule.aspx?id=22&typ=N'', N''Add Server Rules'', NULL, NULL, 30)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (11, 22, N''color:#3d72c1; font-family:sans-serif; font-size:2em; line-height:1;'', N''N'', NULL, N''Reporting: Create tabular report, chart & guage'', NULL, NULL, 10)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (12, 18, N''display:block; font-size: 16px; color: #333; font-family: century gothic;'', N''Y'', N''AdmReport.aspx?id=186&typ=N'', N''Refine the Report Definition'', NULL, NULL, 10)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (13, 18, N''display:block; font-size: 16px; color: #333; font-family: century gothic;'', N''Y'', N''AdmReportCri.aspx?id=188&typ=N'', N''Refine the Report Criteria'', NULL, NULL, 20)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (19, 3, N''vertical-align:middle; padding: 0px 6px 0px 0px; max-height: 30px;'', N''Y'', N''javascript:ShowEmbedScript(); return false;'', NULL, N''images/shortcut/embed.gif'', N''images/shortcut/embedr.gif'', 10)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (23, 11, N''color:#152a57; padding: 0px 5px;'', N''Y'', N''http://www.rintagi.com/home/terms_of_service.pdf'', N''Terms of Service'', NULL, NULL, 10)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (24, 11, N''color:#152a57; padding: 0px 5px;'', N''Y'', N''http://www.rintagi.com/home/privacy_policy.pdf'', N''Privacy Policy'', NULL, NULL, 20)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (25, 13, N''background:url(../images/question.png) no-repeat; display:inline-block; height:16px; padding: 0px 5px 0 20px; color:#152a57; text-decoration:underline; cursor:pointer;'', N''N'', N''javascript:email(''''cs'''',''''robocoder.com''''); return false;'', N''Need help? Get technical support.'', NULL, NULL, 10)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (28, 3, N''vertical-align:middle; padding: 0px 6px 0px 0px; max-height: 30px;'', N''Y'', N''http://www.google.com'', N''Google'', NULL, NULL, 20)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (29, 3, N''vertical-align:middle; padding: 0px 6px 0px 0px; max-height: 30px;'', N''N'', N''ComInstall.aspx?id=265'', N''Installer'', NULL, NULL, 30)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (35, 1, N''width:100%;'', N''N'', N''Default.aspx'', NULL, N''images/special/YourLogo.gif'', N''images/special/Robocoder.png'', 10)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (36, 18, N''display:block; font-size: 16px; color: #333; font-family: century gothic;'', N''Y'', N''AdmRptWiz.aspx?id=229&typ=N'', N''Use the Report Generator'', NULL, NULL, 5)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (38, 28, N''font-size:14px; color:#555;'', N''Y'', NULL, N''The end product as we see it today, and in fact, as we have seen it for a number of years now, is, to the best of my knowledge, the best in the business.'', NULL, NULL, 10)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (39, 28, N''font-size:14px; color:#555;'', N''N'', NULL, N''I have found Robocoder''''s development team to be very knowledgeable, dependable and an absolute pleasure to work with.'', NULL, NULL, 20)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (40, 28, N''font-size:14px; color:#555;'', N''N'', NULL, N''They were able to quickly understand our market requirements and come up with great solutions to our customers'''' challenges.'', NULL, NULL, 30)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (41, 28, N''font-size:14px; color:#555;'', N''N'', NULL, N''We were constantly amazed at the flexibility of the software and how changes that traditionally would take weeks of programming time could be done almost on-the-fly, real time. All in all, the experience has exceeded our expectations.'', NULL, NULL, 40)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (42, 28, N''font-size:14px; color:#555;'', N''N'', NULL, N''The developing and implementing of the new system was seamless.'', NULL, NULL, 50)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (43, 28, N''font-size:14px; color:#555;'', N''N'', NULL, N''With the end user in mind, they have transformed often obscure mental concepts into flexible and easy-to-use solutions.'', NULL, NULL, 60)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (44, 28, N''font-size:14px; color:#555;'', N''N'', NULL, N''Their Late change no penalty approach allowed us to tailor to specific customer needs and requirements.'', NULL, NULL, 70)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (45, 28, N''font-size:14px; color:#555;'', N''N'', NULL, N''Not only have your team made every effort to understand our unique needs, you have suggested innovative concepts that have automated our processes without much effort.'', NULL, NULL, 80)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (46, 28, N''font-size:14px; color:#555;'', N''N'', NULL, N''Working with Robocoder Corporation has been a pleasant experience. Many modifications and improvements were made as we requested them late in the customization process.'', NULL, NULL, 90)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (47, 28, N''font-size:14px; color:#555;'', N''N'', NULL, N''Your attention to detail has been paramount and that every number can be explained. You have delivered a robust system. Thank you for the wonderful job you have done for us and the securitization industry.'', NULL, NULL, 100)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (48, 29, N''max-width:400px; max-height:100px;'', N''N'', NULL, NULL, N''images/testimonial/roynat.png'', NULL, 10)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (49, 29, N''max-width:400px; max-height:100px;'', N''N'', NULL, NULL, N''images/testimonial/pwBank.png'', NULL, 20)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (50, 29, N''max-width:400px; max-height:100px;'', N''N'', NULL, NULL, N''images/testimonial/sunLife.png'', NULL, 30)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (51, 29, N''max-width:400px; max-height:100px;'', N''N'', NULL, NULL, N''images/testimonial/pcw.png'', NULL, 40)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (52, 29, N''max-width:400px; max-height:100px;'', N''N'', NULL, NULL, N''images/testimonial/spartan.png'', NULL, 50)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (53, 29, N''max-width:400px; max-height:100px;'', N''N'', NULL, NULL, N''images/testimonial/beacon.png'', NULL, 60)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (54, 29, N''max-width:400px; max-height:100px;'', N''N'', NULL, NULL, N''images/testimonial/securcor.png'', NULL, 70)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (55, 29, N''max-width:400px; max-height:100px;'', N''N'', NULL, NULL, N''images/testimonial/aileron.png'', NULL, 80)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (58, 30, NULL, N''N'', NULL, N''Prototype to Production in Seconds'', NULL, NULL, 10)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (59, 31, NULL, N''N'', NULL, N''DIY Platform That Last ...'', NULL, NULL, 10)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (60, 35, N''padding: 0px 0px 0px 4px; max-height: 30px;'', N''Y'', NULL, NULL, N''images/special/Facebook.png'', NULL, 10)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (61, 35, N''padding: 0px 0px 0px 4px; max-height: 30px;'', N''Y'', NULL, NULL, N''images/special/Twitter.png'', NULL, 20)
INSERT [dbo].[PageLnk] ([PageLnkId], [PageObjId], [PageLnkCss], [Popup], [PageLnkRef], [PageLnkTxt], [PageLnkImg], [PageLnkAlt], [PageLnkOrd]) VALUES (62, 35, N''padding: 0px 0px 0px 4px; max-height: 30px;'', N''Y'', NULL, NULL, N''images/special/Linkedin.png'', NULL, 30)
SET IDENTITY_INSERT [dbo].[PageLnk] OFF
SET IDENTITY_INSERT [dbo].[PageObj] ON 
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (1, N''HEADER 010: Logo Home'', N''H'', 34, 834, NULL, NULL, 10, N''LGO'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=7'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=19'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (2, N''HEADER 030: User Profile'', N''H'', 68, 812, N''float:right;'', NULL, 30, N''PRF'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=5'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=12'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (3, N''HEADER 020: Link Header'', N''H'', 68, 876, N''text-align:right;'', N''    function openLinkSec() { var linkContainer = $(''''#<%=cLinkHolder.ClientID%>''''); if (linkContainer.hasClass(''''hideMoreButtonSec'''')) { linkContainer.removeClass(''''hideMoreButtonSec''''); } else { linkContainer.addClass(''''hideMoreButtonSec''''); }; }
    $(document).mouseup(function (e) { var linkContainer = $(''''#<%=cLinkHolder.ClientID%>''''); if ($(window).width() <= 1024) { if (!linkContainer.is(e.target) && linkContainer.has(e.target).length === 0 && !linkContainer.hasClass(''''hideMoreButtonSec'''')) { openLinkSec(); } } });'', 20, N''HDR'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=5'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=20'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (5, N''HEADER 050: Menu Horizontal Top'', N''H'', 78, 878, NULL, NULL, 50, N''MNT'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=6'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=15'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (6, N''HEADER 060: Breadcrumb'', N''H'', 78, 813, NULL, NULL, 60, N''BRC'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=6'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=16'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (7, N''HEADER 070: Current Long Date'', N''H'', 78, 853, NULL, NULL, 70, N''CDD'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=6'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=17'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (8, N''HEADER 080: Culture Choice'', N''H'', 78, 842, NULL, NULL, 80, N''CUL'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=6'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=18'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (11, N''FOOTER 010: Link General [Terms of Service]'', N''F'', 78, 801, N''white-space:nowrap; vertical-align:top;'', NULL, 10, N''LNK'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=2'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=7'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (12, N''FOOTER 020: Version Text'', N''F'', 78, 874, N''text-align:center;'', NULL, 20, N''VER'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=2'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=8'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (13, N''FOOTER 030: Link General [Need help? Get technical support.]'', N''F'', 78, 812, N''white-space:nowrap; vertical-align:top;'', NULL, 30, N''LNK'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=2'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=9'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (16, N''DEFAULT 050: Link General [Define the Screen]'', N''D'', 78, 834, N''padding:20px; '', NULL, 50, N''LNK'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=1'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=1'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (17, N''DEFAULT 070: Link General [Add Screen Criteria]'', N''D'', 78, 838, N''padding:20px; '', NULL, 70, N''LNK'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=1'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=2'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (18, N''DEFAULT 090: Link General [Refine the Report Definition]'', N''D'', 78, 842, N''padding:20px; '', NULL, 90, N''LNK'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=1'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=3'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (20, N''DEFAULT 040: Label Only [Screen: Create a simple Screen]'', N''D'', 78, 834, N''padding:30px 20px 0 20px; '', NULL, 40, N''LAB'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=1'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=1'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (21, N''DEFAULT 060: Label Only [Advanced Screen: Enhance Current Screen]'', N''D'', 78, 838, N''padding:30px 20px 0 20px; '', NULL, 60, N''LAB'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=1'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=2'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (22, N''DEFAULT 080: Label Only [Reporting: Create tabular report, chart & guage]'', N''D'', 78, 842, N''padding:30px 20px 0 20px; '', NULL, 80, N''LAB'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=1'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=3'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (28, N''DEFAULT 030: Carousel [The end product as we see it today, and in fact, a]'', N''D'', 78, 863, N''vertical-align:middle; text-align:center;'', N''    $(window).load(function () { $(''''.flexslider'''').flexslider({ animation:''''fade'''', pauseOnHover:true, slideshowSpeed:7000 }); });'', 30, N''CRS'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=1'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=4'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (29, N''DEFAULT 020: Carousel'', N''D'', 78, 843, N''vertical-align:middle; text-align:center;'', N''    $(window).load(function () { $(''''.flexslider'''').flexslider({ animation:''''fade'''', pauseOnHover:true, slideshowSpeed:7000 }); });'', 20, N''CRS'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=1'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=5'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (30, N''DEFAULT 015: Label Only [Prototype to Production in Seconds]'', N''D'', 78, 878, N''color:#d88623; font-family:sans-serif; text-align:center; font-size:3em; line-height:1; margin-bottom:0.5em; text-shadow: 1px 1px 1px #5d5d5d;'', NULL, 15, N''LAB'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=1'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=6'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (31, N''DEFAULT 016: Label Only [DIY Platform That Last ...]'', N''D'', 78, 878, N''color:#222222; font-family:sans-serif; text-align:center; font-size:1.5em; line-height:1; margin-bottom:1em;'', NULL, 16, N''LAB'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=1'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=6'')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (32, N''FOOTER 005: Background Image/Color'', N''F'', NULL, NULL, N''border-top:10px solid #5083D0; background-color:#cdcdcd; color:#282b32; font-family:Tahoma, Verdana; font-size:10px; min-height:44px; padding:4px 0px; margin-top:10px;'', NULL, 5, N''BKI'', N'''', N'''')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (33, N''DEFAULT 010: Background Image/Color'', N''D'', NULL, NULL, N''background-image:url(../images/special/RCLogo_Large.png); background-position: center center; background-repeat: no-repeat; margin-top: 10px; min-height:500px;'', NULL, 10, N''BKI'', N'''', N'''')
INSERT [dbo].[PageObj] ([PageObjId], [PageObjDesc], [SectionCd], [GroupRowId], [GroupColId], [PageObjCss], [PageObjSrp], [PageObjOrd], [LinkTypeCd], [SctGrpRow], [SctGrpCol]) VALUES (35, N''HEADER 040: Link Social'', N''H'', 68, 878, N''text-align:right;'', N''    function openSociSec() { var socialContainer = $(''''#<%=cSociHolder.ClientID%>''''); if (socialContainer.hasClass(''''hideMoreButtonSec'''')) { socialContainer.removeClass(''''hideMoreButtonSec''''); } else { socialContainer.addClass(''''hideMoreButtonSec''''); }; }
    $(document).mouseup(function (e) { var socialContainer = $(''''#<%=cSociHolder.ClientID%>''''); if ($(window).width() <= 1024) { if (!socialContainer.is(e.target) && socialContainer.has(e.target).length === 0 && !socialContainer.hasClass(''''hideMoreButtonSec'''')) { openSociSec(); } } });'', 40, N''SSO'', N''AdmSctGrpRow.aspx?typ=N&col=SctGrpRowId&key=5'', N''AdmSctGrpCol.aspx?typ=N&col=SctGrpColId&key=15'')
SET IDENTITY_INSERT [dbo].[PageObj] OFF
SET IDENTITY_INSERT [dbo].[SctGrpCol] ON 
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (1, N''Default: Column  1 to  4 of 12'', N''D'', 834, N''padding-right:5px; background-color:#ededed; border-radius:4px; opacity:0.8; vertical-align: top;'', NULL)
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (2, N''Default: Column  5 to  8 of 12'', N''D'', 838, N''padding-right:5px; background-color:#ededed; border-radius:4px; opacity:0.8; vertical-align: top;'', NULL)
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (3, N''Default: Column  9 to 12 of 12'', N''D'', 842, N''background-color:#ededed; border-radius:4px; opacity:0.8; vertical-align: top;'', NULL)
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (4, N''Default: Column  6 to 12 of 12'', N''D'', 863, NULL, N''width:100%; height:120px; background-color:#efefef; padding:5px 30px; border-radius:4px; opacity:0.8;'')
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (5, N''Default: Column  1 to  5 of 12'', N''D'', 843, N''padding-right:5px;'', N''width:100%; height:120px; background-color:#efefef; padding:5px 30px; border-radius:4px; opacity:0.8;'')
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (6, N''Default: Column  1 to 12 of 12'', N''D'', 878, NULL, NULL)
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (7, N''Footer: Column  1 to  1 of 12'', N''F'', 801, NULL, NULL)
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (8, N''Footer: Column  2 to 11 of 12'', N''F'', 874, NULL, NULL)
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (9, N''Footer: Column 12 to 12 of 12'', N''F'', 812, NULL, NULL)
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (10, N''Header: Column  1 to  3 of 12'', N''H'', 824, NULL, NULL)
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (11, N''Header: Column  4 to 11 of 12'', N''H'', 867, NULL, NULL)
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (12, N''Header: Column 12 to 12 of 12'', N''H'', 812, N''white-space:nowrap; vertical-align:middle; text-align:right; font-size:14px; font-weight:bold;'', NULL)
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (13, N''Header: Column  5 to 11 of 12'', N''H'', 862, N''vertical-align:middle; text-align:right; font-size:14px;'', NULL)
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (14, N''Header: Column  5 to 12 of 12'', N''H'', 868, N''white-space:nowrap; vertical-align:middle; text-align:right;'', NULL)
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (15, N''Header: Column  1 to 12 of 12'', N''H'', 878, NULL, NULL)
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (16, N''Header: Column  1 to  2 of 12'', N''H'', 813, N''white-space:nowrap; vertical-align:middle; padding: 5px 10px;'', N''color:#333;'')
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (17, N''Header: Column  3 to  8 of 12'', N''H'', 853, N''vertical-align:middle; text-align:center; color:#151515; font-size:11px; font-family: Verdana, Tahoma;'', NULL)
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (18, N''Header: Column  9 to 12 of 12'', N''H'', 842, NULL, NULL)
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (19, N''Header: Column  1 to  4 of 12'', N''H'', 834, NULL, NULL)
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (20, N''Header: Column  1 to 11 of 12'', N''H'', 876, NULL, NULL)
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (21, N''Header: Column  1 to  6 of 12'', N''H'', 851, NULL, NULL)
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (22, N''Header: Column  7 to 12 of 12'', N''H'', 857, NULL, NULL)
INSERT [dbo].[SctGrpCol] ([SctGrpColId], [SctGrpColDesc], [SectionCd], [GroupColId], [SctGrpColCss], [SctGrpColDiv]) VALUES (23, N''Footer: Column  1 to 12 of 12'', N''F'', 878, NULL, NULL)
SET IDENTITY_INSERT [dbo].[SctGrpCol] OFF
SET IDENTITY_INSERT [dbo].[SctGrpRow] ON 
INSERT [dbo].[SctGrpRow] ([SctGrpRowId], [SctGrpRowDesc], [SectionCd], [GroupRowId], [SctGrpRowCss]) VALUES (1, N''Default: Column  1 to 12 of 12'', N''D'', 78, N''margin-top:30px; border-spacing: 3px 0;'')
INSERT [dbo].[SctGrpRow] ([SctGrpRowId], [SctGrpRowDesc], [SectionCd], [GroupRowId], [SctGrpRowCss]) VALUES (2, N''Footer: Column  1 to 12 of 12'', N''F'', 78, NULL)
INSERT [dbo].[SctGrpRow] ([SctGrpRowId], [SctGrpRowDesc], [SectionCd], [GroupRowId], [SctGrpRowCss]) VALUES (3, N''Header: Column  1 to  3 of 12'', N''H'', 24, NULL)
INSERT [dbo].[SctGrpRow] ([SctGrpRowId], [SctGrpRowDesc], [SectionCd], [GroupRowId], [SctGrpRowCss]) VALUES (4, N''Header: Column  4 to 12 of 12'', N''H'', 72, NULL)
INSERT [dbo].[SctGrpRow] ([SctGrpRowId], [SctGrpRowDesc], [SectionCd], [GroupRowId], [SctGrpRowCss]) VALUES (5, N''Header: Column  5 to 12 of 12'', N''H'', 68, NULL)
INSERT [dbo].[SctGrpRow] ([SctGrpRowId], [SctGrpRowDesc], [SectionCd], [GroupRowId], [SctGrpRowCss]) VALUES (6, N''Header: Column  1 to 12 of 12'', N''H'', 78, NULL)
INSERT [dbo].[SctGrpRow] ([SctGrpRowId], [SctGrpRowDesc], [SectionCd], [GroupRowId], [SctGrpRowCss]) VALUES (7, N''Header: Column  1 to  4 of 12'', N''H'', 34, NULL)
INSERT [dbo].[SctGrpRow] ([SctGrpRowId], [SctGrpRowDesc], [SectionCd], [GroupRowId], [SctGrpRowCss]) VALUES (9, N''Header: Column  9 to 12 of 12'', N''H'', 42, NULL)
INSERT [dbo].[SctGrpRow] ([SctGrpRowId], [SctGrpRowDesc], [SectionCd], [GroupRowId], [SctGrpRowCss]) VALUES (10, N''Header: Column 11 to 12 of 12'', N''H'', 23, NULL)
INSERT [dbo].[SctGrpRow] ([SctGrpRowId], [SctGrpRowDesc], [SectionCd], [GroupRowId], [SctGrpRowCss]) VALUES (11, N''Footer: Column  5 to 12 of 12'', N''F'', 68, NULL)
SET IDENTITY_INSERT [dbo].[SctGrpRow] OFF
')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4654&typ=N&sys=3","","",""); return false;
4655~@~   9.   3.50114:D:   10:*:*:M: Change table Screen~@~6376~@~10~@~D~@~~@~~@~M~@~~@~Change table Screen~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Screen (ScreenTypeId tinyint NULL, NumCols tinyint NULL, GridRows tinyint NULL, SearchWidth smallint NULL, ScreenId int NULL, MasterTableId int NULL, DetailTableId int NULL, SearchId int NULL, ScreenDesc nvarchar(50) NULL, GridTitle nvarchar(50) NULL, SearchAscending char(1) NULL, SearchMode char(1) NULL, GenerateSc char(1) NULL, GenerateSr char(1) NULL, HasDeleteAll char(1) NULL, ShowGridHead char(1) NULL, ValidateReq char(1) NULL, DeferError char(1) NULL, NeedRegen char(1) NULL, AuthRequired char(1) NULL, ViewOnly char(1) NULL, ProgramName varchar(20) NULL, GridClass varchar(30) NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenTypeId, NumCols, GridRows, SearchWidth, ScreenId, MasterTableId, DetailTableId, SearchId, ScreenDesc, GridTitle, SearchAscending, SearchMode, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, NeedRegen, AuthRequired, ViewOnly, ProgramName, GridClass, ScreenObj, ScreenFilter) SELECT convert(tinyint,ScreenTypeId), convert(tinyint,NumCols), convert(tinyint,GridRows), convert(smallint,SearchWidth), convert(int,ScreenId), convert(int,MasterTableId), convert(int,DetailTableId), convert(int,SearchId), ScreenDesc, GridTitle, SearchAscending, SearchMode, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, NeedRegen, AuthRequired, ViewOnly, ProgramName, GridClass, ScreenObj, ScreenFilter FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchId Int NULL, SearchWidth SmallInt NULL, SearchAscending Char(1) NOT NULL, SearchMode Char(1) NULL, NumCols TinyInt NOT NULL, GridRows TinyInt NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, GenerateSr Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ShowGridHead Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, NeedRegen Char(1) NOT NULL, AuthRequired Char(1) NOT NULL, ViewOnly Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NumCols DEFAULT (1) FOR NumCols ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSc DEFAULT (''Y'') FOR GenerateSc ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSr DEFAULT (''Y'') FOR GenerateSr ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ShowGridHead DEFAULT (''Y'') FOR ShowGridHead ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NeedRegen DEFAULT (''N'') FOR NeedRegen ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_AuthRequired DEFAULT (''Y'') FOR AuthRequired ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ViewOnly DEFAULT (''N'') FOR ViewOnly SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, NumCols, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, NeedRegen, AuthRequired, ViewOnly) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchWidth, SearchAscending, SearchMode, NumCols, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, NeedRegen, AuthRequired, ViewOnly FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4655&typ=N&sys=3","","",""); return false;
4656~@~   9.   3.50114:D:   20:*:*:M: Reverse WebRule for InsertRow~@~6376~@~20~@~D~@~~@~~@~M~@~~@~Reverse WebRule for InsertRow~@~Y~@~EXEC ('UPDATE dbo.WebRule SET WebRuleProg = REPLACE(WebRuleProg,''GridNotInEdit()'',''Grid.EditIndex < 0'')')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4656&typ=N&sys=3","","",""); return false;
4658~@~   9.   4.50116:D:   10:*:*:M: Default grid to full width~@~6377~@~10~@~D~@~~@~~@~M~@~~@~Default grid to full width~@~Y~@~EXEC ('UPDATE ScreenObj SET GroupRowId = 78, GroupColId = 878 FROM ScreenObj a INNER JOIN Screen b ON a.ScreenId = b.ScreenId WHERE b.ScreenTypeId = 6 AND MasterTable = ''N''')
EXEC ('UPDATE ScreenObj SET GroupRowId = 78, GroupColId = 878 FROM ScreenObj a INNER JOIN Screen b ON a.ScreenId = b.ScreenId WHERE b.ScreenTypeId = 7')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4658&typ=N&sys=3","","",""); return false;
4659~@~   9.  10.50204:D:   10:*:*:M: Change table Screen~@~6383~@~10~@~D~@~~@~~@~M~@~~@~Change table Screen~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Screen (ScreenTypeId tinyint NULL, NumCols tinyint NULL, GridRows tinyint NULL, SearchWidth smallint NULL, ScreenId int NULL, MasterTableId int NULL, DetailTableId int NULL, SearchId int NULL, ScreenDesc nvarchar(50) NULL, SearchAscending char(1) NULL, SearchMode char(1) NULL, GenerateSc char(1) NULL, GenerateSr char(1) NULL, HasDeleteAll char(1) NULL, ShowGridHead char(1) NULL, ValidateReq char(1) NULL, DeferError char(1) NULL, NeedRegen char(1) NULL, AuthRequired char(1) NULL, ViewOnly char(1) NULL, ProgramName varchar(20) NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenTypeId, NumCols, GridRows, SearchWidth, ScreenId, MasterTableId, DetailTableId, SearchId, ScreenDesc, SearchAscending, SearchMode, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, NeedRegen, AuthRequired, ViewOnly, ProgramName, ScreenObj, ScreenFilter) SELECT convert(tinyint,ScreenTypeId), convert(tinyint,NumCols), convert(tinyint,GridRows), convert(smallint,SearchWidth), convert(int,ScreenId), convert(int,MasterTableId), convert(int,DetailTableId), convert(int,SearchId), ScreenDesc, SearchAscending, SearchMode, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, NeedRegen, AuthRequired, ViewOnly, ProgramName, ScreenObj, ScreenFilter FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchId Int NULL, SearchAscending Char(1) NOT NULL, SearchSql NVarChar(2000) NULL, GridRows TinyInt NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, GenerateSr Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ShowGridHead Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, AuthRequired Char(1) NOT NULL, ViewOnly Char(1) NOT NULL, NeedRegen Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSc DEFAULT (''Y'') FOR GenerateSc ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSr DEFAULT (''Y'') FOR GenerateSr ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ShowGridHead DEFAULT (''Y'') FOR ShowGridHead ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_AuthRequired DEFAULT (''Y'') FOR AuthRequired ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ViewOnly DEFAULT (''N'') FOR ViewOnly ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NeedRegen DEFAULT (''N'') FOR NeedRegen SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, NeedRegen) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, NeedRegen FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4659&typ=N&sys=3","","",""); return false;
4660~@~   9.  11.50206:D:   10:*:*:M: Change table ScreenObjHlp~@~6384~@~10~@~D~@~~@~~@~M~@~~@~Change table ScreenObjHlp~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenObjHlp (CultureId smallint NULL, ScreenObjHlpId int NULL, ScreenObjId int NULL, ColumnHeader nvarchar(max) NULL, ToolTip nvarchar(200) NULL, ErrMessage nvarchar(300) NULL, TbHint nvarchar(200) NULL, ScreenObjHlpDesc varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObjHlp (CultureId, ScreenObjHlpId, ScreenObjId, ColumnHeader, ToolTip, ErrMessage, TbHint, ScreenObjHlpDesc) SELECT convert(smallint,CultureId), convert(int,ScreenObjHlpId), convert(int,ScreenObjId), ColumnHeader, ToolTip, ErrMessage, TbHint, ScreenObjHlpDesc FROM dbo.ScreenObjHlp IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObjHlp) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObjHlp) = 0 DROP TABLE dbo.ScreenObjHlp') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObjHlp'')) CREATE TABLE dbo.ScreenObjHlp (ScreenObjHlpId Int IDENTITY NOT NULL, ScreenObjHlpDesc VarChar(200) NULL, ScreenObjId Int NOT NULL, CultureId SmallInt NOT NULL, ColumnHeader NVarChar(max) NULL, ToolTip NVarChar(1000) NULL, ErrMessage NVarChar(1000) NULL, TbHint NVarChar(1000) NULL, CONSTRAINT PK_ScreenObjHlp PRIMARY KEY CLUSTERED (ScreenObjHlpId, CultureId))') EXEC (' SET IDENTITY_INSERT dbo.ScreenObjHlp ON INSERT INTO dbo.ScreenObjHlp (ScreenObjHlpId, ScreenObjHlpDesc, ScreenObjId, CultureId, ColumnHeader, ToolTip, ErrMessage, TbHint) SELECT ScreenObjHlpId, ScreenObjHlpDesc, ScreenObjId, CultureId, ColumnHeader, ToolTip, ErrMessage, TbHint FROM dbo.Tmp_ScreenObjHlp SET IDENTITY_INSERT dbo.ScreenObjHlp OFF IF (SELECT COUNT(1) FROM dbo.ScreenObjHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObjHlp) = 0 DROP TABLE dbo.Tmp_ScreenObjHlp')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4660&typ=N&sys=3","","",""); return false;
4661~@~   9.  14.50214:D:   10:*:*:M: Make sure Admin can access~@~6387~@~10~@~D~@~~@~~@~M~@~~@~Make sure Admin can access~@~Y~@~EXEC ('insert into dbo.MenuPrm (MenuId,GrantDeny,PermKeyId,PermId)
select MenuId,''G'',8,5 from dbo.MenuPrm p
where not exists (select 1 from dbo.MenuPrm p2 
inner join [[?]]Design.dbo.UsrGroup g on p2.PermId = g.UsrGroupId
where p2.MenuId = p.MenuId and p2.PermKeyId = 8 and g.UsrGroupId = 5) 
and GrantDeny = ''G''
group by MenuId,GrantDeny,PermKeyId')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4661&typ=N&sys=3","","",""); return false;
4662~@~   9.  16.50228:D:   10:*:*:M: Special update for older apps~@~6389~@~10~@~D~@~~@~~@~M~@~~@~Special update for older apps~@~Y~@~EXEC ('UPDATE dbo.Screen SET ScreenDesc = b.ScreenTitle FROM dbo.Screen a INNER JOIN dbo.ScreenHlp b ON a.ScreenId = b.ScreenId AND CultureId = 1')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4662&typ=N&sys=3","","",""); return false;
4663~@~   9.  16.50228:C:   20:*:*:*: LinkModule*.*~@~6389~@~20~@~C~@~~@~~@~~@~Modules\~@~LinkModule*.*~@~N~@~~@~Y~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4663&typ=N&sys=3","","",""); return false;
4664~@~   9.  23.50313:D:   10:*:*:M: Increase ColumnName to 50 characters~@~8394~@~10~@~D~@~~@~~@~M~@~~@~Increase ColumnName to 50 characters~@~Y~@~EXEC ('alter table dbo.ScreenObj alter column ColumnName varchar(50)')
EXEC ('alter table dbo.UtReportCri alter column ColumnName varchar(50)')
EXEC ('alter table dbo.UtReportObj alter column ColumnName varchar(50)')
EXEC ('alter table dbo.ReportCri alter column ColumnName varchar(50)')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4664&typ=N&sys=3","","",""); return false;
4665~@~   9.  24.50315:D:   10:*:*:M: Change table Usr~@~8395~@~10~@~D~@~~@~~@~M~@~~@~Change table Usr~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_Usr (DefSystemId tinyint NULL, FailedAttempt tinyint NULL, FailedAttemptFP tinyint NULL, HintQuestionId tinyint NULL, CultureId smallint NULL, DefProjectId smallint NULL, PwdDuration smallint NULL, PwdWarn smallint NULL, UsrId int NULL, InvestorId int NULL, CustomerId int NULL, VendorId int NULL, AgentId int NULL, BrokerId int NULL, MemberId int NULL, DefCompanyId int NULL, UsrPassword varbinary(32) NULL, ConfirmPwd varbinary(32) NULL, ExtPassword varbinary(255) NULL, PicMed varbinary(max) NULL, LoginName nvarchar(32) NULL, UsrEmail nvarchar(50) NULL, UsrName nvarchar(50) NULL, HintAnswer nvarchar(50) NULL, LastFailedDt datetime NULL, LastSuccessDt datetime NULL, LastPwdChgDt datetime NULL, ModifiedOn datetime NULL, InternalUsr char(1) NULL, TechnicalUsr char(1) NULL, Active char(1) NULL, UsrGroupLs varchar(1000) NULL, CompanyLs varchar(1000) NULL, ProjectLs varchar(1000) NULL, UsrImprLink varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_Usr (DefSystemId, FailedAttempt, FailedAttemptFP, HintQuestionId, CultureId, DefProjectId, PwdDuration, PwdWarn, UsrId, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefCompanyId, UsrPassword, ConfirmPwd, ExtPassword, PicMed, LoginName, UsrEmail, UsrName, HintAnswer, LastFailedDt, LastSuccessDt, LastPwdChgDt, ModifiedOn, InternalUsr, TechnicalUsr, Active, UsrGroupLs, CompanyLs, ProjectLs, UsrImprLink) SELECT convert(tinyint,DefSystemId), convert(tinyint,FailedAttempt), convert(tinyint,FailedAttemptFP), convert(tinyint,HintQuestionId), convert(smallint,CultureId), convert(smallint,DefProjectId), convert(smallint,PwdDuration), convert(smallint,PwdWarn), convert(int,UsrId), convert(int,InvestorId), convert(int,CustomerId), convert(int,VendorId), convert(int,AgentId), convert(int,BrokerId), convert(int,MemberId), convert(int,DefCompanyId), UsrPassword, ConfirmPwd, ExtPassword, PicMed, LoginName, UsrEmail, UsrName, HintAnswer, LastFailedDt, LastSuccessDt, LastPwdChgDt, ModifiedOn, InternalUsr, TechnicalUsr, Active, UsrGroupLs, CompanyLs, ProjectLs, UsrImprLink FROM dbo.Usr IF (SELECT COUNT(1) FROM dbo.Tmp_Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Usr) = 0 DROP TABLE dbo.Usr') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Usr'')) CREATE TABLE dbo.Usr (UsrId Int IDENTITY NOT NULL, LoginName NVarChar(32) NOT NULL, UsrEmail NVarChar(50) NULL, UsrName NVarChar(50) NULL, UsrPassword VarBinary(32) NULL, ConfirmPwd VarBinary(32) NULL, ExtPassword VarBinary(255) NULL, CultureId SmallInt NOT NULL, InternalUsr Char(1) NOT NULL, TechnicalUsr Char(1) NOT NULL, UsrGroupLs VarChar(1000) NOT NULL, CompanyLs VarChar(1000) NULL, ProjectLs VarChar(1000) NULL, InvestorId Int NULL, CustomerId Int NULL, VendorId Int NULL, AgentId Int NULL, BrokerId Int NULL, MemberId Int NULL, DefSystemId TinyInt NOT NULL, DefProjectId Int NULL, DefCompanyId Int NULL, FailedAttempt TinyInt NULL, FailedAttemptFP TinyInt NULL, LastFailedDt DateTime NULL, LastSuccessDt DateTime NULL, LastPwdChgDt DateTime NULL, HintQuestionId TinyInt NULL, HintAnswer NVarChar(50) NULL, Active Char(1) NOT NULL, ModifiedOn DateTime NOT NULL, UsrImprLink VarChar(200) NULL, PwdNoRepeat SmallInt NOT NULL, PwdDuration SmallInt NOT NULL, PwdWarn SmallInt NOT NULL, PicMed VarBinary(max) NULL, CONSTRAINT PK_Usr PRIMARY KEY CLUSTERED (UsrId, CultureId))') EXEC (' ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_CultureId DEFAULT (1) FOR CultureId ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_InternalUsr DEFAULT (''N'') FOR InternalUsr ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_TechnicalUsr DEFAULT (''N'') FOR TechnicalUsr ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdNoRepeat DEFAULT (1) FOR PwdNoRepeat ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdDuration DEFAULT (9999) FOR PwdDuration ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdWarn DEFAULT (0) FOR PwdWarn SET IDENTITY_INSERT dbo.Usr ON INSERT INTO dbo.Usr (UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, LastPwdChgDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink, PwdNoRepeat, PwdDuration, PwdWarn, PicMed) SELECT UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, CONVERT(Int,DefProjectId), DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, LastPwdChgDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink, 1, PwdDuration, PwdWarn, PicMed FROM dbo.Tmp_Usr SET IDENTITY_INSERT dbo.Usr OFF IF (SELECT COUNT(1) FROM dbo.Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Usr) = 0 DROP TABLE dbo.Tmp_Usr')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4665&typ=N&sys=3","","",""); return false;
4666~@~   9.  24.50315:D:   20:*:*:M: Add three security tables~@~8395~@~20~@~D~@~~@~~@~M~@~~@~Add three security tables~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrPwd'')) CREATE TABLE dbo.UsrPwd(UsrId int NOT NULL, LastCnt smallint NOT NULL, UsrPassword varbinary(32) NOT NULL, CONSTRAINT PK_UsrPwd PRIMARY KEY CLUSTERED (UsrId ASC,LastCnt ASC))')
EXEC ('IF (SELECT COUNT(1) FROM dbo.UsrPwd) <= 0 INSERT dbo.UsrPwd (UsrId, LastCnt, UsrPassword) SELECT UsrId, 1, UsrPassword FROM dbo.Usr')

EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrAudit'')) CREATE TABLE dbo.UsrAudit(AttemptDt datetime NOT NULL, LoginName nvarchar(32) NOT NULL, UsrId int NULL, IpAddress varchar(50) NOT NULL, LoginSuccess char(1) NOT NULL, CONSTRAINT PK_UsrAudit PRIMARY KEY CLUSTERED (AttemptDt ASC))')

EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrSafeIP'')) CREATE TABLE dbo.UsrSafeIP(UsrId int NOT NULL, IpAddress varchar(50) NOT NULL, CONSTRAINT PK_UsrSafeIP PRIMARY KEY CLUSTERED (UsrId ASC, IpAddress ASC))')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4666&typ=N&sys=3","","",""); return false;
4667~@~   9.  25.50317:D:   10:*:*:M: Change table Menu~@~8396~@~10~@~D~@~~@~~@~M~@~~@~Change table Menu~@~Y~@~ EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_MenuHlp_Menu'') ALTER TABLE dbo.MenuHlp DROP CONSTRAINT FK_MenuHlp_Menu CREATE TABLE dbo.Tmp_Menu (MenuIndex smallint NULL, MenuId int NULL, ParentId int NULL, ReportId int NULL, ScreenId int NULL, WizardId int NULL, StaticPgId int NULL, MenuDesc nvarchar(300) NULL, IconUrl nvarchar(300) NULL, MenuName varchar(30) NULL, Miscellaneous varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_Menu (MenuIndex, MenuId, ParentId, ReportId, ScreenId, WizardId, StaticPgId, MenuDesc, IconUrl, MenuName, Miscellaneous) SELECT convert(smallint,MenuIndex), convert(int,MenuId), convert(int,ParentId), convert(int,ReportId), convert(int,ScreenId), convert(int,WizardId), convert(int,StaticPgId), MenuDesc, IconUrl, MenuName, Miscellaneous FROM dbo.Menu IF (SELECT COUNT(1) FROM dbo.Tmp_Menu) > 0 OR (SELECT COUNT(1) FROM dbo.Menu) = 0 DROP TABLE dbo.Menu') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Menu'')) CREATE TABLE dbo.Menu (MenuId Int IDENTITY NOT NULL, MenuIndex SmallInt NOT NULL, Miscellaneous VarChar(100) NULL, ParentId Int NULL, ReportId Int NULL, ScreenId Int NULL, WizardId Int NULL, StaticPgId Int NULL, IconUrl NVarChar(300) NULL, CONSTRAINT PK_Menu PRIMARY KEY CLUSTERED (MenuId))') EXEC (' SET IDENTITY_INSERT dbo.Menu ON INSERT INTO dbo.Menu (MenuId, MenuIndex, Miscellaneous, ParentId, ReportId, ScreenId, WizardId, StaticPgId, IconUrl) SELECT MenuId, MenuIndex, Miscellaneous, ParentId, ReportId, ScreenId, WizardId, StaticPgId, IconUrl FROM dbo.Tmp_Menu SET IDENTITY_INSERT dbo.Menu OFF IF (SELECT COUNT(1) FROM dbo.Menu) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Menu) = 0 DROP TABLE dbo.Tmp_Menu ALTER TABLE dbo.MenuHlp WITH NOCHECK ADD CONSTRAINT FK_MenuHlp_Menu FOREIGN KEY (MenuId) REFERENCES dbo.Menu (MenuId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4667&typ=N&sys=3","","",""); return false;
4668~@~   9.  25.50317:D:   20:*:*:M: Remove Combobox from DisplayType~@~8396~@~20~@~D~@~~@~~@~M~@~~@~Remove Combobox from DisplayType~@~N~@~EXEC ('DELETE FROM dbo.CtDisplayType WHERE TypeId in (18,22)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4668&typ=N&sys=3","","",""); return false;
4669~@~   9.  25.50317:D:   30:*:*:M: Just in case old Combobox is used~@~8396~@~30~@~D~@~~@~~@~M~@~~@~Just in case old Combobox is used~@~Y~@~EXEC ('UPDATE dbo.ScreenObj SET DisplayModeId = 38 WHERE DisplayModeId in (18,22)')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=4669&typ=N&sys=3","","",""); return false;
5668~@~   9.  25.50317:D:   40:*:*:M: Remove obsolete function~@~8396~@~40~@~D~@~~@~~@~M~@~~@~Remove obsolete function~@~N~@~IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name='fMenu') EXEC ('DROP FUNCTION dbo.fMenu')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5668&typ=N&sys=3","","",""); return false;
5669~@~   9.  28.50329:D:   10:*:*:M: Change table Usr~@~8399~@~10~@~D~@~~@~~@~M~@~~@~Change table Usr~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_Usr (DefSystemId tinyint NULL, FailedAttempt tinyint NULL, FailedAttemptFP tinyint NULL, HintQuestionId tinyint NULL, CultureId smallint NULL, PwdNoRepeat smallint NULL, PwdDuration smallint NULL, PwdWarn smallint NULL, UsrId int NULL, InvestorId int NULL, CustomerId int NULL, VendorId int NULL, AgentId int NULL, BrokerId int NULL, MemberId int NULL, DefProjectId int NULL, DefCompanyId int NULL, UsrPassword varbinary(32) NULL, ConfirmPwd varbinary(32) NULL, ExtPassword varbinary(255) NULL, PicMed varbinary(max) NULL, LoginName nvarchar(32) NULL, UsrEmail nvarchar(50) NULL, UsrName nvarchar(50) NULL, HintAnswer nvarchar(50) NULL, LastFailedDt datetime NULL, LastSuccessDt datetime NULL, LastPwdChgDt datetime NULL, ModifiedOn datetime NULL, InternalUsr char(1) NULL, TechnicalUsr char(1) NULL, Active char(1) NULL, UsrGroupLs varchar(1000) NULL, CompanyLs varchar(1000) NULL, ProjectLs varchar(1000) NULL, UsrImprLink varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_Usr (DefSystemId, FailedAttempt, FailedAttemptFP, HintQuestionId, CultureId, PwdNoRepeat, PwdDuration, PwdWarn, UsrId, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefProjectId, DefCompanyId, UsrPassword, ConfirmPwd, ExtPassword, PicMed, LoginName, UsrEmail, UsrName, HintAnswer, LastFailedDt, LastSuccessDt, LastPwdChgDt, ModifiedOn, InternalUsr, TechnicalUsr, Active, UsrGroupLs, CompanyLs, ProjectLs, UsrImprLink) SELECT convert(tinyint,DefSystemId), convert(tinyint,FailedAttempt), convert(tinyint,FailedAttemptFP), convert(tinyint,HintQuestionId), convert(smallint,CultureId), convert(smallint,PwdNoRepeat), convert(smallint,PwdDuration), convert(smallint,PwdWarn), convert(int,UsrId), convert(int,InvestorId), convert(int,CustomerId), convert(int,VendorId), convert(int,AgentId), convert(int,BrokerId), convert(int,MemberId), convert(int,DefProjectId), convert(int,DefCompanyId), UsrPassword, ConfirmPwd, ExtPassword, PicMed, LoginName, UsrEmail, UsrName, HintAnswer, LastFailedDt, LastSuccessDt, LastPwdChgDt, ModifiedOn, InternalUsr, TechnicalUsr, Active, UsrGroupLs, CompanyLs, ProjectLs, UsrImprLink FROM dbo.Usr IF (SELECT COUNT(1) FROM dbo.Tmp_Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Usr) = 0 DROP TABLE dbo.Usr') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Usr'')) CREATE TABLE dbo.Usr (UsrId Int IDENTITY NOT NULL, LoginName NVarChar(32) NOT NULL, UsrEmail NVarChar(50) NULL, UsrName NVarChar(50) NULL, UsrPassword VarBinary(32) NULL, ConfirmPwd VarBinary(32) NULL, ExtPassword VarBinary(255) NULL, CultureId SmallInt NOT NULL, InternalUsr Char(1) NOT NULL, TechnicalUsr Char(1) NOT NULL, UsrGroupLs VarChar(1000) NOT NULL, CompanyLs VarChar(1000) NULL, ProjectLs VarChar(1000) NULL, InvestorId Int NULL, CustomerId Int NULL, VendorId Int NULL, AgentId Int NULL, BrokerId Int NULL, MemberId Int NULL, DefSystemId TinyInt NOT NULL, DefProjectId Int NULL, DefCompanyId Int NULL, FailedAttempt TinyInt NULL, FailedAttemptFP TinyInt NULL, LastFailedDt DateTime NULL, LastSuccessDt DateTime NULL, LastPwdChgDt DateTime NULL, HintQuestionId TinyInt NULL, HintAnswer NVarChar(50) NULL, Active Char(1) NOT NULL, ModifiedOn DateTime NOT NULL, UsrImprLink VarChar(200) NULL, IPAlert Char(1) NOT NULL, PwdNoRepeat SmallInt NOT NULL, PwdDuration SmallInt NOT NULL, PwdWarn SmallInt NOT NULL, PicMed VarBinary(max) NULL, CONSTRAINT PK_Usr PRIMARY KEY CLUSTERED (UsrId, CultureId))') EXEC (' ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_CultureId DEFAULT (1) FOR CultureId ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_InternalUsr DEFAULT (''N'') FOR InternalUsr ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_TechnicalUsr DEFAULT (''N'') FOR TechnicalUsr ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_IPAlert DEFAULT (''N'') FOR IPAlert ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdNoRepeat DEFAULT (1) FOR PwdNoRepeat ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdDuration DEFAULT (9999) FOR PwdDuration ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdWarn DEFAULT (0) FOR PwdWarn SET IDENTITY_INSERT dbo.Usr ON INSERT INTO dbo.Usr (UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, LastPwdChgDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink, IPAlert, PwdNoRepeat, PwdDuration, PwdWarn, PicMed) SELECT UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, LastPwdChgDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink, ''N'', PwdNoRepeat, PwdDuration, PwdWarn, PicMed FROM dbo.Tmp_Usr SET IDENTITY_INSERT dbo.Usr OFF IF (SELECT COUNT(1) FROM dbo.Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Usr) = 0 DROP TABLE dbo.Tmp_Usr')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5669&typ=N&sys=3","","",""); return false;
5670~@~   9.  34.50413:D:   10:*:*:M: Change table Usr~@~8405~@~10~@~D~@~~@~~@~M~@~~@~Change table Usr~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_Usr (DefSystemId tinyint NULL, FailedAttempt tinyint NULL, FailedAttemptFP tinyint NULL, HintQuestionId tinyint NULL, CultureId smallint NULL, PwdNoRepeat smallint NULL, PwdDuration smallint NULL, PwdWarn smallint NULL, UsrId int NULL, InvestorId int NULL, CustomerId int NULL, VendorId int NULL, AgentId int NULL, BrokerId int NULL, MemberId int NULL, DefProjectId int NULL, DefCompanyId int NULL, UsrPassword varbinary(32) NULL, ConfirmPwd varbinary(32) NULL, ExtPassword varbinary(255) NULL, PicMed varbinary(max) NULL, LoginName nvarchar(32) NULL, UsrEmail nvarchar(50) NULL, UsrName nvarchar(50) NULL, HintAnswer nvarchar(50) NULL, LastFailedDt datetime NULL, LastSuccessDt datetime NULL, LastPwdChgDt datetime NULL, ModifiedOn datetime NULL, InternalUsr char(1) NULL, TechnicalUsr char(1) NULL, Active char(1) NULL, IPAlert char(1) NULL, UsrGroupLs varchar(1000) NULL, CompanyLs varchar(1000) NULL, ProjectLs varchar(1000) NULL, UsrImprLink varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_Usr (DefSystemId, FailedAttempt, FailedAttemptFP, HintQuestionId, CultureId, PwdNoRepeat, PwdDuration, PwdWarn, UsrId, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefProjectId, DefCompanyId, UsrPassword, ConfirmPwd, ExtPassword, PicMed, LoginName, UsrEmail, UsrName, HintAnswer, LastFailedDt, LastSuccessDt, LastPwdChgDt, ModifiedOn, InternalUsr, TechnicalUsr, Active, IPAlert, UsrGroupLs, CompanyLs, ProjectLs, UsrImprLink) SELECT convert(tinyint,DefSystemId), convert(tinyint,FailedAttempt), convert(tinyint,FailedAttemptFP), convert(tinyint,HintQuestionId), convert(smallint,CultureId), convert(smallint,PwdNoRepeat), convert(smallint,PwdDuration), convert(smallint,PwdWarn), convert(int,UsrId), convert(int,InvestorId), convert(int,CustomerId), convert(int,VendorId), convert(int,AgentId), convert(int,BrokerId), convert(int,MemberId), convert(int,DefProjectId), convert(int,DefCompanyId), UsrPassword, ConfirmPwd, ExtPassword, PicMed, LoginName, UsrEmail, UsrName, HintAnswer, LastFailedDt, LastSuccessDt, LastPwdChgDt, ModifiedOn, InternalUsr, TechnicalUsr, Active, IPAlert, UsrGroupLs, CompanyLs, ProjectLs, UsrImprLink FROM dbo.Usr IF (SELECT COUNT(1) FROM dbo.Tmp_Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Usr) = 0 DROP TABLE dbo.Usr') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Usr'')) CREATE TABLE dbo.Usr (UsrId Int IDENTITY NOT NULL, LoginName NVarChar(32) NOT NULL, UsrEmail NVarChar(50) NULL, UsrName NVarChar(50) NULL, UsrPassword VarBinary(32) NULL, ConfirmPwd VarBinary(32) NULL, ExtPassword VarBinary(255) NULL, CultureId SmallInt NOT NULL, InternalUsr Char(1) NOT NULL, TechnicalUsr Char(1) NOT NULL, UsrGroupLs VarChar(1000) NOT NULL, CompanyLs VarChar(1000) NULL, ProjectLs VarChar(1000) NULL, InvestorId Int NULL, CustomerId Int NULL, VendorId Int NULL, AgentId Int NULL, BrokerId Int NULL, MemberId Int NULL, DefSystemId TinyInt NOT NULL, DefProjectId Int NULL, DefCompanyId Int NULL, FailedAttempt TinyInt NULL, FailedAttemptFP TinyInt NULL, LastFailedDt DateTime NULL, LastSuccessDt DateTime NULL, LastPwdChgDt DateTime NULL, HintQuestionId TinyInt NULL, HintAnswer NVarChar(50) NULL, Active Char(1) NOT NULL, ModifiedOn DateTime NOT NULL, UsrImprLink VarChar(200) NULL, IPAlert Char(1) NOT NULL, PwdNoRepeat SmallInt NOT NULL, PwdDuration SmallInt NOT NULL, PwdWarn SmallInt NOT NULL, PicMed VarBinary(max) NULL, CONSTRAINT PK_Usr PRIMARY KEY CLUSTERED (UsrId, CultureId))') EXEC (' ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_CultureId DEFAULT (1) FOR CultureId ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_InternalUsr DEFAULT (''N'') FOR InternalUsr ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_TechnicalUsr DEFAULT (''N'') FOR TechnicalUsr ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_IPAlert DEFAULT (''N'') FOR IPAlert ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdNoRepeat DEFAULT (1) FOR PwdNoRepeat ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdDuration DEFAULT (9999) FOR PwdDuration ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdWarn DEFAULT (0) FOR PwdWarn SET IDENTITY_INSERT dbo.Usr ON INSERT INTO dbo.Usr (UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, LastPwdChgDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink, IPAlert, PwdNoRepeat, PwdDuration, PwdWarn, PicMed) SELECT UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, LastPwdChgDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink, IPAlert, PwdNoRepeat, PwdDuration, PwdWarn, PicMed FROM dbo.Tmp_Usr SET IDENTITY_INSERT dbo.Usr OFF IF (SELECT COUNT(1) FROM dbo.Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Usr) = 0 DROP TABLE dbo.Tmp_Usr IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IU_Usr'') CREATE UNIQUE NONCLUSTERED INDEX IU_Usr ON dbo.Usr(LoginName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5670&typ=N&sys=3","","",""); return false;
5671~@~   9.  36.50514:D:   10:*:*:M: Change table UsrImpr~@~8407~@~10~@~D~@~~@~~@~M~@~~@~Change table UsrImpr~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_UsrImpr (UsrImprId int NULL, UsrId int NULL, ImprUsrId int NULL, TestCurrency money NULL, UsrImprDesc nvarchar(200) NULL, UsrImprLink varchar(200) NULL, TestCulture varchar(10) NULL)') EXEC (' INSERT INTO dbo.Tmp_UsrImpr (UsrImprId, UsrId, ImprUsrId, TestCurrency, UsrImprDesc, UsrImprLink, TestCulture) SELECT convert(int,UsrImprId), convert(int,UsrId), convert(int,ImprUsrId), convert(money,TestCurrency), UsrImprDesc, UsrImprLink, TestCulture FROM dbo.UsrImpr IF (SELECT COUNT(1) FROM dbo.Tmp_UsrImpr) > 0 OR (SELECT COUNT(1) FROM dbo.UsrImpr) = 0 DROP TABLE dbo.UsrImpr') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrImpr'')) CREATE TABLE dbo.UsrImpr (UsrImprId Int IDENTITY NOT NULL, UsrId Int NOT NULL, ImprUsrId Int NOT NULL, UsrImprDesc NVarChar(200) NULL, UsrImprLink VarChar(200) NULL, TestCulture VarChar(10) NULL, TestCurrency Money NULL, SignOff VarBinary(max) NULL, CONSTRAINT PK_UsrImpr PRIMARY KEY CLUSTERED (UsrImprId))') EXEC (' SET IDENTITY_INSERT dbo.UsrImpr ON INSERT INTO dbo.UsrImpr (UsrImprId, UsrId, ImprUsrId, UsrImprDesc, UsrImprLink, TestCulture, TestCurrency) SELECT UsrImprId, UsrId, ImprUsrId, UsrImprDesc, UsrImprLink, TestCulture, TestCurrency FROM dbo.Tmp_UsrImpr SET IDENTITY_INSERT dbo.UsrImpr OFF IF (SELECT COUNT(1) FROM dbo.UsrImpr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrImpr) = 0 DROP TABLE dbo.Tmp_UsrImpr')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5671&typ=N&sys=3","","",""); return false;
5672~@~   9.  43.50616:D:   10:*:*:M: Change table ScreenTab~@~8414~@~10~@~D~@~~@~~@~M~@~~@~Change table ScreenTab~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_ScreenTab (TabFolderOrder tinyint NULL, ScreenTabId int NULL, TabFolderName varchar(30) NULL)')
EXEC ('INSERT INTO dbo.Tmp_ScreenTab (TabFolderOrder, ScreenTabId, TabFolderName) SELECT convert(tinyint,TabFolderOrder), convert(int,ScreenTabId), TabFolderName FROM dbo.ScreenTab IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenTab) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenTab) = 0 DROP TABLE dbo.ScreenTab')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenTab'')) CREATE TABLE dbo.ScreenTab (ScreenTabId Int IDENTITY NOT NULL, ScreenTabDesc nvarchar(200) NULL, ScreenId Int NOT NULL, TabFolderName NVarChar(30) NOT NULL, TabFolderOrder TinyInt NOT NULL, CONSTRAINT PK_ScreenTab PRIMARY KEY CLUSTERED (ScreenTabId))') EXEC (' SET IDENTITY_INSERT dbo.ScreenTab ON INSERT INTO dbo.ScreenTab (ScreenTabId, ScreenId, TabFolderName, TabFolderOrder) SELECT ScreenTabId, 0, TabFolderName, TabFolderOrder FROM dbo.Tmp_ScreenTab SET IDENTITY_INSERT dbo.ScreenTab OFF IF (SELECT COUNT(1) FROM dbo.ScreenTab) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenTab) = 0 DROP TABLE dbo.Tmp_ScreenTab')

EXEC ('CREATE TABLE dbo.TmpTab(ScreenId int, ScreenObjId int, ScreenTabId int, TabFolderName nvarchar(50), TabFolderOrder tinyint)')
EXEC ('INSERT INTO dbo.TmpTab SELECT a.ScreenId, a.ScreenObjId, b.ScreenTabId, b.TabFolderName, b.TabFolderOrder FROM dbo.ScreenObj a INNER JOIN dbo.ScreenTab b ON a.TabFolderId = b.ScreenTabId')
EXEC ('TRUNCATE TABLE dbo.ScreenTabHlp')
EXEC ('TRUNCATE TABLE dbo.ScreenTab')
EXEC ('INSERT INTO dbo.ScreenTab (ScreenId, TabFolderName, TabFolderOrder) SELECT DISTINCT ScreenId, TabFolderName, TabFolderOrder FROM dbo.TmpTab ORDER BY ScreenId, TabFolderOrder')
EXEC ('INSERT dbo.ScreenTab (ScreenId, TabFolderName, TabFolderOrder) SELECT DISTINCT ScreenId, ''Main Info'', 10 FROM dbo.ScreenObj WHERE NOT EXISTS (SELECT 1 FROM dbo.ScreenTab WHERE ScreenId = dbo.ScreenObj.ScreenId)')
EXEC ('INSERT INTO dbo.ScreenTabHlp (ScreenTabId, CultureId, TabFolderName) SELECT ScreenTabId, 1, TabFolderName FROM dbo.ScreenTab')
EXEC ('UPDATE a SET a.TabFolderId = c.ScreenTabId FROM dbo.ScreenObj a INNER JOIN dbo.TmpTab b ON a.ScreenObjId = b.ScreenObjId INNER JOIN dbo.ScreenTab c ON b.ScreenId = c.ScreenId AND b.TabFolderName = c.TabFolderName')

EXEC ('UPDATE dbo.ScreenTab SET ScreenTabDesc = b.ScreenDesc + '' ['' + Convert(varchar(10),a.TabFolderOrder) + ''] '' + a.TabFolderName FROM dbo.ScreenTab a INNER JOIN dbo.Screen b ON a.ScreenId = b.ScreenId')

EXEC ('IF ((SELECT COUNT(1) FROM dbo.TmpTab) <= 0) OR ((SELECT COUNT(1) FROM dbo.ScreenTab) > 0 AND NOT EXISTS (SELECT 1 FROM dbo.ScreenTab WHERE SCreenId is NULL)) DROP TABLE dbo.TmpTab')

EXEC ('UPDATE a SET a.TabFolderId = b.ScreenTabId FROM dbo.ScreenObj a INNER JOIN dbo.ScreenTab b ON a.ScreenId = b.ScreenId where a.TabFolderId is null')

EXEC ('ALTER TABLE dbo.ScreenObj ALTER COLUMN TabfolderId int NOT NULL')
EXEC ('UPDATE dbo.ScreenObj SET ColumnDesc = b.ProgramName + '' ['' +  + right(space(6) + convert(varchar,a.TabIndex),6) + ''] '' + c.TabFolderName + '': '' + a.ColumnName FROM dbo.ScreenObj a INNER JOIN dbo.Screen b ON a.ScreenId = b.ScreenId INNER JOIN dbo.ScreenTab c ON a.TabFolderId = c.ScreenTabId')

~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5672&typ=N&sys=3","","",""); return false;
5673~@~   9.  46.50709:D:   10:*:*:M: Change ScreenTab and ScreenObj Descriptions~@~8417~@~10~@~D~@~~@~~@~M~@~~@~Change ScreenTab and ScreenObj Descriptions~@~Y~@~EXEC ('UPDATE dbo.ScreenTab SET ScreenTabDesc = b.ScreenDesc + '' ['' + right(space(3) + convert(varchar,a.TabFolderOrder),3) + ''] '' + a.TabFolderName FROM dbo.ScreenTab a INNER JOIN dbo.Screen b ON a.ScreenId = b.ScreenId')

EXEC ('UPDATE dbo.ScreenObj SET ColumnDesc = b.ProgramName + '' ['' + right(space(5) + convert(varchar,a.TabIndex),5) + ''] '' + c.TabFolderName + '': '' + a.ColumnName FROM dbo.ScreenObj a INNER JOIN dbo.Screen b ON a.ScreenId = b.ScreenId INNER JOIN dbo.ScreenTab c ON a.TabFolderId = c.ScreenTabId')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5673&typ=N&sys=3","","",""); return false;
5674~@~   9.  46.50709:D:   20:*:*:M: Change table ScreenCri~@~8417~@~20~@~D~@~~@~~@~M~@~~@~Change table ScreenCri~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_ScreenCri (DisplayModeId tinyint NULL, TabIndex smallint NULL, ColumnSize smallint NULL, RowSize smallint NULL, ScreenCriId int NULL, ScreenId int NULL, ColumnId int NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, ColumnJustify char(1) NULL, RequiredValid char(1) NULL, ScreenCriDesc varchar(100) NULL, LabelCss varchar(100) NULL, ContentCss varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenCri (DisplayModeId, TabIndex, ColumnSize, RowSize, ScreenCriId, ScreenId, ColumnId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, ColumnJustify, RequiredValid, ScreenCriDesc, LabelCss, ContentCss) SELECT convert(tinyint,DisplayModeId), convert(smallint,TabIndex), convert(smallint,ColumnSize), convert(smallint,RowSize), convert(int,ScreenCriId), convert(int,ScreenId), convert(int,ColumnId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), ColumnJustify, RequiredValid, ScreenCriDesc, LabelCss, ContentCss FROM dbo.ScreenCri IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenCri) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenCri) = 0 DROP TABLE dbo.ScreenCri') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenCri'')) CREATE TABLE dbo.ScreenCri (ScreenCriId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, ScreenCriDesc VarChar(100) NULL, LabelCss VarChar(100) NULL, ContentCss VarChar(100) NULL, ColumnId Int NOT NULL, OperatorId TinyInt NOT NULL, TabIndex SmallInt NOT NULL, DisplayModeId TinyInt NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, RowSize SmallInt NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, RequiredValid Char(1) NOT NULL, CONSTRAINT PK_ScreenCri PRIMARY KEY CLUSTERED (ScreenCriId))') EXEC (' ALTER TABLE dbo.ScreenCri ADD CONSTRAINT DF_ScreenCri_OperatorId DEFAULT (1) FOR OperatorId SET IDENTITY_INSERT dbo.ScreenCri ON INSERT INTO dbo.ScreenCri (ScreenCriId, ScreenId, ScreenCriDesc, LabelCss, ContentCss, ColumnId, OperatorId, TabIndex, DisplayModeId, ColumnJustify, ColumnSize, RowSize, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, RequiredValid) SELECT ScreenCriId, ScreenId, ScreenCriDesc, LabelCss, ContentCss, ColumnId, 1, TabIndex, DisplayModeId, ColumnJustify, ColumnSize, RowSize, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, RequiredValid FROM dbo.Tmp_ScreenCri SET IDENTITY_INSERT dbo.ScreenCri OFF IF (SELECT COUNT(1) FROM dbo.ScreenCri) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenCri) = 0 DROP TABLE dbo.Tmp_ScreenCri')

~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5674&typ=N&sys=3","","",""); return false;
5675~@~   9.  47.50720:D:   10:*:*:M: Remove script from LinkHeader and Social~@~8418~@~10~@~D~@~~@~~@~M~@~~@~Remove script from LinkHeader and Social~@~N~@~EXEC ('UPDATE dbo.PageObj SET PageObjSrp = NULL WHERE LinkTypeCd IN (''HDR'',''SSO'')')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5675&typ=N&sys=3","","",""); return false;
5676~@~   9.  48.50727:D:   10:*:*:M: Change table CtDataType~@~8419~@~10~@~D~@~~@~~@~M~@~~@~Change table CtDataType~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_CtDataType (DataTypeId tinyint NULL, NumericData char(1) NULL, DoubleByte char(1) NULL, DataTypeName varchar(20) NULL, DataTypeSqlName varchar(20) NULL, DataTypeSysName varchar(20) NULL, DataTypeSByteOle varchar(20) NULL, DataTypeDByteOle varchar(20) NULL, DataTypeRdlParm varchar(20) NULL, DataTypeDesc varchar(80) NULL)') EXEC (' INSERT INTO dbo.Tmp_CtDataType (DataTypeId, NumericData, DoubleByte, DataTypeName, DataTypeSqlName, DataTypeSysName, DataTypeSByteOle, DataTypeDByteOle, DataTypeRdlParm, DataTypeDesc) SELECT convert(tinyint,DataTypeId), NumericData, DoubleByte, DataTypeName, DataTypeSqlName, DataTypeSysName, DataTypeSByteOle, DataTypeDByteOle, DataTypeRdlParm, DataTypeDesc FROM dbo.CtDataType IF (SELECT COUNT(1) FROM dbo.Tmp_CtDataType) > 0 OR (SELECT COUNT(1) FROM dbo.CtDataType) = 0 DROP TABLE dbo.CtDataType') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtDataType'')) CREATE TABLE dbo.CtDataType (DataTypeId TinyInt IDENTITY NOT NULL, DataTypeName VarChar(20) NOT NULL, DataTypeSqlName VarChar(20) NOT NULL, DataTypeSysName VarChar(20) NOT NULL, DataTypeSByteOle VarChar(20) NOT NULL, DataTypeDByteOle VarChar(20) NOT NULL, DataTypeRdlParm VarChar(20) NULL, DataTypeDesc VarChar(80) NOT NULL, NumericData Char(1) NOT NULL, DoubleByte Char(1) NOT NULL, DisplayModeId TinyInt NULL, CONSTRAINT PK_CtDataType PRIMARY KEY CLUSTERED (DataTypeId))') EXEC (' SET IDENTITY_INSERT dbo.CtDataType ON INSERT INTO dbo.CtDataType (DataTypeId, DataTypeName, DataTypeSqlName, DataTypeSysName, DataTypeSByteOle, DataTypeDByteOle, DataTypeRdlParm, DataTypeDesc, NumericData, DoubleByte) SELECT DataTypeId, DataTypeName, DataTypeSqlName, DataTypeSysName, DataTypeSByteOle, DataTypeDByteOle, DataTypeRdlParm, DataTypeDesc, NumericData, DoubleByte FROM dbo.Tmp_CtDataType SET IDENTITY_INSERT dbo.CtDataType OFF IF (SELECT COUNT(1) FROM dbo.CtDataType) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtDataType) = 0 DROP TABLE dbo.Tmp_CtDataType')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5676&typ=N&sys=3","","",""); return false;
5679~@~   9.  49.50730:C:   10:C:3:*: Dsh*.*~@~8420~@~10~@~C~@~C~@~3~@~~@~~@~Dsh*.*~@~N~@~~@~Y~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5679&typ=N&sys=3","","",""); return false;
5680~@~   9.  49.50730:C:   20:C:3:*: AdmListDsh*.*~@~8420~@~20~@~C~@~C~@~3~@~~@~modules\~@~AdmListDsh*.*~@~N~@~~@~Y~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5680&typ=N&sys=3","","",""); return false;
5681~@~   9.  49.50730:C:   30:C:3:*: AdmListRpt*.*~@~8420~@~30~@~C~@~C~@~3~@~~@~modules\~@~AdmListRpt*.*~@~N~@~~@~Y~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5681&typ=N&sys=3","","",""); return false;
5682~@~   9.  49.50730:C:   40:C:3:*: WebPart*.*~@~8420~@~40~@~C~@~C~@~3~@~~@~modules\~@~WebPart*.*~@~N~@~~@~Y~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5682&typ=N&sys=3","","",""); return false;
5683~@~   9.  49.50730:C:   50:C:3:*: DashBoard*.*~@~8420~@~50~@~C~@~C~@~3~@~~@~modules\~@~DashBoard*.*~@~N~@~~@~Y~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5683&typ=N&sys=3","","",""); return false;
5684~@~   9.  49.50730:D:   60:*:*:M: Remove unused items~@~8420~@~60~@~D~@~~@~~@~M~@~~@~Remove unused items~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''QueryStr'') DROP TABLE dbo.QueryStr')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''DshAvail'') DROP TABLE dbo.DshAvail')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''DshFld'') DROP TABLE dbo.DshFld')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''DshFldDtl'') DROP TABLE dbo.DshFldDtl')

EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''GetDashboardCat'') DROP PROCEDURE dbo.GetDashboardCat')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''GetQueryStr'') DROP PROCEDURE dbo.GetQueryStr')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''WrNoDshAvail'') DROP PROCEDURE dbo.WrNoDshAvail')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''WrAddDshAvail'') DROP PROCEDURE dbo.WrAddDshAvail')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''DelDshFldDtl'') DROP PROCEDURE dbo.DelDshFldDtl')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''DelDshFld'') DROP PROCEDURE dbo.DelDshFld')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''GetAdmListDsh102ById'') DROP PROCEDURE dbo.GetAdmListDsh102ById')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''GetAdmListDsh102DtlById'') DROP PROCEDURE dbo.GetAdmListDsh102DtlById')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''GetDdlDshFld'') DROP PROCEDURE dbo.GetDdlDshFld')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''GetDdlDshFldDtl'') DROP PROCEDURE dbo.GetDdlDshFldDtl')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''GetExpAdmListDsh102'') DROP PROCEDURE dbo.GetExpAdmListDsh102')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''GetLisAdmListDsh102'') DROP PROCEDURE dbo.GetLisAdmListDsh102')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''UpdDshFld'') DROP PROCEDURE dbo.UpdDshFld')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''UpdDshFldDtl'') DROP PROCEDURE dbo.UpdDshFldDtl')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''UpdAdmListDsh102In'') DROP PROCEDURE dbo.UpdAdmListDsh102In')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''UpdAdmListRpt101In'') DROP PROCEDURE dbo.UpdAdmListRpt101In')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''GetAdmListRpt101ById'') DROP PROCEDURE dbo.GetAdmListRpt101ById')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''GetAdmListRpt101DtlById'') DROP PROCEDURE dbo.GetAdmListRpt101DtlById')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''GetExpAdmListDsh102'') DROP PROCEDURE dbo.GetExpAdmListDsh102')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''GetExpAdmListRpt101'') DROP PROCEDURE dbo.GetExpAdmListRpt101')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5684&typ=N&sys=3","","",""); return false;
5685~@~   9.  50.50806:D:   10:*:*:M: Change table UsrImpr~@~8421~@~10~@~D~@~~@~~@~M~@~~@~Change table UsrImpr~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_UsrImpr (UsrImprId int NULL, UsrId int NULL, ImprUsrId int NULL, TestCurrency money NULL, SignOff varbinary(max) NULL, UsrImprDesc nvarchar(200) NULL, UsrImprLink varchar(200) NULL, TestCulture varchar(10) NULL)') EXEC (' INSERT INTO dbo.Tmp_UsrImpr (UsrImprId, UsrId, ImprUsrId, TestCurrency, SignOff, UsrImprDesc, UsrImprLink, TestCulture) SELECT convert(int,UsrImprId), convert(int,UsrId), convert(int,ImprUsrId), convert(money,TestCurrency), SignOff, UsrImprDesc, UsrImprLink, TestCulture FROM dbo.UsrImpr IF (SELECT COUNT(1) FROM dbo.Tmp_UsrImpr) > 0 OR (SELECT COUNT(1) FROM dbo.UsrImpr) = 0 DROP TABLE dbo.UsrImpr') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrImpr'')) CREATE TABLE dbo.UsrImpr (UsrImprId Int IDENTITY NOT NULL, UsrId Int NOT NULL, ImprUsrId Int NOT NULL, UsrImprDesc NVarChar(200) NULL, UsrImprLink VarChar(200) NULL, TestCulture VarChar(10) NULL, TestCurrency Money NULL, SignOff VarBinary(max) NULL, InputBy Int NULL, InputOn DateTime NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, CONSTRAINT PK_UsrImpr PRIMARY KEY CLUSTERED (UsrImprId))') EXEC (' SET IDENTITY_INSERT dbo.UsrImpr ON INSERT INTO dbo.UsrImpr (UsrImprId, UsrId, ImprUsrId, UsrImprDesc, UsrImprLink, TestCulture, TestCurrency, SignOff) SELECT UsrImprId, UsrId, ImprUsrId, UsrImprDesc, UsrImprLink, TestCulture, TestCurrency, SignOff FROM dbo.Tmp_UsrImpr SET IDENTITY_INSERT dbo.UsrImpr OFF IF (SELECT COUNT(1) FROM dbo.UsrImpr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrImpr) = 0 DROP TABLE dbo.Tmp_UsrImpr')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5685&typ=N&sys=3","","",""); return false;
5686~@~   9.  53.50814:D:   10:*:*:M: Change table DbTable~@~8424~@~10~@~D~@~~@~~@~M~@~~@~Change table DbTable~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_DbColumn_DbTable'') ALTER TABLE dbo.DbColumn DROP CONSTRAINT FK_DbColumn_DbTable CREATE TABLE dbo.Tmp_DbTable (SystemId tinyint NULL, TableId int NULL, ModifiedBy int NULL, TableDesc nvarchar(100) NULL, VirtualSql nvarchar(max) NULL, TblObjective nvarchar(500) NULL, ModifiedOn datetime NULL, LastSyncDt datetime NULL, MultiDesignDb char(1) NULL, VirtualTbl char(1) NULL, TableName varchar(20) NULL, PrevTblName varchar(20) NULL)') EXEC (' INSERT INTO dbo.Tmp_DbTable (SystemId, TableId, ModifiedBy, TableDesc, VirtualSql, TblObjective, ModifiedOn, LastSyncDt, MultiDesignDb, VirtualTbl, TableName, PrevTblName) SELECT convert(tinyint,SystemId), convert(int,TableId), convert(int,ModifiedBy), TableDesc, VirtualSql, TblObjective, ModifiedOn, LastSyncDt, MultiDesignDb, VirtualTbl, TableName, PrevTblName FROM dbo.DbTable IF (SELECT COUNT(1) FROM dbo.Tmp_DbTable) > 0 OR (SELECT COUNT(1) FROM dbo.DbTable) = 0 DROP TABLE dbo.DbTable') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.DbTable'')) CREATE TABLE dbo.DbTable (TableId Int IDENTITY NOT NULL, SystemId TinyInt NOT NULL, TableName VarChar(50) NOT NULL, TableDesc NVarChar(100) NOT NULL, MultiDesignDb Char(1) NOT NULL, VirtualTbl Char(1) NOT NULL, VirtualSql NVarChar(max) NULL, TblObjective NVarChar(500) NULL, PrevTblName VarChar(20) NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastSyncDt DateTime NULL, CONSTRAINT PK_DbTable PRIMARY KEY CLUSTERED (TableId))') EXEC (' ALTER TABLE dbo.DbTable ADD CONSTRAINT DF_DbTable_VirtualTbl DEFAULT (''N'') FOR VirtualTbl SET IDENTITY_INSERT dbo.DbTable ON INSERT INTO dbo.DbTable (TableId, SystemId, TableName, TableDesc, MultiDesignDb, VirtualTbl, VirtualSql, TblObjective, PrevTblName, ModifiedBy, ModifiedOn, LastSyncDt) SELECT TableId, SystemId, TableName, TableDesc, MultiDesignDb, VirtualTbl, VirtualSql, TblObjective, PrevTblName, ModifiedBy, ModifiedOn, LastSyncDt FROM dbo.Tmp_DbTable SET IDENTITY_INSERT dbo.DbTable OFF IF (SELECT COUNT(1) FROM dbo.DbTable) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_DbTable) = 0 DROP TABLE dbo.Tmp_DbTable ALTER TABLE dbo.DbColumn WITH NOCHECK ADD CONSTRAINT FK_DbColumn_DbTable FOREIGN KEY (TableId) REFERENCES dbo.DbTable (TableId)')

EXEC('UPDATE dbo.DbColumn SET ColumnScale = 6 WHERE DataType = 6')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5686&typ=N&sys=3","","",""); return false;
5687~@~   9.  53.50814:D:   20:*:*:M: Add table CtCrudType~@~8424~@~20~@~D~@~~@~~@~M~@~~@~Add table CtCrudType~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtCrudType'))
BEGIN
EXEC ('CREATE TABLE dbo.CtCrudType (CrudTypeCd Char(1) NOT NULL, CrudTypeName NVarChar(50) NOT NULL, CrudTypeDesc NVarChar(200) NOT NULL, CrudTypeSort Tinyint NOT NULL, CONSTRAINT PK_CtCrudType PRIMARY KEY CLUSTERED (CrudTypeCd))')
EXEC ('INSERT dbo.CtCrudType SELECT ''Y'', ''Before CRUD'', ''Run this s.proc before CRUD and before any Skip-CRUD.'', 1')
EXEC ('INSERT dbo.CtCrudType SELECT ''S'', ''Skip CRUD'', ''Run this s.proc after all the Before-CRUD and skip the CRUD operation.'', 2')
EXEC ('INSERT dbo.CtCrudType SELECT ''N'', ''After CRUD'', ''Run this s.proc after CRUD; Must handle Add scenario when CRUD is skipped.'', 3')
EXEC ('INSERT dbo.CtCrudType SELECT ''C'', ''Last Rule'', ''Run this s.proc after all the After-CRUD and before Commit transaction.'', 4')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5687&typ=N&sys=3","","",""); return false;
5688~@~   9.  54.50816:D:   10:*:*:M: Update Server Rule Exec Order~@~8425~@~10~@~D~@~~@~~@~M~@~~@~Update Server Rule Exec Order~@~Y~@~IF (SELECT count(1) FROM sys.procedures sp JOIN sys.parameters p ON sp.object_id = p.object_id WHERE sp.name = 'Ir_UpdServerRule') = 3
EXEC ('DECLARE @ScreenId int DECLARE scr CURSOR FOR SELECT ScreenId FROM dbo.Screen FOR READ ONLY OPEN scr FETCH NEXT FROM scr INTO @ScreenId WHILE @@FETCH_STATUS = 0 BEGIN EXEC dbo.Ir_UpdServerRule @ScreenId, 0, 1 FETCH NEXT FROM scr INTO @ScreenId END CLOSE scr DEALLOCATE scr')
ELSE
EXEC ('DECLARE @ScreenId int DECLARE scr CURSOR FOR SELECT ScreenId FROM dbo.Screen FOR READ ONLY OPEN scr FETCH NEXT FROM scr INTO @ScreenId WHILE @@FETCH_STATUS = 0 BEGIN EXEC dbo.Ir_UpdServerRule @ScreenId, 1 FETCH NEXT FROM scr INTO @ScreenId END CLOSE scr DEALLOCATE scr')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5688&typ=N&sys=3","","",""); return false;
5691~@~   9.  56.50909:D:   10:*:*:M: Change table ReportCri~@~8427~@~10~@~D~@~~@~~@~M~@~~@~Change table ReportCri~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ReportCri (DataTypeId tinyint NULL, DisplayModeId tinyint NULL, TabIndex smallint NULL, DataTypeSize smallint NULL, ColumnSize smallint NULL, RowSize smallint NULL, ReportCriId int NULL, ReportId int NULL, ReportGrpId int NULL, TableId int NULL, DefaultValue nvarchar(100) NULL, RequiredValid char(1) NULL, ReportCriDesc varchar(100) NULL, LabelCss varchar(100) NULL, ContentCss varchar(100) NULL, TableAbbr varchar(10) NULL, ColumnName varchar(50) NULL, DdlKeyColumnName varchar(50) NULL, DdlRefColumnName varchar(50) NULL, DdlSrtColumnName varchar(50) NULL, WhereClause varchar(1000) NULL, RegClause varchar(400) NULL)') EXEC (' INSERT INTO dbo.Tmp_ReportCri (DataTypeId, DisplayModeId, TabIndex, DataTypeSize, ColumnSize, RowSize, ReportCriId, ReportId, ReportGrpId, TableId, DefaultValue, RequiredValid, ReportCriDesc, LabelCss, ContentCss, TableAbbr, ColumnName, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, WhereClause, RegClause) SELECT convert(tinyint,DataTypeId), convert(tinyint,DisplayModeId), convert(smallint,TabIndex), convert(smallint,DataTypeSize), convert(smallint,ColumnSize), convert(smallint,RowSize), convert(int,ReportCriId), convert(int,ReportId), convert(int,ReportGrpId), convert(int,TableId), DefaultValue, RequiredValid, ReportCriDesc, LabelCss, ContentCss, TableAbbr, ColumnName, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, WhereClause, RegClause FROM dbo.ReportCri IF (SELECT COUNT(1) FROM dbo.Tmp_ReportCri) > 0 OR (SELECT COUNT(1) FROM dbo.ReportCri) = 0 DROP TABLE dbo.ReportCri') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ReportCri'')) CREATE TABLE dbo.ReportCri (ReportCriId Int IDENTITY NOT NULL, ReportId Int NOT NULL, ReportCriDesc VarChar(100) NULL, ReportGrpId Int NOT NULL, LabelCss VarChar(100) NULL, ContentCss VarChar(100) NULL, TableId Int NULL, TableAbbr VarChar(10) NULL, ColumnName VarChar(50) NOT NULL, TabIndex SmallInt NOT NULL, DataTypeId TinyInt NOT NULL, DataTypeSize SmallInt NULL, DisplayModeId TinyInt NOT NULL, ColumnSize SmallInt NULL, RowSize SmallInt NULL, DdlKeyColumnName VarChar(50) NULL, DdlRefColumnName VarChar(50) NULL, DdlSrtColumnName VarChar(50) NULL, DdlFtrColumnId Int NULL, RequiredValid Char(1) NOT NULL, DefaultValue NVarChar(100) NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, CONSTRAINT PK_ReportCri PRIMARY KEY CLUSTERED (ReportCriId))') EXEC (' SET IDENTITY_INSERT dbo.ReportCri ON INSERT INTO dbo.ReportCri (ReportCriId, ReportId, ReportCriDesc, ReportGrpId, LabelCss, ContentCss, TableId, TableAbbr, ColumnName, TabIndex, DataTypeId, DataTypeSize, DisplayModeId, ColumnSize, RowSize, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, RequiredValid, DefaultValue, WhereClause, RegClause) SELECT ReportCriId, ReportId, ReportCriDesc, ReportGrpId, LabelCss, ContentCss, TableId, TableAbbr, ColumnName, TabIndex, DataTypeId, DataTypeSize, DisplayModeId, ColumnSize, RowSize, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, RequiredValid, DefaultValue, WhereClause, RegClause FROM dbo.Tmp_ReportCri SET IDENTITY_INSERT dbo.ReportCri OFF IF (SELECT COUNT(1) FROM dbo.ReportCri) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ReportCri) = 0 DROP TABLE dbo.Tmp_ReportCri')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5691&typ=N&sys=3","","",""); return false;
5692~@~   9.  56.50909:D:   20:*:*:M: Change table ScreenCri~@~8427~@~20~@~D~@~~@~~@~M~@~~@~Change table ScreenCri~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenCri (OperatorId tinyint NULL, DisplayModeId tinyint NULL, TabIndex smallint NULL, ColumnSize smallint NULL, RowSize smallint NULL, ScreenCriId int NULL, ScreenId int NULL, ColumnId int NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, ColumnJustify char(1) NULL, RequiredValid char(1) NULL, ScreenCriDesc varchar(100) NULL, LabelCss varchar(100) NULL, ContentCss varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenCri (OperatorId, DisplayModeId, TabIndex, ColumnSize, RowSize, ScreenCriId, ScreenId, ColumnId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, ColumnJustify, RequiredValid, ScreenCriDesc, LabelCss, ContentCss) SELECT convert(tinyint,OperatorId), convert(tinyint,DisplayModeId), convert(smallint,TabIndex), convert(smallint,ColumnSize), convert(smallint,RowSize), convert(int,ScreenCriId), convert(int,ScreenId), convert(int,ColumnId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), ColumnJustify, RequiredValid, ScreenCriDesc, LabelCss, ContentCss FROM dbo.ScreenCri IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenCri) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenCri) = 0 DROP TABLE dbo.ScreenCri') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenCri'')) CREATE TABLE dbo.ScreenCri (ScreenCriId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, ScreenCriDesc VarChar(100) NULL, LabelCss VarChar(100) NULL, ContentCss VarChar(100) NULL, ColumnId Int NOT NULL, OperatorId TinyInt NOT NULL, TabIndex SmallInt NOT NULL, DisplayModeId TinyInt NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, RowSize SmallInt NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlFtrColumnId Int NULL, RequiredValid Char(1) NOT NULL, CONSTRAINT PK_ScreenCri PRIMARY KEY CLUSTERED (ScreenCriId))') EXEC (' ALTER TABLE dbo.ScreenCri ADD CONSTRAINT DF_ScreenCri_OperatorId DEFAULT (1) FOR OperatorId SET IDENTITY_INSERT dbo.ScreenCri ON INSERT INTO dbo.ScreenCri (ScreenCriId, ScreenId, ScreenCriDesc, LabelCss, ContentCss, ColumnId, OperatorId, TabIndex, DisplayModeId, ColumnJustify, ColumnSize, RowSize, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, RequiredValid) SELECT ScreenCriId, ScreenId, ScreenCriDesc, LabelCss, ContentCss, ColumnId, OperatorId, TabIndex, DisplayModeId, ColumnJustify, ColumnSize, RowSize, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, RequiredValid FROM dbo.Tmp_ScreenCri SET IDENTITY_INSERT dbo.ScreenCri OFF IF (SELECT COUNT(1) FROM dbo.ScreenCri) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenCri) = 0 DROP TABLE dbo.Tmp_ScreenCri')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5692&typ=N&sys=3","","",""); return false;
5693~@~   9.  57.50915:D:   10:*:*:M: Change table UtReportCri~@~8428~@~10~@~D~@~~@~~@~M~@~~@~Change table UtReportCri~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_UtReportCri (DataTypeId tinyint NULL, DisplayModeId tinyint NULL, TabIndex smallint NULL, DataTypeSize smallint NULL, ColumnSize smallint NULL, RowSize smallint NULL, ReportCriId int NULL, ReportId int NULL, ReportGrpId int NULL, TableId int NULL, RequiredValid char(1) NULL, ReportCriDesc varchar(100) NULL, LabelCss varchar(100) NULL, ContentCss varchar(100) NULL, TableAbbr varchar(10) NULL, ColumnName varchar(50) NULL, DdlKeyColumnName varchar(50) NULL, DdlRefColumnName varchar(50) NULL, DdlSrtColumnName varchar(50) NULL, WhereClause varchar(1000) NULL, RegClause varchar(400) NULL)') EXEC (' INSERT INTO dbo.Tmp_UtReportCri (DataTypeId, DisplayModeId, TabIndex, DataTypeSize, ColumnSize, RowSize, ReportCriId, ReportId, ReportGrpId, TableId, RequiredValid, ReportCriDesc, LabelCss, ContentCss, TableAbbr, ColumnName, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, WhereClause, RegClause) SELECT convert(tinyint,DataTypeId), convert(tinyint,DisplayModeId), convert(smallint,TabIndex), convert(smallint,DataTypeSize), convert(smallint,ColumnSize), convert(smallint,RowSize), convert(int,ReportCriId), convert(int,ReportId), convert(int,ReportGrpId), convert(int,TableId), RequiredValid, ReportCriDesc, LabelCss, ContentCss, TableAbbr, ColumnName, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, WhereClause, RegClause FROM dbo.UtReportCri IF (SELECT COUNT(1) FROM dbo.Tmp_UtReportCri) > 0 OR (SELECT COUNT(1) FROM dbo.UtReportCri) = 0 DROP TABLE dbo.UtReportCri') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UtReportCri'')) CREATE TABLE dbo.UtReportCri (ReportCriId Int IDENTITY NOT NULL, ReportId Int NOT NULL, ReportCriDesc VarChar(100) NULL, ReportGrpId Int NOT NULL, LabelCss VarChar(100) NULL, ContentCss VarChar(100) NULL, TableId Int NULL, TableAbbr VarChar(10) NULL, ColumnName VarChar(50) NULL, TabIndex SmallInt NOT NULL, DataTypeId TinyInt NOT NULL, DataTypeSize SmallInt NULL, DisplayModeId TinyInt NOT NULL, ColumnSize SmallInt NULL, RowSize SmallInt NULL, DdlKeyColumnName VarChar(50) NULL, DdlRefColumnName VarChar(50) NULL, DdlSrtColumnName VarChar(50) NULL, DdlFtrColumnId Int NULL, RequiredValid Char(1) NOT NULL, WhereClause VarChar(1000) NULL, RegClause VarChar(400) NULL, CONSTRAINT PK_UtReportCri PRIMARY KEY CLUSTERED (ReportCriId))') EXEC (' SET IDENTITY_INSERT dbo.UtReportCri ON INSERT INTO dbo.UtReportCri (ReportCriId, ReportId, ReportCriDesc, ReportGrpId, LabelCss, ContentCss, TableId, TableAbbr, ColumnName, TabIndex, DataTypeId, DataTypeSize, DisplayModeId, ColumnSize, RowSize, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, RequiredValid, WhereClause, RegClause) SELECT ReportCriId, ReportId, ReportCriDesc, ReportGrpId, LabelCss, ContentCss, TableId, TableAbbr, ColumnName, TabIndex, DataTypeId, DataTypeSize, DisplayModeId, ColumnSize, RowSize, DdlKeyColumnName, DdlRefColumnName, DdlSrtColumnName, RequiredValid, WhereClause, RegClause FROM dbo.Tmp_UtReportCri SET IDENTITY_INSERT dbo.UtReportCri OFF IF (SELECT COUNT(1) FROM dbo.UtReportCri) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UtReportCri) = 0 DROP TABLE dbo.Tmp_UtReportCri')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=5693&typ=N&sys=3","","",""); return false;
6696~@~   9.  58.50921:D:   10:*:*:M: Change table DbTable~@~8429~@~10~@~D~@~~@~~@~M~@~~@~Change table DbTable~@~Y~@~ EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_DbColumn_DbTable'') ALTER TABLE dbo.DbColumn DROP CONSTRAINT FK_DbColumn_DbTable CREATE TABLE dbo.Tmp_DbTable (SystemId tinyint NULL, TableId int NULL, ModifiedBy int NULL, TableDesc nvarchar(100) NULL, VirtualSql nvarchar(max) NULL, TblObjective nvarchar(500) NULL, ModifiedOn datetime NULL, LastSyncDt datetime NULL, MultiDesignDb char(1) NULL, VirtualTbl char(1) NULL, TableName varchar(50) NULL, PrevTblName varchar(20) NULL)') EXEC (' INSERT INTO dbo.Tmp_DbTable (SystemId, TableId, ModifiedBy, TableDesc, VirtualSql, TblObjective, ModifiedOn, LastSyncDt, MultiDesignDb, VirtualTbl, TableName, PrevTblName) SELECT convert(tinyint,SystemId), convert(int,TableId), convert(int,ModifiedBy), TableDesc, VirtualSql, TblObjective, ModifiedOn, LastSyncDt, MultiDesignDb, VirtualTbl, TableName, PrevTblName FROM dbo.DbTable IF (SELECT COUNT(1) FROM dbo.Tmp_DbTable) > 0 OR (SELECT COUNT(1) FROM dbo.DbTable) = 0 DROP TABLE dbo.DbTable') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.DbTable'')) CREATE TABLE dbo.DbTable (TableId Int IDENTITY NOT NULL, SystemId TinyInt NOT NULL, TableName VarChar(500) NOT NULL, TableDesc NVarChar(100) NOT NULL, MultiDesignDb Char(1) NOT NULL, VirtualTbl Char(1) NOT NULL, VirtualSql NVarChar(max) NULL, TblObjective NVarChar(500) NULL, PrevTblName VarChar(20) NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastSyncDt DateTime NULL, CONSTRAINT PK_DbTable PRIMARY KEY CLUSTERED (TableId))') EXEC (' ALTER TABLE dbo.DbTable ADD CONSTRAINT DF_DbTable_VirtualTbl DEFAULT (''N'') FOR VirtualTbl SET IDENTITY_INSERT dbo.DbTable ON INSERT INTO dbo.DbTable (TableId, SystemId, TableName, TableDesc, MultiDesignDb, VirtualTbl, VirtualSql, TblObjective, PrevTblName, ModifiedBy, ModifiedOn, LastSyncDt) SELECT TableId, SystemId, TableName, TableDesc, MultiDesignDb, VirtualTbl, VirtualSql, TblObjective, PrevTblName, ModifiedBy, ModifiedOn, LastSyncDt FROM dbo.Tmp_DbTable SET IDENTITY_INSERT dbo.DbTable OFF IF (SELECT COUNT(1) FROM dbo.DbTable) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_DbTable) = 0 DROP TABLE dbo.Tmp_DbTable ALTER TABLE dbo.DbColumn WITH NOCHECK ADD CONSTRAINT FK_DbColumn_DbTable FOREIGN KEY (TableId) REFERENCES dbo.DbTable (TableId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=6696&typ=N&sys=3","","",""); return false;
6697~@~   9.  65.51114:D:   10:*:*:M: Change table DbTable~@~9435~@~10~@~D~@~~@~~@~M~@~~@~Change table DbTable~@~Y~@~EXEC (' IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_DbColumn_DbTable'') ALTER TABLE dbo.DbColumn DROP CONSTRAINT FK_DbColumn_DbTable IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE name=''FK_DbKey_DbTable'') ALTER TABLE dbo.DbKey DROP CONSTRAINT FK_DbKey_DbTable CREATE TABLE dbo.Tmp_DbTable (SystemId tinyint NULL, TableId int NULL, ModifiedBy int NULL, TableDesc nvarchar(100) NULL, VirtualSql nvarchar(max) NULL, TblObjective nvarchar(500) NULL, ModifiedOn datetime NULL, LastSyncDt datetime NULL, MultiDesignDb char(1) NULL, VirtualTbl char(1) NULL, TableName varchar(500) NULL, PrevTblName varchar(20) NULL)') EXEC (' INSERT INTO dbo.Tmp_DbTable (SystemId, TableId, ModifiedBy, TableDesc, VirtualSql, TblObjective, ModifiedOn, LastSyncDt, MultiDesignDb, VirtualTbl, TableName, PrevTblName) SELECT convert(tinyint,SystemId), convert(int,TableId), convert(int,ModifiedBy), TableDesc, VirtualSql, TblObjective, ModifiedOn, LastSyncDt, MultiDesignDb, VirtualTbl, TableName, PrevTblName FROM dbo.DbTable IF (SELECT COUNT(1) FROM dbo.Tmp_DbTable) > 0 OR (SELECT COUNT(1) FROM dbo.DbTable) = 0 DROP TABLE dbo.DbTable') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.DbTable'')) CREATE TABLE dbo.DbTable (TableId Int IDENTITY NOT NULL, SystemId TinyInt NOT NULL, TableName VarChar(500) NOT NULL, TableDesc NVarChar(100) NOT NULL, MultiDesignDb Char(1) NOT NULL, VirtualTbl Char(1) NOT NULL, VirtualSql NVarChar(max) NULL, TblObjective NVarChar(500) NULL, PrevTblName VarChar(20) NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastSyncDt DateTime NULL, CONSTRAINT PK_DbTable PRIMARY KEY CLUSTERED (TableId))') EXEC (' ALTER TABLE dbo.DbTable ADD CONSTRAINT DF_DbTable_VirtualTbl DEFAULT (''N'') FOR VirtualTbl SET IDENTITY_INSERT dbo.DbTable ON INSERT INTO dbo.DbTable (TableId, SystemId, TableName, TableDesc, MultiDesignDb, VirtualTbl, VirtualSql, TblObjective, PrevTblName, ModifiedBy, ModifiedOn, LastSyncDt) SELECT TableId, SystemId, TableName, TableDesc, MultiDesignDb, VirtualTbl, VirtualSql, TblObjective, PrevTblName, ModifiedBy, ModifiedOn, LastSyncDt FROM dbo.Tmp_DbTable SET IDENTITY_INSERT dbo.DbTable OFF IF (SELECT COUNT(1) FROM dbo.DbTable) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_DbTable) = 0 DROP TABLE dbo.Tmp_DbTable ALTER TABLE dbo.DbColumn WITH NOCHECK ADD CONSTRAINT FK_DbColumn_DbTable FOREIGN KEY (TableId) REFERENCES dbo.DbTable (TableId) IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IU_DbTable'') CREATE UNIQUE NONCLUSTERED INDEX IU_DbTable ON dbo.DbTable(SystemId,TableName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=6697&typ=N&sys=3","","",""); return false;
6700~@~  10.   1.51229:D:   10:*:*:M: Change table ScreenObj~@~9441~@~10~@~D~@~~@~~@~M~@~~@~Change table ScreenObj~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenObj (DisplayModeId tinyint NULL, GroupRowId smallint NULL, GroupColId smallint NULL, ColumnSize smallint NULL, ColumnHeight smallint NULL, TabIndex smallint NULL, SortOrder smallint NULL, ScreenObjId int NULL, ScreenId int NULL, ColumnId int NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DdlAdnColumnId int NULL, DdlFtrColumnId int NULL, TabFolderId int NULL, DefaultValue nvarchar(200) NULL, HyperLinkUrl nvarchar(200) NULL, SystemValue nvarchar(200) NULL, MasterTable char(1) NULL, LabelVertical char(1) NULL, DefAfter char(1) NULL, DefAlways char(1) NULL, ColumnWrap char(1) NULL, GridGrpCd char(1) NULL, HideOnTablet char(1) NULL, HideOnMobile char(1) NULL, ColumnJustify char(1) NULL, AggregateCd char(1) NULL, GenerateSp char(1) NULL, RequiredValid char(1) NULL, RefreshOnCUD char(1) NULL, TrimOnEntry char(1) NULL, MatchCd char(1) NULL, IgnoreConfirm char(1) NULL, LabelCss varchar(1000) NULL, ContentCss varchar(1000) NULL, ColumnName varchar(50) NULL, ColumnDesc varchar(200) NULL, MaskValid varchar(100) NULL, RangeValidType varchar(50) NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, ColumnLink varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObj (DisplayModeId, GroupRowId, GroupColId, ColumnSize, ColumnHeight, TabIndex, SortOrder, ScreenObjId, ScreenId, ColumnId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, TabFolderId, DefaultValue, HyperLinkUrl, SystemValue, MasterTable, LabelVertical, DefAfter, DefAlways, ColumnWrap, GridGrpCd, HideOnTablet, HideOnMobile, ColumnJustify, AggregateCd, GenerateSp, RequiredValid, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm, LabelCss, ContentCss, ColumnName, ColumnDesc, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink) SELECT convert(tinyint,DisplayModeId), convert(smallint,GroupRowId), convert(smallint,GroupColId), convert(smallint,ColumnSize), convert(smallint,ColumnHeight), convert(smallint,TabIndex), convert(smallint,SortOrder), convert(int,ScreenObjId), convert(int,ScreenId), convert(int,ColumnId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), convert(int,DdlAdnColumnId), convert(int,DdlFtrColumnId), convert(int,TabFolderId), DefaultValue, HyperLinkUrl, SystemValue, MasterTable, LabelVertical, DefAfter, DefAlways, ColumnWrap, GridGrpCd, HideOnTablet, HideOnMobile, ColumnJustify, AggregateCd, GenerateSp, RequiredValid, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm, LabelCss, ContentCss, ColumnName, ColumnDesc, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObj'')) CREATE TABLE dbo.ScreenObj (ScreenObjId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, NewGroupRow Char(1) NOT NULL, GroupRowId SmallInt NOT NULL, GroupColId SmallInt NOT NULL, LabelVertical Char(1) NOT NULL, LabelCss VarChar(1000) NULL, ContentCss VarChar(1000) NULL, ColumnId Int NULL, ColumnName VarChar(50) NOT NULL, ColumnDesc VarChar(200) NULL, DefaultValue NVarChar(200) NULL, HyperLinkUrl NVarChar(200) NULL, DefAfter Char(1) NOT NULL, SystemValue NVarChar(200) NULL, DefAlways Char(1) NOT NULL, ColumnWrap Char(1) NOT NULL, GridGrpCd Char(1) NOT NULL, HideOnTablet Char(1) NOT NULL, HideOnMobile Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, ColumnHeight SmallInt NULL, DisplayModeId TinyInt NOT NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlAdnColumnId Int NULL, DdlFtrColumnId Int NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId Int NOT NULL, TabIndex SmallInt NOT NULL, SortOrder SmallInt NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(100) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(1000) NULL, RefreshOnCUD Char(1) NOT NULL, TrimOnEntry Char(1) NOT NULL, MatchCd Char(1) NULL, IgnoreConfirm Char(1) NOT NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))') EXEC (' ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_NewGroupRow DEFAULT (''N'') FOR NewGroupRow ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_GroupRowId DEFAULT (78) FOR GroupRowId ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_LabelVertical DEFAULT (''N'') FOR LabelVertical ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAfter DEFAULT (''N'') FOR DefAfter ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAlways DEFAULT (''N'') FOR DefAlways ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_GridGrpCd DEFAULT (''N'') FOR GridGrpCd ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_HideOnTablet DEFAULT (''N'') FOR HideOnTablet ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_HideOnMobile DEFAULT (''N'') FOR HideOnMobile ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_TrimOnEntry DEFAULT (''Y'') FOR TrimOnEntry ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_IgnoreConfirm DEFAULT (''Y'') FOR IgnoreConfirm SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, NewGroupRow, GroupRowId, GroupColId, LabelVertical, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, HyperLinkUrl, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, HideOnTablet, HideOnMobile, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm) SELECT ScreenObjId, ScreenId, MasterTable, ''N'', GroupRowId, GroupColId, LabelVertical, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, HyperLinkUrl, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, HideOnTablet, HideOnMobile, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=6700&typ=N&sys=3","","",""); return false;
7699~@~  10.   1.51229:D:   20:*:*:M: Change table CtViewType~@~9441~@~20~@~D~@~~@~~@~M~@~~@~Change table CtViewType~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtViewType'))
BEGIN
EXEC ('CREATE TABLE dbo.CtViewType (ViewTypeCd Char(1) NOT NULL, ViewTypeName NVarChar(30) NOT NULL, ViewTypeSort TinyInt NULL, CONSTRAINT PK_CtViewType PRIMARY KEY CLUSTERED (ViewTypeCd))')
EXEC ('INSERT dbo.CtViewType SELECT ''N'',''Not View Only'',10')
EXEC ('INSERT dbo.CtViewType SELECT ''Y'',''Everything View Only'',20')
EXEC ('INSERT dbo.CtViewType SELECT ''T'',''Tab-folder View Only'',30')
EXEC ('INSERT dbo.CtViewType SELECT ''G'',''Grid View Only'',40')
END
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7699&typ=N&sys=3","","",""); return false;
7701~@~  10.   2.51231:D:   10:*:*:M: Change table CtButtonHlp~@~9442~@~10~@~D~@~~@~~@~M~@~~@~Change table CtButtonHlp~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_CtButtonHlp (ButtonTypeId tinyint NULL, CultureId smallint NULL, ButtonHlpId int NULL, ButtonName nvarchar(20) NULL, ButtonToolTip nvarchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_CtButtonHlp (ButtonTypeId, CultureId, ButtonHlpId, ButtonName, ButtonToolTip) SELECT convert(tinyint,ButtonTypeId), convert(smallint,CultureId), convert(int,ButtonHlpId), ButtonName, ButtonToolTip FROM dbo.CtButtonHlp IF (SELECT COUNT(1) FROM dbo.Tmp_CtButtonHlp) > 0 OR (SELECT COUNT(1) FROM dbo.CtButtonHlp) = 0 DROP TABLE dbo.CtButtonHlp') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtButtonHlp'')) CREATE TABLE dbo.CtButtonHlp (ButtonHlpId Int IDENTITY NOT NULL, CultureId SmallInt NOT NULL, ButtonTypeId TinyInt NOT NULL, ButtonName NVarChar(20) NOT NULL, ButtonToolTip NVarChar(100) NOT NULL, CONSTRAINT PK_CtButtonHlp PRIMARY KEY CLUSTERED (ButtonHlpId, CultureId))') EXEC (' SET IDENTITY_INSERT dbo.CtButtonHlp ON INSERT INTO dbo.CtButtonHlp (ButtonHlpId, CultureId, ButtonTypeId, ButtonName, ButtonToolTip) SELECT ButtonHlpId, CultureId, ButtonTypeId, ButtonName, ButtonToolTip FROM dbo.Tmp_CtButtonHlp SET IDENTITY_INSERT dbo.CtButtonHlp OFF IF (SELECT COUNT(1) FROM dbo.CtButtonHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtButtonHlp) = 0 DROP TABLE dbo.Tmp_CtButtonHlp')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7701&typ=N&sys=3","","",""); return false;
7702~@~  10.   2.51231:D:   20:*:*:M: Change table ClientRule~@~9442~@~20~@~D~@~~@~~@~M~@~~@~Change table ClientRule~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_ClientRule (RuleTypeId tinyint NULL, CultureId smallint NULL, ClientScript smallint NULL, ClientRuleId int NULL, ScreenId int NULL, ReportId int NULL, ScreenObjHlpId int NULL, ScreenCriHlpId int NULL, ReportCriHlpId int NULL, RuleName nvarchar(100) NULL, RuleDesc nvarchar(150) NULL, RuleDescription nvarchar(500) NULL, UserScriptEvent varchar(50) NULL, UserScriptName varchar(500) NULL, ScriptParam varchar(300) NULL)') EXEC (' INSERT INTO dbo.Tmp_ClientRule (RuleTypeId, CultureId, ClientScript, ClientRuleId, ScreenId, ReportId, ScreenObjHlpId, ScreenCriHlpId, ReportCriHlpId, RuleName, RuleDesc, RuleDescription, UserScriptEvent, UserScriptName, ScriptParam) SELECT convert(tinyint,RuleTypeId), convert(smallint,CultureId), convert(smallint,ClientScript), convert(int,ClientRuleId), convert(int,ScreenId), convert(int,ReportId), convert(int,ScreenObjHlpId), convert(int,ScreenCriHlpId), convert(int,ReportCriHlpId), RuleName, RuleDesc, RuleDescription, UserScriptEvent, UserScriptName, ScriptParam FROM dbo.ClientRule IF (SELECT COUNT(1) FROM dbo.Tmp_ClientRule) > 0 OR (SELECT COUNT(1) FROM dbo.ClientRule) = 0 DROP TABLE dbo.ClientRule') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ClientRule'')) CREATE TABLE dbo.ClientRule (ClientRuleId Int IDENTITY NOT NULL, RuleTypeId TinyInt NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, ScreenId Int NULL, ReportId Int NULL, CultureId SmallInt NOT NULL, ScreenObjHlpId Int NULL, ScreenCriHlpId Int NULL, ReportCriHlpId Int NULL, ClientScript SmallInt NULL, UserScriptEvent VarChar(50) NULL, UserScriptName VarChar(500) NULL, ScriptParam VarChar(300) NULL, ClientRuleProg NVarChar(max) NULL, CONSTRAINT PK_ClientRule PRIMARY KEY CLUSTERED (ClientRuleId, CultureId))') EXEC (' SET IDENTITY_INSERT dbo.ClientRule ON INSERT INTO dbo.ClientRule (ClientRuleId, RuleTypeId, RuleName, RuleDesc, RuleDescription, ScreenId, ReportId, CultureId, ScreenObjHlpId, ScreenCriHlpId, ReportCriHlpId, ClientScript, UserScriptEvent, UserScriptName, ScriptParam) SELECT ClientRuleId, RuleTypeId, RuleName, RuleDesc, RuleDescription, ScreenId, ReportId, CultureId, ScreenObjHlpId, ScreenCriHlpId, ReportCriHlpId, ClientScript, UserScriptEvent, UserScriptName, ScriptParam FROM dbo.Tmp_ClientRule SET IDENTITY_INSERT dbo.ClientRule OFF IF (SELECT COUNT(1) FROM dbo.ClientRule) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ClientRule) = 0 DROP TABLE dbo.Tmp_ClientRule')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7702&typ=N&sys=3","","",""); return false;
7703~@~  10.   6.60113:D:   10:*:*:M: Change table RuleTier~@~9446~@~10~@~D~@~~@~~@~M~@~~@~Change table RuleTier~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_RuleTier (RuleTierId tinyint NULL, EntityId int NULL, RuleTierName nvarchar(50) NULL, LanguageCd char(1) NULL, FrameworkCd char(1) NULL, IsDefault char(1) NULL, DevProgramPath varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_RuleTier (RuleTierId, EntityId, RuleTierName, LanguageCd, FrameworkCd, IsDefault, DevProgramPath) SELECT convert(tinyint,RuleTierId), convert(int,EntityId), RuleTierName, LanguageCd, FrameworkCd, IsDefault, DevProgramPath FROM dbo.RuleTier IF (SELECT COUNT(1) FROM dbo.Tmp_RuleTier) > 0 OR (SELECT COUNT(1) FROM dbo.RuleTier) = 0 DROP TABLE dbo.RuleTier') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RuleTier'')) CREATE TABLE dbo.RuleTier (RuleTierId TinyInt IDENTITY NOT NULL, RuleTierName NVarChar(50) NOT NULL, EntityId Int NOT NULL, LanguageCd Char(1) NOT NULL, FrameworkCd Char(1) NOT NULL, DevProgramPath VarChar(100) NOT NULL, IsDefault Char(1) NOT NULL, CONSTRAINT PK_RuleTier PRIMARY KEY CLUSTERED (RuleTierId))') EXEC (' SET IDENTITY_INSERT dbo.RuleTier ON INSERT INTO dbo.RuleTier (RuleTierId, RuleTierName, EntityId, LanguageCd, FrameworkCd, DevProgramPath, IsDefault) SELECT RuleTierId, RuleTierName, EntityId, LanguageCd, FrameworkCd, DevProgramPath, IsDefault FROM dbo.Tmp_RuleTier SET IDENTITY_INSERT dbo.RuleTier OFF IF (SELECT COUNT(1) FROM dbo.RuleTier) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_RuleTier) = 0 DROP TABLE dbo.Tmp_RuleTier')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7703&typ=N&sys=3","","",""); return false;
7704~@~  10.   6.60113:D:   20:*:*:M: Change table ClientTier~@~9446~@~20~@~D~@~~@~~@~M~@~~@~Change table ClientTier~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_ClientTier (ClientTierId tinyint NULL, EntityId int NULL, ClientTierName nvarchar(50) NULL, LanguageCd char(1) NULL, FrameworkCd char(1) NULL, CombineAsm char(1) NULL, IsDefault char(1) NULL, DevProgramPath varchar(100) NULL, WsProgramPath varchar(100) NULL, XlsProgramPath varchar(100) NULL, DevCompilePath varchar(100) NULL, WsCompilePath varchar(100) NULL, XlsCompilePath varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_ClientTier (ClientTierId, EntityId, ClientTierName, LanguageCd, FrameworkCd, CombineAsm, IsDefault, DevProgramPath, WsProgramPath, XlsProgramPath, DevCompilePath, WsCompilePath, XlsCompilePath) SELECT convert(tinyint,ClientTierId), convert(int,EntityId), ClientTierName, LanguageCd, FrameworkCd, CombineAsm, IsDefault, DevProgramPath, WsProgramPath, XlsProgramPath, DevCompilePath, WsCompilePath, XlsCompilePath FROM dbo.ClientTier IF (SELECT COUNT(1) FROM dbo.Tmp_ClientTier) > 0 OR (SELECT COUNT(1) FROM dbo.ClientTier) = 0 DROP TABLE dbo.ClientTier') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ClientTier'')) CREATE TABLE dbo.ClientTier (ClientTierId TinyInt IDENTITY NOT NULL, ClientTierName NVarChar(50) NOT NULL, EntityId Int NOT NULL, LanguageCd Char(1) NOT NULL, FrameworkCd Char(1) NOT NULL, DevProgramPath VarChar(100) NOT NULL, WsProgramPath VarChar(100) NULL, XlsProgramPath VarChar(100) NULL, DevCompilePath VarChar(100) NULL, WsCompilePath VarChar(100) NULL, XlsCompilePath VarChar(100) NULL, CombineAsm Char(1) NOT NULL, IsDefault Char(1) NOT NULL, CONSTRAINT PK_ClientTier PRIMARY KEY CLUSTERED (ClientTierId))') EXEC (' ALTER TABLE dbo.ClientTier ADD CONSTRAINT DF_ClientTier_CombineAsm DEFAULT (''N'') FOR CombineAsm SET IDENTITY_INSERT dbo.ClientTier ON INSERT INTO dbo.ClientTier (ClientTierId, ClientTierName, EntityId, LanguageCd, FrameworkCd, DevProgramPath, WsProgramPath, XlsProgramPath, DevCompilePath, WsCompilePath, XlsCompilePath, CombineAsm, IsDefault) SELECT ClientTierId, ClientTierName, EntityId, LanguageCd, FrameworkCd, DevProgramPath, WsProgramPath, XlsProgramPath, DevCompilePath, WsCompilePath, XlsCompilePath, CombineAsm, IsDefault FROM dbo.Tmp_ClientTier SET IDENTITY_INSERT dbo.ClientTier OFF IF (SELECT COUNT(1) FROM dbo.ClientTier) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ClientTier) = 0 DROP TABLE dbo.Tmp_ClientTier')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7704&typ=N&sys=3","","",""); return false;
7705~@~  10.   6.60113:D:   30:*:*:M: Change table DataTier~@~9446~@~30~@~D~@~~@~~@~M~@~~@~Change table DataTier~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_DataTier (DataTierId tinyint NULL, EntityId smallint NULL, DataTierName nvarchar(50) NULL, DbProviderCd char(1) NULL, IsDevelopment char(1) NULL, IsDefault char(1) NULL, ServerName varchar(20) NULL, DesServer varchar(20) NULL, DesDatabase varchar(20) NULL, DesUserId varchar(50) NULL, DesPassword varchar(50) NULL, PortBinPath varchar(100) NULL, InstBinPath varchar(100) NULL, ScriptPath varchar(100) NULL, DbDataPath varchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_DataTier (DataTierId, EntityId, DataTierName, DbProviderCd, IsDevelopment, IsDefault, ServerName, DesServer, DesDatabase, DesUserId, DesPassword, PortBinPath, InstBinPath, ScriptPath, DbDataPath) SELECT convert(tinyint,DataTierId), convert(smallint,EntityId), DataTierName, DbProviderCd, IsDevelopment, IsDefault, ServerName, DesServer, DesDatabase, DesUserId, DesPassword, PortBinPath, InstBinPath, ScriptPath, DbDataPath FROM dbo.DataTier IF (SELECT COUNT(1) FROM dbo.Tmp_DataTier) > 0 OR (SELECT COUNT(1) FROM dbo.DataTier) = 0 DROP TABLE dbo.DataTier') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.DataTier'')) CREATE TABLE dbo.DataTier (DataTierId TinyInt IDENTITY NOT NULL, DataTierName NVarChar(50) NOT NULL, EntityId Int NOT NULL, DbProviderCd Char(1) NOT NULL, ServerName VarChar(20) NOT NULL, DesServer VarChar(20) NOT NULL, DesDatabase VarChar(20) NOT NULL, DesUserId VarChar(50) NOT NULL, DesPassword VarChar(50) NOT NULL, PortBinPath VarChar(100) NOT NULL, InstBinPath VarChar(100) NOT NULL, ScriptPath VarChar(100) NOT NULL, DbDataPath VarChar(100) NOT NULL, IsDevelopment Char(1) NOT NULL, IsDefault Char(1) NOT NULL, CONSTRAINT PK_DataTier PRIMARY KEY CLUSTERED (DataTierId))') EXEC (' SET IDENTITY_INSERT dbo.DataTier ON INSERT INTO dbo.DataTier (DataTierId, DataTierName, EntityId, DbProviderCd, ServerName, DesServer, DesDatabase, DesUserId, DesPassword, PortBinPath, InstBinPath, ScriptPath, DbDataPath, IsDevelopment, IsDefault) SELECT DataTierId, DataTierName, CONVERT(Int,EntityId), DbProviderCd, ServerName, DesServer, DesDatabase, DesUserId, DesPassword, PortBinPath, InstBinPath, ScriptPath, DbDataPath, IsDevelopment, IsDefault FROM dbo.Tmp_DataTier SET IDENTITY_INSERT dbo.DataTier OFF IF (SELECT COUNT(1) FROM dbo.DataTier) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_DataTier) = 0 DROP TABLE dbo.Tmp_DataTier')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7705&typ=N&sys=3","","",""); return false;
7706~@~  10.  12.60213:D:   10:*:*:M: Change table AppItem~@~9452~@~10~@~D~@~~@~~@~M~@~~@~Change table AppItem~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_AppItem (ItemOrder smallint NULL, AppItemId int NULL, AppInfoId int NULL, ScreenId int NULL, ReportId int NULL, WizardId int NULL, CustomId int NULL, AppItemCode nvarchar(max) NULL, ObjectTypeCd char(1) NULL, LanguageCd char(1) NULL, FrameworkCd char(1) NULL, DbProviderCd char(1) NULL, MultiDesignDb char(1) NULL, RemoveItem char(1) NULL, AppItemDesc varchar(200) NULL, RelativePath varchar(100) NULL, AppItemName varchar(50) NULL, AppItemLink varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_AppItem (ItemOrder, AppItemId, AppInfoId, ScreenId, ReportId, WizardId, CustomId, AppItemCode, ObjectTypeCd, LanguageCd, FrameworkCd, DbProviderCd, MultiDesignDb, RemoveItem, AppItemDesc, RelativePath, AppItemName, AppItemLink) SELECT convert(smallint,ItemOrder), convert(int,AppItemId), convert(int,AppInfoId), convert(int,ScreenId), convert(int,ReportId), convert(int,WizardId), convert(int,CustomId), AppItemCode, ObjectTypeCd, LanguageCd, FrameworkCd, DbProviderCd, MultiDesignDb, RemoveItem, AppItemDesc, RelativePath, AppItemName, AppItemLink FROM dbo.AppItem IF (SELECT COUNT(1) FROM dbo.Tmp_AppItem) > 0 OR (SELECT COUNT(1) FROM dbo.AppItem) = 0 DROP TABLE dbo.AppItem') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AppItem'')) CREATE TABLE dbo.AppItem (AppItemId Int IDENTITY NOT NULL, AppItemDesc VarChar(200) NULL, AppInfoId Int NOT NULL, ItemOrder SmallInt NULL, ObjectTypeCd Char(1) NOT NULL, LanguageCd Char(1) NULL, FrameworkCd Char(1) NULL, DbProviderCd Char(1) NULL, RelativePath VarChar(100) NULL, AppItemName VarChar(50) NOT NULL, MultiDesignDb Char(1) NOT NULL, AppItemCode NVarChar(max) NULL, RemoveItem Char(1) NOT NULL, ScreenId Int NULL, ReportId Int NULL, WizardId Int NULL, CustomId Int NULL, AppItemLink VarChar(200) NULL, CONSTRAINT PK_AppItem PRIMARY KEY CLUSTERED (AppItemId))') EXEC (' SET IDENTITY_INSERT dbo.AppItem ON INSERT INTO dbo.AppItem (AppItemId, AppItemDesc, AppInfoId, ItemOrder, ObjectTypeCd, LanguageCd, FrameworkCd, DbProviderCd, RelativePath, AppItemName, MultiDesignDb, AppItemCode, RemoveItem, ScreenId, ReportId, WizardId, CustomId, AppItemLink) SELECT AppItemId, AppItemDesc, AppInfoId, ItemOrder, ObjectTypeCd, LanguageCd, FrameworkCd, DbProviderCd, RelativePath, AppItemName, MultiDesignDb, AppItemCode, RemoveItem, ScreenId, ReportId, WizardId, CustomId, AppItemLink FROM dbo.Tmp_AppItem SET IDENTITY_INSERT dbo.AppItem OFF IF (SELECT COUNT(1) FROM dbo.AppItem) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AppItem) = 0 DROP TABLE dbo.Tmp_AppItem')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7706&typ=N&sys=3","","",""); return false;
7707~@~  10.  13.60306:D:   10:*:*:M: Change table CtRuleCntType~@~10452~@~10~@~D~@~~@~~@~M~@~~@~Change table CtRuleCntType~@~N~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtRuleCntType'')) DROP TABLE dbo.CtRuleCntType')
EXEC ('CREATE TABLE dbo.CtRuleCntType (RuleCntTypeId TinyInt NOT NULL, RuleCntTypeName NVarChar(50) NOT NULL, RuleCntTypeEvent VarChar(20) NOT NULL, RuleCntTypeDesc NVarChar(1000) NOT NULL, CONSTRAINT PK_CtRuleCntType PRIMARY KEY CLUSTERED (RuleCntTypeId))')
EXEC ('INSERT dbo.CtRuleCntType SELECT 1,''CSS'',''css'',''Embed the following inline CSS on page load.''')
EXEC ('INSERT dbo.CtRuleCntType SELECT 2,''JavaScript'',''js'',''Embed the following JavaScript on page load.''')
EXEC ('INSERT dbo.CtRuleCntType SELECT 3,''CSS Link'',''css_link'',''Include the following CSS library URL on page load.''')
EXEC ('INSERT dbo.CtRuleCntType SELECT 4,''JavaScript Link'',''js_link'',''Include the following JavaScript library URL on page load.''')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7707&typ=N&sys=3","","",""); return false;
7708~@~  10.  13.60306:D:   20:*:*:M: Change table CtRuleMethod~@~10452~@~20~@~D~@~~@~~@~M~@~~@~Change table CtRuleMethod~@~N~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtRuleMethod'')) DROP TABLE dbo.CtRuleMethod')
EXEC ('CREATE TABLE dbo.CtRuleMethod (RuleMethodId TinyInt NOT NULL, RuleMethodName NVarChar(50) NOT NULL, RuleMethodDesc NVarChar(1000) NOT NULL, CONSTRAINT PK_CtRuleMethod PRIMARY KEY CLUSTERED (RuleMethodId))')
EXEC ('INSERT dbo.CtRuleMethod SELECT 1,''Embedded CSS/JS'',''Embed CSS or JavaScript on page load.''')
EXEC ('INSERT dbo.CtRuleMethod SELECT 2,''Screen Column Stock Script'',''Execute a predefined JavaScript function on a specified screen column.''')
EXEC ('INSERT dbo.CtRuleMethod SELECT 3,''Screen Column Event Override'',''Override a default JavaScript event with speific JavaScript content on a specified screen column.''')
EXEC ('INSERT dbo.CtRuleMethod SELECT 4,''Screen Criteria Stock Script'',''Execute a predefined JavaScript function on a specified screen criteria.''')
EXEC ('INSERT dbo.CtRuleMethod SELECT 5,''Screen Criteria Event Override'',''Override a default JavaScript event with speific JavaScript content on a specified screen criteria.''')
EXEC ('INSERT dbo.CtRuleMethod SELECT 6,''Report Criteria Stock Script'',''Execute a predefined JavaScript function on a specified report criteria.''')
EXEC ('INSERT dbo.CtRuleMethod SELECT 7,''Report Criteria Event Override'',''Override a default JavaScript event with speific JavaScript content on a specified report criteria.''')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7708&typ=N&sys=3","","",""); return false;
7709~@~  10.  13.60306:D:   30:*:*:M: Change table ClientRule~@~10452~@~30~@~D~@~~@~~@~M~@~~@~Change table ClientRule~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_ClientRule (RuleTypeId tinyint NULL, CultureId smallint NULL, ClientScript smallint NULL, ClientRuleId int NULL, ScreenId int NULL, ReportId int NULL, ScreenObjHlpId int NULL, ScreenCriHlpId int NULL, ReportCriHlpId int NULL, RuleName nvarchar(100) NULL, RuleDesc nvarchar(150) NULL, RuleDescription nvarchar(500) NULL, ClientRuleProg nvarchar(max) NULL, UserScriptEvent varchar(50) NULL, UserScriptName varchar(500) NULL, ScriptParam varchar(300) NULL)') EXEC (' INSERT INTO dbo.Tmp_ClientRule (RuleTypeId, CultureId, ClientScript, ClientRuleId, ScreenId, ReportId, ScreenObjHlpId, ScreenCriHlpId, ReportCriHlpId, RuleName, RuleDesc, RuleDescription, ClientRuleProg, UserScriptEvent, UserScriptName, ScriptParam) SELECT convert(tinyint,RuleTypeId), convert(smallint,CultureId), convert(smallint,ClientScript), convert(int,ClientRuleId), convert(int,ScreenId), convert(int,ReportId), convert(int,ScreenObjHlpId), convert(int,ScreenCriHlpId), convert(int,ReportCriHlpId), RuleName, RuleDesc, RuleDescription, ClientRuleProg, UserScriptEvent, UserScriptName, ScriptParam FROM dbo.ClientRule IF (SELECT COUNT(1) FROM dbo.Tmp_ClientRule) > 0 OR (SELECT COUNT(1) FROM dbo.ClientRule) = 0 DROP TABLE dbo.ClientRule') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ClientRule'')) CREATE TABLE dbo.ClientRule (ClientRuleId Int IDENTITY NOT NULL, RuleTypeId TinyInt NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, RuleMethodId TinyInt NOT NULL, ScreenId Int NULL, ReportId Int NULL, CultureId SmallInt NOT NULL, ScreenObjHlpId Int NULL, ScreenCriHlpId Int NULL, ReportCriHlpId Int NULL, ClientScript SmallInt NULL, UserScriptEvent VarChar(50) NULL, UserScriptName NVarChar(1000) NULL, ScriptParam NVarChar(500) NULL, RuleCntTypeId TinyInt NULL, ClientRuleProg NVarChar(max) NULL, CONSTRAINT PK_ClientRule PRIMARY KEY CLUSTERED (ClientRuleId, CultureId))') EXEC (' ALTER TABLE dbo.ClientRule ADD CONSTRAINT DF_ClientRule_RuleMethodId DEFAULT (1) FOR RuleMethodId SET IDENTITY_INSERT dbo.ClientRule ON INSERT INTO dbo.ClientRule (ClientRuleId, RuleTypeId, RuleName, RuleDesc, RuleDescription, RuleMethodId, ScreenId, ReportId, CultureId, ScreenObjHlpId, ScreenCriHlpId, ReportCriHlpId, ClientScript, UserScriptEvent, UserScriptName, ScriptParam, ClientRuleProg) SELECT ClientRuleId, RuleTypeId, RuleName, RuleDesc, RuleDescription, 1, ScreenId, ReportId, CultureId, ScreenObjHlpId, ScreenCriHlpId, ReportCriHlpId, ClientScript, UserScriptEvent, CONVERT(NVarChar(1000),UserScriptName), CONVERT(NVarChar(500),ScriptParam), ClientRuleProg FROM dbo.Tmp_ClientRule SET IDENTITY_INSERT dbo.ClientRule OFF IF (SELECT COUNT(1) FROM dbo.ClientRule) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ClientRule) = 0 DROP TABLE dbo.Tmp_ClientRule')

EXEC ('UPDATE dbo.ClientRule SET RuleMethodId = 6 WHERE ReportCriHlpId is not null AND ClientScript is not null')
EXEC ('UPDATE dbo.ClientRule SET RuleMethodId = 7 WHERE ReportCriHlpId is not null AND ClientScript is null')
EXEC ('UPDATE dbo.ClientRule SET RuleMethodId = 4 WHERE ScreenCriHlpId is not null AND ClientScript is not null')
EXEC ('UPDATE dbo.ClientRule SET RuleMethodId = 5 WHERE ScreenCriHlpId is not null AND ClientScript is null')
EXEC ('UPDATE dbo.ClientRule SET RuleMethodId = 2 WHERE ScreenObjHlpId is not null AND ClientScript is not null')
EXEC ('UPDATE dbo.ClientRule SET RuleMethodId = 3 WHERE ScreenObjHlpId is not null AND ClientScript is null')

EXEC ('UPDATE dbo.ScreenObjHlp SET ScreenObjHlpDesc = b.ColumnDesc + '' ('' + c.CultureTypeName + '')''
	FROM dbo.ScreenObjHlp a
	INNER JOIN dbo.ScreenObj b ON a.ScreenObjId = b.ScreenObjId
	INNER JOIN [[?]]Design.dbo.VwCulture c ON a.CultureId = c.CultureId')
EXEC ('UPDATE dbo.ScreenCriHlp SET ScreenCriHlpDesc = b.ScreenCriDesc + '' ('' + c.CultureTypeName + '')''
	FROM dbo.ScreenCriHlp a
	INNER JOIN dbo.ScreenCri b ON a.ScreenCriId = b.ScreenCriId
	INNER JOIN [[?]]Design.dbo.VwCulture c ON a.CultureId = c.CultureId')
EXEC ('UPDATE dbo.ReportCriHlp SET ReportCriHlpDesc = b.ReportCriDesc + '' ('' + c.CultureTypeName + '')''
	FROM dbo.ReportCriHlp a
	INNER JOIN dbo.ReportCri b ON a.ReportCriId = b.ReportCriId
	INNER JOIN [[?]]Design.dbo.VwCulture c ON a.CultureId = c.CultureId')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7709&typ=N&sys=3","","",""); return false;
7710~@~  10.  16.60327:D:   10:*:*:M: Remove redundant FK~@~10455~@~10~@~D~@~~@~~@~M~@~~@~Remove redundant FK~@~Y~@~EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.FK_DbColumn_DbTable'')) ALTER TABLE dbo.DbColumn DROP CONSTRAINT FK_DbColumn_DbTable')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.FK_MenuHlp_Menu'')) ALTER TABLE dbo.MenuHlp DROP CONSTRAINT FK_MenuHlp_Menu')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.FK_MsgCenter_Msg'')) ALTER TABLE dbo.MsgCenter DROP CONSTRAINT FK_MsgCenter_Msg')
EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.FK_WizardObj_Wizard'')) ALTER TABLE dbo.WizardObj DROP CONSTRAINT FK_WizardObj_Wizard')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7710&typ=N&sys=3","","",""); return false;
7711~@~  10.  20.60608:D:   30:*:*:M: Update message center~@~10459~@~30~@~D~@~~@~~@~M~@~~@~Update message center~@~Y~@~EXEC ('UPDATE a SET a.MsgName = LEFT(''{'' + CONVERT(varchar(10),a.MsgId) + ''} '' + b.Msg,500) FROM dbo.Msg a INNER JOIN dbo.MsgCenter b ON a.MsgId = b.MsgId AND b.CultureId = 1')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7711&typ=N&sys=3","","",""); return false;
7712~@~  10.  20.60608:D:   40:*:*:M: Change table Usr~@~10459~@~40~@~D~@~~@~~@~M~@~~@~Change table Usr~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_Usr (DefSystemId tinyint NULL, FailedAttempt tinyint NULL, FailedAttemptFP tinyint NULL, HintQuestionId tinyint NULL, CultureId smallint NULL, PwdNoRepeat smallint NULL, PwdDuration smallint NULL, PwdWarn smallint NULL, UsrId int NULL, InvestorId int NULL, CustomerId int NULL, VendorId int NULL, AgentId int NULL, BrokerId int NULL, MemberId int NULL, DefProjectId int NULL, DefCompanyId int NULL, UsrPassword varbinary(32) NULL, ConfirmPwd varbinary(32) NULL, ExtPassword varbinary(255) NULL, PicMed varbinary(max) NULL, LoginName nvarchar(32) NULL, UsrEmail nvarchar(50) NULL, UsrName nvarchar(50) NULL, HintAnswer nvarchar(50) NULL, LastFailedDt datetime NULL, LastSuccessDt datetime NULL, LastPwdChgDt datetime NULL, ModifiedOn datetime NULL, InternalUsr char(1) NULL, TechnicalUsr char(1) NULL, Active char(1) NULL, IPAlert char(1) NULL, UsrGroupLs varchar(1000) NULL, CompanyLs varchar(1000) NULL, ProjectLs varchar(1000) NULL, UsrImprLink varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_Usr (DefSystemId, FailedAttempt, FailedAttemptFP, HintQuestionId, CultureId, PwdNoRepeat, PwdDuration, PwdWarn, UsrId, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefProjectId, DefCompanyId, UsrPassword, ConfirmPwd, ExtPassword, PicMed, LoginName, UsrEmail, UsrName, HintAnswer, LastFailedDt, LastSuccessDt, LastPwdChgDt, ModifiedOn, InternalUsr, TechnicalUsr, Active, IPAlert, UsrGroupLs, CompanyLs, ProjectLs, UsrImprLink) SELECT convert(tinyint,DefSystemId), convert(tinyint,FailedAttempt), convert(tinyint,FailedAttemptFP), convert(tinyint,HintQuestionId), convert(smallint,CultureId), convert(smallint,PwdNoRepeat), convert(smallint,PwdDuration), convert(smallint,PwdWarn), convert(int,UsrId), convert(int,InvestorId), convert(int,CustomerId), convert(int,VendorId), convert(int,AgentId), convert(int,BrokerId), convert(int,MemberId), convert(int,DefProjectId), convert(int,DefCompanyId), UsrPassword, ConfirmPwd, ExtPassword, PicMed, LoginName, UsrEmail, UsrName, HintAnswer, LastFailedDt, LastSuccessDt, LastPwdChgDt, ModifiedOn, InternalUsr, TechnicalUsr, Active, IPAlert, UsrGroupLs, CompanyLs, ProjectLs, UsrImprLink FROM dbo.Usr IF (SELECT COUNT(1) FROM dbo.Tmp_Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Usr) = 0 DROP TABLE dbo.Usr') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Usr'')) CREATE TABLE dbo.Usr (UsrId Int IDENTITY NOT NULL, LoginName NVarChar(32) NOT NULL, UsrEmail NVarChar(50) NULL, UsrName NVarChar(50) NULL, UsrPassword VarBinary(32) NULL, ConfirmPwd VarBinary(32) NULL, ExtPassword VarBinary(255) NULL, CultureId SmallInt NOT NULL, InternalUsr Char(1) NOT NULL, TechnicalUsr Char(1) NOT NULL, UsrGroupLs VarChar(1000) NOT NULL, CompanyLs VarChar(1000) NULL, ProjectLs VarChar(1000) NULL, InvestorId Int NULL, CustomerId Int NULL, VendorId Int NULL, AgentId Int NULL, BrokerId Int NULL, MemberId Int NULL, DefSystemId TinyInt NOT NULL, DefProjectId Int NULL, DefCompanyId Int NULL, FailedAttempt TinyInt NULL, FailedAttemptFP TinyInt NULL, LastFailedDt DateTime NULL, LastSuccessDt DateTime NULL, LastPwdChgDt DateTime NULL, HintQuestionId TinyInt NULL, HintAnswer NVarChar(50) NULL, Active Char(1) NOT NULL, ModifiedOn DateTime NOT NULL, UsrImprLink VarChar(200) NULL, IPAlert Char(1) NOT NULL, PwdNoRepeat SmallInt NOT NULL, PwdDuration SmallInt NOT NULL, PwdWarn SmallInt NOT NULL, PicMed VarBinary(max) NULL, OTPSecret VarChar(64) NULL, TwoFactorAuth Char(1) NOT NULL, CONSTRAINT PK_Usr PRIMARY KEY CLUSTERED (UsrId, CultureId))') EXEC (' ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_CultureId DEFAULT (1) FOR CultureId ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_InternalUsr DEFAULT (''N'') FOR InternalUsr ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_TechnicalUsr DEFAULT (''N'') FOR TechnicalUsr ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_IPAlert DEFAULT (''N'') FOR IPAlert ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdNoRepeat DEFAULT (1) FOR PwdNoRepeat ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdDuration DEFAULT (9999) FOR PwdDuration ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdWarn DEFAULT (0) FOR PwdWarn ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_TwoFactorAuth DEFAULT (''N'') FOR TwoFactorAuth SET IDENTITY_INSERT dbo.Usr ON INSERT INTO dbo.Usr (UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, LastPwdChgDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink, IPAlert, PwdNoRepeat, PwdDuration, PwdWarn, PicMed, TwoFactorAuth) SELECT UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, LastPwdChgDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink, IPAlert, PwdNoRepeat, PwdDuration, PwdWarn, PicMed, ''N'' FROM dbo.Tmp_Usr SET IDENTITY_INSERT dbo.Usr OFF IF (SELECT COUNT(1) FROM dbo.Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Usr) = 0 DROP TABLE dbo.Tmp_Usr IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IU_Usr'') CREATE UNIQUE NONCLUSTERED INDEX IU_Usr ON dbo.Usr(LoginName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7712&typ=N&sys=3","","",""); return false;
7713~@~  10.  20.60608:D:   20:*:*:M: Change table Msg~@~10459~@~20~@~D~@~~@~~@~M~@~~@~Change table Msg~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Msg (MsgId int NULL, MsgName nvarchar(200) NULL, MsgTypeCd char(1) NULL, MsgSource varchar(50) NULL)') EXEC (' INSERT INTO dbo.Tmp_Msg (MsgId, MsgName, MsgTypeCd, MsgSource) SELECT convert(int,MsgId), MsgName, MsgTypeCd, MsgSource FROM dbo.Msg IF (SELECT COUNT(1) FROM dbo.Tmp_Msg) > 0 OR (SELECT COUNT(1) FROM dbo.Msg) = 0 DROP TABLE dbo.Msg') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Msg'')) CREATE TABLE dbo.Msg (MsgId Int IDENTITY NOT NULL, MsgTypeCd Char(1) NOT NULL, MsgSource VarChar(50) NOT NULL, MsgName NVarChar(500) NOT NULL, CONSTRAINT PK_Msg PRIMARY KEY CLUSTERED (MsgId))') EXEC (' SET IDENTITY_INSERT dbo.Msg ON INSERT INTO dbo.Msg (MsgId, MsgTypeCd, MsgSource, MsgName) SELECT MsgId, MsgTypeCd, MsgSource, MsgName FROM dbo.Tmp_Msg SET IDENTITY_INSERT dbo.Msg OFF IF (SELECT COUNT(1) FROM dbo.Msg) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Msg) = 0 DROP TABLE dbo.Tmp_Msg')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7713&typ=N&sys=3","","",""); return false;
7714~@~  10.  20.60608:D:   10:*:*:M: Create function to satisfy dependencies~@~10459~@~10~@~D~@~~@~~@~M~@~~@~Create function to satisfy dependencies~@~N~@~EXEC ('IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(''dbo.SplitStrings_XML'') AND type=''IF'') DROP FUNCTION dbo.SplitStrings_XML')
EXEC ('CREATE FUNCTION [dbo].[SplitStrings_XML]
(
   @List       NVARCHAR(MAX),
   @Delimiter  NVARCHAR(255)
)
RETURNS TABLE
AS
   RETURN 
   (  
      SELECT Item = REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(y.i.value(''(./text())[1]'', ''nvarchar(4000)''),''&quot;'',''"''),''&apos;'',''''''''),''&lt;'',''<''),''&gt;'',''>''),''&amp;'',''&'')
		,Pos = ROW_NUMBER() OVER (ORDER BY (SELECT 1))
      FROM 
      ( 
        SELECT x = CONVERT(XML, 
			''<i>''
			+ 
			REPLACE(
			REPLACE(REPLACE(REPLACE(REPLACE( 
            REPLACE(@List,''"'',''&quot;''),'''''''',''&apos;''),''<'',''&lt;''),''>'',''&gt;''),''&'',''&amp;'')
            ,@Delimiter,''</i><i>'')
          + ''</i>'').query(''.'')
      ) AS a CROSS APPLY x.nodes(''i'') AS y(i)
   );
')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7714&typ=N&sys=3","","",""); return false;
7715~@~  10.  26.60726:D:   10:*:*:M: Change table ColOvrd~@~10465~@~10~@~D~@~~@~~@~M~@~~@~Change table ColOvrd~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_ColOvrd (PermKeyId smallint NULL, Priority smallint NULL, ColOvrdId int NULL, ScreenObjId int NULL, ScreenId int NULL, PermId int NULL, ToolTip nvarchar(200) NULL, ColumnHeader nvarchar(50) NULL, ErrMessage nvarchar(300) NULL, ColVisible char(1) NULL, ColReadOnly char(1) NULL, ColExport char(1) NULL, ColOvrdDesc varchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_ColOvrd (PermKeyId, Priority, ColOvrdId, ScreenObjId, ScreenId, PermId, ToolTip, ColumnHeader, ErrMessage, ColVisible, ColReadOnly, ColExport, ColOvrdDesc) SELECT convert(smallint,PermKeyId), convert(smallint,Priority), convert(int,ColOvrdId), convert(int,ScreenObjId), convert(int,ScreenId), convert(int,PermId), ToolTip, ColumnHeader, ErrMessage, ColVisible, ColReadOnly, ColExport, ColOvrdDesc FROM dbo.ColOvrd IF (SELECT COUNT(1) FROM dbo.Tmp_ColOvrd) > 0 OR (SELECT COUNT(1) FROM dbo.ColOvrd) = 0 DROP TABLE dbo.ColOvrd') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ColOvrd'')) CREATE TABLE dbo.ColOvrd (ColOvrdId Int IDENTITY NOT NULL, ColOvrdDesc VarChar(200) NULL, ScreenObjId Int NOT NULL, ScreenId Int NULL, ColVisible Char(1) NOT NULL, ColReadOnly Char(1) NOT NULL, ColExport Char(1) NOT NULL, ToolTip NVarChar(200) NULL, ColumnHeader NVarChar(50) NULL, ErrMessage NVarChar(300) NULL, PermKeyId SmallInt NULL, PermId Int NULL, Priority SmallInt NULL, PermKeyRowId Int NULL, CONSTRAINT PK_ColOvrd PRIMARY KEY CLUSTERED (ColOvrdId))') EXEC (' SET IDENTITY_INSERT dbo.ColOvrd ON INSERT INTO dbo.ColOvrd (ColOvrdId, ColOvrdDesc, ScreenObjId, ScreenId, ColVisible, ColReadOnly, ColExport, ToolTip, ColumnHeader, ErrMessage, PermKeyId, PermId, Priority) SELECT ColOvrdId, ColOvrdDesc, ScreenObjId, ScreenId, ColVisible, ColReadOnly, ColExport, ToolTip, ColumnHeader, ErrMessage, PermKeyId, PermId, Priority FROM dbo.Tmp_ColOvrd SET IDENTITY_INSERT dbo.ColOvrd OFF IF (SELECT COUNT(1) FROM dbo.ColOvrd) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ColOvrd) = 0 DROP TABLE dbo.Tmp_ColOvrd')

~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7715&typ=N&sys=3","","",""); return false;
7716~@~  10.  31.61014:D:   10:*:*:M: Remove redundancies from all D's except Design DB~@~10470~@~10~@~D~@~~@~~@~M~@~~@~Remove redundancies from all D's except Design DB~@~Y~@~EXEC ('IF DB_NAME()<>''[[?]]Design'' AND EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(''dbo.BreakString'') AND type=''TF'') DROP FUNCTION dbo.BreakString')
EXEC ('IF DB_NAME()<>''[[?]]Design'' AND EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(''dbo.SplitID_Match'') AND type=''IF'') DROP FUNCTION dbo.SplitID_Match')
EXEC ('IF DB_NAME()<>''[[?]]Design'' AND EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(''dbo.SplitStrings_XML'') AND type=''IF'') DROP FUNCTION dbo.SplitStrings_XML')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7716&typ=N&sys=3","","",""); return false;
7717~@~  10.  32.61030:D:   10:*:*:M: Change table Systems 1 of 2~@~10471~@~10~@~D~@~~@~~@~M~@~~@~Change table Systems 1 of 2~@~N~@~EXEC ('CREATE TABLE dbo.Tmp_Systems (SystemId tinyint NULL, SystemName nvarchar(50) NULL, ServerName varchar(50) NULL, dbAppProvider varchar(50) NULL, dbAppServer varchar(50) NULL, dbAppDatabase varchar(50) NULL, dbDesDatabase varchar(50) NULL, dbAppUserId varchar(50) NULL, dbAppPassword varchar(50) NULL, dbX01Provider varchar(50) NULL, dbX01Server varchar(50) NULL, dbX01Database varchar(50) NULL, dbX01UserId varchar(50) NULL, dbX01Password varchar(50) NULL, dbX01Extra varchar(200) NULL, SysProgram char(1) NULL, AdminEmail nvarchar(50) NULL, AdminPhone varchar(20) NULL, CustServEmail nvarchar(50) NULL, CustServPhone varchar(20) NULL, CustServFax varchar(20) NULL, WebAddress varchar(50) NULL)') EXEC (' INSERT INTO dbo.Tmp_Systems (SystemId, SystemName, ServerName, dbAppProvider, dbAppServer, dbAppDatabase, dbDesDatabase, dbAppUserId, dbAppPassword, dbX01Provider, dbX01Server, dbX01Database, dbX01UserId, dbX01Password, dbX01Extra, SysProgram, AdminEmail, AdminPhone, CustServEmail, CustServPhone, CustServFax, WebAddress) SELECT convert(tinyint,SystemId), SystemName, ServerName, dbAppProvider, dbAppServer, dbAppDatabase, dbDesDatabase, dbAppUserId, dbAppPassword, dbX01Provider, dbX01Server, dbX01Database, dbX01UserId, dbX01Password, dbX01Extra, SysProgram, AdminEmail, AdminPhone, CustServEmail, CustServPhone, CustServFax, WebAddress FROM dbo.Systems IF (SELECT COUNT(1) FROM dbo.Tmp_Systems) > 0 OR (SELECT COUNT(1) FROM dbo.Systems) = 0 DROP TABLE dbo.Systems') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Systems'')) CREATE TABLE dbo.Systems (SystemId TinyInt NOT NULL, SystemName NVarChar(50) NOT NULL, ServerName VarChar(50) NOT NULL, dbAppProvider VarChar(50) NOT NULL, dbAppServer VarChar(50) NOT NULL, dbAppDatabase VarChar(50) NOT NULL, dbDesDatabase VarChar(50) NOT NULL, dbAppUserId VarChar(50) NOT NULL, dbAppPassword VarChar(50) NOT NULL, dbX01Provider VarChar(50) NULL, dbX01Server VarChar(50) NULL, dbX01Database VarChar(50) NULL, dbX01UserId VarChar(50) NULL, dbX01Password VarChar(50) NULL, dbX01Extra VarChar(200) NULL, SysProgram Char(1) NOT NULL, AdminEmail NVarChar(50) NULL, AdminPhone VarChar(20) NULL, CustServEmail NVarChar(50) NULL, CustServPhone VarChar(20) NULL, CustServFax VarChar(20) NULL, WebAddress VarChar(50) NULL, Active Char(1) NOT NULL, CONSTRAINT PK_Systems PRIMARY KEY CLUSTERED (SystemId))') EXEC (' ALTER TABLE dbo.Systems ADD CONSTRAINT DF_Systems_Active DEFAULT (''Y'') FOR Active INSERT INTO dbo.Systems (SystemId, SystemName, ServerName, dbAppProvider, dbAppServer, dbAppDatabase, dbDesDatabase, dbAppUserId, dbAppPassword, dbX01Provider, dbX01Server, dbX01Database, dbX01UserId, dbX01Password, dbX01Extra, SysProgram, AdminEmail, AdminPhone, CustServEmail, CustServPhone, CustServFax, WebAddress, Active) SELECT SystemId, SystemName, ServerName, dbAppProvider, dbAppServer, dbAppDatabase, dbDesDatabase, dbAppUserId, dbAppPassword, dbX01Provider, dbX01Server, dbX01Database, dbX01UserId, dbX01Password, dbX01Extra, SysProgram, AdminEmail, AdminPhone, CustServEmail, CustServPhone, CustServFax, WebAddress, ''Y'' FROM dbo.Tmp_Systems IF (SELECT COUNT(1) FROM dbo.Systems) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Systems) = 0 DROP TABLE dbo.Tmp_Systems')

EXEC ('IF EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.GetCustService'')) DROP PROCEDURE dbo.GetCustService')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7717&typ=N&sys=3","","",""); return false;
7718~@~  10.  32.61030:D:   20:*:*:M: Change table Systems 2 of 2~@~10471~@~20~@~D~@~~@~~@~M~@~~@~Change table Systems 2 of 2~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_Systems (SystemId tinyint NULL, SystemName nvarchar(50) NULL, ServerName varchar(50) NULL, dbAppProvider varchar(50) NULL, dbAppServer varchar(50) NULL, dbAppDatabase varchar(50) NULL, dbDesDatabase varchar(50) NULL, dbAppUserId varchar(50) NULL, dbAppPassword varchar(50) NULL, dbX01Provider varchar(50) NULL, dbX01Server varchar(50) NULL, dbX01Database varchar(50) NULL, dbX01UserId varchar(50) NULL, dbX01Password varchar(50) NULL, dbX01Extra varchar(200) NULL, SysProgram char(1) NULL, AdminEmail nvarchar(50) NULL, AdminPhone varchar(20) NULL, CustServEmail nvarchar(50) NULL, CustServPhone varchar(20) NULL, CustServFax varchar(20) NULL, WebAddress varchar(50) NULL, Active char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Systems (SystemId, SystemName, ServerName, dbAppProvider, dbAppServer, dbAppDatabase, dbDesDatabase, dbAppUserId, dbAppPassword, dbX01Provider, dbX01Server, dbX01Database, dbX01UserId, dbX01Password, dbX01Extra, SysProgram, AdminEmail, AdminPhone, CustServEmail, CustServPhone, CustServFax, WebAddress, Active) SELECT convert(tinyint,SystemId), SystemName, ServerName, dbAppProvider, dbAppServer, dbAppDatabase, dbDesDatabase, dbAppUserId, dbAppPassword, dbX01Provider, dbX01Server, dbX01Database, dbX01UserId, dbX01Password, dbX01Extra, SysProgram, AdminEmail, AdminPhone, CustServEmail, CustServPhone, CustServFax, WebAddress, Active FROM dbo.Systems IF (SELECT COUNT(1) FROM dbo.Tmp_Systems) > 0 OR (SELECT COUNT(1) FROM dbo.Systems) = 0 DROP TABLE dbo.Systems') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Systems'')) CREATE TABLE dbo.Systems (SystemId TinyInt NOT NULL, SystemName NVarChar(50) NOT NULL, ServerName VarChar(50) NOT NULL, dbAppProvider VarChar(50) NOT NULL, dbAppServer VarChar(50) NOT NULL, dbAppDatabase VarChar(50) NOT NULL, dbDesDatabase VarChar(50) NOT NULL, dbAppUserId VarChar(50) NOT NULL, dbAppPassword VarChar(50) NOT NULL, dbX01Provider VarChar(50) NULL, dbX01Server VarChar(50) NULL, dbX01Database VarChar(50) NULL, dbX01UserId VarChar(50) NULL, dbX01Password VarChar(50) NULL, dbX01Extra VarChar(200) NULL, SysProgram Char(1) NOT NULL, AdminEmail NVarChar(50) NOT NULL, AdminPhone VarChar(20) NULL, CustServEmail NVarChar(50) NOT NULL, CustServPhone VarChar(20) NULL, CustServFax VarChar(20) NULL, WebAddress VarChar(50) NULL, Active Char(1) NOT NULL, CONSTRAINT PK_Systems PRIMARY KEY CLUSTERED (SystemId))') EXEC (' ALTER TABLE dbo.Systems ADD CONSTRAINT DF_Systems_AdminEmail DEFAULT (''noreply@robocoder.com'') FOR AdminEmail ALTER TABLE dbo.Systems ADD CONSTRAINT DF_Systems_CustServEmail DEFAULT (''noreply@robocoder.com'') FOR CustServEmail ALTER TABLE dbo.Systems ADD CONSTRAINT DF_Systems_Active DEFAULT (''Y'') FOR Active INSERT INTO dbo.Systems (SystemId, SystemName, ServerName, dbAppProvider, dbAppServer, dbAppDatabase, dbDesDatabase, dbAppUserId, dbAppPassword, dbX01Provider, dbX01Server, dbX01Database, dbX01UserId, dbX01Password, dbX01Extra, SysProgram, AdminEmail, AdminPhone, CustServEmail, CustServPhone, CustServFax, WebAddress, Active) SELECT SystemId, SystemName, ServerName, dbAppProvider, dbAppServer, dbAppDatabase, dbDesDatabase, dbAppUserId, dbAppPassword, dbX01Provider, dbX01Server, dbX01Database, dbX01UserId, dbX01Password, dbX01Extra, SysProgram, CASE WHEN AdminEmail is null THEN ''noreply@gmail.com'' ELSE AdminEmail END, AdminPhone, CASE WHEN CustServEmail is null THEN ''noreply@gmail.com'' ELSE CustServEmail END, CustServPhone, CustServFax, WebAddress, Active FROM dbo.Tmp_Systems IF (SELECT COUNT(1) FROM dbo.Systems) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Systems) = 0 DROP TABLE dbo.Tmp_Systems')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7718&typ=N&sys=3","","",""); return false;
7719~@~  10.  35.61123:D:   10:*:*:M: Make sure UsrGroup is up-to-date~@~10474~@~10~@~D~@~~@~~@~M~@~~@~Make sure UsrGroup is up-to-date~@~N~@~EXEC ('DELETE FROM dbo.UsrGroup WHERE UsrGroupId < 10')
EXEC ('DELETE FROM dbo.UsrGroup WHERE lower(UsrGroupName) = ''anonymous''')
EXEC ('DELETE FROM dbo.UsrGroup WHERE lower(UsrGroupName) = ''default user''')
EXEC ('DELETE FROM dbo.UsrGroup WHERE lower(UsrGroupName) = ''reserved #3 (tbd)''')
EXEC ('DELETE FROM dbo.UsrGroup WHERE lower(UsrGroupName) = ''Guest''')
EXEC ('DELETE FROM dbo.UsrGroup WHERE lower(UsrGroupName) = ''sys administrator''')
EXEC ('DELETE FROM dbo.UsrGroup WHERE lower(UsrGroupName) = ''usr administrator''')
EXEC ('DELETE FROM dbo.UsrGroup WHERE lower(UsrGroupName) = ''rpt administrator''')
EXEC ('DELETE FROM dbo.UsrGroup WHERE lower(UsrGroupName) = ''reserved #8 (tbd)''')
EXEC ('DELETE FROM dbo.UsrGroup WHERE lower(UsrGroupName) = ''reserved #9 (tbd)''')
EXEC ('SET IDENTITY_INSERT dbo.UsrGroup ON INSERT dbo.UsrGroup (UsrGroupId,UsrGroupName,RowAuthorityId,CompanyId) SELECT 1,''Anonymous'',7,NULL SET IDENTITY_INSERT dbo.UsrGroup OFF')
EXEC ('SET IDENTITY_INSERT dbo.UsrGroup ON INSERT dbo.UsrGroup (UsrGroupId,UsrGroupName,RowAuthorityId,CompanyId) SELECT 2,''Default User'',6,NULL SET IDENTITY_INSERT dbo.UsrGroup OFF')
EXEC ('SET IDENTITY_INSERT dbo.UsrGroup ON INSERT dbo.UsrGroup (UsrGroupId,UsrGroupName,RowAuthorityId,CompanyId) SELECT 3,''Reserved #3 (TBD)'',7,NULL SET IDENTITY_INSERT dbo.UsrGroup OFF')
EXEC ('SET IDENTITY_INSERT dbo.UsrGroup ON INSERT dbo.UsrGroup (UsrGroupId,UsrGroupName,RowAuthorityId,CompanyId) SELECT 4,''Guest'',7,NULL SET IDENTITY_INSERT dbo.UsrGroup OFF')
EXEC ('SET IDENTITY_INSERT dbo.UsrGroup ON INSERT dbo.UsrGroup (UsrGroupId,UsrGroupName,RowAuthorityId,CompanyId) SELECT 5,''Sys Administrator'',8,NULL SET IDENTITY_INSERT dbo.UsrGroup OFF')
EXEC ('SET IDENTITY_INSERT dbo.UsrGroup ON INSERT dbo.UsrGroup (UsrGroupId,UsrGroupName,RowAuthorityId,CompanyId) SELECT 6,''Usr Administrator'',9,NULL SET IDENTITY_INSERT dbo.UsrGroup OFF')
EXEC ('SET IDENTITY_INSERT dbo.UsrGroup ON INSERT dbo.UsrGroup (UsrGroupId,UsrGroupName,RowAuthorityId,CompanyId) SELECT 7,''Rpt Administrator'',9,NULL SET IDENTITY_INSERT dbo.UsrGroup OFF')
EXEC ('SET IDENTITY_INSERT dbo.UsrGroup ON INSERT dbo.UsrGroup (UsrGroupId,UsrGroupName,RowAuthorityId,CompanyId) SELECT 8,''Reserved #8 (TBD)'',7,NULL SET IDENTITY_INSERT dbo.UsrGroup OFF')
EXEC ('SET IDENTITY_INSERT dbo.UsrGroup ON INSERT dbo.UsrGroup (UsrGroupId,UsrGroupName,RowAuthorityId,CompanyId) SELECT 9,''Reserved #9 (TBD)'',7,NULL SET IDENTITY_INSERT dbo.UsrGroup OFF')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7719&typ=N&sys=3","","",""); return false;
7721~@~  10.  37.61207:D:   10:*:*:M: Change table ScrAudit~@~10476~@~10~@~D~@~~@~~@~M~@~~@~Change table ScrAudit~@~Y~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScrAudit'')) CREATE TABLE dbo.ScrAudit (ScrAuditId BigInt IDENTITY NOT NULL, CudAction Char(1) NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, TableId Int NOT NULL, RowId BigInt NOT NULL, RowDesc NVarChar(max) NOT NULL, ChangedBy Int NOT NULL, ChangedOn DateTime NOT NULL, CONSTRAINT PK_ScrAudit PRIMARY KEY CLUSTERED (ScrAuditId))') EXEC ('') EXEC ('') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IX_ScrAudit'') CREATE NONCLUSTERED INDEX IX_ScrAudit ON dbo.ScrAudit(ScreenId,ChangedOn)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7721&typ=N&sys=3","","",""); return false;
7722~@~  10.  37.61207:D:   20:*:*:M: Change table ScrAuditDtl~@~10476~@~20~@~D~@~~@~~@~M~@~~@~Change table ScrAuditDtl~@~Y~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScrAuditDtl'')) CREATE TABLE dbo.ScrAuditDtl (ScrAuditDtlId BigInt IDENTITY NOT NULL, ScrAuditId BigInt NOT NULL, ScreenObjId Int NOT NULL, ScreenObjDesc NVarChar(max) NOT NULL, ColumnId Int NOT NULL, ColumnDesc NVarChar(max) NOT NULL, ChangedFr NVarChar(max) NULL, ChangedTo NVarChar(max) NULL, CONSTRAINT PK_ScrAuditDtl PRIMARY KEY CLUSTERED (ScrAuditDtlId))') EXEC ('') EXEC ('') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IX_ScrAuditDtl'') CREATE NONCLUSTERED INDEX IX_ScrAuditDtl ON dbo.ScrAuditDtl(ScrAuditId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7722&typ=N&sys=3","","",""); return false;
7723~@~  10.  37.61207:D:   30:*:*:M: Change table Screen~@~10476~@~30~@~D~@~~@~~@~M~@~~@~Change table Screen~@~Y~@~  EXEC (' CREATE TABLE dbo.Tmp_Screen (ScreenId int NULL, ProgramName varchar(20) NULL, ScreenDesc nvarchar(50) NULL, ScreenTypeId tinyint NULL, MasterTableId int NULL, DetailTableId int NULL, SearchId int NULL, SearchAscending char(1) NULL, GridRows tinyint NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL, GenerateSc char(1) NULL, GenerateSr char(1) NULL, HasDeleteAll char(1) NULL, ShowGridHead char(1) NULL, ValidateReq char(1) NULL, DeferError char(1) NULL, AuthRequired char(1) NULL, ViewOnly char(1) NULL, NeedRegen char(1) NULL)') 
 EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, NeedRegen) SELECT convert(int,ScreenId), ProgramName, ScreenDesc, convert(tinyint,ScreenTypeId), convert(int,MasterTableId), convert(int,DetailTableId), convert(int,SearchId), SearchAscending, convert(tinyint,GridRows), ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, NeedRegen FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') 
 EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchId Int NULL, SearchAscending Char(1) NOT NULL, GridRows TinyInt NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, GenerateSr Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ShowGridHead Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, AuthRequired Char(1) NOT NULL, ViewOnly Char(1) NOT NULL, GenAudit Char(1) NOT NULL, NeedRegen Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') 
 EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSc DEFAULT (''Y'') FOR GenerateSc ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSr DEFAULT (''Y'') FOR GenerateSr ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ShowGridHead DEFAULT (''Y'') FOR ShowGridHead ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_AuthRequired DEFAULT (''Y'') FOR AuthRequired ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ViewOnly DEFAULT (''N'') FOR ViewOnly ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenAudit DEFAULT (''N'') FOR GenAudit ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NeedRegen DEFAULT (''N'') FOR NeedRegen SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, ''N'', NeedRegen FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7723&typ=N&sys=3","","",""); return false;
7724~@~  10.  37.61207:D:   40:*:*:M: Change table ServerRule~@~10476~@~40~@~D~@~~@~~@~M~@~~@~Change table ServerRule~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_ServerRule (ServerRuleId int NULL, ScreenId int NULL, RuleTypeId tinyint NULL, MasterTable char(1) NULL, RuleName nvarchar(100) NULL, RuleDesc nvarchar(150) NULL, RuleDescription nvarchar(500) NULL, RuleOrder smallint NULL, ProcedureName varchar(50) NULL, ParameterNames varchar(max) NULL, ParameterTypes varchar(max) NULL, CallingParams varchar(max) NULL, OnAdd char(1) NULL, OnUpd char(1) NULL, OnDel char(1) NULL, BeforeCRUD char(1) NULL, RuleCode nvarchar(max) NULL, ModifiedBy int NULL, ModifiedOn datetime NULL, LastGenDt datetime NULL)')
EXEC ('INSERT INTO dbo.Tmp_ServerRule (ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, RuleOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn, LastGenDt) SELECT convert(int,ServerRuleId), convert(int,ScreenId), convert(tinyint,RuleTypeId), MasterTable, RuleName, RuleDesc, RuleDescription, convert(smallint,RuleOrder), ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, convert(int,ModifiedBy), ModifiedOn, LastGenDt FROM dbo.ServerRule IF (SELECT COUNT(1) FROM dbo.Tmp_ServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.ServerRule) = 0 DROP TABLE dbo.ServerRule')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ServerRule'')) CREATE TABLE dbo.ServerRule (ServerRuleId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, RuleTypeId TinyInt NOT NULL, MasterTable Char(1) NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, RuleOrder SmallInt NOT NULL, ProcedureName VarChar(50) NOT NULL, ParameterNames VarChar(max) NULL, ParameterTypes VarChar(max) NULL, CallingParams VarChar(max) NULL, OnAdd Char(1) NOT NULL, OnUpd Char(1) NOT NULL, OnDel Char(1) NOT NULL, BeforeCRUD Char(1) NOT NULL, RuleCode NVarChar(max) NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, CONSTRAINT PK_ServerRule PRIMARY KEY CLUSTERED (ServerRuleId))')
EXEC ('SET IDENTITY_INSERT dbo.ServerRule ON INSERT INTO dbo.ServerRule (ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, RuleOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn, LastGenDt) SELECT ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, RuleOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn, LastGenDt FROM dbo.Tmp_ServerRule SET IDENTITY_INSERT dbo.ServerRule OFF IF (SELECT COUNT(1) FROM dbo.ServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ServerRule) = 0 DROP TABLE dbo.Tmp_ServerRule IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IX_ServerRule'') CREATE NONCLUSTERED INDEX IX_ServerRule ON dbo.ServerRule(ScreenId,RuleOrder)')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7724&typ=N&sys=3","","",""); return false;
7725~@~  10.  37.61207:D:   50:*:*:M: Change table CtCudAction~@~10476~@~50~@~D~@~~@~~@~M~@~~@~Change table CtCudAction~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtCudAction'')) CREATE TABLE dbo.CtCudAction (CudAction Char(1) NOT NULL, CudActionDesc NVarChar(20) NOT NULL, CONSTRAINT PK_CtCudAction PRIMARY KEY CLUSTERED (CudAction))')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.CtCudAction WHERE CudAction=''A'') INSERT dbo.CtCudAction SELECT ''A'',''ADD''')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.CtCudAction WHERE CudAction=''U'') INSERT dbo.CtCudAction SELECT ''U'',''UPD''')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.CtCudAction WHERE CudAction=''D'') INSERT dbo.CtCudAction SELECT ''D'',''DEL''')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7725&typ=N&sys=3","","",""); return false;
7727~@~  10.  37.61207:D:   60:*:*:M: Add content to CtButtonType~@~10476~@~60~@~D~@~~@~~@~M~@~~@~Add content to CtButtonType~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.CtButtonType WHERE ButtonTypeId = 66)
BEGIN
	EXEC ('INSERT dbo.CtButtonType SELECT 66,''S'',''Audit'',''Screen Audit'',''N'',''N''')
	EXEC ('INSERT dbo.CtButtonHlp (CultureId,ButtonTypeId,ButtonName,ButtonToolTip) SELECT 1,66,''Audit'',''Press this to inspect historical changes and drill down to audit details.''')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7727&typ=N&sys=3","","",""); return false;
7728~@~  10.  37.61207:D:   70:*:*:M: Update deployment configuration~@~10476~@~70~@~D~@~~@~~@~M~@~~@~Update deployment configuration~@~N~@~EXEC ('UPDATE dbo.ReleaseDtl SET ObjectExempt = ObjectExempt + '' |ScrAudit |ScrAuditDtl'' WHERE CHARINDEX(''ScrAudit'',ObjectExempt) <= 0 AND CHARINDEX(''Usage'',ObjectExempt) > 0')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7728&typ=N&sys=3","","",""); return false;
7729~@~  10.  43.70127:D:   10:*:*:M: Change table Menu~@~10482~@~10~@~D~@~~@~~@~M~@~~@~Change table Menu~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Menu (MenuId int NULL, MenuIndex smallint NULL, Miscellaneous varchar(100) NULL, ParentId int NULL, ReportId int NULL, ScreenId int NULL, WizardId int NULL, StaticPgId int NULL, IconUrl nvarchar(300) NULL)') EXEC (' INSERT INTO dbo.Tmp_Menu (MenuId, MenuIndex, Miscellaneous, ParentId, ReportId, ScreenId, WizardId, StaticPgId, IconUrl) SELECT convert(int,MenuId), convert(smallint,MenuIndex), Miscellaneous, convert(int,ParentId), convert(int,ReportId), convert(int,ScreenId), convert(int,WizardId), convert(int,StaticPgId), IconUrl FROM dbo.Menu IF (SELECT COUNT(1) FROM dbo.Tmp_Menu) > 0 OR (SELECT COUNT(1) FROM dbo.Menu) = 0 DROP TABLE dbo.Menu') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Menu'')) CREATE TABLE dbo.Menu (MenuId Int IDENTITY NOT NULL, MenuIndex SmallInt NOT NULL, Miscellaneous VarChar(100) NULL, ParentId Int NULL, ReportId Int NULL, ScreenId Int NULL, WizardId Int NULL, StaticPgId Int NULL, IconUrl NVarChar(300) NULL, Popup Char(1) NOT NULL, CONSTRAINT PK_Menu PRIMARY KEY CLUSTERED (MenuId))') EXEC (' ALTER TABLE dbo.Menu ADD CONSTRAINT DF_Menu_Popup DEFAULT (''N'') FOR Popup SET IDENTITY_INSERT dbo.Menu ON INSERT INTO dbo.Menu (MenuId, MenuIndex, Miscellaneous, ParentId, ReportId, ScreenId, WizardId, StaticPgId, IconUrl, Popup) SELECT MenuId, MenuIndex, Miscellaneous, ParentId, ReportId, ScreenId, WizardId, StaticPgId, IconUrl, ''N'' FROM dbo.Tmp_Menu SET IDENTITY_INSERT dbo.Menu OFF IF (SELECT COUNT(1) FROM dbo.Menu) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Menu) = 0 DROP TABLE dbo.Tmp_Menu')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7729&typ=N&sys=3","","",""); return false;
7730~@~  10.  44.70203:D:   10:*:*:M: Change table LastEmail~@~10483~@~10~@~D~@~~@~~@~M~@~~@~Change table LastEmail~@~N~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.LastEmail'')) CREATE TABLE dbo.LastEmail (LastEmailDt DateTime NOT NULL, LastEmailCnt Int NOT NULL, CONSTRAINT PK_LastEmail PRIMARY KEY CLUSTERED (LastEmailDt))')

EXEC ('UPDATE dbo.ReleaseDtl SET ObjectExempt = REPLACE(ObjectExempt,''|Entity'',''|Entity |LastEmail'') WHERE CHARINDEX(''|LastEmail'',ObjectExempt) <= 0')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7730&typ=N&sys=3","","",""); return false;
7731~@~  10.  47.70210:D:   10:*:*:M: Update deployment configuration~@~10486~@~10~@~D~@~~@~~@~M~@~~@~Update deployment configuration~@~N~@~EXEC ('UPDATE dbo.ReleaseDtl SET ObjectExempt = ObjectExempt + '' |dashboards'' WHERE CHARINDEX(''dashboards'',ObjectExempt) <= 0 AND CHARINDEX(''.config'',ObjectExempt) > 0')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7731&typ=N&sys=3","","",""); return false;
7732~@~  10.  48.70303:D:   10:*:*:M: Change table CtButtonHlp~@~10487~@~10~@~D~@~~@~~@~M~@~~@~Change table CtButtonHlp~@~N~@~EXEC (' CREATE TABLE dbo.Tmp_CtButtonHlp (ButtonHlpId int NULL, CultureId smallint NULL, ButtonTypeId tinyint NULL, ButtonName nvarchar(20) NULL, ButtonToolTip nvarchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_CtButtonHlp (ButtonHlpId, CultureId, ButtonTypeId, ButtonName, ButtonToolTip) SELECT convert(int,ButtonHlpId), convert(smallint,CultureId), convert(tinyint,ButtonTypeId), ButtonName, ButtonToolTip FROM dbo.CtButtonHlp IF (SELECT COUNT(1) FROM dbo.Tmp_CtButtonHlp) > 0 OR (SELECT COUNT(1) FROM dbo.CtButtonHlp) = 0 DROP TABLE dbo.CtButtonHlp') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtButtonHlp'')) CREATE TABLE dbo.CtButtonHlp (ButtonHlpId Int IDENTITY NOT NULL, CultureId SmallInt NOT NULL, ButtonTypeId TinyInt NOT NULL, ButtonName NVarChar(50) NOT NULL, ButtonToolTip NVarChar(100) NOT NULL, CONSTRAINT PK_CtButtonHlp PRIMARY KEY CLUSTERED (ButtonHlpId, CultureId))') EXEC (' SET IDENTITY_INSERT dbo.CtButtonHlp ON INSERT INTO dbo.CtButtonHlp (ButtonHlpId, CultureId, ButtonTypeId, ButtonName, ButtonToolTip) SELECT ButtonHlpId, CultureId, ButtonTypeId, ButtonName, ButtonToolTip FROM dbo.Tmp_CtButtonHlp SET IDENTITY_INSERT dbo.CtButtonHlp OFF IF (SELECT COUNT(1) FROM dbo.CtButtonHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtButtonHlp) = 0 DROP TABLE dbo.Tmp_CtButtonHlp')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7732&typ=N&sys=3","","",""); return false;
7733~@~  10.  48.70303:D:   20:*:*:M: Change table Menu~@~10487~@~20~@~D~@~~@~~@~M~@~~@~Change table Menu~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Menu (MenuId int NULL, MenuIndex smallint NULL, Miscellaneous varchar(100) NULL, ParentId int NULL, ReportId int NULL, ScreenId int NULL, WizardId int NULL, StaticPgId int NULL, IconUrl nvarchar(300) NULL, Popup char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Menu (MenuId, MenuIndex, Miscellaneous, ParentId, ReportId, ScreenId, WizardId, StaticPgId, IconUrl, Popup) SELECT convert(int,MenuId), convert(smallint,MenuIndex), Miscellaneous, convert(int,ParentId), convert(int,ReportId), convert(int,ScreenId), convert(int,WizardId), convert(int,StaticPgId), IconUrl, Popup FROM dbo.Menu IF (SELECT COUNT(1) FROM dbo.Tmp_Menu) > 0 OR (SELECT COUNT(1) FROM dbo.Menu) = 0 DROP TABLE dbo.Menu') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Menu'')) CREATE TABLE dbo.Menu (MenuId Int IDENTITY NOT NULL, MenuIndex SmallInt NOT NULL, Miscellaneous VarChar(1000) NULL, ParentId Int NULL, ReportId Int NULL, ScreenId Int NULL, WizardId Int NULL, StaticPgId Int NULL, IconUrl NVarChar(300) NULL, Popup Char(1) NOT NULL, CONSTRAINT PK_Menu PRIMARY KEY CLUSTERED (MenuId))') EXEC (' ALTER TABLE dbo.Menu ADD CONSTRAINT DF_Menu_Popup DEFAULT (''N'') FOR Popup SET IDENTITY_INSERT dbo.Menu ON INSERT INTO dbo.Menu (MenuId, MenuIndex, Miscellaneous, ParentId, ReportId, ScreenId, WizardId, StaticPgId, IconUrl, Popup) SELECT MenuId, MenuIndex, Miscellaneous, ParentId, ReportId, ScreenId, WizardId, StaticPgId, IconUrl, Popup FROM dbo.Tmp_Menu SET IDENTITY_INSERT dbo.Menu OFF IF (SELECT COUNT(1) FROM dbo.Menu) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Menu) = 0 DROP TABLE dbo.Tmp_Menu')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7733&typ=N&sys=3","","",""); return false;
7734~@~  10.  50.70327:D:   10:*:*:M: Change table Systems~@~10489~@~10~@~D~@~~@~~@~M~@~~@~Change table Systems~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_Systems (SystemId tinyint NULL, SystemName nvarchar(50) NULL, ServerName varchar(50) NULL, dbAppProvider varchar(50) NULL, dbAppServer varchar(50) NULL, dbAppDatabase varchar(50) NULL, dbDesDatabase varchar(50) NULL, dbAppUserId varchar(50) NULL, dbAppPassword varchar(50) NULL, dbX01Provider varchar(50) NULL, dbX01Server varchar(50) NULL, dbX01Database varchar(50) NULL, dbX01UserId varchar(50) NULL, dbX01Password varchar(50) NULL, dbX01Extra varchar(200) NULL, SysProgram char(1) NULL, AdminEmail nvarchar(50) NULL, AdminPhone varchar(20) NULL, CustServEmail nvarchar(50) NULL, CustServPhone varchar(20) NULL, CustServFax varchar(20) NULL, WebAddress varchar(50) NULL, Active char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Systems (SystemId, SystemName, ServerName, dbAppProvider, dbAppServer, dbAppDatabase, dbDesDatabase, dbAppUserId, dbAppPassword, dbX01Provider, dbX01Server, dbX01Database, dbX01UserId, dbX01Password, dbX01Extra, SysProgram, AdminEmail, AdminPhone, CustServEmail, CustServPhone, CustServFax, WebAddress, Active) SELECT convert(tinyint,SystemId), SystemName, ServerName, dbAppProvider, dbAppServer, dbAppDatabase, dbDesDatabase, dbAppUserId, dbAppPassword, dbX01Provider, dbX01Server, dbX01Database, dbX01UserId, dbX01Password, dbX01Extra, SysProgram, AdminEmail, AdminPhone, CustServEmail, CustServPhone, CustServFax, WebAddress, Active FROM dbo.Systems IF (SELECT COUNT(1) FROM dbo.Tmp_Systems) > 0 OR (SELECT COUNT(1) FROM dbo.Systems) = 0 DROP TABLE dbo.Systems') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Systems'')) CREATE TABLE dbo.Systems (SystemId TinyInt NOT NULL, SystemName NVarChar(50) NOT NULL, SystemAbbr VarChar(4) NOT NULL, ServerName VarChar(50) NOT NULL, dbAppProvider VarChar(50) NOT NULL, dbAppServer VarChar(50) NOT NULL, dbAppDatabase VarChar(50) NOT NULL, dbDesDatabase VarChar(50) NOT NULL, dbAppUserId VarChar(50) NOT NULL, dbAppPassword VarChar(50) NOT NULL, dbX01Provider VarChar(50) NULL, dbX01Server VarChar(50) NULL, dbX01Database VarChar(50) NULL, dbX01UserId VarChar(50) NULL, dbX01Password VarChar(50) NULL, dbX01Extra VarChar(200) NULL, SysProgram Char(1) NOT NULL, AdminEmail NVarChar(50) NOT NULL, AdminPhone VarChar(20) NULL, CustServEmail NVarChar(50) NOT NULL, CustServPhone VarChar(20) NULL, CustServFax VarChar(20) NULL, WebAddress VarChar(50) NULL, Active Char(1) NOT NULL, CONSTRAINT PK_Systems PRIMARY KEY CLUSTERED (SystemId))') EXEC (' ALTER TABLE dbo.Systems ADD CONSTRAINT DF_Systems_SystemAbbr DEFAULT (''Abc'') FOR SystemAbbr ALTER TABLE dbo.Systems ADD CONSTRAINT DF_Systems_AdminEmail DEFAULT (''noreply@gmail.com'') FOR AdminEmail ALTER TABLE dbo.Systems ADD CONSTRAINT DF_Systems_CustServEmail DEFAULT (''noreply@gmail.com'') FOR CustServEmail ALTER TABLE dbo.Systems ADD CONSTRAINT DF_Systems_Active DEFAULT (''Y'') FOR Active INSERT INTO dbo.Systems (SystemId, SystemName, SystemAbbr, ServerName, dbAppProvider, dbAppServer, dbAppDatabase, dbDesDatabase, dbAppUserId, dbAppPassword, dbX01Provider, dbX01Server, dbX01Database, dbX01UserId, dbX01Password, dbX01Extra, SysProgram, AdminEmail, AdminPhone, CustServEmail, CustServPhone, CustServFax, WebAddress, Active) SELECT SystemId, SystemName, ''Abc'', ServerName, dbAppProvider, dbAppServer, dbAppDatabase, dbDesDatabase, dbAppUserId, dbAppPassword, dbX01Provider, dbX01Server, dbX01Database, dbX01UserId, dbX01Password, dbX01Extra, SysProgram, AdminEmail, AdminPhone, CustServEmail, CustServPhone, CustServFax, WebAddress, Active FROM dbo.Tmp_Systems IF (SELECT COUNT(1) FROM dbo.Systems) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Systems) = 0 DROP TABLE dbo.Tmp_Systems')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7734&typ=N&sys=3","","",""); return false;
7735~@~  10.  52.70410:D:   10:*:*:M: Change table Usr~@~10491~@~10~@~D~@~~@~~@~M~@~~@~Change table Usr~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_Usr (UsrId int NULL, LoginName nvarchar(32) NULL, UsrEmail nvarchar(50) NULL, UsrName nvarchar(50) NULL, UsrPassword varbinary(32) NULL, ConfirmPwd varbinary(32) NULL, ExtPassword varbinary(255) NULL, CultureId smallint NULL, InternalUsr char(1) NULL, TechnicalUsr char(1) NULL, UsrGroupLs varchar(1000) NULL, CompanyLs varchar(1000) NULL, ProjectLs varchar(1000) NULL, InvestorId int NULL, CustomerId int NULL, VendorId int NULL, AgentId int NULL, BrokerId int NULL, MemberId int NULL, DefSystemId tinyint NULL, DefProjectId int NULL, DefCompanyId int NULL, FailedAttempt tinyint NULL, FailedAttemptFP tinyint NULL, LastFailedDt datetime NULL, LastSuccessDt datetime NULL, LastPwdChgDt datetime NULL, HintQuestionId tinyint NULL, HintAnswer nvarchar(50) NULL, Active char(1) NULL, ModifiedOn datetime NULL, UsrImprLink varchar(200) NULL, IPAlert char(1) NULL, PwdNoRepeat smallint NULL, PwdDuration smallint NULL, PwdWarn smallint NULL, PicMed varbinary(max) NULL, OTPSecret varchar(64) NULL, TwoFactorAuth char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Usr (UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, LastPwdChgDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink, IPAlert, PwdNoRepeat, PwdDuration, PwdWarn, PicMed, OTPSecret, TwoFactorAuth) SELECT convert(int,UsrId), LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, convert(smallint,CultureId), InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, convert(int,InvestorId), convert(int,CustomerId), convert(int,VendorId), convert(int,AgentId), convert(int,BrokerId), convert(int,MemberId), convert(tinyint,DefSystemId), convert(int,DefProjectId), convert(int,DefCompanyId), convert(tinyint,FailedAttempt), convert(tinyint,FailedAttemptFP), LastFailedDt, LastSuccessDt, LastPwdChgDt, convert(tinyint,HintQuestionId), HintAnswer, Active, ModifiedOn, UsrImprLink, IPAlert, convert(smallint,PwdNoRepeat), convert(smallint,PwdDuration), convert(smallint,PwdWarn), PicMed, OTPSecret, TwoFactorAuth FROM dbo.Usr IF (SELECT COUNT(1) FROM dbo.Tmp_Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Usr) = 0 DROP TABLE dbo.Usr') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Usr'')) CREATE TABLE dbo.Usr (UsrId Int IDENTITY NOT NULL, LoginName NVarChar(32) NOT NULL, UsrEmail NVarChar(50) NULL, UsrMobile VarChar(50) NULL, UsrName NVarChar(50) NULL, UsrPassword VarBinary(32) NULL, ConfirmPwd VarBinary(32) NULL, ExtPassword VarBinary(255) NULL, CultureId SmallInt NOT NULL, InternalUsr Char(1) NOT NULL, TechnicalUsr Char(1) NOT NULL, UsrGroupLs VarChar(1000) NOT NULL, CompanyLs VarChar(1000) NULL, ProjectLs VarChar(1000) NULL, InvestorId Int NULL, CustomerId Int NULL, VendorId Int NULL, AgentId Int NULL, BrokerId Int NULL, MemberId Int NULL, DefSystemId TinyInt NOT NULL, DefProjectId Int NULL, DefCompanyId Int NULL, FailedAttempt TinyInt NULL, FailedAttemptFP TinyInt NULL, LastFailedDt DateTime NULL, LastSuccessDt DateTime NULL, LastPwdChgDt DateTime NULL, HintQuestionId TinyInt NULL, HintAnswer NVarChar(50) NULL, Active Char(1) NOT NULL, ModifiedOn DateTime NOT NULL, UsrImprLink VarChar(200) NULL, IPAlert Char(1) NOT NULL, PwdNoRepeat SmallInt NOT NULL, PwdDuration SmallInt NOT NULL, PwdWarn SmallInt NOT NULL, PicMed VarBinary(max) NULL, OTPSecret VarChar(64) NULL, TwoFactorAuth Char(1) NOT NULL, CONSTRAINT PK_Usr PRIMARY KEY CLUSTERED (UsrId, CultureId))') EXEC (' ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_CultureId DEFAULT (1) FOR CultureId ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_InternalUsr DEFAULT (''N'') FOR InternalUsr ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_TechnicalUsr DEFAULT (''N'') FOR TechnicalUsr ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_IPAlert DEFAULT (''N'') FOR IPAlert ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdNoRepeat DEFAULT (1) FOR PwdNoRepeat ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdDuration DEFAULT (9999) FOR PwdDuration ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdWarn DEFAULT (0) FOR PwdWarn ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_TwoFactorAuth DEFAULT (''N'') FOR TwoFactorAuth SET IDENTITY_INSERT dbo.Usr ON INSERT INTO dbo.Usr (UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, LastPwdChgDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink, IPAlert, PwdNoRepeat, PwdDuration, PwdWarn, PicMed, OTPSecret, TwoFactorAuth) SELECT UsrId, LoginName, UsrEmail, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, LastPwdChgDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink, IPAlert, PwdNoRepeat, PwdDuration, PwdWarn, PicMed, OTPSecret, TwoFactorAuth FROM dbo.Tmp_Usr SET IDENTITY_INSERT dbo.Usr OFF IF (SELECT COUNT(1) FROM dbo.Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Usr) = 0 DROP TABLE dbo.Tmp_Usr IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IU_Usr'') CREATE UNIQUE NONCLUSTERED INDEX IU_Usr ON dbo.Usr(LoginName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7735&typ=N&sys=3","","",""); return false;
7736~@~  10.  56.70510:D:   10:*:*:M: Change table Screen 1 of 2~@~11494~@~10~@~D~@~~@~~@~M~@~~@~Change table Screen 1 of 2~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_Screen (ScreenId int NULL, ProgramName varchar(20) NULL, ScreenDesc nvarchar(50) NULL, ScreenTypeId tinyint NULL, MasterTableId int NULL, DetailTableId int NULL, SearchId int NULL, SearchAscending char(1) NULL, GridRows tinyint NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL, GenerateSc char(1) NULL, GenerateSr char(1) NULL, HasDeleteAll char(1) NULL, ShowGridHead char(1) NULL, ValidateReq char(1) NULL, DeferError char(1) NULL, AuthRequired char(1) NULL, ViewOnly char(1) NULL, GenAudit char(1) NULL, NeedRegen char(1) NULL)')
EXEC ('INSERT INTO dbo.Tmp_Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchId, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen) SELECT convert(int,ScreenId), ProgramName, ScreenDesc, convert(tinyint,ScreenTypeId), convert(int,MasterTableId), convert(int,DetailTableId), convert(int,SearchId), SearchAscending, convert(tinyint,GridRows), ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen')
EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchTableId Int NOT NULL, SearchId Int NOT NULL, SearchAscending Char(1) NOT NULL, SearchDtlId Int NULL, SearchUrlId int NULL, SearchImgId int NULL, GridRows TinyInt NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, GenerateSr Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ShowGridHead Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, AuthRequired Char(1) NOT NULL, ViewOnly Char(1) NOT NULL, GenAudit Char(1) NOT NULL, NeedRegen Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))')
EXEC ('ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_SearchTableId DEFAULT (0) FOR SearchTableId ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_SearchId DEFAULT (0) FOR SearchId ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSc DEFAULT (''Y'') FOR GenerateSc ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSr DEFAULT (''Y'') FOR GenerateSr ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ShowGridHead DEFAULT (''Y'') FOR ShowGridHead ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_AuthRequired DEFAULT (''Y'') FOR AuthRequired ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ViewOnly DEFAULT (''N'') FOR ViewOnly ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenAudit DEFAULT (''N'') FOR GenAudit ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NeedRegen DEFAULT (''N'') FOR NeedRegen SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchTableId, SearchId, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, 0, CASE WHEN SearchId is null THEN 0 ELSE SearchId END, SearchAscending, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen')

EXEC ('UPDATE dbo.Screen SET SearchTableId = MasterTableId WHERE SearchTableId = 0')
EXEC('UPDATE a SET SearchId = b.ColumnId
FROM dbo.Screen a INNER JOIN dbo.DbColumn b ON a.MasterTableId = b.TableId AND b.PrimaryKey = ''Y''
WHERE (a.SearchId is NULL OR a.SearchId = 0) AND a.ScreenTypeId IN (5,6)')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7736&typ=N&sys=3","","",""); return false;
7737~@~  10.  56.70510:D:   20:*:*:M: Change table Screen 2 of 2~@~11494~@~20~@~D~@~~@~~@~M~@~~@~Change table Screen 2 of 2~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Screen (ScreenId int NULL, ProgramName varchar(20) NULL, ScreenDesc nvarchar(50) NULL, ScreenTypeId tinyint NULL, MasterTableId int NULL, DetailTableId int NULL, SearchTableId int NULL, SearchId int NULL, SearchAscending char(1) NULL, SearchDtlId int NULL, SearchUrlId int NULL, SearchImgId int NULL, GridRows tinyint NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL, GenerateSc char(1) NULL, GenerateSr char(1) NULL, HasDeleteAll char(1) NULL, ShowGridHead char(1) NULL, ValidateReq char(1) NULL, DeferError char(1) NULL, AuthRequired char(1) NULL, ViewOnly char(1) NULL, GenAudit char(1) NULL, NeedRegen char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchTableId, SearchId, SearchAscending, SearchDtlId, SearchUrlId, SearchImgId, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen) SELECT convert(int,ScreenId), ProgramName, ScreenDesc, convert(tinyint,ScreenTypeId), convert(int,MasterTableId), convert(int,DetailTableId), convert(int,SearchTableId), convert(int,SearchId), SearchAscending, convert(int,SearchDtlId), convert(int,SearchUrlId), convert(int,SearchImgId), convert(tinyint,GridRows), ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchTableId Int NOT NULL, SearchId Int NOT NULL, SearchAscending Char(1) NOT NULL, SearchDtlId Int NULL, SearchUrlId Int NULL, SearchImgId Int NULL, GridRows TinyInt NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, GenerateSr Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ShowGridHead Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, AuthRequired Char(1) NOT NULL, ViewOnly Char(1) NOT NULL, GenAudit Char(1) NOT NULL, NeedRegen Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_SearchTableId DEFAULT (0) FOR SearchTableId ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_SearchId DEFAULT (0) FOR SearchId ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSc DEFAULT (''Y'') FOR GenerateSc ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSr DEFAULT (''Y'') FOR GenerateSr ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ShowGridHead DEFAULT (''Y'') FOR ShowGridHead ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_AuthRequired DEFAULT (''Y'') FOR AuthRequired ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ViewOnly DEFAULT (''N'') FOR ViewOnly ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenAudit DEFAULT (''N'') FOR GenAudit ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NeedRegen DEFAULT (''N'') FOR NeedRegen SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchTableId, SearchId, SearchAscending, SearchDtlId, SearchUrlId, SearchImgId, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchTableId, SearchId, SearchAscending, SearchDtlId, SearchUrlId, SearchImgId, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7737&typ=N&sys=3","","",""); return false;
7738~@~  10.  60.70606:D:   10:*:*:M: Change table Screen~@~11498~@~10~@~D~@~~@~~@~M~@~~@~Change table Screen~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_Screen (ScreenId int NULL, ProgramName varchar(20) NULL, ScreenDesc nvarchar(50) NULL, ScreenTypeId tinyint NULL, MasterTableId int NULL, DetailTableId int NULL, SearchTableId int NULL, SearchId int NULL, SearchAscending char(1) NULL, SearchDtlId int NULL, SearchUrlId int NULL, SearchImgId int NULL, GridRows tinyint NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL, GenerateSc char(1) NULL, GenerateSr char(1) NULL, HasDeleteAll char(1) NULL, ShowGridHead char(1) NULL, ValidateReq char(1) NULL, DeferError char(1) NULL, AuthRequired char(1) NULL, ViewOnly char(1) NULL, GenAudit char(1) NULL, NeedRegen char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchTableId, SearchId, SearchAscending, SearchDtlId, SearchUrlId, SearchImgId, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen) SELECT convert(int,ScreenId), ProgramName, ScreenDesc, convert(tinyint,ScreenTypeId), convert(int,MasterTableId), convert(int,DetailTableId), convert(int,SearchTableId), convert(int,SearchId), SearchAscending, convert(int,SearchDtlId), convert(int,SearchUrlId), convert(int,SearchImgId), convert(tinyint,GridRows), ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchTableId Int NULL, SearchId Int NULL, SearchAscending Char(1) NOT NULL, SearchDtlId Int NULL, SearchUrlId Int NULL, SearchImgId Int NULL, GridRows TinyInt NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, GenerateSr Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ShowGridHead Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, AuthRequired Char(1) NOT NULL, ViewOnly Char(1) NOT NULL, GenAudit Char(1) NOT NULL, NeedRegen Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSc DEFAULT (''Y'') FOR GenerateSc ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSr DEFAULT (''Y'') FOR GenerateSr ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ShowGridHead DEFAULT (''Y'') FOR ShowGridHead ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_AuthRequired DEFAULT (''Y'') FOR AuthRequired ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ViewOnly DEFAULT (''N'') FOR ViewOnly ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenAudit DEFAULT (''N'') FOR GenAudit ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NeedRegen DEFAULT (''N'') FOR NeedRegen SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchTableId, SearchId, SearchAscending, SearchDtlId, SearchUrlId, SearchImgId, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchTableId, SearchId, SearchAscending, SearchDtlId, SearchUrlId, SearchImgId, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen')

EXEC ('UPDATE Screen SET SearchTableId = NULL, SearchId = NULL where ScreenTypeId = 7')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7738&typ=N&sys=3","","",""); return false;
7739~@~  10.  67.80921:D:   10:*:*:M: Change table CtButtonType~@~11505~@~10~@~D~@~~@~~@~M~@~~@~Change table CtButtonType~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.CtButtonType WHERE ButtonTypeId >= 67)
BEGIN
EXEC ('CREATE TABLE dbo.Tmp_CtButtonType (ButtonTypeId tinyint NULL, ObjectType char(1) NULL, ButtonTypeName varchar(20) NULL, ButtonTypeDesc nvarchar(50) NULL, ButtonVisible char(1) NULL, ViewOnlyVisible char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_CtButtonType (ButtonTypeId, ObjectType, ButtonTypeName, ButtonTypeDesc, ButtonVisible, ViewOnlyVisible) SELECT convert(tinyint,ButtonTypeId), ObjectType, ButtonTypeName, ButtonTypeDesc, ButtonVisible, ViewOnlyVisible FROM dbo.CtButtonType IF (SELECT COUNT(1) FROM dbo.Tmp_CtButtonType) > 0 OR (SELECT COUNT(1) FROM dbo.CtButtonType) = 0 DROP TABLE dbo.CtButtonType') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtButtonType'')) CREATE TABLE dbo.CtButtonType (ButtonTypeId TinyInt NOT NULL, ObjectType Char(1) NOT NULL, ButtonTypeName VarChar(20) NOT NULL, ButtonTypeDesc NVarChar(50) NOT NULL, ButtonVisible Char(1) NOT NULL, ViewOnlyVisible Char(1) NOT NULL, TopVisible Char(1) NOT NULL, RowVisible Char(1) NOT NULL, BotVisible Char(1) NOT NULL, CONSTRAINT PK_CtButtonType PRIMARY KEY CLUSTERED (ButtonTypeId))') EXEC (' ALTER TABLE dbo.CtButtonType ADD CONSTRAINT DF_CtButtonType_ViewOnlyVisible DEFAULT (''Y'') FOR ViewOnlyVisible ALTER TABLE dbo.CtButtonType ADD CONSTRAINT DF_CtButtonType_TopVisible DEFAULT (''N'') FOR TopVisible ALTER TABLE dbo.CtButtonType ADD CONSTRAINT DF_CtButtonType_RowVisible DEFAULT (''N'') FOR RowVisible ALTER TABLE dbo.CtButtonType ADD CONSTRAINT DF_CtButtonType_BotVisible DEFAULT (''N'') FOR BotVisible INSERT INTO dbo.CtButtonType (ButtonTypeId, ObjectType, ButtonTypeName, ButtonTypeDesc, ButtonVisible, ViewOnlyVisible, TopVisible, RowVisible, BotVisible) SELECT ButtonTypeId, ObjectType, ButtonTypeName, ButtonTypeDesc, ButtonVisible, ViewOnlyVisible, ''N'', ''N'', ''N'' FROM dbo.Tmp_CtButtonType IF (SELECT COUNT(1) FROM dbo.CtButtonType) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtButtonType) = 0 DROP TABLE dbo.Tmp_CtButtonType')

EXEC ('UPDATE dbo.CtButtonType SET TopVisible = ''L'',RowVisible = ''L'',BotVisible = ''N'' WHERE ButtonVisible = ''Y''')
EXEC ('UPDATE dbo.CtButtonType SET TopVisible = ''B'',RowVisible = ''N'',BotVisible = ''B'' WHERE ButtonTypeName = ''InsRow''')
EXEC ('INSERT dbo.CtButtonType SELECT 67,''S'',''DelRow'',''Screen Delete Row'',''N'',''N'',''L'',''B'',''N''')
EXEC ('INSERT dbo.CtButtonType SELECT 68,''S'',''CopyRow'',''Screen Copy Row'',''N'',''N'',''L'',''L'',''N''')
EXEC ('INSERT dbo.CtButtonType SELECT 69,''S'',''EditRow'',''Screen Eidt Row'',''N'',''N'',''L'',''B'',''N''')
EXEC ('INSERT dbo.CtButtonType SELECT 70,''S'',''EditHdr'',''Screen Edit Header'',''N'',''N'',''L'',''B'',''N''')
EXEC ('INSERT dbo.CtButtonType SELECT 71,''S'',''DrillDown'',''Screen Drill Down'',''N'',''N'',''L'',''B'',''N''')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7739&typ=N&sys=3","","",""); return false;
7740~@~  10.  67.80921:D:   20:*:*:M: Change table CtButtonHlp~@~11505~@~20~@~D~@~~@~~@~M~@~~@~Change table CtButtonHlp~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.CtButtonHlp WHERE ButtonTypeId >= 67)
BEGIN
EXEC (' CREATE TABLE dbo.Tmp_CtButtonHlp (ButtonHlpId int NULL, CultureId smallint NULL, ButtonTypeId tinyint NULL, ButtonName nvarchar(50) NULL, ButtonToolTip nvarchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_CtButtonHlp (ButtonHlpId, CultureId, ButtonTypeId, ButtonName, ButtonToolTip) SELECT convert(int,ButtonHlpId), convert(smallint,CultureId), convert(tinyint,ButtonTypeId), ButtonName, ButtonToolTip FROM dbo.CtButtonHlp IF (SELECT COUNT(1) FROM dbo.Tmp_CtButtonHlp) > 0 OR (SELECT COUNT(1) FROM dbo.CtButtonHlp) = 0 DROP TABLE dbo.CtButtonHlp') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtButtonHlp'')) CREATE TABLE dbo.CtButtonHlp (ButtonHlpId Int IDENTITY NOT NULL, CultureId SmallInt NOT NULL, ButtonTypeId TinyInt NOT NULL, ButtonName NVarChar(50) NOT NULL, ButtonLongNm NVarChar(100) NOT NULL, ButtonToolTip NVarChar(200) NOT NULL, CONSTRAINT PK_CtButtonHlp PRIMARY KEY CLUSTERED (ButtonHlpId, CultureId))') EXEC (' ALTER TABLE dbo.CtButtonHlp ADD CONSTRAINT DF_CtButtonHlp_ButtonLongNm DEFAULT (''.'') FOR ButtonLongNm SET IDENTITY_INSERT dbo.CtButtonHlp ON INSERT INTO dbo.CtButtonHlp (ButtonHlpId, CultureId, ButtonTypeId, ButtonName, ButtonLongNm, ButtonToolTip) SELECT ButtonHlpId, CultureId, ButtonTypeId, ButtonName, ''.'', ButtonToolTip FROM dbo.Tmp_CtButtonHlp SET IDENTITY_INSERT dbo.CtButtonHlp OFF IF (SELECT COUNT(1) FROM dbo.CtButtonHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtButtonHlp) = 0 DROP TABLE dbo.Tmp_CtButtonHlp')

EXEC ('UPDATE dbo.CtButtonHlp SET ButtonLongNm = ButtonName')
EXEC ('INSERT dbo.CtButtonHlp (CultureId,ButtonTypeId,ButtonName,ButtonLongNm,ButtonToolTip) SELECT 1,67,''Delete'',''Delete Row'',''Press this to delete selected row''')
EXEC ('INSERT dbo.CtButtonHlp (CultureId,ButtonTypeId,ButtonName,ButtonLongNm,ButtonToolTip) SELECT 1,68,''Copy'',''Copy Row'',''Press this to duplicate selected row''')
EXEC ('INSERT dbo.CtButtonHlp (CultureId,ButtonTypeId,ButtonName,ButtonLongNm,ButtonToolTip) SELECT 1,69,''Edit'',''Edit Row'',''Press this to view/edit selected row''')
EXEC ('INSERT dbo.CtButtonHlp (CultureId,ButtonTypeId,ButtonName,ButtonLongNm,ButtonToolTip) SELECT 1,70,''Edit'',''Edit Header'',''Press this to view/edit selected header record''')
EXEC ('INSERT dbo.CtButtonHlp (CultureId,ButtonTypeId,ButtonName,ButtonLongNm,ButtonToolTip) SELECT 1,71,''Drilldown'',''Detail List'',''Press this to drill down to detail list''')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7740&typ=N&sys=3","","",""); return false;
7741~@~  10.  67.80921:D:   30:*:*:M: Change table ButtonHlp~@~11505~@~30~@~D~@~~@~~@~M~@~~@~Change table ButtonHlp~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_ButtonHlp (ButtonHlpId int NULL, ScreenId int NULL, ReportId int NULL, WizardId int NULL, CultureId smallint NULL, ButtonTypeId tinyint NULL, ButtonName nvarchar(200) NULL, ButtonToolTip nvarchar(400) NULL, ButtonVisible char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_ButtonHlp (ButtonHlpId, ScreenId, ReportId, WizardId, CultureId, ButtonTypeId, ButtonName, ButtonToolTip, ButtonVisible) SELECT convert(int,ButtonHlpId), convert(int,ScreenId), convert(int,ReportId), convert(int,WizardId), convert(smallint,CultureId), convert(tinyint,ButtonTypeId), ButtonName, ButtonToolTip, ButtonVisible FROM dbo.ButtonHlp IF (SELECT COUNT(1) FROM dbo.Tmp_ButtonHlp) > 0 OR (SELECT COUNT(1) FROM dbo.ButtonHlp) = 0 DROP TABLE dbo.ButtonHlp') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ButtonHlp'')) CREATE TABLE dbo.ButtonHlp (ButtonHlpId Int IDENTITY NOT NULL, ScreenId Int NULL, ReportId Int NULL, WizardId Int NULL, CultureId SmallInt NOT NULL, ButtonTypeId TinyInt NOT NULL, ButtonName NVarChar(200) NULL, ButtonLongNm NVarChar(400) NULL, ButtonToolTip NVarChar(400) NULL, ButtonVisible Char(1) NOT NULL, TopVisible Char(1) NOT NULL, RowVisible Char(1) NOT NULL, BotVisible Char(1) NOT NULL, CONSTRAINT PK_ButtonHlp PRIMARY KEY CLUSTERED (ButtonHlpId, CultureId))') EXEC (' ALTER TABLE dbo.ButtonHlp ADD CONSTRAINT DF_ButtonHlp_TopVisible DEFAULT (''N'') FOR TopVisible ALTER TABLE dbo.ButtonHlp ADD CONSTRAINT DF_ButtonHlp_RowVisible DEFAULT (''N'') FOR RowVisible ALTER TABLE dbo.ButtonHlp ADD CONSTRAINT DF_ButtonHlp_BotVisible DEFAULT (''N'') FOR BotVisible SET IDENTITY_INSERT dbo.ButtonHlp ON INSERT INTO dbo.ButtonHlp (ButtonHlpId, ScreenId, ReportId, WizardId, CultureId, ButtonTypeId, ButtonName, ButtonToolTip, ButtonVisible, TopVisible, RowVisible, BotVisible) SELECT ButtonHlpId, ScreenId, ReportId, WizardId, CultureId, ButtonTypeId, ButtonName, ButtonToolTip, ButtonVisible, ''N'', ''N'', ''N'' FROM dbo.Tmp_ButtonHlp SET IDENTITY_INSERT dbo.ButtonHlp OFF IF (SELECT COUNT(1) FROM dbo.ButtonHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ButtonHlp) = 0 DROP TABLE dbo.Tmp_ButtonHlp')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7741&typ=N&sys=3","","",""); return false;
7742~@~  10.  67.80921:D:   40:*:*:M: Add table CtButtonStyle~@~11505~@~40~@~D~@~~@~~@~M~@~~@~Add table CtButtonStyle~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtButtonStyle'))
BEGIN
EXEC ('CREATE TABLE dbo.CtButtonStyle (ButtonStyleCd Char(1) NOT NULL, ButtonStyleDesc NVarChar(100) NOT NULL, CONSTRAINT PK_CtButtonStyle PRIMARY KEY CLUSTERED (ButtonStyleCd))')
EXEC ('INSERT dbo.CtButtonStyle SELECT ''B'',''Display as a button''')
EXEC ('INSERT dbo.CtButtonStyle SELECT ''L'',''Display inside a list''')
EXEC ('INSERT dbo.CtButtonStyle SELECT ''N'',''Not displayed''')
END
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7742&typ=N&sys=3","","",""); return false;
7743~@~  10.  69.81011:D:   10:*:*:M: Change table Screen~@~11507~@~10~@~D~@~~@~~@~M~@~~@~Change table Screen~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Screen (ScreenId int NULL, ProgramName varchar(20) NULL, ScreenDesc nvarchar(50) NULL, ScreenTypeId tinyint NULL, MasterTableId int NULL, DetailTableId int NULL, SearchTableId int NULL, SearchId int NULL, SearchAscending char(1) NULL, SearchDtlId int NULL, SearchUrlId int NULL, SearchImgId int NULL, GridRows tinyint NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL, GenerateSc char(1) NULL, GenerateSr char(1) NULL, HasDeleteAll char(1) NULL, ShowGridHead char(1) NULL, ValidateReq char(1) NULL, DeferError char(1) NULL, AuthRequired char(1) NULL, ViewOnly char(1) NULL, GenAudit char(1) NULL, NeedRegen char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchTableId, SearchId, SearchAscending, SearchDtlId, SearchUrlId, SearchImgId, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen) SELECT convert(int,ScreenId), ProgramName, ScreenDesc, convert(tinyint,ScreenTypeId), convert(int,MasterTableId), convert(int,DetailTableId), convert(int,SearchTableId), convert(int,SearchId), SearchAscending, convert(int,SearchDtlId), convert(int,SearchUrlId), convert(int,SearchImgId), convert(tinyint,GridRows), ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchTableId Int NULL, SearchId Int NULL, SearchAscending Char(1) NOT NULL, SearchIdR Int NULL, SearchDtlId Int NULL, SearchDtlIdR Int NULL, SearchUrlId Int NULL, SearchImgId Int NULL, GridRows TinyInt NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, GenerateSr Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ShowGridHead Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, AuthRequired Char(1) NOT NULL, ViewOnly Char(1) NOT NULL, GenAudit Char(1) NOT NULL, NeedRegen Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSc DEFAULT (''Y'') FOR GenerateSc ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSr DEFAULT (''Y'') FOR GenerateSr ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ShowGridHead DEFAULT (''Y'') FOR ShowGridHead ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_AuthRequired DEFAULT (''Y'') FOR AuthRequired ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ViewOnly DEFAULT (''N'') FOR ViewOnly ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenAudit DEFAULT (''N'') FOR GenAudit ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NeedRegen DEFAULT (''N'') FOR NeedRegen SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchTableId, SearchId, SearchAscending, SearchDtlId, SearchUrlId, SearchImgId, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchTableId, SearchId, SearchAscending, SearchDtlId, SearchUrlId, SearchImgId, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7743&typ=N&sys=3","","",""); return false;
7744~@~  10.  70.81013:D:   10:*:*:M: Change table ScreenObj~@~11508~@~10~@~D~@~~@~~@~M~@~~@~Change table ScreenObj~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_ScreenObj (ScreenObjId int NULL, ScreenId int NULL, MasterTable char(1) NULL, NewGroupRow char(1) NULL, GroupRowId smallint NULL, GroupColId smallint NULL, LabelVertical char(1) NULL, LabelCss varchar(1000) NULL, ContentCss varchar(1000) NULL, ColumnId int NULL, ColumnName varchar(50) NULL, ColumnDesc varchar(200) NULL, DefaultValue nvarchar(200) NULL, HyperLinkUrl nvarchar(200) NULL, DefAfter char(1) NULL, SystemValue nvarchar(200) NULL, DefAlways char(1) NULL, ColumnWrap char(1) NULL, GridGrpCd char(1) NULL, HideOnTablet char(1) NULL, HideOnMobile char(1) NULL, ColumnJustify char(1) NULL, ColumnSize smallint NULL, ColumnHeight smallint NULL, DisplayModeId tinyint NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DdlAdnColumnId int NULL, DdlFtrColumnId int NULL, AggregateCd char(1) NULL, GenerateSp char(1) NULL, TabFolderId int NULL, TabIndex smallint NULL, SortOrder smallint NULL, RequiredValid char(1) NULL, MaskValid varchar(100) NULL, RangeValidType varchar(50) NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, ColumnLink varchar(1000) NULL, RefreshOnCUD char(1) NULL, TrimOnEntry char(1) NULL, MatchCd char(1) NULL, IgnoreConfirm char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObj (ScreenObjId, ScreenId, MasterTable, NewGroupRow, GroupRowId, GroupColId, LabelVertical, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, HyperLinkUrl, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, HideOnTablet, HideOnMobile, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm) SELECT convert(int,ScreenObjId), convert(int,ScreenId), MasterTable, NewGroupRow, convert(smallint,GroupRowId), convert(smallint,GroupColId), LabelVertical, LabelCss, ContentCss, convert(int,ColumnId), ColumnName, ColumnDesc, DefaultValue, HyperLinkUrl, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, HideOnTablet, HideOnMobile, ColumnJustify, convert(smallint,ColumnSize), convert(smallint,ColumnHeight), convert(tinyint,DisplayModeId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), convert(int,DdlAdnColumnId), convert(int,DdlFtrColumnId), AggregateCd, GenerateSp, convert(int,TabFolderId), convert(smallint,TabIndex), convert(smallint,SortOrder), RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj')
IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.ScreenObj'))
BEGIN
EXEC ('CREATE TABLE dbo.ScreenObj (ScreenObjId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, NewGroupRow Char(1) NOT NULL, GroupRowId SmallInt NOT NULL, GroupColId SmallInt NOT NULL, LabelVertical Char(1) NOT NULL, LabelCss VarChar(1000) NULL, ContentCss VarChar(1000) NULL, ColumnId Int NULL, ColumnName VarChar(50) NOT NULL, ColumnDesc VarChar(200) NULL, DefaultValue NVarChar(200) NULL, HyperLinkUrl NVarChar(200) NULL, DefAfter Char(1) NOT NULL, SystemValue NVarChar(200) NULL, DefAlways Char(1) NOT NULL, ColumnWrap Char(1) NOT NULL, GridGrpCd Char(1) NOT NULL, HideOnTablet Char(1) NOT NULL, HideOnMobile Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, ResizeWidth SmallInt NULL, ColumnHeight SmallInt NULL, ResizeHeight SmallInt NULL, DisplayModeId TinyInt NOT NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlAdnColumnId Int NULL, DdlFtrColumnId Int NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId Int NOT NULL, TabIndex SmallInt NOT NULL, SortOrder SmallInt NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(100) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(1000) NULL, RefreshOnCUD Char(1) NOT NULL, TrimOnEntry Char(1) NOT NULL, MatchCd Char(1) NULL, IgnoreConfirm Char(1) NOT NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))') EXEC (' ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_NewGroupRow DEFAULT (''N'') FOR NewGroupRow ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_GroupRowId DEFAULT (78) FOR GroupRowId ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_LabelVertical DEFAULT (''N'') FOR LabelVertical ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAfter DEFAULT (''N'') FOR DefAfter ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAlways DEFAULT (''N'') FOR DefAlways ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_GridGrpCd DEFAULT (''N'') FOR GridGrpCd ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_HideOnTablet DEFAULT (''N'') FOR HideOnTablet ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_HideOnMobile DEFAULT (''N'') FOR HideOnMobile ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_TrimOnEntry DEFAULT (''Y'') FOR TrimOnEntry ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_IgnoreConfirm DEFAULT (''Y'') FOR IgnoreConfirm SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, NewGroupRow, GroupRowId, GroupColId, LabelVertical, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, HyperLinkUrl, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, HideOnTablet, HideOnMobile, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm) SELECT ScreenObjId, ScreenId, MasterTable, NewGroupRow, GroupRowId, GroupColId, LabelVertical, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, HyperLinkUrl, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, HideOnTablet, HideOnMobile, ColumnJustify, ColumnSize, ColumnHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj')
EXEC ('UPDATE dbo.ScreenObj SET ResizeHeight = ColumnHeight, ResizeWidth = ColumnSize WHERE DisplayModeId = 28')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7744&typ=N&sys=3","","",""); return false;
7746~@~  10.  70.81013:D:   20:*:*:M: Change table ScreenHlp~@~11508~@~20~@~D~@~~@~~@~M~@~~@~Change table ScreenHlp~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_ScreenHlp (ScreenHlpId int NULL, ScreenId int NULL, CultureId smallint NULL, DefaultHlpMsg nvarchar(max) NULL, FootNote nvarchar(400) NULL, ScreenTitle nvarchar(50) NULL, AddMsg nvarchar(100) NULL, UpdMsg nvarchar(100) NULL, DelMsg nvarchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenHlp (ScreenHlpId, ScreenId, CultureId, DefaultHlpMsg, FootNote, ScreenTitle, AddMsg, UpdMsg, DelMsg) SELECT convert(int,ScreenHlpId), convert(int,ScreenId), convert(smallint,CultureId), DefaultHlpMsg, FootNote, ScreenTitle, AddMsg, UpdMsg, DelMsg FROM dbo.ScreenHlp IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenHlp) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenHlp) = 0 DROP TABLE dbo.ScreenHlp')
IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.ScreenHlp'))
BEGIN
EXEC ('CREATE TABLE dbo.ScreenHlp (ScreenHlpId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, CultureId SmallInt NOT NULL, DefaultHlpMsg NVarChar(max) NOT NULL, FootNote NVarChar(400) NULL, ScreenTitle NVarChar(50) NOT NULL, AddMsg NVarChar(100) NULL, UpdMsg NVarChar(100) NULL, DelMsg NVarChar(100) NULL, IncrementMsg NVarChar(100) NULL, MasterLstTitle NVarChar(100) NULL, MasterLstSubtitle NVarChar(100) NULL, MasterRecTitle NVarChar(100) NULL, MasterRecSubtitle NVarChar(100) NULL, DetailLstTitle NVarChar(100) NULL, DetailLstSubtitle NVarChar(100) NULL, DetailRecTitle NVarChar(100) NULL, DetailRecSubtitle NVarChar(100) NULL, CONSTRAINT PK_ScreenHlp PRIMARY KEY CLUSTERED (ScreenHlpId, CultureId))') EXEC (' SET IDENTITY_INSERT dbo.ScreenHlp ON INSERT INTO dbo.ScreenHlp (ScreenHlpId, ScreenId, CultureId, DefaultHlpMsg, FootNote, ScreenTitle, AddMsg, UpdMsg, DelMsg) SELECT ScreenHlpId, ScreenId, CultureId, DefaultHlpMsg, FootNote, ScreenTitle, AddMsg, UpdMsg, DelMsg FROM dbo.Tmp_ScreenHlp SET IDENTITY_INSERT dbo.ScreenHlp OFF IF (SELECT COUNT(1) FROM dbo.ScreenHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenHlp) = 0 DROP TABLE dbo.Tmp_ScreenHlp')
EXEC ('delete from ScreenHlp where CultureId <> 1')
EXEC ('update ScreenHlp SET MasterLstTitle = ''Master list'', MasterLstSubtitle = ''Create or select a master record''')
EXEC ('update ScreenHlp SET DetailLstTitle = ''Detail list'', DetailLstSubtitle = ''Add or edit a detail record''')
EXEC ('update ScreenHlp SET MasterRecTitle = ''Master record'', MasterRecSubtitle = ''Manage your master information''')
EXEC ('update ScreenHlp SET DetailRecTitle = ''Detail record'', DetailRecSubtitle = ''Enter or update detail information''')
EXEC ('update ScreenHlp SET IncrementMsg = ''View {10} more''')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7746&typ=N&sys=3","","",""); return false;
7747~@~  10.  70.81013:D:   30:*:*:M: Change table CtButtonHlp~@~11508~@~30~@~D~@~~@~~@~M~@~~@~Change table CtButtonHlp~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_CtButtonHlp (ButtonHlpId int NULL, CultureId smallint NULL, ButtonTypeId tinyint NULL, ButtonName nvarchar(50) NULL, ButtonLongNm nvarchar(100) NULL, ButtonToolTip nvarchar(200) NULL)') EXEC (' INSERT INTO dbo.Tmp_CtButtonHlp (ButtonHlpId, CultureId, ButtonTypeId, ButtonName, ButtonLongNm, ButtonToolTip) SELECT convert(int,ButtonHlpId), convert(smallint,CultureId), convert(tinyint,ButtonTypeId), ButtonName, ButtonLongNm, ButtonToolTip FROM dbo.CtButtonHlp IF (SELECT COUNT(1) FROM dbo.Tmp_CtButtonHlp) > 0 OR (SELECT COUNT(1) FROM dbo.CtButtonHlp) = 0 DROP TABLE dbo.CtButtonHlp') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtButtonHlp'')) CREATE TABLE dbo.CtButtonHlp (ButtonHlpId Int IDENTITY NOT NULL, CultureId SmallInt NOT NULL, ButtonTypeId TinyInt NOT NULL, ButtonName NVarChar(50) NOT NULL, ButtonLongNm NVarChar(100) NOT NULL, ButtonToolTip NVarChar(200) NOT NULL, CONSTRAINT PK_CtButtonHlp PRIMARY KEY CLUSTERED (ButtonHlpId, CultureId))') EXEC (' ALTER TABLE dbo.CtButtonHlp ADD CONSTRAINT DF_CtButtonHlp_ButtonLongNm DEFAULT (''.'') FOR ButtonLongNm SET IDENTITY_INSERT dbo.CtButtonHlp ON INSERT INTO dbo.CtButtonHlp (ButtonHlpId, CultureId, ButtonTypeId, ButtonName, ButtonLongNm, ButtonToolTip) SELECT ButtonHlpId, CultureId, ButtonTypeId, ButtonName, ButtonLongNm, ButtonToolTip FROM dbo.Tmp_CtButtonHlp SET IDENTITY_INSERT dbo.CtButtonHlp OFF IF (SELECT COUNT(1) FROM dbo.CtButtonHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_CtButtonHlp) = 0 DROP TABLE dbo.Tmp_CtButtonHlp IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IU_CtButtonHlp'') CREATE UNIQUE NONCLUSTERED INDEX IU_CtButtonHlp ON dbo.CtButtonHlp(CultureId,ButtonTypeId)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7747&typ=N&sys=3","","",""); return false;
7748~@~  10.  71.81014:D:   10:*:*:M: Change table ScreenHlp~@~11509~@~10~@~D~@~~@~~@~M~@~~@~Change table ScreenHlp~@~Y~@~EXEC ('CREATE TABLE dbo.Tmp_ScreenHlp (ScreenHlpId int NULL, ScreenId int NULL, CultureId smallint NULL, DefaultHlpMsg nvarchar(max) NULL, FootNote nvarchar(400) NULL, ScreenTitle nvarchar(50) NULL, AddMsg nvarchar(100) NULL, UpdMsg nvarchar(100) NULL, DelMsg nvarchar(100) NULL, IncrementMsg nvarchar(100) NULL, MasterLstTitle nvarchar(100) NULL, MasterLstSubtitle nvarchar(100) NULL, MasterRecTitle nvarchar(100) NULL, MasterRecSubtitle nvarchar(100) NULL, DetailLstTitle nvarchar(100) NULL, DetailLstSubtitle nvarchar(100) NULL, DetailRecTitle nvarchar(100) NULL, DetailRecSubtitle nvarchar(100) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenHlp (ScreenHlpId, ScreenId, CultureId, DefaultHlpMsg, FootNote, ScreenTitle, AddMsg, UpdMsg, DelMsg, IncrementMsg, MasterLstTitle, MasterLstSubtitle, MasterRecTitle, MasterRecSubtitle, DetailLstTitle, DetailLstSubtitle, DetailRecTitle, DetailRecSubtitle) SELECT convert(int,ScreenHlpId), convert(int,ScreenId), convert(smallint,CultureId), DefaultHlpMsg, FootNote, ScreenTitle, AddMsg, UpdMsg, DelMsg, IncrementMsg, MasterLstTitle, MasterLstSubtitle, MasterRecTitle, MasterRecSubtitle, DetailLstTitle, DetailLstSubtitle, DetailRecTitle, DetailRecSubtitle FROM dbo.ScreenHlp IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenHlp) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenHlp) = 0 DROP TABLE dbo.ScreenHlp')
IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.ScreenHlp'))
BEGIN
EXEC ('CREATE TABLE dbo.ScreenHlp (ScreenHlpId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, CultureId SmallInt NOT NULL, DefaultHlpMsg NVarChar(max) NOT NULL, FootNote NVarChar(400) NULL, ScreenTitle NVarChar(50) NOT NULL, AddMsg NVarChar(100) NULL, UpdMsg NVarChar(100) NULL, DelMsg NVarChar(100) NULL, IncrementMsg NVarChar(100) NULL, MasterLstTitle NVarChar(100) NULL, MasterLstSubtitle NVarChar(100) NULL, MasterRecTitle NVarChar(100) NULL, MasterRecSubtitle NVarChar(100) NULL, DetailLstTitle NVarChar(100) NULL, DetailLstSubtitle NVarChar(100) NULL, DetailRecTitle NVarChar(100) NULL, DetailRecSubtitle NVarChar(100) NULL, NoMasterMsg NVarChar(100) NULL, NoDetailMsg NVarChar(100) NULL, AddMasterMsg NVarChar(100) NULL, AddDetailMsg NVarChar(100) NULL, MasterFoundMsg NVarChar(100) NULL, DetailFoundMsg NVarChar(100) NULL, CONSTRAINT PK_ScreenHlp PRIMARY KEY CLUSTERED (ScreenHlpId, CultureId))') EXEC (' SET IDENTITY_INSERT dbo.ScreenHlp ON INSERT INTO dbo.ScreenHlp (ScreenHlpId, ScreenId, CultureId, DefaultHlpMsg, FootNote, ScreenTitle, AddMsg, UpdMsg, DelMsg, IncrementMsg, MasterLstTitle, MasterLstSubtitle, MasterRecTitle, MasterRecSubtitle, DetailLstTitle, DetailLstSubtitle, DetailRecTitle, DetailRecSubtitle) SELECT ScreenHlpId, ScreenId, CultureId, DefaultHlpMsg, FootNote, ScreenTitle, AddMsg, UpdMsg, DelMsg, IncrementMsg, MasterLstTitle, MasterLstSubtitle, MasterRecTitle, MasterRecSubtitle, DetailLstTitle, DetailLstSubtitle, DetailRecTitle, DetailRecSubtitle FROM dbo.Tmp_ScreenHlp SET IDENTITY_INSERT dbo.ScreenHlp OFF IF (SELECT COUNT(1) FROM dbo.ScreenHlp) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenHlp) = 0 DROP TABLE dbo.Tmp_ScreenHlp')
EXEC ('update ScreenHlp SET NoMasterMsg = ''No master record selected'', NoDetailMsg = ''No detail record selected''')
EXEC ('update ScreenHlp SET AddMasterMsg = ''Click here to enter a new master record'', AddDetailMsg = ''Click here to enter a new detail record''')
EXEC ('update ScreenHlp SET MasterFoundMsg = ''Master records found'', DetailFoundMsg = ''Detail records found''')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7748&typ=N&sys=3","","",""); return false;
7749~@~  10.  75.81024:D:   10:*:*:M: Change table Usr~@~11513~@~10~@~D~@~~@~~@~M~@~~@~Change table Usr~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_Usr (UsrId int NULL, LoginName nvarchar(32) NULL, UsrEmail nvarchar(50) NULL, UsrMobile varchar(50) NULL, UsrName nvarchar(50) NULL, UsrPassword varbinary(32) NULL, ConfirmPwd varbinary(32) NULL, ExtPassword varbinary(255) NULL, CultureId smallint NULL, InternalUsr char(1) NULL, TechnicalUsr char(1) NULL, UsrGroupLs varchar(1000) NULL, CompanyLs varchar(1000) NULL, ProjectLs varchar(1000) NULL, InvestorId int NULL, CustomerId int NULL, VendorId int NULL, AgentId int NULL, BrokerId int NULL, MemberId int NULL, DefSystemId tinyint NULL, DefProjectId int NULL, DefCompanyId int NULL, FailedAttempt tinyint NULL, FailedAttemptFP tinyint NULL, LastFailedDt datetime NULL, LastSuccessDt datetime NULL, LastPwdChgDt datetime NULL, HintQuestionId tinyint NULL, HintAnswer nvarchar(50) NULL, Active char(1) NULL, ModifiedOn datetime NULL, UsrImprLink varchar(200) NULL, IPAlert char(1) NULL, PwdNoRepeat smallint NULL, PwdDuration smallint NULL, PwdWarn smallint NULL, PicMed varbinary(max) NULL, OTPSecret varchar(64) NULL, TwoFactorAuth char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Usr (UsrId, LoginName, UsrEmail, UsrMobile, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, LastPwdChgDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink, IPAlert, PwdNoRepeat, PwdDuration, PwdWarn, PicMed, OTPSecret, TwoFactorAuth) SELECT convert(int,UsrId), LoginName, UsrEmail, UsrMobile, UsrName, UsrPassword, ConfirmPwd, ExtPassword, convert(smallint,CultureId), InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, convert(int,InvestorId), convert(int,CustomerId), convert(int,VendorId), convert(int,AgentId), convert(int,BrokerId), convert(int,MemberId), convert(tinyint,DefSystemId), convert(int,DefProjectId), convert(int,DefCompanyId), convert(tinyint,FailedAttempt), convert(tinyint,FailedAttemptFP), LastFailedDt, LastSuccessDt, LastPwdChgDt, convert(tinyint,HintQuestionId), HintAnswer, Active, ModifiedOn, UsrImprLink, IPAlert, convert(smallint,PwdNoRepeat), convert(smallint,PwdDuration), convert(smallint,PwdWarn), PicMed, OTPSecret, TwoFactorAuth FROM dbo.Usr IF (SELECT COUNT(1) FROM dbo.Tmp_Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Usr) = 0 DROP TABLE dbo.Usr') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Usr'')) CREATE TABLE dbo.Usr (UsrId Int IDENTITY NOT NULL, LoginName NVarChar(32) NOT NULL, UsrEmail NVarChar(50) NULL, UsrMobile VarChar(50) NULL, UsrName NVarChar(50) NULL, UsrPassword VarBinary(32) NULL, ConfirmPwd VarBinary(32) NULL, ExtPassword VarBinary(255) NULL, CultureId SmallInt NOT NULL, InternalUsr Char(1) NOT NULL, TechnicalUsr Char(1) NOT NULL, UsrGroupLs VarChar(1000) NOT NULL, CompanyLs VarChar(1000) NULL, ProjectLs VarChar(1000) NULL, InvestorId Int NULL, CustomerId Int NULL, VendorId Int NULL, AgentId Int NULL, BrokerId Int NULL, MemberId Int NULL, LenderId Int NULL, BorrowerId Int NULL, GuarantorId Int NULL, DefSystemId TinyInt NOT NULL, DefProjectId Int NULL, DefCompanyId Int NULL, FailedAttempt TinyInt NULL, FailedAttemptFP TinyInt NULL, LastFailedDt DateTime NULL, LastSuccessDt DateTime NULL, LastPwdChgDt DateTime NULL, HintQuestionId TinyInt NULL, HintAnswer NVarChar(50) NULL, Active Char(1) NOT NULL, ModifiedOn DateTime NOT NULL, UsrImprLink VarChar(200) NULL, IPAlert Char(1) NOT NULL, PwdNoRepeat SmallInt NOT NULL, PwdDuration SmallInt NOT NULL, PwdWarn SmallInt NOT NULL, PicMed VarBinary(max) NULL, OTPSecret VarChar(64) NULL, TwoFactorAuth Char(1) NOT NULL, CONSTRAINT PK_Usr PRIMARY KEY CLUSTERED (UsrId, CultureId))') EXEC (' ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_CultureId DEFAULT (1) FOR CultureId ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_InternalUsr DEFAULT (''N'') FOR InternalUsr ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_TechnicalUsr DEFAULT (''N'') FOR TechnicalUsr ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_IPAlert DEFAULT (''N'') FOR IPAlert ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdNoRepeat DEFAULT (1) FOR PwdNoRepeat ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdDuration DEFAULT (9999) FOR PwdDuration ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_PwdWarn DEFAULT (0) FOR PwdWarn ALTER TABLE dbo.Usr ADD CONSTRAINT DF_Usr_TwoFactorAuth DEFAULT (''N'') FOR TwoFactorAuth SET IDENTITY_INSERT dbo.Usr ON INSERT INTO dbo.Usr (UsrId, LoginName, UsrEmail, UsrMobile, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, LastPwdChgDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink, IPAlert, PwdNoRepeat, PwdDuration, PwdWarn, PicMed, OTPSecret, TwoFactorAuth) SELECT UsrId, LoginName, UsrEmail, UsrMobile, UsrName, UsrPassword, ConfirmPwd, ExtPassword, CultureId, InternalUsr, TechnicalUsr, UsrGroupLs, CompanyLs, ProjectLs, InvestorId, CustomerId, VendorId, AgentId, BrokerId, MemberId, DefSystemId, DefProjectId, DefCompanyId, FailedAttempt, FailedAttemptFP, LastFailedDt, LastSuccessDt, LastPwdChgDt, HintQuestionId, HintAnswer, Active, ModifiedOn, UsrImprLink, IPAlert, PwdNoRepeat, PwdDuration, PwdWarn, PicMed, OTPSecret, TwoFactorAuth FROM dbo.Tmp_Usr SET IDENTITY_INSERT dbo.Usr OFF IF (SELECT COUNT(1) FROM dbo.Usr) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Usr) = 0 DROP TABLE dbo.Tmp_Usr IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IU_Usr'') CREATE UNIQUE NONCLUSTERED INDEX IU_Usr ON dbo.Usr(LoginName)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7749&typ=N&sys=3","","",""); return false;
7750~@~  10.  75.81024:D:   20:*:*:M: Change table UsrPref~@~11513~@~20~@~D~@~~@~~@~M~@~~@~Change table UsrPref~@~N~@~ EXEC (' CREATE TABLE dbo.Tmp_UsrPref (UsrPrefId int NULL, UsrId int NULL, UsrGroupId smallint NULL, CompanyId int NULL, MemberId int NULL, AgentId int NULL, BrokerId int NULL, CustomerId int NULL, InvestorId int NULL, VendorId int NULL, ProjectId int NULL, SystemId tinyint NULL, PrefDefault char(1) NULL, UsrPrefDesc nvarchar(50) NULL, SysListVisible char(1) NULL, ComListVisible char(1) NULL, PrjListVisible char(1) NULL, MenuOptId int NULL, UsrStyleSheet varchar(max) NULL, MasterPgFile varchar(100) NULL, LoginImage varchar(200) NULL, MobileImage varchar(200) NULL, SampleImage varbinary(max) NULL)') EXEC (' INSERT INTO dbo.Tmp_UsrPref (UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOptId, UsrStyleSheet, MasterPgFile, LoginImage, MobileImage, SampleImage) SELECT convert(int,UsrPrefId), convert(int,UsrId), convert(smallint,UsrGroupId), convert(int,CompanyId), convert(int,MemberId), convert(int,AgentId), convert(int,BrokerId), convert(int,CustomerId), convert(int,InvestorId), convert(int,VendorId), convert(int,ProjectId), convert(tinyint,SystemId), PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, convert(int,MenuOptId), UsrStyleSheet, MasterPgFile, LoginImage, MobileImage, SampleImage FROM dbo.UsrPref IF (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.UsrPref) = 0 DROP TABLE dbo.UsrPref') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.UsrPref'')) CREATE TABLE dbo.UsrPref (UsrPrefId Int IDENTITY NOT NULL, UsrId Int NULL, UsrGroupId SmallInt NULL, CompanyId Int NULL, MemberId Int NULL, AgentId Int NULL, BrokerId Int NULL, CustomerId Int NULL, InvestorId Int NULL, VendorId Int NULL, LenderId Int NULL, BorrowerId Int NULL, GuarantorId Int NULL, ProjectId Int NULL, SystemId TinyInt NULL, PrefDefault Char(1) NOT NULL, UsrPrefDesc NVarChar(50) NOT NULL, SysListVisible Char(1) NOT NULL, ComListVisible Char(1) NOT NULL, PrjListVisible Char(1) NOT NULL, MenuOptId Int NOT NULL, UsrStyleSheet VarChar(max) NULL, MasterPgFile VarChar(100) NULL, LoginImage VarChar(200) NULL, MobileImage VarChar(200) NULL, SampleImage VarBinary(max) NULL, CONSTRAINT PK_UsrPref PRIMARY KEY CLUSTERED (UsrPrefId))') EXEC (' ALTER TABLE dbo.UsrPref ADD CONSTRAINT DF_UsrPref_PrjListVisible DEFAULT (''N'') FOR PrjListVisible SET IDENTITY_INSERT dbo.UsrPref ON INSERT INTO dbo.UsrPref (UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOptId, UsrStyleSheet, MasterPgFile, LoginImage, MobileImage, SampleImage) SELECT UsrPrefId, UsrId, UsrGroupId, CompanyId, MemberId, AgentId, BrokerId, CustomerId, InvestorId, VendorId, ProjectId, SystemId, PrefDefault, UsrPrefDesc, SysListVisible, ComListVisible, PrjListVisible, MenuOptId, UsrStyleSheet, MasterPgFile, LoginImage, MobileImage, SampleImage FROM dbo.Tmp_UsrPref SET IDENTITY_INSERT dbo.UsrPref OFF IF (SELECT COUNT(1) FROM dbo.UsrPref) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_UsrPref) = 0 DROP TABLE dbo.Tmp_UsrPref')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7750&typ=N&sys=3","","",""); return false;
7751~@~   9.  14.50214:D:   10:*:*:M: Adjust when absent~@~6387~@~10~@~D~@~~@~~@~M~@~~@~Adjust when absent~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM [[?]]CmonD.dbo.DbTable WHERE TableName = ''Usr'')
BEGIN
	DECLARE @id int
	INSERT [[?]]CmonD.dbo.DbTable (SystemId,TableName,TableDesc,MultiDesignDb,VirtualTbl) SELECT 3,''Usr'',''Adm - User Info'',''N'',''N''
	SELECT @id = @@IDENTITY
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,10,''UsrId'',''Usr - UsrId'',3,4,''N'',''Y'',''Y'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,20,''UsrName'',''Usr - UsrName'',11,50,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,30,''Active'',''Usr - Active'',14,1,''N'',''N'',''N'',''N'',''N''
END')
EXEC ('IF NOT EXISTS (SELECT 1 FROM [[?]]CmonD.dbo.DbTable WHERE TableName = ''Project'')
BEGIN
	DECLARE @id int
	INSERT [[?]]CmonD.dbo.DbTable (SystemId,TableName,TableDesc,MultiDesignDb,VirtualTbl) SELECT 5,''Project'',''Cmn - Project Info'',''N'',''N''
	SELECT @id = @@IDENTITY
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,10,''ProjectId'',''Project - ProjectId'',3,4,''N'',''Y'',''Y'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,20,''ProjectDesc'',''Project - ProjectDesc'',11,100,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,30,''CompanyId'',''Project - CompanyId'',3,4,''Y'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,40,''Active'',''Project - Active'',14,1,''N'',''N'',''N'',''N'',''N''
END')
EXEC ('IF NOT EXISTS (SELECT 1 FROM [[?]]CmonD.dbo.DbTable WHERE TableName = ''Company'')
BEGIN
	DECLARE @id int
	INSERT [[?]]CmonD.dbo.DbTable (SystemId,TableName,TableDesc,MultiDesignDb,VirtualTbl) SELECT 5,''Company'',''Cmn - Company Info'',''N'',''N''
	SELECT @id = @@IDENTITY
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,10,''CompanyId'',''Company - CompanyId'',3,4,''N'',''Y'',''Y'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,20,''FirmId'',''Company - FirmId'',3,4,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,30,''CompanyDesc'',''Company - CompanyDesc'',11,100,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,40,''Active'',''Company - Active'',14,1,''N'',''N'',''N'',''N'',''N''
END')
EXEC ('IF NOT EXISTS (SELECT 1 FROM [[?]]CmonD.dbo.DbTable WHERE TableName = ''Country'')
BEGIN
	DECLARE @id int
	INSERT [[?]]CmonD.dbo.DbTable (SystemId,TableName,TableDesc,MultiDesignDb,VirtualTbl) SELECT 5,''Country'',''Cmn - Country Info'',''N'',''N''
	SELECT @id = @@IDENTITY
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,10,''CountryId'',''Country - CountryId'',2,2,''N'',''Y'',''Y'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,20,''CountryName'',''Country - CountryName'',11,50,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,30,''CountryCd'',''Country - CountryCd'',14,3,''N'',''N'',''N'',''N'',''N''
END')
EXEC ('IF NOT EXISTS (SELECT 1 FROM [[?]]CmonD.dbo.DbTable WHERE TableName = ''State'')
BEGIN
	DECLARE @id int
	INSERT [[?]]CmonD.dbo.DbTable (SystemId,TableName,TableDesc,MultiDesignDb,VirtualTbl) SELECT 5,''State'',''Cmn - State Info'',''N'',''N''
	SELECT @id = @@IDENTITY
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,10,''StateId'',''State - StateId'',2,2,''N'',''Y'',''Y'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,20,''StateName'',''State - StateName'',11,50,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,30,''CountryId'',''State - CountryId'',2,2,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,40,''StateCode'',''State - StateCode'',15,3,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,50,''PstTaxable'',''State - PstTaxable'',14,1,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,60,''GstTaxable'',''State - GstTaxable'',14,1,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,70,''GstCascade'',''State - GstCascade'',14,1,''N'',''N'',''N'',''N'',''N''
END')
EXEC ('IF NOT EXISTS (SELECT 1 FROM [[?]]CmonD.dbo.DbTable WHERE TableName = ''City'')
BEGIN
	DECLARE @id int
	INSERT [[?]]CmonD.dbo.DbTable (SystemId,TableName,TableDesc,MultiDesignDb,VirtualTbl) SELECT 5,''City'',''Cmn - City Info'',''N'',''N''
	SELECT @id = @@IDENTITY
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,10,''CityId'',''City - CityId'',3,4,''N'',''Y'',''Y'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,20,''CityName'',''City - CityName'',11,50,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,30,''CountryId'',''City - CountryId'',2,2,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,40,''StateId'',''City - StateId'',2,2,''N'',''N'',''N'',''N'',''N''
END')
EXEC ('IF NOT EXISTS (SELECT 1 FROM [[?]]CmonD.dbo.DbTable WHERE TableName = ''Firm'')
BEGIN
	DECLARE @id int
	INSERT [[?]]CmonD.dbo.DbTable (SystemId,TableName,TableDesc,MultiDesignDb,VirtualTbl) SELECT 5,''Firm'',''Cmn - Firm Info'',''N'',''N''
	SELECT @id = @@IDENTITY
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,10,''FirmId'',''Firm - FirmId'',3,4,''N'',''Y'',''Y'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,20,''TradeName'',''Firm - TradeName'',11,100,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,30,''LegalName'',''Firm - LegalName'',11,100,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,40,''Active'',''Firm - Active'',14,1,''N'',''N'',''N'',''N'',''N''
END')
EXEC ('IF NOT EXISTS (SELECT 1 FROM [[?]]CmonD.dbo.DbTable WHERE TableName = ''Agent'')
BEGIN
	DECLARE @id int
	INSERT [[?]]CmonD.dbo.DbTable (SystemId,TableName,TableDesc,MultiDesignDb,VirtualTbl) SELECT 5,''Agent'',''Cmn - Agent Info'',''N'',''N''
	SELECT @id = @@IDENTITY
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,10,''AgentId'',''Agent - AgentId'',3,4,''N'',''Y'',''Y'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,20,''FirmId'',''Agent - FirmId'',3,4,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,30,''AgentName'',''Agent - AgentName'',11,100,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,40,''Active'',''Agent - Active'',14,1,''N'',''N'',''N'',''N'',''N''
END')
EXEC ('IF NOT EXISTS (SELECT 1 FROM [[?]]CmonD.dbo.DbTable WHERE TableName = ''Broker'')
BEGIN
	DECLARE @id int
	INSERT [[?]]CmonD.dbo.DbTable (SystemId,TableName,TableDesc,MultiDesignDb,VirtualTbl) SELECT 5,''Broker'',''Cmn - Broker Info'',''N'',''N''
	SELECT @id = @@IDENTITY
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,10,''BrokerId'',''Broker - BrokerId'',3,4,''N'',''Y'',''Y'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,20,''FirmId'',''Broker - FirmId'',3,4,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,30,''BrokerName'',''Broker - BrokerName'',11,100,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,40,''Active'',''Broker - Active'',14,1,''N'',''N'',''N'',''N'',''N''
END')
EXEC ('IF NOT EXISTS (SELECT 1 FROM [[?]]CmonD.dbo.DbTable WHERE TableName = ''Customer'')
BEGIN
	DECLARE @id int
	INSERT [[?]]CmonD.dbo.DbTable (SystemId,TableName,TableDesc,MultiDesignDb,VirtualTbl) SELECT 5,''Customer'',''Cmn - Customer Info'',''N'',''N''
	SELECT @id = @@IDENTITY
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,10,''CustomerId'',''Customer - CustomerId'',3,4,''N'',''Y'',''Y'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,20,''FirmId'',''Customer - FirmId'',3,4,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,30,''CustomerName'',''Customer - CustomerName'',11,100,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,40,''Active'',''Customer - Active'',14,1,''N'',''N'',''N'',''N'',''N''
END')
EXEC ('IF NOT EXISTS (SELECT 1 FROM [[?]]CmonD.dbo.DbTable WHERE TableName = ''Investor'')
BEGIN
	DECLARE @id int
	INSERT [[?]]CmonD.dbo.DbTable (SystemId,TableName,TableDesc,MultiDesignDb,VirtualTbl) SELECT 5,''Investor'',''Cmn - Investor Info'',''N'',''N''
	SELECT @id = @@IDENTITY
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,10,''InvestorId'',''Investor - InvestorId'',3,4,''N'',''Y'',''Y'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,20,''FirmId'',''Investor - FirmId'',3,4,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,30,''InvestorName'',''Investor - InvestorName'',11,100,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,40,''Active'',''Investor - Active'',14,1,''N'',''N'',''N'',''N'',''N''
END')
EXEC ('IF NOT EXISTS (SELECT 1 FROM [[?]]CmonD.dbo.DbTable WHERE TableName = ''Vendor'')
BEGIN
	DECLARE @id int
	INSERT [[?]]CmonD.dbo.DbTable (SystemId,TableName,TableDesc,MultiDesignDb,VirtualTbl) SELECT 5,''Vendor'',''Cmn - Vendor Info'',''N'',''N''
	SELECT @id = @@IDENTITY
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,10,''VendorId'',''Vendor - VendorId'',3,4,''N'',''Y'',''Y'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,20,''FirmId'',''Vendor - FirmId'',3,4,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,30,''VendorName'',''Vendor - VendorName'',11,100,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,40,''Active'',''Vendor - Active'',14,1,''N'',''N'',''N'',''N'',''N''
END')
EXEC ('IF NOT EXISTS (SELECT 1 FROM [[?]]CmonD.dbo.DbTable WHERE TableName = ''Member'')
BEGIN
	DECLARE @id int
	INSERT [[?]]CmonD.dbo.DbTable (SystemId,TableName,TableDesc,MultiDesignDb,VirtualTbl) SELECT 5,''Member'',''Cmn - Member Info'',''N'',''N''
	SELECT @id = @@IDENTITY
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,10,''MemberId'',''Member - MemberId'',3,4,''N'',''Y'',''Y'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,20,''MemberName'',''Member - MemberName'',11,100,''N'',''N'',''N'',''N'',''N''
	INSERT [[?]]CmonD.dbo.DbColumn (TableId,ColumnIndex,ColumnName,ColumnDesc,DataType,ColumnLength,AllowNulls,ColumnIdentity,PrimaryKey,IsIndexU,IsIndex)
		SELECT @id,30,''Active'',''Member - Active'',14,1,''N'',''N'',''N'',''N'',''N''
END')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7751&typ=N&sys=3","","",""); return false;
7752~@~  10.  75.81024:D:   30:*:*:M: Add table Guarantor~@~11513~@~30~@~D~@~~@~~@~M~@~~@~Add table Guarantor~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''[[?]]Cmon.dbo.Guarantor'')) CREATE TABLE [[?]]Cmon.dbo.Guarantor (GuarantorId Int IDENTITY NOT NULL, FirmId Int NOT NULL, ParentId Int NULL, GuarantorName NVarChar(100) NOT NULL, Active Char(1) NOT NULL, CONSTRAINT PK_Guarantor PRIMARY KEY CLUSTERED (GuarantorId))')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7752&typ=N&sys=3","","",""); return false;
7753~@~  10.  75.81024:D:   40:*:*:M: Add table Borrower~@~11513~@~40~@~D~@~~@~~@~M~@~~@~Add table Borrower~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''[[?]]Cmon.dbo.Borrower'')) CREATE TABLE [[?]]Cmon.dbo.Borrower (BorrowerId Int IDENTITY NOT NULL, FirmId Int NOT NULL, ParentId Int NULL, BorrowerName NVarChar(100) NOT NULL, Active Char(1) NOT NULL, CONSTRAINT PK_Borrower PRIMARY KEY CLUSTERED (BorrowerId))')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7753&typ=N&sys=3","","",""); return false;
7754~@~  10.  75.81024:D:   50:*:*:M: Add table Lender~@~11513~@~50~@~D~@~~@~~@~M~@~~@~Add table Lender~@~N~@~EXEC ('IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''[[?]]Cmon.dbo.Lender'')) CREATE TABLE [[?]]Cmon.dbo.Lender (LenderId Int IDENTITY NOT NULL, FirmId Int NOT NULL, ParentId Int NULL, LenderName NVarChar(100) NOT NULL, Active Char(1) NOT NULL, CONSTRAINT PK_Lender PRIMARY KEY CLUSTERED (LenderId))')
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7754&typ=N&sys=3","","",""); return false;
7755~@~  10.  78.90513:D:   10:*:*:M: Change table Screen~@~11516~@~10~@~D~@~~@~~@~M~@~~@~Change table Screen~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Screen (ScreenId int NULL, ProgramName varchar(20) NULL, ScreenDesc nvarchar(50) NULL, ScreenTypeId tinyint NULL, MasterTableId int NULL, DetailTableId int NULL, SearchTableId int NULL, SearchId int NULL, SearchAscending char(1) NULL, SearchIdR int NULL, SearchDtlId int NULL, SearchDtlIdR int NULL, SearchUrlId int NULL, SearchImgId int NULL, GridRows tinyint NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL, GenerateSc char(1) NULL, GenerateSr char(1) NULL, HasDeleteAll char(1) NULL, ShowGridHead char(1) NULL, ValidateReq char(1) NULL, DeferError char(1) NULL, AuthRequired char(1) NULL, ViewOnly char(1) NULL, GenAudit char(1) NULL, NeedRegen char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchTableId, SearchId, SearchAscending, SearchIdR, SearchDtlId, SearchDtlIdR, SearchUrlId, SearchImgId, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen) SELECT convert(int,ScreenId), ProgramName, ScreenDesc, convert(tinyint,ScreenTypeId), convert(int,MasterTableId), convert(int,DetailTableId), convert(int,SearchTableId), convert(int,SearchId), SearchAscending, convert(int,SearchIdR), convert(int,SearchDtlId), convert(int,SearchDtlIdR), convert(int,SearchUrlId), convert(int,SearchImgId), convert(tinyint,GridRows), ScreenObj, ScreenFilter, GenerateSc, GenerateSr, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchTableId Int NULL, SearchId Int NULL, SearchAscending Char(1) NOT NULL, SearchIdR Int NULL, SearchDtlId Int NULL, SearchDtlIdR Int NULL, SearchUrlId Int NULL, SearchImgId Int NULL, GridRows TinyInt NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, GenerateSr Char(1) NOT NULL, ReactGenerated Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ShowGridHead Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, AuthRequired Char(1) NOT NULL, ViewOnly Char(1) NOT NULL, GenAudit Char(1) NOT NULL, NeedRegen Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSc DEFAULT (''Y'') FOR GenerateSc ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSr DEFAULT (''Y'') FOR GenerateSr ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ReactGenerated DEFAULT (''N'') FOR ReactGenerated ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ShowGridHead DEFAULT (''Y'') FOR ShowGridHead ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_AuthRequired DEFAULT (''Y'') FOR AuthRequired ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ViewOnly DEFAULT (''N'') FOR ViewOnly ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenAudit DEFAULT (''N'') FOR GenAudit ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NeedRegen DEFAULT (''N'') FOR NeedRegen SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchTableId, SearchId, SearchAscending, SearchIdR, SearchDtlId, SearchDtlIdR, SearchUrlId, SearchImgId, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, ReactGenerated, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchTableId, SearchId, SearchAscending, SearchIdR, SearchDtlId, SearchDtlIdR, SearchUrlId, SearchImgId, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, ''N'', HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7755&typ=N&sys=3","","",""); return false;
7756~@~  10.  79.90531:D:   10:*:*:M: Change table CtRuleAsmxType~@~11517~@~10~@~D~@~~@~~@~M~@~~@~Change table CtRuleAsmxType~@~N~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtRuleAsmxType'')) CREATE TABLE dbo.CtRuleAsmxType (RuleAsmxTypeId TinyInt NOT NULL, RuleAsmxTypeDesc NVarChar(50) NOT NULL, CONSTRAINT PK_CtRuleAsmxType PRIMARY KEY CLUSTERED (RuleAsmxTypeId))') EXEC ('') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7756&typ=N&sys=3","","",""); return false;
7757~@~  10.  79.90531:D:   20:*:*:M: Change table CtRuleReactType~@~11517~@~20~@~D~@~~@~~@~M~@~~@~Change table CtRuleReactType~@~N~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtRuleReactType'')) CREATE TABLE dbo.CtRuleReactType (RuleReactTypeId TinyInt NOT NULL, RuleReactTypeDesc NVarChar(50) NOT NULL, CONSTRAINT PK_CtRuleReactType PRIMARY KEY CLUSTERED (RuleReactTypeId))') EXEC ('') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7757&typ=N&sys=3","","",""); return false;
7758~@~  10.  79.90531:D:   30:*:*:M: Change table RuleReact~@~11517~@~30~@~D~@~~@~~@~M~@~~@~Change table RuleReact~@~Y~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RuleReact'')) CREATE TABLE dbo.RuleReact (RuleReactId Int IDENTITY NOT NULL, RuleReactTypeId TinyInt NOT NULL, RuleReactName NVarChar(100) NOT NULL, RuleReactDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, ScreenId Int NOT NULL, ScreenObjId Int NULL, RuleReactProg NVarChar(max) NOT NULL, CONSTRAINT PK_RuleReact PRIMARY KEY CLUSTERED (RuleReactId))') EXEC ('') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7758&typ=N&sys=3","","",""); return false;
7759~@~  10.  79.90531:D:   40:*:*:M: Change table RuleAsmx~@~11517~@~40~@~D~@~~@~~@~M~@~~@~Change table RuleAsmx~@~Y~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.RuleAsmx'')) CREATE TABLE dbo.RuleAsmx (RuleAsmxId Int IDENTITY NOT NULL, RuleAsmxTypeId TinyInt NOT NULL, RuleAsmxName NVarChar(100) NOT NULL, RuleAsmxDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, ScreenId Int NOT NULL, RuleAsmxProg NVarChar(max) NOT NULL, CONSTRAINT PK_RuleAsmx PRIMARY KEY CLUSTERED (RuleAsmxId))') EXEC ('') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7759&typ=N&sys=3","","",""); return false;
7760~@~  10.  79.90531:D:   50:*:*:M: Change table Screen~@~11517~@~50~@~D~@~~@~~@~M~@~~@~Change table Screen~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Screen (ScreenId int NULL, ProgramName varchar(20) NULL, ScreenDesc nvarchar(50) NULL, ScreenTypeId tinyint NULL, MasterTableId int NULL, DetailTableId int NULL, SearchTableId int NULL, SearchId int NULL, SearchAscending char(1) NULL, SearchIdR int NULL, SearchDtlId int NULL, SearchDtlIdR int NULL, SearchUrlId int NULL, SearchImgId int NULL, GridRows tinyint NULL, ScreenObj varchar(100) NULL, ScreenFilter varchar(100) NULL, GenerateSc char(1) NULL, GenerateSr char(1) NULL, ReactGenerated char(1) NULL, HasDeleteAll char(1) NULL, ShowGridHead char(1) NULL, ValidateReq char(1) NULL, DeferError char(1) NULL, AuthRequired char(1) NULL, ViewOnly char(1) NULL, GenAudit char(1) NULL, NeedRegen char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchTableId, SearchId, SearchAscending, SearchIdR, SearchDtlId, SearchDtlIdR, SearchUrlId, SearchImgId, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, ReactGenerated, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen) SELECT convert(int,ScreenId), ProgramName, ScreenDesc, convert(tinyint,ScreenTypeId), convert(int,MasterTableId), convert(int,DetailTableId), convert(int,SearchTableId), convert(int,SearchId), SearchAscending, convert(int,SearchIdR), convert(int,SearchDtlId), convert(int,SearchDtlIdR), convert(int,SearchUrlId), convert(int,SearchImgId), convert(tinyint,GridRows), ScreenObj, ScreenFilter, GenerateSc, GenerateSr, ReactGenerated, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen FROM dbo.Screen IF (SELECT COUNT(1) FROM dbo.Tmp_Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Screen) = 0 DROP TABLE dbo.Screen') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Screen'')) CREATE TABLE dbo.Screen (ScreenId Int IDENTITY NOT NULL, ProgramName VarChar(20) NOT NULL, ScreenDesc NVarChar(50) NULL, ScreenTypeId TinyInt NOT NULL, MasterTableId Int NULL, DetailTableId Int NULL, SearchTableId Int NULL, SearchId Int NULL, SearchAscending Char(1) NOT NULL, SearchIdR Int NULL, SearchDtlId Int NULL, SearchDtlIdR Int NULL, SearchUrlId Int NULL, SearchImgId Int NULL, GridRows TinyInt NULL, ScreenObj VarChar(100) NULL, ScreenFilter VarChar(100) NULL, GenerateSc Char(1) NOT NULL, GenerateSr Char(1) NOT NULL, ReactGenerated Char(1) NOT NULL, HasDeleteAll Char(1) NOT NULL, ShowGridHead Char(1) NOT NULL, ValidateReq Char(1) NOT NULL, DeferError Char(1) NOT NULL, AuthRequired Char(1) NOT NULL, ViewOnly Char(1) NOT NULL, GenAudit Char(1) NOT NULL, NeedRegen Char(1) NOT NULL, NeedReactRegen Char(1) NOT NULL, CONSTRAINT PK_Screen PRIMARY KEY CLUSTERED (ScreenId))') EXEC (' ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSc DEFAULT (''Y'') FOR GenerateSc ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenerateSr DEFAULT (''Y'') FOR GenerateSr ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ReactGenerated DEFAULT (''N'') FOR ReactGenerated ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ShowGridHead DEFAULT (''Y'') FOR ShowGridHead ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_DeferError DEFAULT (''N'') FOR DeferError ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_AuthRequired DEFAULT (''Y'') FOR AuthRequired ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_ViewOnly DEFAULT (''N'') FOR ViewOnly ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_GenAudit DEFAULT (''N'') FOR GenAudit ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NeedRegen DEFAULT (''N'') FOR NeedRegen ALTER TABLE dbo.Screen ADD CONSTRAINT DF_Screen_NeedReactRegen DEFAULT (''N'') FOR NeedReactRegen SET IDENTITY_INSERT dbo.Screen ON INSERT INTO dbo.Screen (ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchTableId, SearchId, SearchAscending, SearchIdR, SearchDtlId, SearchDtlIdR, SearchUrlId, SearchImgId, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, ReactGenerated, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen, NeedReactRegen) SELECT ScreenId, ProgramName, ScreenDesc, ScreenTypeId, MasterTableId, DetailTableId, SearchTableId, SearchId, SearchAscending, SearchIdR, SearchDtlId, SearchDtlIdR, SearchUrlId, SearchImgId, GridRows, ScreenObj, ScreenFilter, GenerateSc, GenerateSr, ReactGenerated, HasDeleteAll, ShowGridHead, ValidateReq, DeferError, AuthRequired, ViewOnly, GenAudit, NeedRegen, ''N'' FROM dbo.Tmp_Screen SET IDENTITY_INSERT dbo.Screen OFF IF (SELECT COUNT(1) FROM dbo.Screen) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Screen) = 0 DROP TABLE dbo.Tmp_Screen')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7760&typ=N&sys=3","","",""); return false;
7761~@~  10.  82.90820:D:   10:*:*:M: Change table CtDtlLstPos~@~11520~@~10~@~D~@~~@~~@~M~@~~@~Change table CtDtlLstPos~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtDtlLstPos'))
BEGIN
EXEC ('CREATE TABLE dbo.CtDtlLstPos (DtlLstPosId tinyint NOT NULL, DtlLstPosNm NVarChar(20) NOT NULL, CONSTRAINT PK_CtDtlLstPos PRIMARY KEY CLUSTERED (DtlLstPosId))')
EXEC ('INSERT dbo.CtDtlLstPos SELECT 1, ''Top Left''')
EXEC ('INSERT dbo.CtDtlLstPos SELECT 2, ''Bottom Left''')
EXEC ('INSERT dbo.CtDtlLstPos SELECT 3, ''Top Right''')
EXEC ('INSERT dbo.CtDtlLstPos SELECT 4, ''Bottom Right''')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7761&typ=N&sys=3","","",""); return false;
7762~@~  10.  82.90820:D:   20:*:*:M: Change table ScreenObj~@~11520~@~20~@~D~@~~@~~@~M~@~~@~Change table ScreenObj~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ScreenObj (ScreenObjId int NULL, ScreenId int NULL, MasterTable char(1) NULL, NewGroupRow char(1) NULL, GroupRowId smallint NULL, GroupColId smallint NULL, LabelVertical char(1) NULL, LabelCss varchar(1000) NULL, ContentCss varchar(1000) NULL, ColumnId int NULL, ColumnName varchar(50) NULL, ColumnDesc varchar(200) NULL, DefaultValue nvarchar(200) NULL, HyperLinkUrl nvarchar(200) NULL, DefAfter char(1) NULL, SystemValue nvarchar(200) NULL, DefAlways char(1) NULL, ColumnWrap char(1) NULL, GridGrpCd char(1) NULL, HideOnTablet char(1) NULL, HideOnMobile char(1) NULL, ColumnJustify char(1) NULL, ColumnSize smallint NULL, ResizeWidth smallint NULL, ColumnHeight smallint NULL, ResizeHeight smallint NULL, DisplayModeId tinyint NULL, DdlKeyColumnId int NULL, DdlRefColumnId int NULL, DdlSrtColumnId int NULL, DdlAdnColumnId int NULL, DdlFtrColumnId int NULL, AggregateCd char(1) NULL, GenerateSp char(1) NULL, TabFolderId int NULL, TabIndex smallint NULL, SortOrder smallint NULL, RequiredValid char(1) NULL, MaskValid varchar(100) NULL, RangeValidType varchar(50) NULL, RangeValidMax varchar(50) NULL, RangeValidMin varchar(50) NULL, ColumnLink varchar(1000) NULL, RefreshOnCUD char(1) NULL, TrimOnEntry char(1) NULL, MatchCd char(1) NULL, IgnoreConfirm char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_ScreenObj (ScreenObjId, ScreenId, MasterTable, NewGroupRow, GroupRowId, GroupColId, LabelVertical, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, HyperLinkUrl, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, HideOnTablet, HideOnMobile, ColumnJustify, ColumnSize, ResizeWidth, ColumnHeight, ResizeHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm) SELECT convert(int,ScreenObjId), convert(int,ScreenId), MasterTable, NewGroupRow, convert(smallint,GroupRowId), convert(smallint,GroupColId), LabelVertical, LabelCss, ContentCss, convert(int,ColumnId), ColumnName, ColumnDesc, DefaultValue, HyperLinkUrl, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, HideOnTablet, HideOnMobile, ColumnJustify, convert(smallint,ColumnSize), convert(smallint,ResizeWidth), convert(smallint,ColumnHeight), convert(smallint,ResizeHeight), convert(tinyint,DisplayModeId), convert(int,DdlKeyColumnId), convert(int,DdlRefColumnId), convert(int,DdlSrtColumnId), convert(int,DdlAdnColumnId), convert(int,DdlFtrColumnId), AggregateCd, GenerateSp, convert(int,TabFolderId), convert(smallint,TabIndex), convert(smallint,SortOrder), RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm FROM dbo.ScreenObj IF (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.ScreenObj) = 0 DROP TABLE dbo.ScreenObj') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ScreenObj'')) CREATE TABLE dbo.ScreenObj (ScreenObjId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, MasterTable Char(1) NOT NULL, NewGroupRow Char(1) NOT NULL, GroupRowId SmallInt NOT NULL, GroupColId SmallInt NOT NULL, LabelVertical Char(1) NOT NULL, LabelCss VarChar(1000) NULL, ContentCss VarChar(1000) NULL, ColumnId Int NULL, ColumnName VarChar(50) NOT NULL, ColumnDesc VarChar(200) NULL, DefaultValue NVarChar(200) NULL, HyperLinkUrl NVarChar(200) NULL, DefAfter Char(1) NOT NULL, SystemValue NVarChar(200) NULL, DefAlways Char(1) NOT NULL, ColumnWrap Char(1) NOT NULL, GridGrpCd Char(1) NOT NULL, HideOnTablet Char(1) NOT NULL, HideOnMobile Char(1) NOT NULL, ColumnJustify Char(1) NULL, ColumnSize SmallInt NULL, ResizeWidth SmallInt NULL, ColumnHeight SmallInt NULL, ResizeHeight SmallInt NULL, DisplayModeId TinyInt NOT NULL, DdlKeyColumnId Int NULL, DdlRefColumnId Int NULL, DdlSrtColumnId Int NULL, DdlAdnColumnId Int NULL, DdlFtrColumnId Int NULL, AggregateCd Char(1) NULL, GenerateSp Char(1) NOT NULL, TabFolderId Int NOT NULL, TabIndex SmallInt NOT NULL, SortOrder SmallInt NULL, DtlLstPosId TinyInt NULL, RequiredValid Char(1) NOT NULL, MaskValid VarChar(100) NULL, RangeValidType VarChar(50) NULL, RangeValidMax VarChar(50) NULL, RangeValidMin VarChar(50) NULL, ColumnLink VarChar(1000) NULL, RefreshOnCUD Char(1) NOT NULL, TrimOnEntry Char(1) NOT NULL, MatchCd Char(1) NULL, IgnoreConfirm Char(1) NOT NULL, CONSTRAINT PK_ScreenObj PRIMARY KEY CLUSTERED (ScreenObjId))') EXEC (' ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_NewGroupRow DEFAULT (''N'') FOR NewGroupRow ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_GroupRowId DEFAULT (78) FOR GroupRowId ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_LabelVertical DEFAULT (''N'') FOR LabelVertical ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAfter DEFAULT (''N'') FOR DefAfter ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_DefAlways DEFAULT (''N'') FOR DefAlways ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_GridGrpCd DEFAULT (''N'') FOR GridGrpCd ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_HideOnTablet DEFAULT (''N'') FOR HideOnTablet ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_HideOnMobile DEFAULT (''N'') FOR HideOnMobile ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_TrimOnEntry DEFAULT (''Y'') FOR TrimOnEntry ALTER TABLE dbo.ScreenObj ADD CONSTRAINT DF_ScreenObj_IgnoreConfirm DEFAULT (''Y'') FOR IgnoreConfirm SET IDENTITY_INSERT dbo.ScreenObj ON INSERT INTO dbo.ScreenObj (ScreenObjId, ScreenId, MasterTable, NewGroupRow, GroupRowId, GroupColId, LabelVertical, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, HyperLinkUrl, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, HideOnTablet, HideOnMobile, ColumnJustify, ColumnSize, ResizeWidth, ColumnHeight, ResizeHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm) SELECT ScreenObjId, ScreenId, MasterTable, NewGroupRow, GroupRowId, GroupColId, LabelVertical, LabelCss, ContentCss, ColumnId, ColumnName, ColumnDesc, DefaultValue, HyperLinkUrl, DefAfter, SystemValue, DefAlways, ColumnWrap, GridGrpCd, HideOnTablet, HideOnMobile, ColumnJustify, ColumnSize, ResizeWidth, ColumnHeight, ResizeHeight, DisplayModeId, DdlKeyColumnId, DdlRefColumnId, DdlSrtColumnId, DdlAdnColumnId, DdlFtrColumnId, AggregateCd, GenerateSp, TabFolderId, TabIndex, SortOrder, RequiredValid, MaskValid, RangeValidType, RangeValidMax, RangeValidMin, ColumnLink, RefreshOnCUD, TrimOnEntry, MatchCd, IgnoreConfirm FROM dbo.Tmp_ScreenObj SET IDENTITY_INSERT dbo.ScreenObj OFF IF (SELECT COUNT(1) FROM dbo.ScreenObj) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ScreenObj) = 0 DROP TABLE dbo.Tmp_ScreenObj')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7762&typ=N&sys=3","","",""); return false;
7763~@~  10.  83.90829:D:   10:*:*:M: Change table WebRule~@~11521~@~10~@~D~@~~@~~@~M~@~~@~Change table WebRule~@~Y~@~EXEC (' CREATE TABLE dbo.Tmp_WebRule (WebRuleId int NULL, RuleTypeId tinyint NULL, RuleName nvarchar(100) NULL, RuleDesc nvarchar(150) NULL, RuleDescription nvarchar(500) NULL, ScreenId int NULL, ScreenObjId int NULL, ButtonTypeId tinyint NULL, EventId tinyint NULL, WebRuleProg nvarchar(max) NULL)') EXEC (' INSERT INTO dbo.Tmp_WebRule (WebRuleId, RuleTypeId, RuleName, RuleDesc, RuleDescription, ScreenId, ScreenObjId, ButtonTypeId, EventId, WebRuleProg) SELECT convert(int,WebRuleId), convert(tinyint,RuleTypeId), RuleName, RuleDesc, RuleDescription, convert(int,ScreenId), convert(int,ScreenObjId), convert(tinyint,ButtonTypeId), convert(tinyint,EventId), WebRuleProg FROM dbo.WebRule IF (SELECT COUNT(1) FROM dbo.Tmp_WebRule) > 0 OR (SELECT COUNT(1) FROM dbo.WebRule) = 0 DROP TABLE dbo.WebRule') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.WebRule'')) CREATE TABLE dbo.WebRule (WebRuleId Int IDENTITY NOT NULL, RuleTypeId TinyInt NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, ScreenId Int NOT NULL, ScreenObjId Int NULL, ButtonTypeId TinyInt NULL, EventId TinyInt NOT NULL, WebRuleProg NVarChar(max) NOT NULL, ReactEventId TinyInt NULL, ReactRuleProg NVarChar(max) NULL, ReduxEventId TinyInt NULL, ReduxRuleProg NVarChar(max) NULL, ServiceEventId TinyInt NULL, ServiceRuleProg NVarChar(max) NULL, AsmxEventId TinyInt NULL, AsmxRuleProg NVarChar(max) NULL, CONSTRAINT PK_WebRule PRIMARY KEY CLUSTERED (WebRuleId))') EXEC (' SET IDENTITY_INSERT dbo.WebRule ON INSERT INTO dbo.WebRule (WebRuleId, RuleTypeId, RuleName, RuleDesc, RuleDescription, ScreenId, ScreenObjId, ButtonTypeId, EventId, WebRuleProg) SELECT WebRuleId, RuleTypeId, RuleName, RuleDesc, RuleDescription, ScreenId, ScreenObjId, ButtonTypeId, EventId, WebRuleProg FROM dbo.Tmp_WebRule SET IDENTITY_INSERT dbo.WebRule OFF IF (SELECT COUNT(1) FROM dbo.WebRule) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_WebRule) = 0 DROP TABLE dbo.Tmp_WebRule')

~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7763&typ=N&sys=3","","",""); return false;
7764~@~  10.  83.90829:D:   20:*:*:M: Change table CtRuleServiceType~@~11521~@~20~@~D~@~~@~~@~M~@~~@~Change table CtRuleServiceType~@~N~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.CtRuleServiceType'')) CREATE TABLE dbo.CtRuleServiceType (RuleServiceTypeId TinyInt NOT NULL, RuleServiceTypeDesc NVarChar(50) NOT NULL, CONSTRAINT PK_CtRuleServiceType PRIMARY KEY CLUSTERED (RuleServiceTypeId))') EXEC ('') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7764&typ=N&sys=3","","",""); return false;
7765~@~  10.  83.90829:D:   30:*:*:M: Change table CtRuleReduxType~@~11521~@~30~@~D~@~~@~~@~M~@~~@~Change table CtRuleReduxType~@~N~@~IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id('dbo.CtRuleReduxType'))
BEGIN
EXEC ('CREATE TABLE dbo.CtRuleReduxType (RuleReduxTypeId TinyInt NOT NULL, RuleReduxTypeDesc NVarChar(50) NOT NULL, CONSTRAINT PK_CtRuleReduxType PRIMARY KEY CLUSTERED (RuleReduxTypeId))') EXEC ('INSERT dbo.CtRuleReduxType SELECT 1, ''Custom Function''')
EXEC ('INSERT dbo.CtRuleServiceType SELECT 1, ''Custom Function''')
EXEC ('DELETE FROM dbo.CtRuleReactType WHERE RuleReactTypeId in (4,5,6,7,8)')
EXEC ('INSERT dbo.CtRuleReactType SELECT 4, ''Master Record Screen Column''')
EXEC ('INSERT dbo.CtRuleReactType SELECT 5, ''Detail Record Custom Function''')
EXEC ('INSERT dbo.CtRuleReactType SELECT 6, ''Detail Record Save''')
EXEC ('INSERT dbo.CtRuleReactType SELECT 7, ''Detail Record Render''')
EXEC ('INSERT dbo.CtRuleReactType SELECT 8, ''Detail Record Screen Column''')
END~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7765&typ=N&sys=3","","",""); return false;
7766~@~  11. 141.00403:D:   10:*:*:M: Change table Menu~@~12578~@~10~@~D~@~~@~~@~M~@~~@~Change table Menu~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Menu (MenuIndex smallint NULL, MenuId int NULL, ParentId int NULL, ReportId int NULL, ScreenId int NULL, WizardId int NULL, StaticPgId int NULL, IconUrl nvarchar(300) NULL, Popup char(1) NULL, Miscellaneous varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_Menu (MenuIndex, MenuId, ParentId, ReportId, ScreenId, WizardId, StaticPgId, IconUrl, Popup, Miscellaneous) SELECT convert(smallint,MenuIndex), convert(int,MenuId), convert(int,ParentId), convert(int,ReportId), convert(int,ScreenId), convert(int,WizardId), convert(int,StaticPgId), IconUrl, Popup, Miscellaneous FROM dbo.Menu IF (SELECT COUNT(1) FROM dbo.Tmp_Menu) > 0 OR (SELECT COUNT(1) FROM dbo.Menu) = 0 DROP TABLE dbo.Menu') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Menu'')) CREATE TABLE dbo.Menu (MenuId Int IDENTITY NOT NULL, MenuIndex SmallInt NOT NULL, Miscellaneous VarChar(1000) NULL, ParentId Int NULL, ReportId Int NULL, ScreenId Int NULL, WizardId Int NULL, StaticPgId Int NULL, IconUrl NVarChar(300) NULL, Popup Char(1) NOT NULL, ReactQuickMenu Char(1) NOT NULL, CONSTRAINT PK_Menu PRIMARY KEY CLUSTERED (MenuId))') EXEC (' ALTER TABLE dbo.Menu ADD CONSTRAINT DF_Menu_Popup DEFAULT (''N'') FOR Popup ALTER TABLE dbo.Menu ADD CONSTRAINT DF_Menu_ReactQuickMenu DEFAULT (''N'') FOR ReactQuickMenu SET IDENTITY_INSERT dbo.Menu ON INSERT INTO dbo.Menu (MenuId, MenuIndex, Miscellaneous, ParentId, ReportId, ScreenId, WizardId, StaticPgId, IconUrl, Popup, ReactQuickMenu) SELECT MenuId, MenuIndex, Miscellaneous, ParentId, ReportId, ScreenId, WizardId, StaticPgId, IconUrl, Popup, ''N'' FROM dbo.Tmp_Menu SET IDENTITY_INSERT dbo.Menu OFF IF (SELECT COUNT(1) FROM dbo.Menu) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Menu) = 0 DROP TABLE dbo.Tmp_Menu')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7766&typ=N&sys=3","","",""); return false;
7767~@~  11. 141.00403:D:   20:*:*:M: Change table Menu~@~12578~@~20~@~D~@~~@~~@~M~@~~@~Change table Menu~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_Menu (MenuIndex smallint NULL, MenuId int NULL, ParentId int NULL, ReportId int NULL, ScreenId int NULL, WizardId int NULL, StaticPgId int NULL, IconUrl nvarchar(300) NULL, Popup char(1) NULL, ReactQuickMenu char(1) NULL, Miscellaneous varchar(1000) NULL)') EXEC (' INSERT INTO dbo.Tmp_Menu (MenuIndex, MenuId, ParentId, ReportId, ScreenId, WizardId, StaticPgId, IconUrl, Popup, ReactQuickMenu, Miscellaneous) SELECT convert(smallint,MenuIndex), convert(int,MenuId), convert(int,ParentId), convert(int,ReportId), convert(int,ScreenId), convert(int,WizardId), convert(int,StaticPgId), IconUrl, Popup, ReactQuickMenu, Miscellaneous FROM dbo.Menu IF (SELECT COUNT(1) FROM dbo.Tmp_Menu) > 0 OR (SELECT COUNT(1) FROM dbo.Menu) = 0 DROP TABLE dbo.Menu') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.Menu'')) CREATE TABLE dbo.Menu (MenuId Int IDENTITY NOT NULL, MenuIndex SmallInt NOT NULL, Miscellaneous VarChar(1000) NULL, ParentId Int NULL, ReportId Int NULL, ScreenId Int NULL, WizardId Int NULL, StaticPgId Int NULL, IconUrl NVarChar(300) NULL, Popup Char(1) NOT NULL, ReactQuickMenu Char(1) NOT NULL, CONSTRAINT PK_Menu PRIMARY KEY CLUSTERED (MenuId))') EXEC (' ALTER TABLE dbo.Menu ADD CONSTRAINT DF_Menu_Popup DEFAULT (''N'') FOR Popup ALTER TABLE dbo.Menu ADD CONSTRAINT DF_Menu_ReactQuickMenu DEFAULT (''N'') FOR ReactQuickMenu SET IDENTITY_INSERT dbo.Menu ON INSERT INTO dbo.Menu (MenuId, MenuIndex, Miscellaneous, ParentId, ReportId, ScreenId, WizardId, StaticPgId, IconUrl, Popup, ReactQuickMenu) SELECT MenuId, MenuIndex, Miscellaneous, ParentId, ReportId, ScreenId, WizardId, StaticPgId, IconUrl, Popup, ReactQuickMenu FROM dbo.Tmp_Menu SET IDENTITY_INSERT dbo.Menu OFF IF (SELECT COUNT(1) FROM dbo.Menu) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_Menu) = 0 DROP TABLE dbo.Tmp_Menu')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7767&typ=N&sys=3","","",""); return false;
7768~@~  11. 154.00422:D:   10:*:*:M: Change table ServerRule~@~12591~@~10~@~D~@~~@~~@~M~@~~@~Change table ServerRule~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ServerRule (RuleTypeId tinyint NULL, RuleOrder smallint NULL, ServerRuleId int NULL, ScreenId int NULL, ModifiedBy int NULL, RuleName nvarchar(100) NULL, RuleDesc nvarchar(150) NULL, RuleDescription nvarchar(500) NULL, RuleCode nvarchar(max) NULL, ModifiedOn datetime NULL, LastGenDt datetime NULL, MasterTable char(1) NULL, OnAdd char(1) NULL, OnUpd char(1) NULL, OnDel char(1) NULL, BeforeCRUD char(1) NULL, ProcedureName varchar(50) NULL, ParameterNames varchar(max) NULL, ParameterTypes varchar(max) NULL, CallingParams varchar(max) NULL)') EXEC (' INSERT INTO dbo.Tmp_ServerRule (RuleTypeId, RuleOrder, ServerRuleId, ScreenId, ModifiedBy, RuleName, RuleDesc, RuleDescription, RuleCode, ModifiedOn, LastGenDt, MasterTable, OnAdd, OnUpd, OnDel, BeforeCRUD, ProcedureName, ParameterNames, ParameterTypes, CallingParams) SELECT convert(tinyint,RuleTypeId), convert(smallint,RuleOrder), convert(int,ServerRuleId), convert(int,ScreenId), convert(int,ModifiedBy), RuleName, RuleDesc, RuleDescription, RuleCode, ModifiedOn, LastGenDt, MasterTable, OnAdd, OnUpd, OnDel, BeforeCRUD, ProcedureName, ParameterNames, ParameterTypes, CallingParams FROM dbo.ServerRule IF (SELECT COUNT(1) FROM dbo.Tmp_ServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.ServerRule) = 0 DROP TABLE dbo.ServerRule') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ServerRule'')) CREATE TABLE dbo.ServerRule (ServerRuleId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, RuleTypeId TinyInt NOT NULL, MasterTable Char(1) NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, RuleOrder SmallInt NOT NULL, ProcedureName VarChar(50) NOT NULL, ParameterNames VarChar(max) NULL, ParameterTypes VarChar(max) NULL, CallingParams VarChar(max) NULL, OnAdd Char(1) NOT NULL, OnUpd Char(1) NOT NULL, OnDel Char(1) NOT NULL, BeforeCRUD Char(1) NOT NULL, RuleCode NVarChar(max) NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, Guid VarChar(50) NOT NULL, RunMode Char(1) NULL, CONSTRAINT PK_ServerRule PRIMARY KEY CLUSTERED (ServerRuleId))') EXEC (' ALTER TABLE dbo.ServerRule ADD CONSTRAINT DF_ServerRule_Guid DEFAULT (NEWID()) FOR Guid SET IDENTITY_INSERT dbo.ServerRule ON INSERT INTO dbo.ServerRule (ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, RuleOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn, LastGenDt, Guid) SELECT ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, RuleOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn, LastGenDt, NEWID() FROM dbo.Tmp_ServerRule SET IDENTITY_INSERT dbo.ServerRule OFF IF (SELECT COUNT(1) FROM dbo.ServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ServerRule) = 0 DROP TABLE dbo.Tmp_ServerRule IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IX_ServerRule'') CREATE NONCLUSTERED INDEX IX_ServerRule ON dbo.ServerRule(ScreenId,RuleOrder)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7768&typ=N&sys=3","","",""); return false;
7769~@~  11. 155.00423:D:   10:*:*:M: Add table AtServerRule~@~12592~@~10~@~D~@~~@~~@~M~@~~@~Add table AtServerRule~@~Y~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AtServerRule'')) CREATE TABLE dbo.AtServerRule (ServerRuleId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, RuleTypeId TinyInt NOT NULL, MasterTable Char(1) NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, RuleOrder SmallInt NOT NULL, ProcedureName VarChar(50) NOT NULL, ParameterNames VarChar(max) NULL, ParameterTypes VarChar(max) NULL, CallingParams VarChar(max) NULL, OnAdd Char(1) NOT NULL, OnUpd Char(1) NOT NULL, OnDel Char(1) NOT NULL, BeforeCRUD Char(1) NOT NULL, RuleCode NVarChar(max) NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, Guid VarChar(50) NOT NULL, RunMode Char(1) NULL, CONSTRAINT PK_AtServerRule PRIMARY KEY CLUSTERED (ServerRuleId))') 
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7769&typ=N&sys=3","","",""); return false;
7770~@~  11. 155.00423:D:   20:*:*:M: Change table ServerRule~@~12592~@~20~@~D~@~~@~~@~M~@~~@~Change table ServerRule~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_ServerRule (RuleTypeId tinyint NULL, RuleOrder smallint NULL, ServerRuleId int NULL, ScreenId int NULL, ModifiedBy int NULL, RuleName nvarchar(100) NULL, RuleDesc nvarchar(150) NULL, RuleDescription nvarchar(500) NULL, RuleCode nvarchar(max) NULL, ModifiedOn datetime NULL, LastGenDt datetime NULL, MasterTable char(1) NULL, OnAdd char(1) NULL, OnUpd char(1) NULL, OnDel char(1) NULL, BeforeCRUD char(1) NULL, RunMode char(1) NULL, ProcedureName varchar(50) NULL, ParameterNames varchar(max) NULL, ParameterTypes varchar(max) NULL, CallingParams varchar(max) NULL, Guid varchar(50) NULL)') EXEC (' INSERT INTO dbo.Tmp_ServerRule (RuleTypeId, RuleOrder, ServerRuleId, ScreenId, ModifiedBy, RuleName, RuleDesc, RuleDescription, RuleCode, ModifiedOn, LastGenDt, MasterTable, OnAdd, OnUpd, OnDel, BeforeCRUD, RunMode, ProcedureName, ParameterNames, ParameterTypes, CallingParams, Guid) SELECT convert(tinyint,RuleTypeId), convert(smallint,RuleOrder), convert(int,ServerRuleId), convert(int,ScreenId), convert(int,ModifiedBy), RuleName, RuleDesc, RuleDescription, RuleCode, ModifiedOn, LastGenDt, MasterTable, OnAdd, OnUpd, OnDel, BeforeCRUD, RunMode, ProcedureName, ParameterNames, ParameterTypes, CallingParams, Guid FROM dbo.ServerRule IF (SELECT COUNT(1) FROM dbo.Tmp_ServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.ServerRule) = 0 DROP TABLE dbo.ServerRule') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.ServerRule'')) CREATE TABLE dbo.ServerRule (ServerRuleId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, RuleTypeId TinyInt NOT NULL, MasterTable Char(1) NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, RuleOrder SmallInt NOT NULL, ProcedureName VarChar(50) NOT NULL, ParameterNames VarChar(max) NULL, ParameterTypes VarChar(max) NULL, CallingParams VarChar(max) NULL, OnAdd Char(1) NOT NULL, OnUpd Char(1) NOT NULL, OnDel Char(1) NOT NULL, BeforeCRUD Char(1) NOT NULL, RuleCode NVarChar(max) NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, Guid VarChar(50) NOT NULL, RunMode Char(1) NULL, SrcNS VarChar(30) NULL, CONSTRAINT PK_ServerRule PRIMARY KEY CLUSTERED (ServerRuleId))') EXEC (' ALTER TABLE dbo.ServerRule ADD CONSTRAINT DF_ServerRule_Guid DEFAULT (NEWID()) FOR Guid SET IDENTITY_INSERT dbo.ServerRule ON INSERT INTO dbo.ServerRule (ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, RuleOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn, LastGenDt, Guid, RunMode) SELECT ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, RuleOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn, LastGenDt, Guid, RunMode FROM dbo.Tmp_ServerRule SET IDENTITY_INSERT dbo.ServerRule OFF IF (SELECT COUNT(1) FROM dbo.ServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_ServerRule) = 0 DROP TABLE dbo.Tmp_ServerRule IF NOT EXISTS (SELECT 1 FROM dbo.sysindexes WHERE name = ''IX_ServerRule'') CREATE NONCLUSTERED INDEX IX_ServerRule ON dbo.ServerRule(ScreenId,RuleOrder)')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7770&typ=N&sys=3","","",""); return false;
7771~@~  11. 155.00423:D:   40:*:*:M: Change table AtServerRule~@~12592~@~40~@~D~@~~@~~@~M~@~~@~Change table AtServerRule~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_AtServerRule (RuleTypeId tinyint NULL, RuleOrder smallint NULL, ServerRuleId int NULL, ScreenId int NULL, ModifiedBy int NULL, RuleName nvarchar(100) NULL, RuleDesc nvarchar(150) NULL, RuleDescription nvarchar(500) NULL, RuleCode nvarchar(max) NULL, ModifiedOn datetime NULL, LastGenDt datetime NULL, MasterTable char(1) NULL, OnAdd char(1) NULL, OnUpd char(1) NULL, OnDel char(1) NULL, BeforeCRUD char(1) NULL, RunMode char(1) NULL, ProcedureName varchar(50) NULL, ParameterNames varchar(max) NULL, ParameterTypes varchar(max) NULL, CallingParams varchar(max) NULL, Guid varchar(50) NULL)') EXEC (' INSERT INTO dbo.Tmp_AtServerRule (RuleTypeId, RuleOrder, ServerRuleId, ScreenId, ModifiedBy, RuleName, RuleDesc, RuleDescription, RuleCode, ModifiedOn, LastGenDt, MasterTable, OnAdd, OnUpd, OnDel, BeforeCRUD, RunMode, ProcedureName, ParameterNames, ParameterTypes, CallingParams, Guid) SELECT convert(tinyint,RuleTypeId), convert(smallint,RuleOrder), convert(int,ServerRuleId), convert(int,ScreenId), convert(int,ModifiedBy), RuleName, RuleDesc, RuleDescription, RuleCode, ModifiedOn, LastGenDt, MasterTable, OnAdd, OnUpd, OnDel, BeforeCRUD, RunMode, ProcedureName, ParameterNames, ParameterTypes, CallingParams, Guid FROM dbo.AtServerRule IF (SELECT COUNT(1) FROM dbo.Tmp_AtServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.AtServerRule) = 0 DROP TABLE dbo.AtServerRule') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AtServerRule'')) CREATE TABLE dbo.AtServerRule (ServerRuleId Int IDENTITY NOT NULL, ScreenId Int NOT NULL, RuleTypeId TinyInt NOT NULL, MasterTable Char(1) NOT NULL, RuleName NVarChar(100) NOT NULL, RuleDesc NVarChar(150) NULL, RuleDescription NVarChar(500) NULL, RuleOrder SmallInt NOT NULL, ProcedureName VarChar(50) NOT NULL, ParameterNames VarChar(max) NULL, ParameterTypes VarChar(max) NULL, CallingParams VarChar(max) NULL, OnAdd Char(1) NOT NULL, OnUpd Char(1) NOT NULL, OnDel Char(1) NOT NULL, BeforeCRUD Char(1) NOT NULL, RuleCode NVarChar(max) NULL, ModifiedBy Int NULL, ModifiedOn DateTime NULL, LastGenDt DateTime NULL, Guid VarChar(50) NOT NULL, RunMode Char(1) NULL, SrcNS VarChar(30) NULL, CONSTRAINT PK_AtServerRule PRIMARY KEY CLUSTERED (ServerRuleId))') EXEC (' SET IDENTITY_INSERT dbo.AtServerRule ON INSERT INTO dbo.AtServerRule (ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, RuleOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn, LastGenDt, Guid, RunMode) SELECT ServerRuleId, ScreenId, RuleTypeId, MasterTable, RuleName, RuleDesc, RuleDescription, RuleOrder, ProcedureName, ParameterNames, ParameterTypes, CallingParams, OnAdd, OnUpd, OnDel, BeforeCRUD, RuleCode, ModifiedBy, ModifiedOn, LastGenDt, Guid, RunMode FROM dbo.Tmp_AtServerRule SET IDENTITY_INSERT dbo.AtServerRule OFF IF (SELECT COUNT(1) FROM dbo.AtServerRule) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AtServerRule) = 0 DROP TABLE dbo.Tmp_AtServerRule')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7771&typ=N&sys=3","","",""); return false;
7772~@~  11. 155.00423:D:   30:*:*:M: Update SrvNS for ServerRule~@~12592~@~30~@~D~@~~@~~@~M~@~~@~Update SrvNS for ServerRule~@~Y~@~EXEC('
UPDATE r
SET SrcNS = ISNULL(SrcNS, ns.MyNS)
FROM
dbo.ServerRule r
INNER JOIN
(
SELECT
MyNS = REPLACE(s.dbDesDatabase, ''Design'', '''')
FROM
[[?]]Design.dbo.Systems s
WHERE s.SysProgram = ''Y''
AND s.Active =''Y''
) ns ON 1=1
WHERE r.SrcNS IS NULL
')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7772&typ=N&sys=3","","",""); return false;
7774~@~  11. 157.00424:D:   10:*:*:M: Add table AtServerRuleOvrdPrm~@~12594~@~10~@~D~@~~@~~@~M~@~~@~Add table AtServerRuleOvrdPrm~@~Y~@~EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AtServerRuleOvrdPrm'')) CREATE TABLE dbo.AtServerRuleOvrdPrm (ServerRuledOvrdPrmId Int IDENTITY NOT NULL, ServerRuleId Int NOT NULL, PermKeyId SmallInt NOT NULL, Suppress Char(1) NOT NULL, AndCondition Char(1) NOT NULL, CONSTRAINT PK_AtServerRuleOvrdPrm PRIMARY KEY CLUSTERED (ServerRuledOvrdPrmId))') ~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7774&typ=N&sys=3","","",""); return false;
7775~@~  11. 158.00425:D:   10:*:*:M: Change table AtServerRuleOvrdPrm~@~12595~@~10~@~D~@~~@~~@~M~@~~@~Change table AtServerRuleOvrdPrm~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_AtServerRuleOvrdPrm (PermKeyId smallint NULL, ServerRuledOvrdPrmId int NULL, ServerRuleId int NULL, Suppress char(1) NULL, AndCondition char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_AtServerRuleOvrdPrm (PermKeyId, ServerRuledOvrdPrmId, ServerRuleId, Suppress, AndCondition) SELECT convert(smallint,PermKeyId), convert(int,ServerRuledOvrdPrmId), convert(int,ServerRuleId), Suppress, AndCondition FROM dbo.AtServerRuleOvrdPrm IF (SELECT COUNT(1) FROM dbo.Tmp_AtServerRuleOvrdPrm) > 0 OR (SELECT COUNT(1) FROM dbo.AtServerRuleOvrdPrm) = 0 DROP TABLE dbo.AtServerRuleOvrdPrm') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AtServerRuleOvrdPrm'')) CREATE TABLE dbo.AtServerRuleOvrdPrm (ServerRuledOvrdPrmId Int IDENTITY NOT NULL, ServerRuleId Int NOT NULL, PermKeyId SmallInt NOT NULL, AndCondition Char(1) NOT NULL, CONSTRAINT PK_AtServerRuleOvrdPrm PRIMARY KEY CLUSTERED (ServerRuledOvrdPrmId))') EXEC (' SET IDENTITY_INSERT dbo.AtServerRuleOvrdPrm ON INSERT INTO dbo.AtServerRuleOvrdPrm (ServerRuledOvrdPrmId, ServerRuleId, PermKeyId, AndCondition) SELECT ServerRuledOvrdPrmId, ServerRuleId, PermKeyId, AndCondition FROM dbo.Tmp_AtServerRuleOvrdPrm SET IDENTITY_INSERT dbo.AtServerRuleOvrdPrm OFF IF (SELECT COUNT(1) FROM dbo.AtServerRuleOvrdPrm) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AtServerRuleOvrdPrm) = 0 DROP TABLE dbo.Tmp_AtServerRuleOvrdPrm')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7775&typ=N&sys=3","","",""); return false;
7776~@~  11. 158.00425:D:   20:*:*:M: Add table AtServerRuleOvrd~@~12595~@~20~@~D~@~~@~~@~M~@~~@~Add table AtServerRuleOvrd~@~Y~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AtServerRuleOvrd'')) CREATE TABLE dbo.AtServerRuleOvrd (AtServerRuleOvrdId Int IDENTITY NOT NULL, ServerRuleOvrdDesc VarChar(1000) NULL, ServerRuleOvrdName VarChar(500) NOT NULL, ServerRuleId Int NOT NULL, Disable Char(1) NOT NULL, CONSTRAINT PK_AtServerRuleOvrd PRIMARY KEY CLUSTERED (AtServerRuleOvrdId))')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7776&typ=N&sys=3","","",""); return false;
7778~@~  11. 158.00425:D:   30:*:*:M: Change table AtServerRuleOvrdPrm~@~12595~@~30~@~D~@~~@~~@~M~@~~@~Change table AtServerRuleOvrdPrm~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_AtServerRuleOvrdPrm (PermKeyId smallint NULL, ServerRuledOvrdPrmId int NULL, ServerRuleId int NULL, AndCondition char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_AtServerRuleOvrdPrm (PermKeyId, ServerRuledOvrdPrmId, ServerRuleId, AndCondition) SELECT convert(smallint,PermKeyId), convert(int,ServerRuledOvrdPrmId), convert(int,ServerRuleId), AndCondition FROM dbo.AtServerRuleOvrdPrm IF (SELECT COUNT(1) FROM dbo.Tmp_AtServerRuleOvrdPrm) > 0 OR (SELECT COUNT(1) FROM dbo.AtServerRuleOvrdPrm) = 0 DROP TABLE dbo.AtServerRuleOvrdPrm') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AtServerRuleOvrdPrm'')) CREATE TABLE dbo.AtServerRuleOvrdPrm (ServerRuledOvrdPrmId Int IDENTITY NOT NULL, PermKeyId SmallInt NOT NULL, AndCondition Char(1) NOT NULL, ServerRuleOvrdId Int NOT NULL, CONSTRAINT PK_AtServerRuleOvrdPrm PRIMARY KEY CLUSTERED (ServerRuledOvrdPrmId))') EXEC (' ALTER TABLE dbo.AtServerRuleOvrdPrm ADD CONSTRAINT DF_AtServerRuleOvrdPrm_ServerRuleOvrdId DEFAULT (-1) FOR ServerRuleOvrdId SET IDENTITY_INSERT dbo.AtServerRuleOvrdPrm ON INSERT INTO dbo.AtServerRuleOvrdPrm (ServerRuledOvrdPrmId, PermKeyId, AndCondition, ServerRuleOvrdId) SELECT ServerRuledOvrdPrmId, PermKeyId, AndCondition, -1 FROM dbo.Tmp_AtServerRuleOvrdPrm SET IDENTITY_INSERT dbo.AtServerRuleOvrdPrm OFF IF (SELECT COUNT(1) FROM dbo.AtServerRuleOvrdPrm) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AtServerRuleOvrdPrm) = 0 DROP TABLE dbo.Tmp_AtServerRuleOvrdPrm')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7778&typ=N&sys=3","","",""); return false;
7779~@~  11. 158.00425:D:   40:*:*:M: Change table AtServerRuleOvrdPrm~@~12595~@~40~@~D~@~~@~~@~M~@~~@~Change table AtServerRuleOvrdPrm~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_AtServerRuleOvrdPrm (PermKeyId smallint NULL, ServerRuledOvrdPrmId int NULL, ServerRuleOvrdId int NULL, AndCondition char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_AtServerRuleOvrdPrm (PermKeyId, ServerRuledOvrdPrmId, ServerRuleOvrdId, AndCondition) SELECT convert(smallint,PermKeyId), convert(int,ServerRuledOvrdPrmId), convert(int,ServerRuleOvrdId), AndCondition FROM dbo.AtServerRuleOvrdPrm IF (SELECT COUNT(1) FROM dbo.Tmp_AtServerRuleOvrdPrm) > 0 OR (SELECT COUNT(1) FROM dbo.AtServerRuleOvrdPrm) = 0 DROP TABLE dbo.AtServerRuleOvrdPrm') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AtServerRuleOvrdPrm'')) CREATE TABLE dbo.AtServerRuleOvrdPrm (ServerRuledOvrdPrmId Int IDENTITY NOT NULL, PermKeyId SmallInt NOT NULL, AndCondition Char(1) NOT NULL, AtServerRuleOvrdId Int NOT NULL, CONSTRAINT PK_AtServerRuleOvrdPrm PRIMARY KEY CLUSTERED (ServerRuledOvrdPrmId))') EXEC (' ALTER TABLE dbo.AtServerRuleOvrdPrm ADD CONSTRAINT DF_AtServerRuleOvrdPrm_AtServerRuleOvrdId DEFAULT (-1) FOR AtServerRuleOvrdId SET IDENTITY_INSERT dbo.AtServerRuleOvrdPrm ON INSERT INTO dbo.AtServerRuleOvrdPrm (ServerRuledOvrdPrmId, PermKeyId, AndCondition, AtServerRuleOvrdId) SELECT ServerRuledOvrdPrmId, PermKeyId, AndCondition, -1 FROM dbo.Tmp_AtServerRuleOvrdPrm SET IDENTITY_INSERT dbo.AtServerRuleOvrdPrm OFF IF (SELECT COUNT(1) FROM dbo.AtServerRuleOvrdPrm) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AtServerRuleOvrdPrm) = 0 DROP TABLE dbo.Tmp_AtServerRuleOvrdPrm')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7779&typ=N&sys=3","","",""); return false;
7780~@~  11. 158.00425:D:   50:*:*:M: Change table AtServerRuleOvrd~@~12595~@~50~@~D~@~~@~~@~M~@~~@~Change table AtServerRuleOvrd~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_AtServerRuleOvrd (AtServerRuleOvrdId int NULL, ServerRuleId int NULL, Disable char(1) NULL, ServerRuleOvrdDesc varchar(1000) NULL, ServerRuleOvrdName varchar(500) NULL)') EXEC (' INSERT INTO dbo.Tmp_AtServerRuleOvrd (AtServerRuleOvrdId, ServerRuleId, Disable, ServerRuleOvrdDesc, ServerRuleOvrdName) SELECT convert(int,AtServerRuleOvrdId), convert(int,ServerRuleId), Disable, ServerRuleOvrdDesc, ServerRuleOvrdName FROM dbo.AtServerRuleOvrd IF (SELECT COUNT(1) FROM dbo.Tmp_AtServerRuleOvrd) > 0 OR (SELECT COUNT(1) FROM dbo.AtServerRuleOvrd) = 0 DROP TABLE dbo.AtServerRuleOvrd') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AtServerRuleOvrd'')) CREATE TABLE dbo.AtServerRuleOvrd (AtServerRuleOvrdId Int IDENTITY NOT NULL, ServerRuleOvrdDesc VarChar(1000) NULL, ServerRuleOvrdName VarChar(500) NOT NULL, ServerRuleId Int NOT NULL, Disable Char(1) NOT NULL, ServerRuleGuid VarChar(50) NULL, ScreenId Int NULL, Priority SmallInt NULL, CONSTRAINT PK_AtServerRuleOvrd PRIMARY KEY CLUSTERED (AtServerRuleOvrdId))') EXEC (' SET IDENTITY_INSERT dbo.AtServerRuleOvrd ON INSERT INTO dbo.AtServerRuleOvrd (AtServerRuleOvrdId, ServerRuleOvrdDesc, ServerRuleOvrdName, ServerRuleId, Disable) SELECT AtServerRuleOvrdId, ServerRuleOvrdDesc, ServerRuleOvrdName, ServerRuleId, Disable FROM dbo.Tmp_AtServerRuleOvrd SET IDENTITY_INSERT dbo.AtServerRuleOvrd OFF IF (SELECT COUNT(1) FROM dbo.AtServerRuleOvrd) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AtServerRuleOvrd) = 0 DROP TABLE dbo.Tmp_AtServerRuleOvrd')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7780&typ=N&sys=3","","",""); return false;
7781~@~  11. 158.00425:D:   60:*:*:M: Change table AtServerRuleOvrdPrm~@~12595~@~60~@~D~@~~@~~@~M~@~~@~Change table AtServerRuleOvrdPrm~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_AtServerRuleOvrdPrm (PermKeyId smallint NULL, ServerRuledOvrdPrmId int NULL, AtServerRuleOvrdId int NULL, AndCondition char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_AtServerRuleOvrdPrm (PermKeyId, ServerRuledOvrdPrmId, AtServerRuleOvrdId, AndCondition) SELECT convert(smallint,PermKeyId), convert(int,ServerRuledOvrdPrmId), convert(int,AtServerRuleOvrdId), AndCondition FROM dbo.AtServerRuleOvrdPrm IF (SELECT COUNT(1) FROM dbo.Tmp_AtServerRuleOvrdPrm) > 0 OR (SELECT COUNT(1) FROM dbo.AtServerRuleOvrdPrm) = 0 DROP TABLE dbo.AtServerRuleOvrdPrm') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AtServerRuleOvrdPrm'')) CREATE TABLE dbo.AtServerRuleOvrdPrm (ServerRuledOvrdPrmId Int IDENTITY NOT NULL, PermKeyId SmallInt NOT NULL, AndCondition Char(1) NOT NULL, AtServerRuleOvrdId Int NOT NULL, PermKeyRowIdLs VarChar(max) NULL, PermIdLs VarChar(max) NULL, CONSTRAINT PK_AtServerRuleOvrdPrm PRIMARY KEY CLUSTERED (ServerRuledOvrdPrmId))') EXEC (' ALTER TABLE dbo.AtServerRuleOvrdPrm ADD CONSTRAINT DF_AtServerRuleOvrdPrm_AtServerRuleOvrdId DEFAULT (-1) FOR AtServerRuleOvrdId SET IDENTITY_INSERT dbo.AtServerRuleOvrdPrm ON INSERT INTO dbo.AtServerRuleOvrdPrm (ServerRuledOvrdPrmId, PermKeyId, AndCondition, AtServerRuleOvrdId) SELECT ServerRuledOvrdPrmId, PermKeyId, AndCondition, AtServerRuleOvrdId FROM dbo.Tmp_AtServerRuleOvrdPrm SET IDENTITY_INSERT dbo.AtServerRuleOvrdPrm OFF IF (SELECT COUNT(1) FROM dbo.AtServerRuleOvrdPrm) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AtServerRuleOvrdPrm) = 0 DROP TABLE dbo.Tmp_AtServerRuleOvrdPrm')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7781&typ=N&sys=3","","",""); return false;
7782~@~  11. 159.00425:D:   10:*:*:M: Change table AtServerRuleOvrdPrm~@~12596~@~10~@~D~@~~@~~@~M~@~~@~Change table AtServerRuleOvrdPrm~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_AtServerRuleOvrdPrm (PermKeyId smallint NULL, ServerRuledOvrdPrmId int NULL, AtServerRuleOvrdId int NULL, AndCondition char(1) NULL, PermKeyRowIdLs varchar(max) NULL, PermIdLs varchar(max) NULL)') EXEC (' INSERT INTO dbo.Tmp_AtServerRuleOvrdPrm (PermKeyId, ServerRuledOvrdPrmId, AtServerRuleOvrdId, AndCondition, PermKeyRowIdLs, PermIdLs) SELECT convert(smallint,PermKeyId), convert(int,ServerRuledOvrdPrmId), convert(int,AtServerRuleOvrdId), AndCondition, PermKeyRowIdLs, PermIdLs FROM dbo.AtServerRuleOvrdPrm IF (SELECT COUNT(1) FROM dbo.Tmp_AtServerRuleOvrdPrm) > 0 OR (SELECT COUNT(1) FROM dbo.AtServerRuleOvrdPrm) = 0 DROP TABLE dbo.AtServerRuleOvrdPrm') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AtServerRuleOvrdPrm'')) CREATE TABLE dbo.AtServerRuleOvrdPrm (ServerRuledOvrdPrmId Int IDENTITY NOT NULL, PermKeyId SmallInt NOT NULL, AndCondition Char(1) NOT NULL, AtServerRuleOvrdId Int NOT NULL, Match Char(1) NOT NULL, PermKeyRowId Int NULL, PermId Int NULL, CONSTRAINT PK_AtServerRuleOvrdPrm PRIMARY KEY CLUSTERED (ServerRuledOvrdPrmId))') EXEC (' ALTER TABLE dbo.AtServerRuleOvrdPrm ADD CONSTRAINT DF_AtServerRuleOvrdPrm_AtServerRuleOvrdId DEFAULT (-1) FOR AtServerRuleOvrdId ALTER TABLE dbo.AtServerRuleOvrdPrm ADD CONSTRAINT DF_AtServerRuleOvrdPrm_Match DEFAULT (''Y'') FOR Match SET IDENTITY_INSERT dbo.AtServerRuleOvrdPrm ON INSERT INTO dbo.AtServerRuleOvrdPrm (ServerRuledOvrdPrmId, PermKeyId, AndCondition, AtServerRuleOvrdId, Match) SELECT ServerRuledOvrdPrmId, PermKeyId, AndCondition, AtServerRuleOvrdId, ''Y'' FROM dbo.Tmp_AtServerRuleOvrdPrm SET IDENTITY_INSERT dbo.AtServerRuleOvrdPrm OFF IF (SELECT COUNT(1) FROM dbo.AtServerRuleOvrdPrm) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AtServerRuleOvrdPrm) = 0 DROP TABLE dbo.Tmp_AtServerRuleOvrdPrm')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7782&typ=N&sys=3","","",""); return false;
7783~@~  11. 161.00429:D:   10:*:*:M: Change table AtServerRuleOvrd~@~12598~@~10~@~D~@~~@~~@~M~@~~@~Change table AtServerRuleOvrd~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_AtServerRuleOvrd (Priority smallint NULL, AtServerRuleOvrdId int NULL, ServerRuleId int NULL, ScreenId int NULL, Disable char(1) NULL, ServerRuleOvrdDesc varchar(1000) NULL, ServerRuleOvrdName varchar(500) NULL, ServerRuleGuid varchar(50) NULL)') EXEC (' INSERT INTO dbo.Tmp_AtServerRuleOvrd (Priority, AtServerRuleOvrdId, ServerRuleId, ScreenId, Disable, ServerRuleOvrdDesc, ServerRuleOvrdName, ServerRuleGuid) SELECT convert(smallint,Priority), convert(int,AtServerRuleOvrdId), convert(int,ServerRuleId), convert(int,ScreenId), Disable, ServerRuleOvrdDesc, ServerRuleOvrdName, ServerRuleGuid FROM dbo.AtServerRuleOvrd IF (SELECT COUNT(1) FROM dbo.Tmp_AtServerRuleOvrd) > 0 OR (SELECT COUNT(1) FROM dbo.AtServerRuleOvrd) = 0 DROP TABLE dbo.AtServerRuleOvrd') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AtServerRuleOvrd'')) CREATE TABLE dbo.AtServerRuleOvrd (AtServerRuleOvrdId Int IDENTITY NOT NULL, ServerRuleOvrdDesc VarChar(1000) NULL, ServerRuleOvrdName VarChar(500) NOT NULL, ServerRuleId Int NOT NULL, Disable Char(1) NOT NULL, ServerRuleGuid VarChar(50) NULL, ScreenId Int NULL, Priority SmallInt NULL, Guid VarChar(50) NOT NULL, CONSTRAINT PK_AtServerRuleOvrd PRIMARY KEY CLUSTERED (AtServerRuleOvrdId))') EXEC (' ALTER TABLE dbo.AtServerRuleOvrd ADD CONSTRAINT DF_AtServerRuleOvrd_Guid DEFAULT (NEWID()) FOR Guid SET IDENTITY_INSERT dbo.AtServerRuleOvrd ON INSERT INTO dbo.AtServerRuleOvrd (AtServerRuleOvrdId, ServerRuleOvrdDesc, ServerRuleOvrdName, ServerRuleId, Disable, ServerRuleGuid, ScreenId, Priority, Guid) SELECT AtServerRuleOvrdId, ServerRuleOvrdDesc, ServerRuleOvrdName, ServerRuleId, Disable, ServerRuleGuid, ScreenId, Priority, NEWID() FROM dbo.Tmp_AtServerRuleOvrd SET IDENTITY_INSERT dbo.AtServerRuleOvrd OFF IF (SELECT COUNT(1) FROM dbo.AtServerRuleOvrd) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AtServerRuleOvrd) = 0 DROP TABLE dbo.Tmp_AtServerRuleOvrd')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7783&typ=N&sys=3","","",""); return false;
7784~@~  11. 161.00429:D:   20:*:*:M: Change table AtServerRuleOvrdPrm~@~12598~@~20~@~D~@~~@~~@~M~@~~@~Change table AtServerRuleOvrdPrm~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_AtServerRuleOvrdPrm (PermKeyId smallint NULL, ServerRuledOvrdPrmId int NULL, AtServerRuleOvrdId int NULL, PermKeyRowId int NULL, PermId int NULL, AndCondition char(1) NULL, Match char(1) NULL)') EXEC (' INSERT INTO dbo.Tmp_AtServerRuleOvrdPrm (PermKeyId, ServerRuledOvrdPrmId, AtServerRuleOvrdId, PermKeyRowId, PermId, AndCondition, Match) SELECT convert(smallint,PermKeyId), convert(int,ServerRuledOvrdPrmId), convert(int,AtServerRuleOvrdId), convert(int,PermKeyRowId), convert(int,PermId), AndCondition, Match FROM dbo.AtServerRuleOvrdPrm IF (SELECT COUNT(1) FROM dbo.Tmp_AtServerRuleOvrdPrm) > 0 OR (SELECT COUNT(1) FROM dbo.AtServerRuleOvrdPrm) = 0 DROP TABLE dbo.AtServerRuleOvrdPrm') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AtServerRuleOvrdPrm'')) CREATE TABLE dbo.AtServerRuleOvrdPrm (ServerRuledOvrdPrmId Int IDENTITY NOT NULL, PermKeyId SmallInt NOT NULL, AndCondition Char(1) NOT NULL, AtServerRuleOvrdId Int NOT NULL, Match Char(1) NOT NULL, PermKeyRowId Int NULL, PermId Int NULL, Guid VarChar(50) NOT NULL, AtServerRuleOvrdGuid VarChar(50) NULL, CONSTRAINT PK_AtServerRuleOvrdPrm PRIMARY KEY CLUSTERED (ServerRuledOvrdPrmId))') EXEC (' ALTER TABLE dbo.AtServerRuleOvrdPrm ADD CONSTRAINT DF_AtServerRuleOvrdPrm_AtServerRuleOvrdId DEFAULT (-1) FOR AtServerRuleOvrdId ALTER TABLE dbo.AtServerRuleOvrdPrm ADD CONSTRAINT DF_AtServerRuleOvrdPrm_Match DEFAULT (''Y'') FOR Match ALTER TABLE dbo.AtServerRuleOvrdPrm ADD CONSTRAINT DF_AtServerRuleOvrdPrm_Guid DEFAULT (NEWID()) FOR Guid SET IDENTITY_INSERT dbo.AtServerRuleOvrdPrm ON INSERT INTO dbo.AtServerRuleOvrdPrm (ServerRuledOvrdPrmId, PermKeyId, AndCondition, AtServerRuleOvrdId, Match, PermKeyRowId, PermId, Guid) SELECT ServerRuledOvrdPrmId, PermKeyId, AndCondition, AtServerRuleOvrdId, Match, PermKeyRowId, PermId, NEWID() FROM dbo.Tmp_AtServerRuleOvrdPrm SET IDENTITY_INSERT dbo.AtServerRuleOvrdPrm OFF IF (SELECT COUNT(1) FROM dbo.AtServerRuleOvrdPrm) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AtServerRuleOvrdPrm) = 0 DROP TABLE dbo.Tmp_AtServerRuleOvrdPrm')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7784&typ=N&sys=3","","",""); return false;
7785~@~  11. 162.00430:D:   10:*:*:M: Change table AtServerRuleOvrd~@~12599~@~10~@~D~@~~@~~@~M~@~~@~Change table AtServerRuleOvrd~@~Y~@~ EXEC (' CREATE TABLE dbo.Tmp_AtServerRuleOvrd (Priority smallint NULL, AtServerRuleOvrdId int NULL, ServerRuleId int NULL, ScreenId int NULL, Disable char(1) NULL, ServerRuleOvrdDesc varchar(1000) NULL, ServerRuleOvrdName varchar(500) NULL, ServerRuleGuid varchar(50) NULL, Guid varchar(50) NULL)') EXEC (' INSERT INTO dbo.Tmp_AtServerRuleOvrd (Priority, AtServerRuleOvrdId, ServerRuleId, ScreenId, Disable, ServerRuleOvrdDesc, ServerRuleOvrdName, ServerRuleGuid, Guid) SELECT convert(smallint,Priority), convert(int,AtServerRuleOvrdId), convert(int,ServerRuleId), convert(int,ScreenId), Disable, ServerRuleOvrdDesc, ServerRuleOvrdName, ServerRuleGuid, Guid FROM dbo.AtServerRuleOvrd IF (SELECT COUNT(1) FROM dbo.Tmp_AtServerRuleOvrd) > 0 OR (SELECT COUNT(1) FROM dbo.AtServerRuleOvrd) = 0 DROP TABLE dbo.AtServerRuleOvrd') EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.AtServerRuleOvrd'')) CREATE TABLE dbo.AtServerRuleOvrd (AtServerRuleOvrdId Int IDENTITY NOT NULL, ServerRuleOvrdDesc VarChar(1000) NULL, ServerRuleOvrdName VarChar(500) NOT NULL, ServerRuleId Int NOT NULL, Disable Char(1) NOT NULL, ServerRuleGuid VarChar(50) NULL, ScreenId Int NULL, Priority SmallInt NULL, Guid VarChar(50) NOT NULL, RunMode Char(1) NULL, CONSTRAINT PK_AtServerRuleOvrd PRIMARY KEY CLUSTERED (AtServerRuleOvrdId))') EXEC (' ALTER TABLE dbo.AtServerRuleOvrd ADD CONSTRAINT DF_AtServerRuleOvrd_Guid DEFAULT (NEWID()) FOR Guid SET IDENTITY_INSERT dbo.AtServerRuleOvrd ON INSERT INTO dbo.AtServerRuleOvrd (AtServerRuleOvrdId, ServerRuleOvrdDesc, ServerRuleOvrdName, ServerRuleId, Disable, ServerRuleGuid, ScreenId, Priority, Guid) SELECT AtServerRuleOvrdId, ServerRuleOvrdDesc, ServerRuleOvrdName, ServerRuleId, Disable, ServerRuleGuid, ScreenId, Priority, Guid FROM dbo.Tmp_AtServerRuleOvrd SET IDENTITY_INSERT dbo.AtServerRuleOvrd OFF IF (SELECT COUNT(1) FROM dbo.AtServerRuleOvrd) > 0 OR (SELECT COUNT(1) FROM dbo.Tmp_AtServerRuleOvrd) = 0 DROP TABLE dbo.Tmp_AtServerRuleOvrd')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7785&typ=N&sys=3","","",""); return false;
7786~@~  11. 162.00430:D:   20:*:*:M: Add table utServerRuleOvrd~@~12599~@~20~@~D~@~~@~~@~M~@~~@~Add table utServerRuleOvrd~@~Y~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.utServerRuleOvrd'')) CREATE TABLE dbo.utServerRuleOvrd (AtServerRuleOvrdId Int NOT NULL, ServerRuleOvrdDesc VarChar(1000) NULL, ServerRuleOvrdName VarChar(500) NOT NULL, ServerRuleId Int NOT NULL, Disable Char(1) NOT NULL, ServerRuleGuid VarChar(50) NULL, ScreenId Int NULL, Priority SmallInt NULL, Guid VarChar(50) NOT NULL, RunMode Char(1) NULL, CONSTRAINT PK_utServerRuleOvrd PRIMARY KEY CLUSTERED (AtServerRuleOvrdId))') EXEC (' ALTER TABLE dbo.utServerRuleOvrd ADD CONSTRAINT DF_utServerRuleOvrd_Guid DEFAULT (NEWID()) FOR Guid') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7786&typ=N&sys=3","","",""); return false;
7787~@~  11. 162.00430:D:   30:*:*:M: Add table utServerRuleOvrdPrm~@~12599~@~30~@~D~@~~@~~@~M~@~~@~Add table utServerRuleOvrdPrm~@~Y~@~ EXEC (' IF NOT EXISTS (SELECT 1 FROM dbo.sysobjects WHERE id = object_id(''dbo.utServerRuleOvrdPrm'')) CREATE TABLE dbo.utServerRuleOvrdPrm (ServerRuledOvrdPrmId Int IDENTITY NOT NULL, PermKeyId SmallInt NOT NULL, AndCondition Char(1) NOT NULL, AtServerRuleOvrdId Int NOT NULL, Match Char(1) NOT NULL, PermKeyRowId Int NULL, PermId Int NULL, Guid VarChar(50) NOT NULL, AtServerRuleOvrdGuid VarChar(50) NULL, CONSTRAINT PK_utServerRuleOvrdPrm PRIMARY KEY CLUSTERED (ServerRuledOvrdPrmId))') EXEC (' ALTER TABLE dbo.utServerRuleOvrdPrm ADD CONSTRAINT DF_utServerRuleOvrdPrm_AtServerRuleOvrdId DEFAULT (-1) FOR AtServerRuleOvrdId ALTER TABLE dbo.utServerRuleOvrdPrm ADD CONSTRAINT DF_utServerRuleOvrdPrm_Match DEFAULT (''Y'') FOR Match ALTER TABLE dbo.utServerRuleOvrdPrm ADD CONSTRAINT DF_utServerRuleOvrdPrm_Guid DEFAULT (NEWID()) FOR Guid') EXEC ('') EXEC ('')~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7787&typ=N&sys=3","","",""); return false;
7790~@~  10.  26.60726:D:   20:*:*:M: Post ColOvrd change script~@~10465~@~20~@~D~@~~@~~@~M~@~~@~Post ColOvrd change script~@~Y~@~EXEC ('UPDATE ScreenObj SET RequiredValid = ''N'' WHERE DisplayModeId in (4,21)')
EXEC ('UPDATE ScreenCri SET RequiredValid = ''N'' WHERE DisplayModeId in (4,21)')
EXEC ('UPDATE ReportCri SET RequiredValid = ''N'' WHERE DisplayModeId in (4,21)')

~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7790&typ=N&sys=3","","",""); return false;
7791~@~  10.  26.60726:D:   30:*:*:M: Post ColOvrd change script - map PermKeyRowId~@~10465~@~30~@~D~@~~@~~@~M~@~~@~Post ColOvrd change script - map PermKeyRowId~@~Y~@~/* can't be done here, as VwPermKeyRow is not created YET for existing installation 
EXEC ('update c set PermKeyRowId = p.PermKeyRowId from dbo.ColOvrd c inner join [[?]]Design.dbo.VwPermKeyRow p on c.PermId = p.PermId and c.PermKeyId = p.PermKeyId WHERE c.PermKeyRowId IS NULL')
*/
~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7791&typ=N&sys=3","","",""); return false;
7792~@~  11. 168.00505:D:   10:*:*:M: remove dangling foreign keys~@~12605~@~10~@~D~@~~@~~@~M~@~~@~remove dangling foreign keys~@~Y~@~if exists (select * from dbo.sysobjects where id = object_id(N'dbo.FK_ScreenLstCri_UsrId') and OBJECTPROPERTY(id, N'IsForeignKey') = 1)
ALTER TABLE dbo.ScreenLstCri DROP CONSTRAINT FK_ScreenLstCri_UsrId 

if exists (select * from dbo.sysobjects where id = object_id(N'dbo.FK_ScreenObj_Screen') and OBJECTPROPERTY(id, N'IsForeignKey') = 1)
ALTER TABLE dbo.ScreenObj DROP CONSTRAINT FK_ScreenObj_Screen ~@~N~@~~@~~@~~@~~@~SearchLink("AdmAppItem.aspx?id=213&key=7792&typ=N&sys=3","","",""); return false;
